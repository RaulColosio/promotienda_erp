(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function $S(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var b0={exports:{}},Ad={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oE;function SD(){if(oE)return Ad;oE=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,i,o){var u=null;if(o!==void 0&&(u=""+o),i.key!==void 0&&(u=""+i.key),"key"in i){o={};for(var h in i)h!=="key"&&(o[h]=i[h])}else o=i;return i=o.ref,{$$typeof:n,type:s,key:u,ref:i!==void 0?i:null,props:o}}return Ad.Fragment=e,Ad.jsx=t,Ad.jsxs=t,Ad}var lE;function ND(){return lE||(lE=1,b0.exports=SD()),b0.exports}var c=ND(),w0={exports:{}},Qe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cE;function AD(){if(cE)return Qe;cE=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),v=Symbol.iterator;function b(O){return O===null||typeof O!="object"?null:(O=v&&O[v]||O["@@iterator"],typeof O=="function"?O:null)}var I={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,E={};function A(O,oe,me){this.props=O,this.context=oe,this.refs=E,this.updater=me||I}A.prototype.isReactComponent={},A.prototype.setState=function(O,oe){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,oe,"setState")},A.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function C(){}C.prototype=A.prototype;function q(O,oe,me){this.props=O,this.context=oe,this.refs=E,this.updater=me||I}var P=q.prototype=new C;P.constructor=q,N(P,A.prototype),P.isPureReactComponent=!0;var V=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},K=Object.prototype.hasOwnProperty;function L(O,oe,me,te,we,Ce){return me=Ce.ref,{$$typeof:n,type:O,key:oe,ref:me!==void 0?me:null,props:Ce}}function k(O,oe){return L(O.type,oe,void 0,void 0,void 0,O.props)}function D(O){return typeof O=="object"&&O!==null&&O.$$typeof===n}function M(O){var oe={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(me){return oe[me]})}var B=/\/+/g;function G(O,oe){return typeof O=="object"&&O!==null&&O.key!=null?M(""+O.key):oe.toString(36)}function z(){}function he(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(z,z):(O.status="pending",O.then(function(oe){O.status==="pending"&&(O.status="fulfilled",O.value=oe)},function(oe){O.status==="pending"&&(O.status="rejected",O.reason=oe)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function Se(O,oe,me,te,we){var Ce=typeof O;(Ce==="undefined"||Ce==="boolean")&&(O=null);var Pe=!1;if(O===null)Pe=!0;else switch(Ce){case"bigint":case"string":case"number":Pe=!0;break;case"object":switch(O.$$typeof){case n:case e:Pe=!0;break;case x:return Pe=O._init,Se(Pe(O._payload),oe,me,te,we)}}if(Pe)return we=we(O),Pe=te===""?"."+G(O,0):te,V(we)?(me="",Pe!=null&&(me=Pe.replace(B,"$&/")+"/"),Se(we,oe,me,"",function(Ot){return Ot})):we!=null&&(D(we)&&(we=k(we,me+(we.key==null||O&&O.key===we.key?"":(""+we.key).replace(B,"$&/")+"/")+Pe)),oe.push(we)),1;Pe=0;var xt=te===""?".":te+":";if(V(O))for(var rt=0;rt<O.length;rt++)te=O[rt],Ce=xt+G(te,rt),Pe+=Se(te,oe,me,Ce,we);else if(rt=b(O),typeof rt=="function")for(O=rt.call(O),rt=0;!(te=O.next()).done;)te=te.value,Ce=xt+G(te,rt++),Pe+=Se(te,oe,me,Ce,we);else if(Ce==="object"){if(typeof O.then=="function")return Se(he(O),oe,me,te,we);throw oe=String(O),Error("Objects are not valid as a React child (found: "+(oe==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":oe)+"). If you meant to render a collection of children, use an array instead.")}return Pe}function J(O,oe,me){if(O==null)return O;var te=[],we=0;return Se(O,te,"","",function(Ce){return oe.call(me,Ce,we++)}),te}function ge(O){if(O._status===-1){var oe=O._result;oe=oe(),oe.then(function(me){(O._status===0||O._status===-1)&&(O._status=1,O._result=me)},function(me){(O._status===0||O._status===-1)&&(O._status=2,O._result=me)}),O._status===-1&&(O._status=0,O._result=oe)}if(O._status===1)return O._result.default;throw O._result}var le=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var oe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(oe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)};function Ie(){}return Qe.Children={map:J,forEach:function(O,oe,me){J(O,function(){oe.apply(this,arguments)},me)},count:function(O){var oe=0;return J(O,function(){oe++}),oe},toArray:function(O){return J(O,function(oe){return oe})||[]},only:function(O){if(!D(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},Qe.Component=A,Qe.Fragment=t,Qe.Profiler=i,Qe.PureComponent=q,Qe.StrictMode=s,Qe.Suspense=f,Qe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,Qe.__COMPILER_RUNTIME={__proto__:null,c:function(O){return F.H.useMemoCache(O)}},Qe.cache=function(O){return function(){return O.apply(null,arguments)}},Qe.cloneElement=function(O,oe,me){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var te=N({},O.props),we=O.key,Ce=void 0;if(oe!=null)for(Pe in oe.ref!==void 0&&(Ce=void 0),oe.key!==void 0&&(we=""+oe.key),oe)!K.call(oe,Pe)||Pe==="key"||Pe==="__self"||Pe==="__source"||Pe==="ref"&&oe.ref===void 0||(te[Pe]=oe[Pe]);var Pe=arguments.length-2;if(Pe===1)te.children=me;else if(1<Pe){for(var xt=Array(Pe),rt=0;rt<Pe;rt++)xt[rt]=arguments[rt+2];te.children=xt}return L(O.type,we,void 0,void 0,Ce,te)},Qe.createContext=function(O){return O={$$typeof:u,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:o,_context:O},O},Qe.createElement=function(O,oe,me){var te,we={},Ce=null;if(oe!=null)for(te in oe.key!==void 0&&(Ce=""+oe.key),oe)K.call(oe,te)&&te!=="key"&&te!=="__self"&&te!=="__source"&&(we[te]=oe[te]);var Pe=arguments.length-2;if(Pe===1)we.children=me;else if(1<Pe){for(var xt=Array(Pe),rt=0;rt<Pe;rt++)xt[rt]=arguments[rt+2];we.children=xt}if(O&&O.defaultProps)for(te in Pe=O.defaultProps,Pe)we[te]===void 0&&(we[te]=Pe[te]);return L(O,Ce,void 0,void 0,null,we)},Qe.createRef=function(){return{current:null}},Qe.forwardRef=function(O){return{$$typeof:h,render:O}},Qe.isValidElement=D,Qe.lazy=function(O){return{$$typeof:x,_payload:{_status:-1,_result:O},_init:ge}},Qe.memo=function(O,oe){return{$$typeof:p,type:O,compare:oe===void 0?null:oe}},Qe.startTransition=function(O){var oe=F.T,me={};F.T=me;try{var te=O(),we=F.S;we!==null&&we(me,te),typeof te=="object"&&te!==null&&typeof te.then=="function"&&te.then(Ie,le)}catch(Ce){le(Ce)}finally{F.T=oe}},Qe.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},Qe.use=function(O){return F.H.use(O)},Qe.useActionState=function(O,oe,me){return F.H.useActionState(O,oe,me)},Qe.useCallback=function(O,oe){return F.H.useCallback(O,oe)},Qe.useContext=function(O){return F.H.useContext(O)},Qe.useDebugValue=function(){},Qe.useDeferredValue=function(O,oe){return F.H.useDeferredValue(O,oe)},Qe.useEffect=function(O,oe,me){var te=F.H;if(typeof me=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return te.useEffect(O,oe)},Qe.useId=function(){return F.H.useId()},Qe.useImperativeHandle=function(O,oe,me){return F.H.useImperativeHandle(O,oe,me)},Qe.useInsertionEffect=function(O,oe){return F.H.useInsertionEffect(O,oe)},Qe.useLayoutEffect=function(O,oe){return F.H.useLayoutEffect(O,oe)},Qe.useMemo=function(O,oe){return F.H.useMemo(O,oe)},Qe.useOptimistic=function(O,oe){return F.H.useOptimistic(O,oe)},Qe.useReducer=function(O,oe,me){return F.H.useReducer(O,oe,me)},Qe.useRef=function(O){return F.H.useRef(O)},Qe.useState=function(O){return F.H.useState(O)},Qe.useSyncExternalStore=function(O,oe,me){return F.H.useSyncExternalStore(O,oe,me)},Qe.useTransition=function(){return F.H.useTransition()},Qe.version="19.1.0",Qe}var uE;function Gx(){return uE||(uE=1,w0.exports=AD()),w0.exports}var S=Gx();const Wi=$S(S);var T0={exports:{}},Rd={},E0={exports:{}},I0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dE;function RD(){return dE||(dE=1,function(n){function e(J,ge){var le=J.length;J.push(ge);e:for(;0<le;){var Ie=le-1>>>1,O=J[Ie];if(0<i(O,ge))J[Ie]=ge,J[le]=O,le=Ie;else break e}}function t(J){return J.length===0?null:J[0]}function s(J){if(J.length===0)return null;var ge=J[0],le=J.pop();if(le!==ge){J[0]=le;e:for(var Ie=0,O=J.length,oe=O>>>1;Ie<oe;){var me=2*(Ie+1)-1,te=J[me],we=me+1,Ce=J[we];if(0>i(te,le))we<O&&0>i(Ce,te)?(J[Ie]=Ce,J[we]=le,Ie=we):(J[Ie]=te,J[me]=le,Ie=me);else if(we<O&&0>i(Ce,le))J[Ie]=Ce,J[we]=le,Ie=we;else break e}}return ge}function i(J,ge){var le=J.sortIndex-ge.sortIndex;return le!==0?le:J.id-ge.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var u=Date,h=u.now();n.unstable_now=function(){return u.now()-h}}var f=[],p=[],x=1,v=null,b=3,I=!1,N=!1,E=!1,A=!1,C=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;function V(J){for(var ge=t(p);ge!==null;){if(ge.callback===null)s(p);else if(ge.startTime<=J)s(p),ge.sortIndex=ge.expirationTime,e(f,ge);else break;ge=t(p)}}function F(J){if(E=!1,V(J),!N)if(t(f)!==null)N=!0,K||(K=!0,G());else{var ge=t(p);ge!==null&&Se(F,ge.startTime-J)}}var K=!1,L=-1,k=5,D=-1;function M(){return A?!0:!(n.unstable_now()-D<k)}function B(){if(A=!1,K){var J=n.unstable_now();D=J;var ge=!0;try{e:{N=!1,E&&(E=!1,q(L),L=-1),I=!0;var le=b;try{t:{for(V(J),v=t(f);v!==null&&!(v.expirationTime>J&&M());){var Ie=v.callback;if(typeof Ie=="function"){v.callback=null,b=v.priorityLevel;var O=Ie(v.expirationTime<=J);if(J=n.unstable_now(),typeof O=="function"){v.callback=O,V(J),ge=!0;break t}v===t(f)&&s(f),V(J)}else s(f);v=t(f)}if(v!==null)ge=!0;else{var oe=t(p);oe!==null&&Se(F,oe.startTime-J),ge=!1}}break e}finally{v=null,b=le,I=!1}ge=void 0}}finally{ge?G():K=!1}}}var G;if(typeof P=="function")G=function(){P(B)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,he=z.port2;z.port1.onmessage=B,G=function(){he.postMessage(null)}}else G=function(){C(B,0)};function Se(J,ge){L=C(function(){J(n.unstable_now())},ge)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(J){J.callback=null},n.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<J?Math.floor(1e3/J):5},n.unstable_getCurrentPriorityLevel=function(){return b},n.unstable_next=function(J){switch(b){case 1:case 2:case 3:var ge=3;break;default:ge=b}var le=b;b=ge;try{return J()}finally{b=le}},n.unstable_requestPaint=function(){A=!0},n.unstable_runWithPriority=function(J,ge){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var le=b;b=J;try{return ge()}finally{b=le}},n.unstable_scheduleCallback=function(J,ge,le){var Ie=n.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?Ie+le:Ie):le=Ie,J){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=le+O,J={id:x++,callback:ge,priorityLevel:J,startTime:le,expirationTime:O,sortIndex:-1},le>Ie?(J.sortIndex=le,e(p,J),t(f)===null&&J===t(p)&&(E?(q(L),L=-1):E=!0,Se(F,le-Ie))):(J.sortIndex=O,e(f,J),N||I||(N=!0,K||(K=!0,G()))),J},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(J){var ge=b;return function(){var le=b;b=ge;try{return J.apply(this,arguments)}finally{b=le}}}}(I0)),I0}var hE;function CD(){return hE||(hE=1,E0.exports=RD()),E0.exports}var S0={exports:{}},Wn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fE;function DD(){if(fE)return Wn;fE=1;var n=Gx();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)p+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function o(f,p,x){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:v==null?null:""+v,children:f,containerInfo:p,implementation:x}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return Wn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Wn.createPortal=function(f,p){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return o(f,p,null,x)},Wn.flushSync=function(f){var p=u.T,x=s.p;try{if(u.T=null,s.p=2,f)return f()}finally{u.T=p,s.p=x,s.d.f()}},Wn.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,s.d.C(f,p))},Wn.prefetchDNS=function(f){typeof f=="string"&&s.d.D(f)},Wn.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var x=p.as,v=h(x,p.crossOrigin),b=typeof p.integrity=="string"?p.integrity:void 0,I=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;x==="style"?s.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:v,integrity:b,fetchPriority:I}):x==="script"&&s.d.X(f,{crossOrigin:v,integrity:b,fetchPriority:I,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},Wn.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var x=h(p.as,p.crossOrigin);s.d.M(f,{crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&s.d.M(f)},Wn.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var x=p.as,v=h(x,p.crossOrigin);s.d.L(f,x,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},Wn.preloadModule=function(f,p){if(typeof f=="string")if(p){var x=h(p.as,p.crossOrigin);s.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else s.d.m(f)},Wn.requestFormReset=function(f){s.d.r(f)},Wn.unstable_batchedUpdates=function(f,p){return f(p)},Wn.useFormState=function(f,p,x){return u.H.useFormState(f,p,x)},Wn.useFormStatus=function(){return u.H.useHostTransitionStatus()},Wn.version="19.1.0",Wn}var mE;function kD(){if(mE)return S0.exports;mE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),S0.exports=DD(),S0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pE;function jD(){if(pE)return Rd;pE=1;var n=CD(),e=Gx(),t=kD();function s(r){var a="https://react.dev/errors/"+r;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var a=r,l=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(l=a.return),r=a.return;while(r)}return a.tag===3?l:null}function u(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function h(r){if(o(r)!==r)throw Error(s(188))}function f(r){var a=r.alternate;if(!a){if(a=o(r),a===null)throw Error(s(188));return a!==r?null:r}for(var l=r,d=a;;){var g=l.return;if(g===null)break;var y=g.alternate;if(y===null){if(d=g.return,d!==null){l=d;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===l)return h(g),r;if(y===d)return h(g),a;y=y.sibling}throw Error(s(188))}if(l.return!==d.return)l=g,d=y;else{for(var T=!1,R=g.child;R;){if(R===l){T=!0,l=g,d=y;break}if(R===d){T=!0,d=g,l=y;break}R=R.sibling}if(!T){for(R=y.child;R;){if(R===l){T=!0,l=y,d=g;break}if(R===d){T=!0,d=y,l=g;break}R=R.sibling}if(!T)throw Error(s(189))}}if(l.alternate!==d)throw Error(s(190))}if(l.tag!==3)throw Error(s(188));return l.stateNode.current===l?r:a}function p(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r;for(r=r.child;r!==null;){if(a=p(r),a!==null)return a;r=r.sibling}return null}var x=Object.assign,v=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),I=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),q=Symbol.for("react.consumer"),P=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function G(r){return r===null||typeof r!="object"?null:(r=B&&r[B]||r["@@iterator"],typeof r=="function"?r:null)}var z=Symbol.for("react.client.reference");function he(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===z?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case N:return"Fragment";case A:return"Profiler";case E:return"StrictMode";case F:return"Suspense";case K:return"SuspenseList";case D:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case I:return"Portal";case P:return(r.displayName||"Context")+".Provider";case q:return(r._context.displayName||"Context")+".Consumer";case V:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case L:return a=r.displayName||null,a!==null?a:he(r.type)||"Memo";case k:a=r._payload,r=r._init;try{return he(r(a))}catch{}}return null}var Se=Array.isArray,J=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ge=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le={pending:!1,data:null,method:null,action:null},Ie=[],O=-1;function oe(r){return{current:r}}function me(r){0>O||(r.current=Ie[O],Ie[O]=null,O--)}function te(r,a){O++,Ie[O]=r.current,r.current=a}var we=oe(null),Ce=oe(null),Pe=oe(null),xt=oe(null);function rt(r,a){switch(te(Pe,a),te(Ce,r),te(we,null),a.nodeType){case 9:case 11:r=(r=a.documentElement)&&(r=r.namespaceURI)?OT(r):0;break;default:if(r=a.tagName,a=a.namespaceURI)a=OT(a),r=MT(a,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}me(we),te(we,r)}function Ot(){me(we),me(Ce),me(Pe)}function ws(r){r.memoizedState!==null&&te(xt,r);var a=we.current,l=MT(a,r.type);a!==l&&(te(Ce,r),te(we,l))}function Ts(r){Ce.current===r&&(me(we),me(Ce)),xt.current===r&&(me(xt),Td._currentValue=le)}var Es=Object.prototype.hasOwnProperty,lr=n.unstable_scheduleCallback,Ne=n.unstable_cancelCallback,Je=n.unstable_shouldYield,ct=n.unstable_requestPaint,Yt=n.unstable_now,It=n.unstable_getCurrentPriorityLevel,dt=n.unstable_ImmediatePriority,rn=n.unstable_UserBlockingPriority,cr=n.unstable_NormalPriority,yo=n.unstable_LowPriority,ur=n.unstable_IdlePriority,xo=n.log,kl=n.unstable_setDisableYieldValue,Ft=null,ht=null;function rs(r){if(typeof xo=="function"&&kl(r),ht&&typeof ht.setStrictMode=="function")try{ht.setStrictMode(Ft,r)}catch{}}var Nn=Math.clz32?Math.clz32:Is,zs=Math.log,jl=Math.LN2;function Is(r){return r>>>=0,r===0?32:31-(zs(r)/jl|0)|0}var dr=256,kr=4194304;function Ss(r){var a=r&42;if(a!==0)return a;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function aa(r,a,l){var d=r.pendingLanes;if(d===0)return 0;var g=0,y=r.suspendedLanes,T=r.pingedLanes;r=r.warmLanes;var R=d&134217727;return R!==0?(d=R&~y,d!==0?g=Ss(d):(T&=R,T!==0?g=Ss(T):l||(l=R&~r,l!==0&&(g=Ss(l))))):(R=d&~y,R!==0?g=Ss(R):T!==0?g=Ss(T):l||(l=d&~r,l!==0&&(g=Ss(l)))),g===0?0:a!==0&&a!==g&&(a&y)===0&&(y=g&-g,l=a&-a,y>=l||y===32&&(l&4194048)!==0)?a:g}function fi(r,a){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&a)===0}function vo(r,a){switch(r){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _o(){var r=dr;return dr<<=1,(dr&4194048)===0&&(dr=256),r}function bo(){var r=kr;return kr<<=1,(kr&62914560)===0&&(kr=4194304),r}function hr(r){for(var a=[],l=0;31>l;l++)a.push(r);return a}function fr(r,a){r.pendingLanes|=a,a!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function wo(r,a,l,d,g,y){var T=r.pendingLanes;r.pendingLanes=l,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=l,r.entangledLanes&=l,r.errorRecoveryDisabledLanes&=l,r.shellSuspendCounter=0;var R=r.entanglements,H=r.expirationTimes,ee=r.hiddenUpdates;for(l=T&~l;0<l;){var ce=31-Nn(l),fe=1<<ce;R[ce]=0,H[ce]=-1;var se=ee[ce];if(se!==null)for(ee[ce]=null,ce=0;ce<se.length;ce++){var re=se[ce];re!==null&&(re.lane&=-536870913)}l&=~fe}d!==0&&an(r,d,0),y!==0&&g===0&&r.tag!==0&&(r.suspendedLanes|=y&~(T&~a))}function an(r,a,l){r.pendingLanes|=a,r.suspendedLanes&=~a;var d=31-Nn(a);r.entangledLanes|=a,r.entanglements[d]=r.entanglements[d]|1073741824|l&4194090}function To(r,a){var l=r.entangledLanes|=a;for(r=r.entanglements;l;){var d=31-Nn(l),g=1<<d;g&a|r[d]&a&&(r[d]|=a),l&=~g}}function jr(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function oa(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function mr(){var r=ge.p;return r!==0?r:(r=window.event,r===void 0?32:tE(r.type))}function Au(r,a){var l=ge.p;try{return ge.p=r,a()}finally{ge.p=l}}var Mt=Math.random().toString(36).slice(2),mn="__reactFiber$"+Mt,on="__reactProps$"+Mt,Ns="__reactContainer$"+Mt,Pl="__reactEvents$"+Mt,ff="__reactListeners$"+Mt,mi="__reactHandles$"+Mt,Ru="__reactResources$"+Mt,la="__reactMarker$"+Mt;function pi(r){delete r[mn],delete r[on],delete r[Pl],delete r[ff],delete r[mi]}function Pr(r){var a=r[mn];if(a)return a;for(var l=r.parentNode;l;){if(a=l[Ns]||l[mn]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(r=FT(r);r!==null;){if(l=r[mn])return l;r=FT(r)}return a}r=l,l=r.parentNode}return null}function pr(r){if(r=r[mn]||r[Ns]){var a=r.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return r}return null}function gr(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r.stateNode;throw Error(s(33))}function Kn(r){var a=r[Ru];return a||(a=r[Ru]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Xt(r){r[la]=!0}var Ol=new Set,Eo={};function qs(r,a){Or(r,a),Or(r+"Capture",a)}function Or(r,a){for(Eo[r]=a,r=0;r<a.length;r++)Ol.add(a[r])}var Cu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Du={},ca={};function ku(r){return Es.call(ca,r)?!0:Es.call(Du,r)?!1:Cu.test(r)?ca[r]=!0:(Du[r]=!0,!1)}function gi(r,a,l){if(ku(a))if(l===null)r.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":r.removeAttribute(a);return;case"boolean":var d=a.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){r.removeAttribute(a);return}}r.setAttribute(a,""+l)}}function yr(r,a,l){if(l===null)r.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(a);return}r.setAttribute(a,""+l)}}function An(r,a,l,d){if(d===null)r.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttributeNS(a,l,""+d)}}var ua,ju;function Mr(r){if(ua===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);ua=a&&a[1]||"",ju=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ua+r+ju}var da=!1;function U(r,a){if(!r||da)return"";da=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(a){var fe=function(){throw Error()};if(Object.defineProperty(fe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(fe,[])}catch(re){var se=re}Reflect.construct(r,[],fe)}else{try{fe.call()}catch(re){se=re}r.call(fe.prototype)}}else{try{throw Error()}catch(re){se=re}(fe=r())&&typeof fe.catch=="function"&&fe.catch(function(){})}}catch(re){if(re&&se&&typeof re.stack=="string")return[re.stack,se.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=d.DetermineComponentFrameRoot(),T=y[0],R=y[1];if(T&&R){var H=T.split(`
`),ee=R.split(`
`);for(g=d=0;d<H.length&&!H[d].includes("DetermineComponentFrameRoot");)d++;for(;g<ee.length&&!ee[g].includes("DetermineComponentFrameRoot");)g++;if(d===H.length||g===ee.length)for(d=H.length-1,g=ee.length-1;1<=d&&0<=g&&H[d]!==ee[g];)g--;for(;1<=d&&0<=g;d--,g--)if(H[d]!==ee[g]){if(d!==1||g!==1)do if(d--,g--,0>g||H[d]!==ee[g]){var ce=`
`+H[d].replace(" at new "," at ");return r.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",r.displayName)),ce}while(1<=d&&0<=g);break}}}finally{da=!1,Error.prepareStackTrace=l}return(l=r?r.displayName||r.name:"")?Mr(l):""}function Z(r){switch(r.tag){case 26:case 27:case 5:return Mr(r.type);case 16:return Mr("Lazy");case 13:return Mr("Suspense");case 19:return Mr("SuspenseList");case 0:case 15:return U(r.type,!1);case 11:return U(r.type.render,!1);case 1:return U(r.type,!0);case 31:return Mr("Activity");default:return""}}function ne(r){try{var a="";do a+=Z(r),r=r.return;while(r);return a}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function ue(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function ve(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function xe(r){var a=ve(r)?"checked":"value",l=Object.getOwnPropertyDescriptor(r.constructor.prototype,a),d=""+r[a];if(!r.hasOwnProperty(a)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var g=l.get,y=l.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return g.call(this)},set:function(T){d=""+T,y.call(this,T)}}),Object.defineProperty(r,a,{enumerable:l.enumerable}),{getValue:function(){return d},setValue:function(T){d=""+T},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function Le(r){r._valueTracker||(r._valueTracker=xe(r))}function je(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var l=a.getValue(),d="";return r&&(d=ve(r)?r.checked?"true":"false":r.value),r=d,r!==l?(a.setValue(r),!0):!1}function Me(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var gt=/[\n"\\]/g;function ft(r){return r.replace(gt,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Be(r,a,l,d,g,y,T,R){r.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?r.type=T:r.removeAttribute("type"),a!=null?T==="number"?(a===0&&r.value===""||r.value!=a)&&(r.value=""+ue(a)):r.value!==""+ue(a)&&(r.value=""+ue(a)):T!=="submit"&&T!=="reset"||r.removeAttribute("value"),a!=null?ut(r,T,ue(a)):l!=null?ut(r,T,ue(l)):d!=null&&r.removeAttribute("value"),g==null&&y!=null&&(r.defaultChecked=!!y),g!=null&&(r.checked=g&&typeof g!="function"&&typeof g!="symbol"),R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?r.name=""+ue(R):r.removeAttribute("name")}function Dt(r,a,l,d,g,y,T,R){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),a!=null||l!=null){if(!(y!=="submit"&&y!=="reset"||a!=null))return;l=l!=null?""+ue(l):"",a=a!=null?""+ue(a):l,R||a===r.value||(r.value=a),r.defaultValue=a}d=d??g,d=typeof d!="function"&&typeof d!="symbol"&&!!d,r.checked=R?r.checked:!!d,r.defaultChecked=!!d,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(r.name=T)}function ut(r,a,l){a==="number"&&Me(r.ownerDocument)===r||r.defaultValue===""+l||(r.defaultValue=""+l)}function Ye(r,a,l,d){if(r=r.options,a){a={};for(var g=0;g<l.length;g++)a["$"+l[g]]=!0;for(l=0;l<r.length;l++)g=a.hasOwnProperty("$"+r[l].value),r[l].selected!==g&&(r[l].selected=g),g&&d&&(r[l].defaultSelected=!0)}else{for(l=""+ue(l),a=null,g=0;g<r.length;g++){if(r[g].value===l){r[g].selected=!0,d&&(r[g].defaultSelected=!0);return}a!==null||r[g].disabled||(a=r[g])}a!==null&&(a.selected=!0)}}function ze(r,a,l){if(a!=null&&(a=""+ue(a),a!==r.value&&(r.value=a),l==null)){r.defaultValue!==a&&(r.defaultValue=a);return}r.defaultValue=l!=null?""+ue(l):""}function Hs(r,a,l,d){if(a==null){if(d!=null){if(l!=null)throw Error(s(92));if(Se(d)){if(1<d.length)throw Error(s(93));d=d[0]}l=d}l==null&&(l=""),a=l}l=ue(a),r.defaultValue=l,d=r.textContent,d===l&&d!==""&&d!==null&&(r.value=d)}function Rn(r,a){if(a){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=a;return}}r.textContent=a}var Vr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ha(r,a,l){var d=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?d?r.setProperty(a,""):a==="float"?r.cssFloat="":r[a]="":d?r.setProperty(a,l):typeof l!="number"||l===0||Vr.has(a)?a==="float"?r.cssFloat=l:r[a]=(""+l).trim():r[a]=l+"px"}function xr(r,a,l){if(a!=null&&typeof a!="object")throw Error(s(62));if(r=r.style,l!=null){for(var d in l)!l.hasOwnProperty(d)||a!=null&&a.hasOwnProperty(d)||(d.indexOf("--")===0?r.setProperty(d,""):d==="float"?r.cssFloat="":r[d]="");for(var g in a)d=a[g],a.hasOwnProperty(g)&&l[g]!==d&&ha(r,g,d)}else for(var y in a)a.hasOwnProperty(y)&&ha(r,y,a[y])}function Pu(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ng=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ag=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ml(r){return Ag.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var yi=null;function Gs(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var xi=null,vi=null;function Ou(r){var a=pr(r);if(a&&(r=a.stateNode)){var l=r[on]||null;e:switch(r=a.stateNode,a.type){case"input":if(Be(r,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+ft(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var d=l[a];if(d!==r&&d.form===r.form){var g=d[on]||null;if(!g)throw Error(s(90));Be(d,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(a=0;a<l.length;a++)d=l[a],d.form===r.form&&je(d)}break e;case"textarea":ze(r,l.value,l.defaultValue);break e;case"select":a=l.value,a!=null&&Ye(r,!!l.multiple,a,!1)}}}var Lr=!1;function mf(r,a,l){if(Lr)return r(a,l);Lr=!0;try{var d=r(a);return d}finally{if(Lr=!1,(xi!==null||vi!==null)&&(om(),xi&&(a=xi,r=vi,vi=xi=null,Ou(a),r)))for(a=0;a<r.length;a++)Ou(r[a])}}function Io(r,a){var l=r.stateNode;if(l===null)return null;var d=l[on]||null;if(d===null)return null;l=d[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(r=r.type,d=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!d;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(s(231,a,typeof l));return l}var vr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$s=!1;if(vr)try{var So={};Object.defineProperty(So,"passive",{get:function(){$s=!0}}),window.addEventListener("test",So,So),window.removeEventListener("test",So,So)}catch{$s=!1}var Ur=null,fa=null,_i=null;function Mu(){if(_i)return _i;var r,a=fa,l=a.length,d,g="value"in Ur?Ur.value:Ur.textContent,y=g.length;for(r=0;r<l&&a[r]===g[r];r++);var T=l-r;for(d=1;d<=T&&a[l-d]===g[y-d];d++);return _i=g.slice(r,1<d?1-d:void 0)}function Fr(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function Br(){return!0}function Vu(){return!1}function Cn(r){function a(l,d,g,y,T){this._reactName=l,this._targetInst=g,this.type=d,this.nativeEvent=y,this.target=T,this.currentTarget=null;for(var R in r)r.hasOwnProperty(R)&&(l=r[R],this[R]=l?l(y):y[R]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Br:Vu,this.isPropagationStopped=Vu,this}return x(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Br)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Br)},persist:function(){},isPersistent:Br}),a}var vt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vl=Cn(vt),No=x({},vt,{view:0,detail:0}),pf=Cn(No),Ll,Ul,zr,Ao=x({},No,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Do,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==zr&&(zr&&r.type==="mousemove"?(Ll=r.screenX-zr.screenX,Ul=r.screenY-zr.screenY):Ul=Ll=0,zr=r),Ll)},movementY:function(r){return"movementY"in r?r.movementY:Ul}}),Ks=Cn(Ao),gf=x({},Ao,{dataTransfer:0}),Rg=Cn(gf),Ro=x({},No,{relatedTarget:0}),Fl=Cn(Ro),Lu=x({},vt,{animationName:0,elapsedTime:0,pseudoElement:0}),Bl=Cn(Lu),yf=x({},vt,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),zl=Cn(yf),Cg=x({},vt,{data:0}),Uu=Cn(Cg),Co={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Fu(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=vf[r])?!!a[r]:!1}function Do(){return Fu}var _f=x({},No,{key:function(r){if(r.key){var a=Co[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=Fr(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?xf[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Do,charCode:function(r){return r.type==="keypress"?Fr(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Fr(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),ql=Cn(_f),bf=x({},Ao,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bu=Cn(bf),bi=x({},No,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Do}),wf=Cn(bi),Tf=x({},vt,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ef=Cn(Tf),If=x({},Ao,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Hl=Cn(If),is=x({},vt,{newState:0,oldState:0}),Sf=Cn(is),Nf=[9,13,27,32],qr=vr&&"CompositionEvent"in window,m=null;vr&&"documentMode"in document&&(m=document.documentMode);var _=vr&&"TextEvent"in window&&!m,w=vr&&(!qr||m&&8<m&&11>=m),j=" ",W=!1;function ae(r,a){switch(r){case"keyup":return Nf.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function be(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var it=!1;function _n(r,a){switch(r){case"compositionend":return be(a);case"keypress":return a.which!==32?null:(W=!0,j);case"textInput":return r=a.data,r===j&&W?null:r;default:return null}}function at(r,a){if(it)return r==="compositionend"||!qr&&ae(r,a)?(r=Mu(),_i=fa=Ur=null,it=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return w&&a.locale!=="ko"?null:a.data;default:return null}}var Dn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bn(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!Dn[r.type]:a==="textarea"}function wi(r,a,l,d){xi?vi?vi.push(d):vi=[d]:xi=d,a=fm(a,"onChange"),0<a.length&&(l=new Vl("onChange","change",null,l,d),r.push({event:l,listeners:a}))}var Ln=null,Hr=null;function zu(r){CT(r,0)}function Af(r){var a=gr(r);if(je(a))return r}function X_(r,a){if(r==="change")return a}var J_=!1;if(vr){var Dg;if(vr){var kg="oninput"in document;if(!kg){var Z_=document.createElement("div");Z_.setAttribute("oninput","return;"),kg=typeof Z_.oninput=="function"}Dg=kg}else Dg=!1;J_=Dg&&(!document.documentMode||9<document.documentMode)}function eb(){Ln&&(Ln.detachEvent("onpropertychange",tb),Hr=Ln=null)}function tb(r){if(r.propertyName==="value"&&Af(Hr)){var a=[];wi(a,Hr,r,Gs(r)),mf(zu,a)}}function nC(r,a,l){r==="focusin"?(eb(),Ln=a,Hr=l,Ln.attachEvent("onpropertychange",tb)):r==="focusout"&&eb()}function sC(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Af(Hr)}function rC(r,a){if(r==="click")return Af(a)}function iC(r,a){if(r==="input"||r==="change")return Af(a)}function aC(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var As=typeof Object.is=="function"?Object.is:aC;function qu(r,a){if(As(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var l=Object.keys(r),d=Object.keys(a);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var g=l[d];if(!Es.call(a,g)||!As(r[g],a[g]))return!1}return!0}function nb(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function sb(r,a){var l=nb(r);r=0;for(var d;l;){if(l.nodeType===3){if(d=r+l.textContent.length,r<=a&&d>=a)return{node:l,offset:a-r};r=d}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=nb(l)}}function rb(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?rb(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function ib(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var a=Me(r.document);a instanceof r.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)r=a.contentWindow;else break;a=Me(r.document)}return a}function jg(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}var oC=vr&&"documentMode"in document&&11>=document.documentMode,Gl=null,Pg=null,Hu=null,Og=!1;function ab(r,a,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Og||Gl==null||Gl!==Me(d)||(d=Gl,"selectionStart"in d&&jg(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Hu&&qu(Hu,d)||(Hu=d,d=fm(Pg,"onSelect"),0<d.length&&(a=new Vl("onSelect","select",null,a,l),r.push({event:a,listeners:d}),a.target=Gl)))}function ko(r,a){var l={};return l[r.toLowerCase()]=a.toLowerCase(),l["Webkit"+r]="webkit"+a,l["Moz"+r]="moz"+a,l}var $l={animationend:ko("Animation","AnimationEnd"),animationiteration:ko("Animation","AnimationIteration"),animationstart:ko("Animation","AnimationStart"),transitionrun:ko("Transition","TransitionRun"),transitionstart:ko("Transition","TransitionStart"),transitioncancel:ko("Transition","TransitionCancel"),transitionend:ko("Transition","TransitionEnd")},Mg={},ob={};vr&&(ob=document.createElement("div").style,"AnimationEvent"in window||(delete $l.animationend.animation,delete $l.animationiteration.animation,delete $l.animationstart.animation),"TransitionEvent"in window||delete $l.transitionend.transition);function jo(r){if(Mg[r])return Mg[r];if(!$l[r])return r;var a=$l[r],l;for(l in a)if(a.hasOwnProperty(l)&&l in ob)return Mg[r]=a[l];return r}var lb=jo("animationend"),cb=jo("animationiteration"),ub=jo("animationstart"),lC=jo("transitionrun"),cC=jo("transitionstart"),uC=jo("transitioncancel"),db=jo("transitionend"),hb=new Map,Vg="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Vg.push("scrollEnd");function _r(r,a){hb.set(r,a),qs(a,[r])}var fb=new WeakMap;function Qs(r,a){if(typeof r=="object"&&r!==null){var l=fb.get(r);return l!==void 0?l:(a={value:r,source:a,stack:ne(a)},fb.set(r,a),a)}return{value:r,source:a,stack:ne(a)}}var Ws=[],Kl=0,Lg=0;function Rf(){for(var r=Kl,a=Lg=Kl=0;a<r;){var l=Ws[a];Ws[a++]=null;var d=Ws[a];Ws[a++]=null;var g=Ws[a];Ws[a++]=null;var y=Ws[a];if(Ws[a++]=null,d!==null&&g!==null){var T=d.pending;T===null?g.next=g:(g.next=T.next,T.next=g),d.pending=g}y!==0&&mb(l,g,y)}}function Cf(r,a,l,d){Ws[Kl++]=r,Ws[Kl++]=a,Ws[Kl++]=l,Ws[Kl++]=d,Lg|=d,r.lanes|=d,r=r.alternate,r!==null&&(r.lanes|=d)}function Ug(r,a,l,d){return Cf(r,a,l,d),Df(r)}function Ql(r,a){return Cf(r,null,null,a),Df(r)}function mb(r,a,l){r.lanes|=l;var d=r.alternate;d!==null&&(d.lanes|=l);for(var g=!1,y=r.return;y!==null;)y.childLanes|=l,d=y.alternate,d!==null&&(d.childLanes|=l),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(g=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,g&&a!==null&&(g=31-Nn(l),r=y.hiddenUpdates,d=r[g],d===null?r[g]=[a]:d.push(a),a.lane=l|536870912),y):null}function Df(r){if(50<pd)throw pd=0,Gy=null,Error(s(185));for(var a=r.return;a!==null;)r=a,a=r.return;return r.tag===3?r.stateNode:null}var Wl={};function dC(r,a,l,d){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rs(r,a,l,d){return new dC(r,a,l,d)}function Fg(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Ti(r,a){var l=r.alternate;return l===null?(l=Rs(r.tag,a,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=a,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&65011712,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,a=r.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l.refCleanup=r.refCleanup,l}function pb(r,a){r.flags&=65011714;var l=r.alternate;return l===null?(r.childLanes=0,r.lanes=a,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,a=l.dependencies,r.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),r}function kf(r,a,l,d,g,y){var T=0;if(d=r,typeof r=="function")Fg(r)&&(T=1);else if(typeof r=="string")T=fD(r,l,we.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case D:return r=Rs(31,l,a,g),r.elementType=D,r.lanes=y,r;case N:return Po(l.children,g,y,a);case E:T=8,g|=24;break;case A:return r=Rs(12,l,a,g|2),r.elementType=A,r.lanes=y,r;case F:return r=Rs(13,l,a,g),r.elementType=F,r.lanes=y,r;case K:return r=Rs(19,l,a,g),r.elementType=K,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case C:case P:T=10;break e;case q:T=9;break e;case V:T=11;break e;case L:T=14;break e;case k:T=16,d=null;break e}T=29,l=Error(s(130,r===null?"null":typeof r,"")),d=null}return a=Rs(T,l,a,g),a.elementType=r,a.type=d,a.lanes=y,a}function Po(r,a,l,d){return r=Rs(7,r,d,a),r.lanes=l,r}function Bg(r,a,l){return r=Rs(6,r,null,a),r.lanes=l,r}function zg(r,a,l){return a=Rs(4,r.children!==null?r.children:[],r.key,a),a.lanes=l,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}var Yl=[],Xl=0,jf=null,Pf=0,Ys=[],Xs=0,Oo=null,Ei=1,Ii="";function Mo(r,a){Yl[Xl++]=Pf,Yl[Xl++]=jf,jf=r,Pf=a}function gb(r,a,l){Ys[Xs++]=Ei,Ys[Xs++]=Ii,Ys[Xs++]=Oo,Oo=r;var d=Ei;r=Ii;var g=32-Nn(d)-1;d&=~(1<<g),l+=1;var y=32-Nn(a)+g;if(30<y){var T=g-g%5;y=(d&(1<<T)-1).toString(32),d>>=T,g-=T,Ei=1<<32-Nn(a)+g|l<<g|d,Ii=y+r}else Ei=1<<y|l<<g|d,Ii=r}function qg(r){r.return!==null&&(Mo(r,1),gb(r,1,0))}function Hg(r){for(;r===jf;)jf=Yl[--Xl],Yl[Xl]=null,Pf=Yl[--Xl],Yl[Xl]=null;for(;r===Oo;)Oo=Ys[--Xs],Ys[Xs]=null,Ii=Ys[--Xs],Ys[Xs]=null,Ei=Ys[--Xs],Ys[Xs]=null}var as=null,Jt=null,yt=!1,Vo=null,Gr=!1,Gg=Error(s(519));function Lo(r){var a=Error(s(418,""));throw Ku(Qs(a,r)),Gg}function yb(r){var a=r.stateNode,l=r.type,d=r.memoizedProps;switch(a[mn]=r,a[on]=d,l){case"dialog":et("cancel",a),et("close",a);break;case"iframe":case"object":case"embed":et("load",a);break;case"video":case"audio":for(l=0;l<yd.length;l++)et(yd[l],a);break;case"source":et("error",a);break;case"img":case"image":case"link":et("error",a),et("load",a);break;case"details":et("toggle",a);break;case"input":et("invalid",a),Dt(a,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0),Le(a);break;case"select":et("invalid",a);break;case"textarea":et("invalid",a),Hs(a,d.value,d.defaultValue,d.children),Le(a)}l=d.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||d.suppressHydrationWarning===!0||PT(a.textContent,l)?(d.popover!=null&&(et("beforetoggle",a),et("toggle",a)),d.onScroll!=null&&et("scroll",a),d.onScrollEnd!=null&&et("scrollend",a),d.onClick!=null&&(a.onclick=mm),a=!0):a=!1,a||Lo(r)}function xb(r){for(as=r.return;as;)switch(as.tag){case 5:case 13:Gr=!1;return;case 27:case 3:Gr=!0;return;default:as=as.return}}function Gu(r){if(r!==as)return!1;if(!yt)return xb(r),yt=!0,!1;var a=r.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=r.type,l=!(l!=="form"&&l!=="button")||o0(r.type,r.memoizedProps)),l=!l),l&&Jt&&Lo(r),xb(r),a===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));e:{for(r=r.nextSibling,a=0;r;){if(r.nodeType===8)if(l=r.data,l==="/$"){if(a===0){Jt=wr(r.nextSibling);break e}a--}else l!=="$"&&l!=="$!"&&l!=="$?"||a++;r=r.nextSibling}Jt=null}}else a===27?(a=Jt,Ra(r.type)?(r=d0,d0=null,Jt=r):Jt=a):Jt=as?wr(r.stateNode.nextSibling):null;return!0}function $u(){Jt=as=null,yt=!1}function vb(){var r=Vo;return r!==null&&(ys===null?ys=r:ys.push.apply(ys,r),Vo=null),r}function Ku(r){Vo===null?Vo=[r]:Vo.push(r)}var $g=oe(null),Uo=null,Si=null;function ma(r,a,l){te($g,a._currentValue),a._currentValue=l}function Ni(r){r._currentValue=$g.current,me($g)}function Kg(r,a,l){for(;r!==null;){var d=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,d!==null&&(d.childLanes|=a)):d!==null&&(d.childLanes&a)!==a&&(d.childLanes|=a),r===l)break;r=r.return}}function Qg(r,a,l,d){var g=r.child;for(g!==null&&(g.return=r);g!==null;){var y=g.dependencies;if(y!==null){var T=g.child;y=y.firstContext;e:for(;y!==null;){var R=y;y=g;for(var H=0;H<a.length;H++)if(R.context===a[H]){y.lanes|=l,R=y.alternate,R!==null&&(R.lanes|=l),Kg(y.return,l,r),d||(T=null);break e}y=R.next}}else if(g.tag===18){if(T=g.return,T===null)throw Error(s(341));T.lanes|=l,y=T.alternate,y!==null&&(y.lanes|=l),Kg(T,l,r),T=null}else T=g.child;if(T!==null)T.return=g;else for(T=g;T!==null;){if(T===r){T=null;break}if(g=T.sibling,g!==null){g.return=T.return,T=g;break}T=T.return}g=T}}function Qu(r,a,l,d){r=null;for(var g=a,y=!1;g!==null;){if(!y){if((g.flags&524288)!==0)y=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var T=g.alternate;if(T===null)throw Error(s(387));if(T=T.memoizedProps,T!==null){var R=g.type;As(g.pendingProps.value,T.value)||(r!==null?r.push(R):r=[R])}}else if(g===xt.current){if(T=g.alternate,T===null)throw Error(s(387));T.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(r!==null?r.push(Td):r=[Td])}g=g.return}r!==null&&Qg(a,r,l,d),a.flags|=262144}function Of(r){for(r=r.firstContext;r!==null;){if(!As(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Fo(r){Uo=r,Si=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Qn(r){return _b(Uo,r)}function Mf(r,a){return Uo===null&&Fo(r),_b(r,a)}function _b(r,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},Si===null){if(r===null)throw Error(s(308));Si=a,r.dependencies={lanes:0,firstContext:a},r.flags|=524288}else Si=Si.next=a;return l}var hC=typeof AbortController<"u"?AbortController:function(){var r=[],a=this.signal={aborted:!1,addEventListener:function(l,d){r.push(d)}};this.abort=function(){a.aborted=!0,r.forEach(function(l){return l()})}},fC=n.unstable_scheduleCallback,mC=n.unstable_NormalPriority,wn={$$typeof:P,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Wg(){return{controller:new hC,data:new Map,refCount:0}}function Wu(r){r.refCount--,r.refCount===0&&fC(mC,function(){r.controller.abort()})}var Yu=null,Yg=0,Jl=0,Zl=null;function pC(r,a){if(Yu===null){var l=Yu=[];Yg=0,Jl=Jy(),Zl={status:"pending",value:void 0,then:function(d){l.push(d)}}}return Yg++,a.then(bb,bb),a}function bb(){if(--Yg===0&&Yu!==null){Zl!==null&&(Zl.status="fulfilled");var r=Yu;Yu=null,Jl=0,Zl=null;for(var a=0;a<r.length;a++)(0,r[a])()}}function gC(r,a){var l=[],d={status:"pending",value:null,reason:null,then:function(g){l.push(g)}};return r.then(function(){d.status="fulfilled",d.value=a;for(var g=0;g<l.length;g++)(0,l[g])(a)},function(g){for(d.status="rejected",d.reason=g,g=0;g<l.length;g++)(0,l[g])(void 0)}),d}var wb=J.S;J.S=function(r,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&pC(r,a),wb!==null&&wb(r,a)};var Bo=oe(null);function Xg(){var r=Bo.current;return r!==null?r:kt.pooledCache}function Vf(r,a){a===null?te(Bo,Bo.current):te(Bo,a.pool)}function Tb(){var r=Xg();return r===null?null:{parent:wn._currentValue,pool:r}}var Xu=Error(s(460)),Eb=Error(s(474)),Lf=Error(s(542)),Jg={then:function(){}};function Ib(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Uf(){}function Sb(r,a,l){switch(l=r[l],l===void 0?r.push(a):l!==a&&(a.then(Uf,Uf),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,Ab(r),r;default:if(typeof a.status=="string")a.then(Uf,Uf);else{if(r=kt,r!==null&&100<r.shellSuspendCounter)throw Error(s(482));r=a,r.status="pending",r.then(function(d){if(a.status==="pending"){var g=a;g.status="fulfilled",g.value=d}},function(d){if(a.status==="pending"){var g=a;g.status="rejected",g.reason=d}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,Ab(r),r}throw Ju=a,Xu}}var Ju=null;function Nb(){if(Ju===null)throw Error(s(459));var r=Ju;return Ju=null,r}function Ab(r){if(r===Xu||r===Lf)throw Error(s(483))}var pa=!1;function Zg(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ey(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function ga(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ya(r,a,l){var d=r.updateQueue;if(d===null)return null;if(d=d.shared,(bt&2)!==0){var g=d.pending;return g===null?a.next=a:(a.next=g.next,g.next=a),d.pending=a,a=Df(r),mb(r,null,l),a}return Cf(r,d,a,l),Df(r)}function Zu(r,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var d=a.lanes;d&=r.pendingLanes,l|=d,a.lanes=l,To(r,l)}}function ty(r,a){var l=r.updateQueue,d=r.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var g=null,y=null;if(l=l.firstBaseUpdate,l!==null){do{var T={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};y===null?g=y=T:y=y.next=T,l=l.next}while(l!==null);y===null?g=y=a:y=y.next=a}else g=y=a;l={baseState:d.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:d.shared,callbacks:d.callbacks},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=a:r.next=a,l.lastBaseUpdate=a}var ny=!1;function ed(){if(ny){var r=Zl;if(r!==null)throw r}}function td(r,a,l,d){ny=!1;var g=r.updateQueue;pa=!1;var y=g.firstBaseUpdate,T=g.lastBaseUpdate,R=g.shared.pending;if(R!==null){g.shared.pending=null;var H=R,ee=H.next;H.next=null,T===null?y=ee:T.next=ee,T=H;var ce=r.alternate;ce!==null&&(ce=ce.updateQueue,R=ce.lastBaseUpdate,R!==T&&(R===null?ce.firstBaseUpdate=ee:R.next=ee,ce.lastBaseUpdate=H))}if(y!==null){var fe=g.baseState;T=0,ce=ee=H=null,R=y;do{var se=R.lane&-536870913,re=se!==R.lane;if(re?(ot&se)===se:(d&se)===se){se!==0&&se===Jl&&(ny=!0),ce!==null&&(ce=ce.next={lane:0,tag:R.tag,payload:R.payload,callback:null,next:null});e:{var Ge=r,qe=R;se=a;var At=l;switch(qe.tag){case 1:if(Ge=qe.payload,typeof Ge=="function"){fe=Ge.call(At,fe,se);break e}fe=Ge;break e;case 3:Ge.flags=Ge.flags&-65537|128;case 0:if(Ge=qe.payload,se=typeof Ge=="function"?Ge.call(At,fe,se):Ge,se==null)break e;fe=x({},fe,se);break e;case 2:pa=!0}}se=R.callback,se!==null&&(r.flags|=64,re&&(r.flags|=8192),re=g.callbacks,re===null?g.callbacks=[se]:re.push(se))}else re={lane:se,tag:R.tag,payload:R.payload,callback:R.callback,next:null},ce===null?(ee=ce=re,H=fe):ce=ce.next=re,T|=se;if(R=R.next,R===null){if(R=g.shared.pending,R===null)break;re=R,R=re.next,re.next=null,g.lastBaseUpdate=re,g.shared.pending=null}}while(!0);ce===null&&(H=fe),g.baseState=H,g.firstBaseUpdate=ee,g.lastBaseUpdate=ce,y===null&&(g.shared.lanes=0),Ia|=T,r.lanes=T,r.memoizedState=fe}}function Rb(r,a){if(typeof r!="function")throw Error(s(191,r));r.call(a)}function Cb(r,a){var l=r.callbacks;if(l!==null)for(r.callbacks=null,r=0;r<l.length;r++)Rb(l[r],a)}var ec=oe(null),Ff=oe(0);function Db(r,a){r=Pi,te(Ff,r),te(ec,a),Pi=r|a.baseLanes}function sy(){te(Ff,Pi),te(ec,ec.current)}function ry(){Pi=Ff.current,me(ec),me(Ff)}var xa=0,We=null,St=null,pn=null,Bf=!1,tc=!1,zo=!1,zf=0,nd=0,nc=null,yC=0;function ln(){throw Error(s(321))}function iy(r,a){if(a===null)return!1;for(var l=0;l<a.length&&l<r.length;l++)if(!As(r[l],a[l]))return!1;return!0}function ay(r,a,l,d,g,y){return xa=y,We=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,J.H=r===null||r.memoizedState===null?mw:pw,zo=!1,y=l(d,g),zo=!1,tc&&(y=jb(a,l,d,g)),kb(r),y}function kb(r){J.H=Qf;var a=St!==null&&St.next!==null;if(xa=0,pn=St=We=null,Bf=!1,nd=0,nc=null,a)throw Error(s(300));r===null||kn||(r=r.dependencies,r!==null&&Of(r)&&(kn=!0))}function jb(r,a,l,d){We=r;var g=0;do{if(tc&&(nc=null),nd=0,tc=!1,25<=g)throw Error(s(301));if(g+=1,pn=St=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}J.H=EC,y=a(l,d)}while(tc);return y}function xC(){var r=J.H,a=r.useState()[0];return a=typeof a.then=="function"?sd(a):a,r=r.useState()[0],(St!==null?St.memoizedState:null)!==r&&(We.flags|=1024),a}function oy(){var r=zf!==0;return zf=0,r}function ly(r,a,l){a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~l}function cy(r){if(Bf){for(r=r.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Bf=!1}xa=0,pn=St=We=null,tc=!1,nd=zf=0,nc=null}function ps(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?We.memoizedState=pn=r:pn=pn.next=r,pn}function gn(){if(St===null){var r=We.alternate;r=r!==null?r.memoizedState:null}else r=St.next;var a=pn===null?We.memoizedState:pn.next;if(a!==null)pn=a,St=r;else{if(r===null)throw We.alternate===null?Error(s(467)):Error(s(310));St=r,r={memoizedState:St.memoizedState,baseState:St.baseState,baseQueue:St.baseQueue,queue:St.queue,next:null},pn===null?We.memoizedState=pn=r:pn=pn.next=r}return pn}function uy(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function sd(r){var a=nd;return nd+=1,nc===null&&(nc=[]),r=Sb(nc,r,a),a=We,(pn===null?a.memoizedState:pn.next)===null&&(a=a.alternate,J.H=a===null||a.memoizedState===null?mw:pw),r}function qf(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return sd(r);if(r.$$typeof===P)return Qn(r)}throw Error(s(438,String(r)))}function dy(r){var a=null,l=We.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var d=We.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(a={data:d.data.map(function(g){return g.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=uy(),We.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(r),d=0;d<r;d++)l[d]=M;return a.index++,l}function Ai(r,a){return typeof a=="function"?a(r):a}function Hf(r){var a=gn();return hy(a,St,r)}function hy(r,a,l){var d=r.queue;if(d===null)throw Error(s(311));d.lastRenderedReducer=l;var g=r.baseQueue,y=d.pending;if(y!==null){if(g!==null){var T=g.next;g.next=y.next,y.next=T}a.baseQueue=g=y,d.pending=null}if(y=r.baseState,g===null)r.memoizedState=y;else{a=g.next;var R=T=null,H=null,ee=a,ce=!1;do{var fe=ee.lane&-536870913;if(fe!==ee.lane?(ot&fe)===fe:(xa&fe)===fe){var se=ee.revertLane;if(se===0)H!==null&&(H=H.next={lane:0,revertLane:0,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null}),fe===Jl&&(ce=!0);else if((xa&se)===se){ee=ee.next,se===Jl&&(ce=!0);continue}else fe={lane:0,revertLane:ee.revertLane,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null},H===null?(R=H=fe,T=y):H=H.next=fe,We.lanes|=se,Ia|=se;fe=ee.action,zo&&l(y,fe),y=ee.hasEagerState?ee.eagerState:l(y,fe)}else se={lane:fe,revertLane:ee.revertLane,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null},H===null?(R=H=se,T=y):H=H.next=se,We.lanes|=fe,Ia|=fe;ee=ee.next}while(ee!==null&&ee!==a);if(H===null?T=y:H.next=R,!As(y,r.memoizedState)&&(kn=!0,ce&&(l=Zl,l!==null)))throw l;r.memoizedState=y,r.baseState=T,r.baseQueue=H,d.lastRenderedState=y}return g===null&&(d.lanes=0),[r.memoizedState,d.dispatch]}function fy(r){var a=gn(),l=a.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=r;var d=l.dispatch,g=l.pending,y=a.memoizedState;if(g!==null){l.pending=null;var T=g=g.next;do y=r(y,T.action),T=T.next;while(T!==g);As(y,a.memoizedState)||(kn=!0),a.memoizedState=y,a.baseQueue===null&&(a.baseState=y),l.lastRenderedState=y}return[y,d]}function Pb(r,a,l){var d=We,g=gn(),y=yt;if(y){if(l===void 0)throw Error(s(407));l=l()}else l=a();var T=!As((St||g).memoizedState,l);T&&(g.memoizedState=l,kn=!0),g=g.queue;var R=Vb.bind(null,d,g,r);if(rd(2048,8,R,[r]),g.getSnapshot!==a||T||pn!==null&&pn.memoizedState.tag&1){if(d.flags|=2048,sc(9,Gf(),Mb.bind(null,d,g,l,a),null),kt===null)throw Error(s(349));y||(xa&124)!==0||Ob(d,a,l)}return l}function Ob(r,a,l){r.flags|=16384,r={getSnapshot:a,value:l},a=We.updateQueue,a===null?(a=uy(),We.updateQueue=a,a.stores=[r]):(l=a.stores,l===null?a.stores=[r]:l.push(r))}function Mb(r,a,l,d){a.value=l,a.getSnapshot=d,Lb(a)&&Ub(r)}function Vb(r,a,l){return l(function(){Lb(a)&&Ub(r)})}function Lb(r){var a=r.getSnapshot;r=r.value;try{var l=a();return!As(r,l)}catch{return!0}}function Ub(r){var a=Ql(r,2);a!==null&&Ps(a,r,2)}function my(r){var a=ps();if(typeof r=="function"){var l=r;if(r=l(),zo){rs(!0);try{l()}finally{rs(!1)}}}return a.memoizedState=a.baseState=r,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ai,lastRenderedState:r},a}function Fb(r,a,l,d){return r.baseState=l,hy(r,St,typeof d=="function"?d:Ai)}function vC(r,a,l,d,g){if(Kf(r))throw Error(s(485));if(r=a.action,r!==null){var y={payload:g,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){y.listeners.push(T)}};J.T!==null?l(!0):y.isTransition=!1,d(y),l=a.pending,l===null?(y.next=a.pending=y,Bb(a,y)):(y.next=l.next,a.pending=l.next=y)}}function Bb(r,a){var l=a.action,d=a.payload,g=r.state;if(a.isTransition){var y=J.T,T={};J.T=T;try{var R=l(g,d),H=J.S;H!==null&&H(T,R),zb(r,a,R)}catch(ee){py(r,a,ee)}finally{J.T=y}}else try{y=l(g,d),zb(r,a,y)}catch(ee){py(r,a,ee)}}function zb(r,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(d){qb(r,a,d)},function(d){return py(r,a,d)}):qb(r,a,l)}function qb(r,a,l){a.status="fulfilled",a.value=l,Hb(a),r.state=l,a=r.pending,a!==null&&(l=a.next,l===a?r.pending=null:(l=l.next,a.next=l,Bb(r,l)))}function py(r,a,l){var d=r.pending;if(r.pending=null,d!==null){d=d.next;do a.status="rejected",a.reason=l,Hb(a),a=a.next;while(a!==d)}r.action=null}function Hb(r){r=r.listeners;for(var a=0;a<r.length;a++)(0,r[a])()}function Gb(r,a){return a}function $b(r,a){if(yt){var l=kt.formState;if(l!==null){e:{var d=We;if(yt){if(Jt){t:{for(var g=Jt,y=Gr;g.nodeType!==8;){if(!y){g=null;break t}if(g=wr(g.nextSibling),g===null){g=null;break t}}y=g.data,g=y==="F!"||y==="F"?g:null}if(g){Jt=wr(g.nextSibling),d=g.data==="F!";break e}}Lo(d)}d=!1}d&&(a=l[0])}}return l=ps(),l.memoizedState=l.baseState=a,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gb,lastRenderedState:a},l.queue=d,l=dw.bind(null,We,d),d.dispatch=l,d=my(!1),y=_y.bind(null,We,!1,d.queue),d=ps(),g={state:a,dispatch:null,action:r,pending:null},d.queue=g,l=vC.bind(null,We,g,y,l),g.dispatch=l,d.memoizedState=r,[a,l,!1]}function Kb(r){var a=gn();return Qb(a,St,r)}function Qb(r,a,l){if(a=hy(r,a,Gb)[0],r=Hf(Ai)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var d=sd(a)}catch(T){throw T===Xu?Lf:T}else d=a;a=gn();var g=a.queue,y=g.dispatch;return l!==a.memoizedState&&(We.flags|=2048,sc(9,Gf(),_C.bind(null,g,l),null)),[d,y,r]}function _C(r,a){r.action=a}function Wb(r){var a=gn(),l=St;if(l!==null)return Qb(a,l,r);gn(),a=a.memoizedState,l=gn();var d=l.queue.dispatch;return l.memoizedState=r,[a,d,!1]}function sc(r,a,l,d){return r={tag:r,create:l,deps:d,inst:a,next:null},a=We.updateQueue,a===null&&(a=uy(),We.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=r.next=r:(d=l.next,l.next=r,r.next=d,a.lastEffect=r),r}function Gf(){return{destroy:void 0,resource:void 0}}function Yb(){return gn().memoizedState}function $f(r,a,l,d){var g=ps();d=d===void 0?null:d,We.flags|=r,g.memoizedState=sc(1|a,Gf(),l,d)}function rd(r,a,l,d){var g=gn();d=d===void 0?null:d;var y=g.memoizedState.inst;St!==null&&d!==null&&iy(d,St.memoizedState.deps)?g.memoizedState=sc(a,y,l,d):(We.flags|=r,g.memoizedState=sc(1|a,y,l,d))}function Xb(r,a){$f(8390656,8,r,a)}function Jb(r,a){rd(2048,8,r,a)}function Zb(r,a){return rd(4,2,r,a)}function ew(r,a){return rd(4,4,r,a)}function tw(r,a){if(typeof a=="function"){r=r();var l=a(r);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function nw(r,a,l){l=l!=null?l.concat([r]):null,rd(4,4,tw.bind(null,a,r),l)}function gy(){}function sw(r,a){var l=gn();a=a===void 0?null:a;var d=l.memoizedState;return a!==null&&iy(a,d[1])?d[0]:(l.memoizedState=[r,a],r)}function rw(r,a){var l=gn();a=a===void 0?null:a;var d=l.memoizedState;if(a!==null&&iy(a,d[1]))return d[0];if(d=r(),zo){rs(!0);try{r()}finally{rs(!1)}}return l.memoizedState=[d,a],d}function yy(r,a,l){return l===void 0||(xa&1073741824)!==0?r.memoizedState=a:(r.memoizedState=l,r=oT(),We.lanes|=r,Ia|=r,l)}function iw(r,a,l,d){return As(l,a)?l:ec.current!==null?(r=yy(r,l,d),As(r,a)||(kn=!0),r):(xa&42)===0?(kn=!0,r.memoizedState=l):(r=oT(),We.lanes|=r,Ia|=r,a)}function aw(r,a,l,d,g){var y=ge.p;ge.p=y!==0&&8>y?y:8;var T=J.T,R={};J.T=R,_y(r,!1,a,l);try{var H=g(),ee=J.S;if(ee!==null&&ee(R,H),H!==null&&typeof H=="object"&&typeof H.then=="function"){var ce=gC(H,d);id(r,a,ce,js(r))}else id(r,a,d,js(r))}catch(fe){id(r,a,{then:function(){},status:"rejected",reason:fe},js())}finally{ge.p=y,J.T=T}}function bC(){}function xy(r,a,l,d){if(r.tag!==5)throw Error(s(476));var g=ow(r).queue;aw(r,g,a,le,l===null?bC:function(){return lw(r),l(d)})}function ow(r){var a=r.memoizedState;if(a!==null)return a;a={memoizedState:le,baseState:le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ai,lastRenderedState:le},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ai,lastRenderedState:l},next:null},r.memoizedState=a,r=r.alternate,r!==null&&(r.memoizedState=a),a}function lw(r){var a=ow(r).next.queue;id(r,a,{},js())}function vy(){return Qn(Td)}function cw(){return gn().memoizedState}function uw(){return gn().memoizedState}function wC(r){for(var a=r.return;a!==null;){switch(a.tag){case 24:case 3:var l=js();r=ga(l);var d=ya(a,r,l);d!==null&&(Ps(d,a,l),Zu(d,a,l)),a={cache:Wg()},r.payload=a;return}a=a.return}}function TC(r,a,l){var d=js();l={lane:d,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},Kf(r)?hw(a,l):(l=Ug(r,a,l,d),l!==null&&(Ps(l,r,d),fw(l,a,d)))}function dw(r,a,l){var d=js();id(r,a,l,d)}function id(r,a,l,d){var g={lane:d,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(Kf(r))hw(a,g);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=a.lastRenderedReducer,y!==null))try{var T=a.lastRenderedState,R=y(T,l);if(g.hasEagerState=!0,g.eagerState=R,As(R,T))return Cf(r,a,g,0),kt===null&&Rf(),!1}catch{}finally{}if(l=Ug(r,a,g,d),l!==null)return Ps(l,r,d),fw(l,a,d),!0}return!1}function _y(r,a,l,d){if(d={lane:2,revertLane:Jy(),action:d,hasEagerState:!1,eagerState:null,next:null},Kf(r)){if(a)throw Error(s(479))}else a=Ug(r,l,d,2),a!==null&&Ps(a,r,2)}function Kf(r){var a=r.alternate;return r===We||a!==null&&a===We}function hw(r,a){tc=Bf=!0;var l=r.pending;l===null?a.next=a:(a.next=l.next,l.next=a),r.pending=a}function fw(r,a,l){if((l&4194048)!==0){var d=a.lanes;d&=r.pendingLanes,l|=d,a.lanes=l,To(r,l)}}var Qf={readContext:Qn,use:qf,useCallback:ln,useContext:ln,useEffect:ln,useImperativeHandle:ln,useLayoutEffect:ln,useInsertionEffect:ln,useMemo:ln,useReducer:ln,useRef:ln,useState:ln,useDebugValue:ln,useDeferredValue:ln,useTransition:ln,useSyncExternalStore:ln,useId:ln,useHostTransitionStatus:ln,useFormState:ln,useActionState:ln,useOptimistic:ln,useMemoCache:ln,useCacheRefresh:ln},mw={readContext:Qn,use:qf,useCallback:function(r,a){return ps().memoizedState=[r,a===void 0?null:a],r},useContext:Qn,useEffect:Xb,useImperativeHandle:function(r,a,l){l=l!=null?l.concat([r]):null,$f(4194308,4,tw.bind(null,a,r),l)},useLayoutEffect:function(r,a){return $f(4194308,4,r,a)},useInsertionEffect:function(r,a){$f(4,2,r,a)},useMemo:function(r,a){var l=ps();a=a===void 0?null:a;var d=r();if(zo){rs(!0);try{r()}finally{rs(!1)}}return l.memoizedState=[d,a],d},useReducer:function(r,a,l){var d=ps();if(l!==void 0){var g=l(a);if(zo){rs(!0);try{l(a)}finally{rs(!1)}}}else g=a;return d.memoizedState=d.baseState=g,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:g},d.queue=r,r=r.dispatch=TC.bind(null,We,r),[d.memoizedState,r]},useRef:function(r){var a=ps();return r={current:r},a.memoizedState=r},useState:function(r){r=my(r);var a=r.queue,l=dw.bind(null,We,a);return a.dispatch=l,[r.memoizedState,l]},useDebugValue:gy,useDeferredValue:function(r,a){var l=ps();return yy(l,r,a)},useTransition:function(){var r=my(!1);return r=aw.bind(null,We,r.queue,!0,!1),ps().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,a,l){var d=We,g=ps();if(yt){if(l===void 0)throw Error(s(407));l=l()}else{if(l=a(),kt===null)throw Error(s(349));(ot&124)!==0||Ob(d,a,l)}g.memoizedState=l;var y={value:l,getSnapshot:a};return g.queue=y,Xb(Vb.bind(null,d,y,r),[r]),d.flags|=2048,sc(9,Gf(),Mb.bind(null,d,y,l,a),null),l},useId:function(){var r=ps(),a=kt.identifierPrefix;if(yt){var l=Ii,d=Ei;l=(d&~(1<<32-Nn(d)-1)).toString(32)+l,a=""+a+"R"+l,l=zf++,0<l&&(a+="H"+l.toString(32)),a+=""}else l=yC++,a=""+a+"r"+l.toString(32)+"";return r.memoizedState=a},useHostTransitionStatus:vy,useFormState:$b,useActionState:$b,useOptimistic:function(r){var a=ps();a.memoizedState=a.baseState=r;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=_y.bind(null,We,!0,l),l.dispatch=a,[r,a]},useMemoCache:dy,useCacheRefresh:function(){return ps().memoizedState=wC.bind(null,We)}},pw={readContext:Qn,use:qf,useCallback:sw,useContext:Qn,useEffect:Jb,useImperativeHandle:nw,useInsertionEffect:Zb,useLayoutEffect:ew,useMemo:rw,useReducer:Hf,useRef:Yb,useState:function(){return Hf(Ai)},useDebugValue:gy,useDeferredValue:function(r,a){var l=gn();return iw(l,St.memoizedState,r,a)},useTransition:function(){var r=Hf(Ai)[0],a=gn().memoizedState;return[typeof r=="boolean"?r:sd(r),a]},useSyncExternalStore:Pb,useId:cw,useHostTransitionStatus:vy,useFormState:Kb,useActionState:Kb,useOptimistic:function(r,a){var l=gn();return Fb(l,St,r,a)},useMemoCache:dy,useCacheRefresh:uw},EC={readContext:Qn,use:qf,useCallback:sw,useContext:Qn,useEffect:Jb,useImperativeHandle:nw,useInsertionEffect:Zb,useLayoutEffect:ew,useMemo:rw,useReducer:fy,useRef:Yb,useState:function(){return fy(Ai)},useDebugValue:gy,useDeferredValue:function(r,a){var l=gn();return St===null?yy(l,r,a):iw(l,St.memoizedState,r,a)},useTransition:function(){var r=fy(Ai)[0],a=gn().memoizedState;return[typeof r=="boolean"?r:sd(r),a]},useSyncExternalStore:Pb,useId:cw,useHostTransitionStatus:vy,useFormState:Wb,useActionState:Wb,useOptimistic:function(r,a){var l=gn();return St!==null?Fb(l,St,r,a):(l.baseState=r,[r,l.queue.dispatch])},useMemoCache:dy,useCacheRefresh:uw},rc=null,ad=0;function Wf(r){var a=ad;return ad+=1,rc===null&&(rc=[]),Sb(rc,r,a)}function od(r,a){a=a.props.ref,r.ref=a!==void 0?a:null}function Yf(r,a){throw a.$$typeof===v?Error(s(525)):(r=Object.prototype.toString.call(a),Error(s(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r)))}function gw(r){var a=r._init;return a(r._payload)}function yw(r){function a(Q,$){if(r){var X=Q.deletions;X===null?(Q.deletions=[$],Q.flags|=16):X.push($)}}function l(Q,$){if(!r)return null;for(;$!==null;)a(Q,$),$=$.sibling;return null}function d(Q){for(var $=new Map;Q!==null;)Q.key!==null?$.set(Q.key,Q):$.set(Q.index,Q),Q=Q.sibling;return $}function g(Q,$){return Q=Ti(Q,$),Q.index=0,Q.sibling=null,Q}function y(Q,$,X){return Q.index=X,r?(X=Q.alternate,X!==null?(X=X.index,X<$?(Q.flags|=67108866,$):X):(Q.flags|=67108866,$)):(Q.flags|=1048576,$)}function T(Q){return r&&Q.alternate===null&&(Q.flags|=67108866),Q}function R(Q,$,X,de){return $===null||$.tag!==6?($=Bg(X,Q.mode,de),$.return=Q,$):($=g($,X),$.return=Q,$)}function H(Q,$,X,de){var De=X.type;return De===N?ce(Q,$,X.props.children,de,X.key):$!==null&&($.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===k&&gw(De)===$.type)?($=g($,X.props),od($,X),$.return=Q,$):($=kf(X.type,X.key,X.props,null,Q.mode,de),od($,X),$.return=Q,$)}function ee(Q,$,X,de){return $===null||$.tag!==4||$.stateNode.containerInfo!==X.containerInfo||$.stateNode.implementation!==X.implementation?($=zg(X,Q.mode,de),$.return=Q,$):($=g($,X.children||[]),$.return=Q,$)}function ce(Q,$,X,de,De){return $===null||$.tag!==7?($=Po(X,Q.mode,de,De),$.return=Q,$):($=g($,X),$.return=Q,$)}function fe(Q,$,X){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=Bg(""+$,Q.mode,X),$.return=Q,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case b:return X=kf($.type,$.key,$.props,null,Q.mode,X),od(X,$),X.return=Q,X;case I:return $=zg($,Q.mode,X),$.return=Q,$;case k:var de=$._init;return $=de($._payload),fe(Q,$,X)}if(Se($)||G($))return $=Po($,Q.mode,X,null),$.return=Q,$;if(typeof $.then=="function")return fe(Q,Wf($),X);if($.$$typeof===P)return fe(Q,Mf(Q,$),X);Yf(Q,$)}return null}function se(Q,$,X,de){var De=$!==null?$.key:null;if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return De!==null?null:R(Q,$,""+X,de);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case b:return X.key===De?H(Q,$,X,de):null;case I:return X.key===De?ee(Q,$,X,de):null;case k:return De=X._init,X=De(X._payload),se(Q,$,X,de)}if(Se(X)||G(X))return De!==null?null:ce(Q,$,X,de,null);if(typeof X.then=="function")return se(Q,$,Wf(X),de);if(X.$$typeof===P)return se(Q,$,Mf(Q,X),de);Yf(Q,X)}return null}function re(Q,$,X,de,De){if(typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint")return Q=Q.get(X)||null,R($,Q,""+de,De);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case b:return Q=Q.get(de.key===null?X:de.key)||null,H($,Q,de,De);case I:return Q=Q.get(de.key===null?X:de.key)||null,ee($,Q,de,De);case k:var Xe=de._init;return de=Xe(de._payload),re(Q,$,X,de,De)}if(Se(de)||G(de))return Q=Q.get(X)||null,ce($,Q,de,De,null);if(typeof de.then=="function")return re(Q,$,X,Wf(de),De);if(de.$$typeof===P)return re(Q,$,X,Mf($,de),De);Yf($,de)}return null}function Ge(Q,$,X,de){for(var De=null,Xe=null,Fe=$,He=$=0,Pn=null;Fe!==null&&He<X.length;He++){Fe.index>He?(Pn=Fe,Fe=null):Pn=Fe.sibling;var mt=se(Q,Fe,X[He],de);if(mt===null){Fe===null&&(Fe=Pn);break}r&&Fe&&mt.alternate===null&&a(Q,Fe),$=y(mt,$,He),Xe===null?De=mt:Xe.sibling=mt,Xe=mt,Fe=Pn}if(He===X.length)return l(Q,Fe),yt&&Mo(Q,He),De;if(Fe===null){for(;He<X.length;He++)Fe=fe(Q,X[He],de),Fe!==null&&($=y(Fe,$,He),Xe===null?De=Fe:Xe.sibling=Fe,Xe=Fe);return yt&&Mo(Q,He),De}for(Fe=d(Fe);He<X.length;He++)Pn=re(Fe,Q,He,X[He],de),Pn!==null&&(r&&Pn.alternate!==null&&Fe.delete(Pn.key===null?He:Pn.key),$=y(Pn,$,He),Xe===null?De=Pn:Xe.sibling=Pn,Xe=Pn);return r&&Fe.forEach(function(Pa){return a(Q,Pa)}),yt&&Mo(Q,He),De}function qe(Q,$,X,de){if(X==null)throw Error(s(151));for(var De=null,Xe=null,Fe=$,He=$=0,Pn=null,mt=X.next();Fe!==null&&!mt.done;He++,mt=X.next()){Fe.index>He?(Pn=Fe,Fe=null):Pn=Fe.sibling;var Pa=se(Q,Fe,mt.value,de);if(Pa===null){Fe===null&&(Fe=Pn);break}r&&Fe&&Pa.alternate===null&&a(Q,Fe),$=y(Pa,$,He),Xe===null?De=Pa:Xe.sibling=Pa,Xe=Pa,Fe=Pn}if(mt.done)return l(Q,Fe),yt&&Mo(Q,He),De;if(Fe===null){for(;!mt.done;He++,mt=X.next())mt=fe(Q,mt.value,de),mt!==null&&($=y(mt,$,He),Xe===null?De=mt:Xe.sibling=mt,Xe=mt);return yt&&Mo(Q,He),De}for(Fe=d(Fe);!mt.done;He++,mt=X.next())mt=re(Fe,Q,He,mt.value,de),mt!==null&&(r&&mt.alternate!==null&&Fe.delete(mt.key===null?He:mt.key),$=y(mt,$,He),Xe===null?De=mt:Xe.sibling=mt,Xe=mt);return r&&Fe.forEach(function(ID){return a(Q,ID)}),yt&&Mo(Q,He),De}function At(Q,$,X,de){if(typeof X=="object"&&X!==null&&X.type===N&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case b:e:{for(var De=X.key;$!==null;){if($.key===De){if(De=X.type,De===N){if($.tag===7){l(Q,$.sibling),de=g($,X.props.children),de.return=Q,Q=de;break e}}else if($.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===k&&gw(De)===$.type){l(Q,$.sibling),de=g($,X.props),od(de,X),de.return=Q,Q=de;break e}l(Q,$);break}else a(Q,$);$=$.sibling}X.type===N?(de=Po(X.props.children,Q.mode,de,X.key),de.return=Q,Q=de):(de=kf(X.type,X.key,X.props,null,Q.mode,de),od(de,X),de.return=Q,Q=de)}return T(Q);case I:e:{for(De=X.key;$!==null;){if($.key===De)if($.tag===4&&$.stateNode.containerInfo===X.containerInfo&&$.stateNode.implementation===X.implementation){l(Q,$.sibling),de=g($,X.children||[]),de.return=Q,Q=de;break e}else{l(Q,$);break}else a(Q,$);$=$.sibling}de=zg(X,Q.mode,de),de.return=Q,Q=de}return T(Q);case k:return De=X._init,X=De(X._payload),At(Q,$,X,de)}if(Se(X))return Ge(Q,$,X,de);if(G(X)){if(De=G(X),typeof De!="function")throw Error(s(150));return X=De.call(X),qe(Q,$,X,de)}if(typeof X.then=="function")return At(Q,$,Wf(X),de);if(X.$$typeof===P)return At(Q,$,Mf(Q,X),de);Yf(Q,X)}return typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint"?(X=""+X,$!==null&&$.tag===6?(l(Q,$.sibling),de=g($,X),de.return=Q,Q=de):(l(Q,$),de=Bg(X,Q.mode,de),de.return=Q,Q=de),T(Q)):l(Q,$)}return function(Q,$,X,de){try{ad=0;var De=At(Q,$,X,de);return rc=null,De}catch(Fe){if(Fe===Xu||Fe===Lf)throw Fe;var Xe=Rs(29,Fe,null,Q.mode);return Xe.lanes=de,Xe.return=Q,Xe}finally{}}}var ic=yw(!0),xw=yw(!1),Js=oe(null),$r=null;function va(r){var a=r.alternate;te(Tn,Tn.current&1),te(Js,r),$r===null&&(a===null||ec.current!==null||a.memoizedState!==null)&&($r=r)}function vw(r){if(r.tag===22){if(te(Tn,Tn.current),te(Js,r),$r===null){var a=r.alternate;a!==null&&a.memoizedState!==null&&($r=r)}}else _a()}function _a(){te(Tn,Tn.current),te(Js,Js.current)}function Ri(r){me(Js),$r===r&&($r=null),me(Tn)}var Tn=oe(0);function Xf(r){for(var a=r;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||u0(l)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function by(r,a,l,d){a=r.memoizedState,l=l(d,a),l=l==null?a:x({},a,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var wy={enqueueSetState:function(r,a,l){r=r._reactInternals;var d=js(),g=ga(d);g.payload=a,l!=null&&(g.callback=l),a=ya(r,g,d),a!==null&&(Ps(a,r,d),Zu(a,r,d))},enqueueReplaceState:function(r,a,l){r=r._reactInternals;var d=js(),g=ga(d);g.tag=1,g.payload=a,l!=null&&(g.callback=l),a=ya(r,g,d),a!==null&&(Ps(a,r,d),Zu(a,r,d))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var l=js(),d=ga(l);d.tag=2,a!=null&&(d.callback=a),a=ya(r,d,l),a!==null&&(Ps(a,r,l),Zu(a,r,l))}};function _w(r,a,l,d,g,y,T){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(d,y,T):a.prototype&&a.prototype.isPureReactComponent?!qu(l,d)||!qu(g,y):!0}function bw(r,a,l,d){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,d),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,d),a.state!==r&&wy.enqueueReplaceState(a,a.state,null)}function qo(r,a){var l=a;if("ref"in a){l={};for(var d in a)d!=="ref"&&(l[d]=a[d])}if(r=r.defaultProps){l===a&&(l=x({},l));for(var g in r)l[g]===void 0&&(l[g]=r[g])}return l}var Jf=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function ww(r){Jf(r)}function Tw(r){console.error(r)}function Ew(r){Jf(r)}function Zf(r,a){try{var l=r.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(d){setTimeout(function(){throw d})}}function Iw(r,a,l){try{var d=r.onCaughtError;d(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Ty(r,a,l){return l=ga(l),l.tag=3,l.payload={element:null},l.callback=function(){Zf(r,a)},l}function Sw(r){return r=ga(r),r.tag=3,r}function Nw(r,a,l,d){var g=l.type.getDerivedStateFromError;if(typeof g=="function"){var y=d.value;r.payload=function(){return g(y)},r.callback=function(){Iw(a,l,d)}}var T=l.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(r.callback=function(){Iw(a,l,d),typeof g!="function"&&(Sa===null?Sa=new Set([this]):Sa.add(this));var R=d.stack;this.componentDidCatch(d.value,{componentStack:R!==null?R:""})})}function IC(r,a,l,d,g){if(l.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(a=l.alternate,a!==null&&Qu(a,l,g,!0),l=Js.current,l!==null){switch(l.tag){case 13:return $r===null?Ky():l.alternate===null&&Zt===0&&(Zt=3),l.flags&=-257,l.flags|=65536,l.lanes=g,d===Jg?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([d]):a.add(d),Wy(r,d,g)),!1;case 22:return l.flags|=65536,d===Jg?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([d])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([d]):l.add(d)),Wy(r,d,g)),!1}throw Error(s(435,l.tag))}return Wy(r,d,g),Ky(),!1}if(yt)return a=Js.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=g,d!==Gg&&(r=Error(s(422),{cause:d}),Ku(Qs(r,l)))):(d!==Gg&&(a=Error(s(423),{cause:d}),Ku(Qs(a,l))),r=r.current.alternate,r.flags|=65536,g&=-g,r.lanes|=g,d=Qs(d,l),g=Ty(r.stateNode,d,g),ty(r,g),Zt!==4&&(Zt=2)),!1;var y=Error(s(520),{cause:d});if(y=Qs(y,l),md===null?md=[y]:md.push(y),Zt!==4&&(Zt=2),a===null)return!0;d=Qs(d,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,r=g&-g,l.lanes|=r,r=Ty(l.stateNode,d,r),ty(l,r),!1;case 1:if(a=l.type,y=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Sa===null||!Sa.has(y))))return l.flags|=65536,g&=-g,l.lanes|=g,g=Sw(g),Nw(g,r,l,d),ty(l,g),!1}l=l.return}while(l!==null);return!1}var Aw=Error(s(461)),kn=!1;function Un(r,a,l,d){a.child=r===null?xw(a,null,l,d):ic(a,r.child,l,d)}function Rw(r,a,l,d,g){l=l.render;var y=a.ref;if("ref"in d){var T={};for(var R in d)R!=="ref"&&(T[R]=d[R])}else T=d;return Fo(a),d=ay(r,a,l,T,y,g),R=oy(),r!==null&&!kn?(ly(r,a,g),Ci(r,a,g)):(yt&&R&&qg(a),a.flags|=1,Un(r,a,d,g),a.child)}function Cw(r,a,l,d,g){if(r===null){var y=l.type;return typeof y=="function"&&!Fg(y)&&y.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=y,Dw(r,a,y,d,g)):(r=kf(l.type,null,d,a,a.mode,g),r.ref=a.ref,r.return=a,a.child=r)}if(y=r.child,!Dy(r,g)){var T=y.memoizedProps;if(l=l.compare,l=l!==null?l:qu,l(T,d)&&r.ref===a.ref)return Ci(r,a,g)}return a.flags|=1,r=Ti(y,d),r.ref=a.ref,r.return=a,a.child=r}function Dw(r,a,l,d,g){if(r!==null){var y=r.memoizedProps;if(qu(y,d)&&r.ref===a.ref)if(kn=!1,a.pendingProps=d=y,Dy(r,g))(r.flags&131072)!==0&&(kn=!0);else return a.lanes=r.lanes,Ci(r,a,g)}return Ey(r,a,l,d,g)}function kw(r,a,l){var d=a.pendingProps,g=d.children,y=r!==null?r.memoizedState:null;if(d.mode==="hidden"){if((a.flags&128)!==0){if(d=y!==null?y.baseLanes|l:l,r!==null){for(g=a.child=r.child,y=0;g!==null;)y=y|g.lanes|g.childLanes,g=g.sibling;a.childLanes=y&~d}else a.childLanes=0,a.child=null;return jw(r,a,d,l)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},r!==null&&Vf(a,y!==null?y.cachePool:null),y!==null?Db(a,y):sy(),vw(a);else return a.lanes=a.childLanes=536870912,jw(r,a,y!==null?y.baseLanes|l:l,l)}else y!==null?(Vf(a,y.cachePool),Db(a,y),_a(),a.memoizedState=null):(r!==null&&Vf(a,null),sy(),_a());return Un(r,a,g,l),a.child}function jw(r,a,l,d){var g=Xg();return g=g===null?null:{parent:wn._currentValue,pool:g},a.memoizedState={baseLanes:l,cachePool:g},r!==null&&Vf(a,null),sy(),vw(a),r!==null&&Qu(r,a,d,!0),null}function em(r,a){var l=a.ref;if(l===null)r!==null&&r.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(s(284));(r===null||r.ref!==l)&&(a.flags|=4194816)}}function Ey(r,a,l,d,g){return Fo(a),l=ay(r,a,l,d,void 0,g),d=oy(),r!==null&&!kn?(ly(r,a,g),Ci(r,a,g)):(yt&&d&&qg(a),a.flags|=1,Un(r,a,l,g),a.child)}function Pw(r,a,l,d,g,y){return Fo(a),a.updateQueue=null,l=jb(a,d,l,g),kb(r),d=oy(),r!==null&&!kn?(ly(r,a,y),Ci(r,a,y)):(yt&&d&&qg(a),a.flags|=1,Un(r,a,l,y),a.child)}function Ow(r,a,l,d,g){if(Fo(a),a.stateNode===null){var y=Wl,T=l.contextType;typeof T=="object"&&T!==null&&(y=Qn(T)),y=new l(d,y),a.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=wy,a.stateNode=y,y._reactInternals=a,y=a.stateNode,y.props=d,y.state=a.memoizedState,y.refs={},Zg(a),T=l.contextType,y.context=typeof T=="object"&&T!==null?Qn(T):Wl,y.state=a.memoizedState,T=l.getDerivedStateFromProps,typeof T=="function"&&(by(a,l,T,d),y.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(T=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),T!==y.state&&wy.enqueueReplaceState(y,y.state,null),td(a,d,y,g),ed(),y.state=a.memoizedState),typeof y.componentDidMount=="function"&&(a.flags|=4194308),d=!0}else if(r===null){y=a.stateNode;var R=a.memoizedProps,H=qo(l,R);y.props=H;var ee=y.context,ce=l.contextType;T=Wl,typeof ce=="object"&&ce!==null&&(T=Qn(ce));var fe=l.getDerivedStateFromProps;ce=typeof fe=="function"||typeof y.getSnapshotBeforeUpdate=="function",R=a.pendingProps!==R,ce||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(R||ee!==T)&&bw(a,y,d,T),pa=!1;var se=a.memoizedState;y.state=se,td(a,d,y,g),ed(),ee=a.memoizedState,R||se!==ee||pa?(typeof fe=="function"&&(by(a,l,fe,d),ee=a.memoizedState),(H=pa||_w(a,l,H,d,se,ee,T))?(ce||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(a.flags|=4194308)):(typeof y.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=d,a.memoizedState=ee),y.props=d,y.state=ee,y.context=T,d=H):(typeof y.componentDidMount=="function"&&(a.flags|=4194308),d=!1)}else{y=a.stateNode,ey(r,a),T=a.memoizedProps,ce=qo(l,T),y.props=ce,fe=a.pendingProps,se=y.context,ee=l.contextType,H=Wl,typeof ee=="object"&&ee!==null&&(H=Qn(ee)),R=l.getDerivedStateFromProps,(ee=typeof R=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(T!==fe||se!==H)&&bw(a,y,d,H),pa=!1,se=a.memoizedState,y.state=se,td(a,d,y,g),ed();var re=a.memoizedState;T!==fe||se!==re||pa||r!==null&&r.dependencies!==null&&Of(r.dependencies)?(typeof R=="function"&&(by(a,l,R,d),re=a.memoizedState),(ce=pa||_w(a,l,ce,d,se,re,H)||r!==null&&r.dependencies!==null&&Of(r.dependencies))?(ee||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(d,re,H),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(d,re,H)),typeof y.componentDidUpdate=="function"&&(a.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof y.componentDidUpdate!="function"||T===r.memoizedProps&&se===r.memoizedState||(a.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||T===r.memoizedProps&&se===r.memoizedState||(a.flags|=1024),a.memoizedProps=d,a.memoizedState=re),y.props=d,y.state=re,y.context=H,d=ce):(typeof y.componentDidUpdate!="function"||T===r.memoizedProps&&se===r.memoizedState||(a.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||T===r.memoizedProps&&se===r.memoizedState||(a.flags|=1024),d=!1)}return y=d,em(r,a),d=(a.flags&128)!==0,y||d?(y=a.stateNode,l=d&&typeof l.getDerivedStateFromError!="function"?null:y.render(),a.flags|=1,r!==null&&d?(a.child=ic(a,r.child,null,g),a.child=ic(a,null,l,g)):Un(r,a,l,g),a.memoizedState=y.state,r=a.child):r=Ci(r,a,g),r}function Mw(r,a,l,d){return $u(),a.flags|=256,Un(r,a,l,d),a.child}var Iy={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Sy(r){return{baseLanes:r,cachePool:Tb()}}function Ny(r,a,l){return r=r!==null?r.childLanes&~l:0,a&&(r|=Zs),r}function Vw(r,a,l){var d=a.pendingProps,g=!1,y=(a.flags&128)!==0,T;if((T=y)||(T=r!==null&&r.memoizedState===null?!1:(Tn.current&2)!==0),T&&(g=!0,a.flags&=-129),T=(a.flags&32)!==0,a.flags&=-33,r===null){if(yt){if(g?va(a):_a(),yt){var R=Jt,H;if(H=R){e:{for(H=R,R=Gr;H.nodeType!==8;){if(!R){R=null;break e}if(H=wr(H.nextSibling),H===null){R=null;break e}}R=H}R!==null?(a.memoizedState={dehydrated:R,treeContext:Oo!==null?{id:Ei,overflow:Ii}:null,retryLane:536870912,hydrationErrors:null},H=Rs(18,null,null,0),H.stateNode=R,H.return=a,a.child=H,as=a,Jt=null,H=!0):H=!1}H||Lo(a)}if(R=a.memoizedState,R!==null&&(R=R.dehydrated,R!==null))return u0(R)?a.lanes=32:a.lanes=536870912,null;Ri(a)}return R=d.children,d=d.fallback,g?(_a(),g=a.mode,R=tm({mode:"hidden",children:R},g),d=Po(d,g,l,null),R.return=a,d.return=a,R.sibling=d,a.child=R,g=a.child,g.memoizedState=Sy(l),g.childLanes=Ny(r,T,l),a.memoizedState=Iy,d):(va(a),Ay(a,R))}if(H=r.memoizedState,H!==null&&(R=H.dehydrated,R!==null)){if(y)a.flags&256?(va(a),a.flags&=-257,a=Ry(r,a,l)):a.memoizedState!==null?(_a(),a.child=r.child,a.flags|=128,a=null):(_a(),g=d.fallback,R=a.mode,d=tm({mode:"visible",children:d.children},R),g=Po(g,R,l,null),g.flags|=2,d.return=a,g.return=a,d.sibling=g,a.child=d,ic(a,r.child,null,l),d=a.child,d.memoizedState=Sy(l),d.childLanes=Ny(r,T,l),a.memoizedState=Iy,a=g);else if(va(a),u0(R)){if(T=R.nextSibling&&R.nextSibling.dataset,T)var ee=T.dgst;T=ee,d=Error(s(419)),d.stack="",d.digest=T,Ku({value:d,source:null,stack:null}),a=Ry(r,a,l)}else if(kn||Qu(r,a,l,!1),T=(l&r.childLanes)!==0,kn||T){if(T=kt,T!==null&&(d=l&-l,d=(d&42)!==0?1:jr(d),d=(d&(T.suspendedLanes|l))!==0?0:d,d!==0&&d!==H.retryLane))throw H.retryLane=d,Ql(r,d),Ps(T,r,d),Aw;R.data==="$?"||Ky(),a=Ry(r,a,l)}else R.data==="$?"?(a.flags|=192,a.child=r.child,a=null):(r=H.treeContext,Jt=wr(R.nextSibling),as=a,yt=!0,Vo=null,Gr=!1,r!==null&&(Ys[Xs++]=Ei,Ys[Xs++]=Ii,Ys[Xs++]=Oo,Ei=r.id,Ii=r.overflow,Oo=a),a=Ay(a,d.children),a.flags|=4096);return a}return g?(_a(),g=d.fallback,R=a.mode,H=r.child,ee=H.sibling,d=Ti(H,{mode:"hidden",children:d.children}),d.subtreeFlags=H.subtreeFlags&65011712,ee!==null?g=Ti(ee,g):(g=Po(g,R,l,null),g.flags|=2),g.return=a,d.return=a,d.sibling=g,a.child=d,d=g,g=a.child,R=r.child.memoizedState,R===null?R=Sy(l):(H=R.cachePool,H!==null?(ee=wn._currentValue,H=H.parent!==ee?{parent:ee,pool:ee}:H):H=Tb(),R={baseLanes:R.baseLanes|l,cachePool:H}),g.memoizedState=R,g.childLanes=Ny(r,T,l),a.memoizedState=Iy,d):(va(a),l=r.child,r=l.sibling,l=Ti(l,{mode:"visible",children:d.children}),l.return=a,l.sibling=null,r!==null&&(T=a.deletions,T===null?(a.deletions=[r],a.flags|=16):T.push(r)),a.child=l,a.memoizedState=null,l)}function Ay(r,a){return a=tm({mode:"visible",children:a},r.mode),a.return=r,r.child=a}function tm(r,a){return r=Rs(22,r,null,a),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function Ry(r,a,l){return ic(a,r.child,null,l),r=Ay(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function Lw(r,a,l){r.lanes|=a;var d=r.alternate;d!==null&&(d.lanes|=a),Kg(r.return,a,l)}function Cy(r,a,l,d,g){var y=r.memoizedState;y===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:g}:(y.isBackwards=a,y.rendering=null,y.renderingStartTime=0,y.last=d,y.tail=l,y.tailMode=g)}function Uw(r,a,l){var d=a.pendingProps,g=d.revealOrder,y=d.tail;if(Un(r,a,d.children,l),d=Tn.current,(d&2)!==0)d=d&1|2,a.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Lw(r,l,a);else if(r.tag===19)Lw(r,l,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}d&=1}switch(te(Tn,d),g){case"forwards":for(l=a.child,g=null;l!==null;)r=l.alternate,r!==null&&Xf(r)===null&&(g=l),l=l.sibling;l=g,l===null?(g=a.child,a.child=null):(g=l.sibling,l.sibling=null),Cy(a,!1,g,l,y);break;case"backwards":for(l=null,g=a.child,a.child=null;g!==null;){if(r=g.alternate,r!==null&&Xf(r)===null){a.child=g;break}r=g.sibling,g.sibling=l,l=g,g=r}Cy(a,!0,l,null,y);break;case"together":Cy(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Ci(r,a,l){if(r!==null&&(a.dependencies=r.dependencies),Ia|=a.lanes,(l&a.childLanes)===0)if(r!==null){if(Qu(r,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(r!==null&&a.child!==r.child)throw Error(s(153));if(a.child!==null){for(r=a.child,l=Ti(r,r.pendingProps),a.child=l,l.return=a;r.sibling!==null;)r=r.sibling,l=l.sibling=Ti(r,r.pendingProps),l.return=a;l.sibling=null}return a.child}function Dy(r,a){return(r.lanes&a)!==0?!0:(r=r.dependencies,!!(r!==null&&Of(r)))}function SC(r,a,l){switch(a.tag){case 3:rt(a,a.stateNode.containerInfo),ma(a,wn,r.memoizedState.cache),$u();break;case 27:case 5:ws(a);break;case 4:rt(a,a.stateNode.containerInfo);break;case 10:ma(a,a.type,a.memoizedProps.value);break;case 13:var d=a.memoizedState;if(d!==null)return d.dehydrated!==null?(va(a),a.flags|=128,null):(l&a.child.childLanes)!==0?Vw(r,a,l):(va(a),r=Ci(r,a,l),r!==null?r.sibling:null);va(a);break;case 19:var g=(r.flags&128)!==0;if(d=(l&a.childLanes)!==0,d||(Qu(r,a,l,!1),d=(l&a.childLanes)!==0),g){if(d)return Uw(r,a,l);a.flags|=128}if(g=a.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),te(Tn,Tn.current),d)break;return null;case 22:case 23:return a.lanes=0,kw(r,a,l);case 24:ma(a,wn,r.memoizedState.cache)}return Ci(r,a,l)}function Fw(r,a,l){if(r!==null)if(r.memoizedProps!==a.pendingProps)kn=!0;else{if(!Dy(r,l)&&(a.flags&128)===0)return kn=!1,SC(r,a,l);kn=(r.flags&131072)!==0}else kn=!1,yt&&(a.flags&1048576)!==0&&gb(a,Pf,a.index);switch(a.lanes=0,a.tag){case 16:e:{r=a.pendingProps;var d=a.elementType,g=d._init;if(d=g(d._payload),a.type=d,typeof d=="function")Fg(d)?(r=qo(d,r),a.tag=1,a=Ow(null,a,d,r,l)):(a.tag=0,a=Ey(null,a,d,r,l));else{if(d!=null){if(g=d.$$typeof,g===V){a.tag=11,a=Rw(null,a,d,r,l);break e}else if(g===L){a.tag=14,a=Cw(null,a,d,r,l);break e}}throw a=he(d)||d,Error(s(306,a,""))}}return a;case 0:return Ey(r,a,a.type,a.pendingProps,l);case 1:return d=a.type,g=qo(d,a.pendingProps),Ow(r,a,d,g,l);case 3:e:{if(rt(a,a.stateNode.containerInfo),r===null)throw Error(s(387));d=a.pendingProps;var y=a.memoizedState;g=y.element,ey(r,a),td(a,d,null,l);var T=a.memoizedState;if(d=T.cache,ma(a,wn,d),d!==y.cache&&Qg(a,[wn],l,!0),ed(),d=T.element,y.isDehydrated)if(y={element:d,isDehydrated:!1,cache:T.cache},a.updateQueue.baseState=y,a.memoizedState=y,a.flags&256){a=Mw(r,a,d,l);break e}else if(d!==g){g=Qs(Error(s(424)),a),Ku(g),a=Mw(r,a,d,l);break e}else{switch(r=a.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Jt=wr(r.firstChild),as=a,yt=!0,Vo=null,Gr=!0,l=xw(a,null,d,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if($u(),d===g){a=Ci(r,a,l);break e}Un(r,a,d,l)}a=a.child}return a;case 26:return em(r,a),r===null?(l=HT(a.type,null,a.pendingProps,null))?a.memoizedState=l:yt||(l=a.type,r=a.pendingProps,d=pm(Pe.current).createElement(l),d[mn]=a,d[on]=r,Bn(d,l,r),Xt(d),a.stateNode=d):a.memoizedState=HT(a.type,r.memoizedProps,a.pendingProps,r.memoizedState),null;case 27:return ws(a),r===null&&yt&&(d=a.stateNode=BT(a.type,a.pendingProps,Pe.current),as=a,Gr=!0,g=Jt,Ra(a.type)?(d0=g,Jt=wr(d.firstChild)):Jt=g),Un(r,a,a.pendingProps.children,l),em(r,a),r===null&&(a.flags|=4194304),a.child;case 5:return r===null&&yt&&((g=d=Jt)&&(d=eD(d,a.type,a.pendingProps,Gr),d!==null?(a.stateNode=d,as=a,Jt=wr(d.firstChild),Gr=!1,g=!0):g=!1),g||Lo(a)),ws(a),g=a.type,y=a.pendingProps,T=r!==null?r.memoizedProps:null,d=y.children,o0(g,y)?d=null:T!==null&&o0(g,T)&&(a.flags|=32),a.memoizedState!==null&&(g=ay(r,a,xC,null,null,l),Td._currentValue=g),em(r,a),Un(r,a,d,l),a.child;case 6:return r===null&&yt&&((r=l=Jt)&&(l=tD(l,a.pendingProps,Gr),l!==null?(a.stateNode=l,as=a,Jt=null,r=!0):r=!1),r||Lo(a)),null;case 13:return Vw(r,a,l);case 4:return rt(a,a.stateNode.containerInfo),d=a.pendingProps,r===null?a.child=ic(a,null,d,l):Un(r,a,d,l),a.child;case 11:return Rw(r,a,a.type,a.pendingProps,l);case 7:return Un(r,a,a.pendingProps,l),a.child;case 8:return Un(r,a,a.pendingProps.children,l),a.child;case 12:return Un(r,a,a.pendingProps.children,l),a.child;case 10:return d=a.pendingProps,ma(a,a.type,d.value),Un(r,a,d.children,l),a.child;case 9:return g=a.type._context,d=a.pendingProps.children,Fo(a),g=Qn(g),d=d(g),a.flags|=1,Un(r,a,d,l),a.child;case 14:return Cw(r,a,a.type,a.pendingProps,l);case 15:return Dw(r,a,a.type,a.pendingProps,l);case 19:return Uw(r,a,l);case 31:return d=a.pendingProps,l=a.mode,d={mode:d.mode,children:d.children},r===null?(l=tm(d,l),l.ref=a.ref,a.child=l,l.return=a,a=l):(l=Ti(r.child,d),l.ref=a.ref,a.child=l,l.return=a,a=l),a;case 22:return kw(r,a,l);case 24:return Fo(a),d=Qn(wn),r===null?(g=Xg(),g===null&&(g=kt,y=Wg(),g.pooledCache=y,y.refCount++,y!==null&&(g.pooledCacheLanes|=l),g=y),a.memoizedState={parent:d,cache:g},Zg(a),ma(a,wn,g)):((r.lanes&l)!==0&&(ey(r,a),td(a,null,null,l),ed()),g=r.memoizedState,y=a.memoizedState,g.parent!==d?(g={parent:d,cache:d},a.memoizedState=g,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=g),ma(a,wn,d)):(d=y.cache,ma(a,wn,d),d!==g.cache&&Qg(a,[wn],l,!0))),Un(r,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(s(156,a.tag))}function Di(r){r.flags|=4}function Bw(r,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!WT(a)){if(a=Js.current,a!==null&&((ot&4194048)===ot?$r!==null:(ot&62914560)!==ot&&(ot&536870912)===0||a!==$r))throw Ju=Jg,Eb;r.flags|=8192}}function nm(r,a){a!==null&&(r.flags|=4),r.flags&16384&&(a=r.tag!==22?bo():536870912,r.lanes|=a,cc|=a)}function ld(r,a){if(!yt)switch(r.tailMode){case"hidden":a=r.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:d.sibling=null}}function $t(r){var a=r.alternate!==null&&r.alternate.child===r.child,l=0,d=0;if(a)for(var g=r.child;g!==null;)l|=g.lanes|g.childLanes,d|=g.subtreeFlags&65011712,d|=g.flags&65011712,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)l|=g.lanes|g.childLanes,d|=g.subtreeFlags,d|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=d,r.childLanes=l,a}function NC(r,a,l){var d=a.pendingProps;switch(Hg(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $t(a),null;case 1:return $t(a),null;case 3:return l=a.stateNode,d=null,r!==null&&(d=r.memoizedState.cache),a.memoizedState.cache!==d&&(a.flags|=2048),Ni(wn),Ot(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(r===null||r.child===null)&&(Gu(a)?Di(a):r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,vb())),$t(a),null;case 26:return l=a.memoizedState,r===null?(Di(a),l!==null?($t(a),Bw(a,l)):($t(a),a.flags&=-16777217)):l?l!==r.memoizedState?(Di(a),$t(a),Bw(a,l)):($t(a),a.flags&=-16777217):(r.memoizedProps!==d&&Di(a),$t(a),a.flags&=-16777217),null;case 27:Ts(a),l=Pe.current;var g=a.type;if(r!==null&&a.stateNode!=null)r.memoizedProps!==d&&Di(a);else{if(!d){if(a.stateNode===null)throw Error(s(166));return $t(a),null}r=we.current,Gu(a)?yb(a):(r=BT(g,d,l),a.stateNode=r,Di(a))}return $t(a),null;case 5:if(Ts(a),l=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==d&&Di(a);else{if(!d){if(a.stateNode===null)throw Error(s(166));return $t(a),null}if(r=we.current,Gu(a))yb(a);else{switch(g=pm(Pe.current),r){case 1:r=g.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:r=g.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":r=g.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":r=g.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":r=g.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof d.is=="string"?g.createElement("select",{is:d.is}):g.createElement("select"),d.multiple?r.multiple=!0:d.size&&(r.size=d.size);break;default:r=typeof d.is=="string"?g.createElement(l,{is:d.is}):g.createElement(l)}}r[mn]=a,r[on]=d;e:for(g=a.child;g!==null;){if(g.tag===5||g.tag===6)r.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===a)break e;for(;g.sibling===null;){if(g.return===null||g.return===a)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}a.stateNode=r;e:switch(Bn(r,l,d),l){case"button":case"input":case"select":case"textarea":r=!!d.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&Di(a)}}return $t(a),a.flags&=-16777217,null;case 6:if(r&&a.stateNode!=null)r.memoizedProps!==d&&Di(a);else{if(typeof d!="string"&&a.stateNode===null)throw Error(s(166));if(r=Pe.current,Gu(a)){if(r=a.stateNode,l=a.memoizedProps,d=null,g=as,g!==null)switch(g.tag){case 27:case 5:d=g.memoizedProps}r[mn]=a,r=!!(r.nodeValue===l||d!==null&&d.suppressHydrationWarning===!0||PT(r.nodeValue,l)),r||Lo(a)}else r=pm(r).createTextNode(d),r[mn]=a,a.stateNode=r}return $t(a),null;case 13:if(d=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(g=Gu(a),d!==null&&d.dehydrated!==null){if(r===null){if(!g)throw Error(s(318));if(g=a.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(s(317));g[mn]=a}else $u(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;$t(a),g=!1}else g=vb(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=g),g=!0;if(!g)return a.flags&256?(Ri(a),a):(Ri(a),null)}if(Ri(a),(a.flags&128)!==0)return a.lanes=l,a;if(l=d!==null,r=r!==null&&r.memoizedState!==null,l){d=a.child,g=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(g=d.alternate.memoizedState.cachePool.pool);var y=null;d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(y=d.memoizedState.cachePool.pool),y!==g&&(d.flags|=2048)}return l!==r&&l&&(a.child.flags|=8192),nm(a,a.updateQueue),$t(a),null;case 4:return Ot(),r===null&&n0(a.stateNode.containerInfo),$t(a),null;case 10:return Ni(a.type),$t(a),null;case 19:if(me(Tn),g=a.memoizedState,g===null)return $t(a),null;if(d=(a.flags&128)!==0,y=g.rendering,y===null)if(d)ld(g,!1);else{if(Zt!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(y=Xf(r),y!==null){for(a.flags|=128,ld(g,!1),r=y.updateQueue,a.updateQueue=r,nm(a,r),a.subtreeFlags=0,r=l,l=a.child;l!==null;)pb(l,r),l=l.sibling;return te(Tn,Tn.current&1|2),a.child}r=r.sibling}g.tail!==null&&Yt()>im&&(a.flags|=128,d=!0,ld(g,!1),a.lanes=4194304)}else{if(!d)if(r=Xf(y),r!==null){if(a.flags|=128,d=!0,r=r.updateQueue,a.updateQueue=r,nm(a,r),ld(g,!0),g.tail===null&&g.tailMode==="hidden"&&!y.alternate&&!yt)return $t(a),null}else 2*Yt()-g.renderingStartTime>im&&l!==536870912&&(a.flags|=128,d=!0,ld(g,!1),a.lanes=4194304);g.isBackwards?(y.sibling=a.child,a.child=y):(r=g.last,r!==null?r.sibling=y:a.child=y,g.last=y)}return g.tail!==null?(a=g.tail,g.rendering=a,g.tail=a.sibling,g.renderingStartTime=Yt(),a.sibling=null,r=Tn.current,te(Tn,d?r&1|2:r&1),a):($t(a),null);case 22:case 23:return Ri(a),ry(),d=a.memoizedState!==null,r!==null?r.memoizedState!==null!==d&&(a.flags|=8192):d&&(a.flags|=8192),d?(l&536870912)!==0&&(a.flags&128)===0&&($t(a),a.subtreeFlags&6&&(a.flags|=8192)):$t(a),l=a.updateQueue,l!==null&&nm(a,l.retryQueue),l=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),d=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),d!==l&&(a.flags|=2048),r!==null&&me(Bo),null;case 24:return l=null,r!==null&&(l=r.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),Ni(wn),$t(a),null;case 25:return null;case 30:return null}throw Error(s(156,a.tag))}function AC(r,a){switch(Hg(a),a.tag){case 1:return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return Ni(wn),Ot(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 26:case 27:case 5:return Ts(a),null;case 13:if(Ri(a),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(s(340));$u()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return me(Tn),null;case 4:return Ot(),null;case 10:return Ni(a.type),null;case 22:case 23:return Ri(a),ry(),r!==null&&me(Bo),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 24:return Ni(wn),null;case 25:return null;default:return null}}function zw(r,a){switch(Hg(a),a.tag){case 3:Ni(wn),Ot();break;case 26:case 27:case 5:Ts(a);break;case 4:Ot();break;case 13:Ri(a);break;case 19:me(Tn);break;case 10:Ni(a.type);break;case 22:case 23:Ri(a),ry(),r!==null&&me(Bo);break;case 24:Ni(wn)}}function cd(r,a){try{var l=a.updateQueue,d=l!==null?l.lastEffect:null;if(d!==null){var g=d.next;l=g;do{if((l.tag&r)===r){d=void 0;var y=l.create,T=l.inst;d=y(),T.destroy=d}l=l.next}while(l!==g)}}catch(R){Rt(a,a.return,R)}}function ba(r,a,l){try{var d=a.updateQueue,g=d!==null?d.lastEffect:null;if(g!==null){var y=g.next;d=y;do{if((d.tag&r)===r){var T=d.inst,R=T.destroy;if(R!==void 0){T.destroy=void 0,g=a;var H=l,ee=R;try{ee()}catch(ce){Rt(g,H,ce)}}}d=d.next}while(d!==y)}}catch(ce){Rt(a,a.return,ce)}}function qw(r){var a=r.updateQueue;if(a!==null){var l=r.stateNode;try{Cb(a,l)}catch(d){Rt(r,r.return,d)}}}function Hw(r,a,l){l.props=qo(r.type,r.memoizedProps),l.state=r.memoizedState;try{l.componentWillUnmount()}catch(d){Rt(r,a,d)}}function ud(r,a){try{var l=r.ref;if(l!==null){switch(r.tag){case 26:case 27:case 5:var d=r.stateNode;break;case 30:d=r.stateNode;break;default:d=r.stateNode}typeof l=="function"?r.refCleanup=l(d):l.current=d}}catch(g){Rt(r,a,g)}}function Kr(r,a){var l=r.ref,d=r.refCleanup;if(l!==null)if(typeof d=="function")try{d()}catch(g){Rt(r,a,g)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(g){Rt(r,a,g)}else l.current=null}function Gw(r){var a=r.type,l=r.memoizedProps,d=r.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&d.focus();break e;case"img":l.src?d.src=l.src:l.srcSet&&(d.srcset=l.srcSet)}}catch(g){Rt(r,r.return,g)}}function ky(r,a,l){try{var d=r.stateNode;WC(d,r.type,l,a),d[on]=a}catch(g){Rt(r,r.return,g)}}function $w(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Ra(r.type)||r.tag===4}function jy(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||$w(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Ra(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Py(r,a,l){var d=r.tag;if(d===5||d===6)r=r.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(r,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(r),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=mm));else if(d!==4&&(d===27&&Ra(r.type)&&(l=r.stateNode,a=null),r=r.child,r!==null))for(Py(r,a,l),r=r.sibling;r!==null;)Py(r,a,l),r=r.sibling}function sm(r,a,l){var d=r.tag;if(d===5||d===6)r=r.stateNode,a?l.insertBefore(r,a):l.appendChild(r);else if(d!==4&&(d===27&&Ra(r.type)&&(l=r.stateNode),r=r.child,r!==null))for(sm(r,a,l),r=r.sibling;r!==null;)sm(r,a,l),r=r.sibling}function Kw(r){var a=r.stateNode,l=r.memoizedProps;try{for(var d=r.type,g=a.attributes;g.length;)a.removeAttributeNode(g[0]);Bn(a,d,l),a[mn]=r,a[on]=l}catch(y){Rt(r,r.return,y)}}var ki=!1,cn=!1,Oy=!1,Qw=typeof WeakSet=="function"?WeakSet:Set,jn=null;function RC(r,a){if(r=r.containerInfo,i0=bm,r=ib(r),jg(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var g=d.anchorOffset,y=d.focusNode;d=d.focusOffset;try{l.nodeType,y.nodeType}catch{l=null;break e}var T=0,R=-1,H=-1,ee=0,ce=0,fe=r,se=null;t:for(;;){for(var re;fe!==l||g!==0&&fe.nodeType!==3||(R=T+g),fe!==y||d!==0&&fe.nodeType!==3||(H=T+d),fe.nodeType===3&&(T+=fe.nodeValue.length),(re=fe.firstChild)!==null;)se=fe,fe=re;for(;;){if(fe===r)break t;if(se===l&&++ee===g&&(R=T),se===y&&++ce===d&&(H=T),(re=fe.nextSibling)!==null)break;fe=se,se=fe.parentNode}fe=re}l=R===-1||H===-1?null:{start:R,end:H}}else l=null}l=l||{start:0,end:0}}else l=null;for(a0={focusedElem:r,selectionRange:l},bm=!1,jn=a;jn!==null;)if(a=jn,r=a.child,(a.subtreeFlags&1024)!==0&&r!==null)r.return=a,jn=r;else for(;jn!==null;){switch(a=jn,y=a.alternate,r=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,l=a,g=y.memoizedProps,y=y.memoizedState,d=l.stateNode;try{var Ge=qo(l.type,g,l.elementType===l.type);r=d.getSnapshotBeforeUpdate(Ge,y),d.__reactInternalSnapshotBeforeUpdate=r}catch(qe){Rt(l,l.return,qe)}}break;case 3:if((r&1024)!==0){if(r=a.stateNode.containerInfo,l=r.nodeType,l===9)c0(r);else if(l===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":c0(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(s(163))}if(r=a.sibling,r!==null){r.return=a.return,jn=r;break}jn=a.return}}function Ww(r,a,l){var d=l.flags;switch(l.tag){case 0:case 11:case 15:wa(r,l),d&4&&cd(5,l);break;case 1:if(wa(r,l),d&4)if(r=l.stateNode,a===null)try{r.componentDidMount()}catch(T){Rt(l,l.return,T)}else{var g=qo(l.type,a.memoizedProps);a=a.memoizedState;try{r.componentDidUpdate(g,a,r.__reactInternalSnapshotBeforeUpdate)}catch(T){Rt(l,l.return,T)}}d&64&&qw(l),d&512&&ud(l,l.return);break;case 3:if(wa(r,l),d&64&&(r=l.updateQueue,r!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{Cb(r,a)}catch(T){Rt(l,l.return,T)}}break;case 27:a===null&&d&4&&Kw(l);case 26:case 5:wa(r,l),a===null&&d&4&&Gw(l),d&512&&ud(l,l.return);break;case 12:wa(r,l);break;case 13:wa(r,l),d&4&&Jw(r,l),d&64&&(r=l.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(l=LC.bind(null,l),nD(r,l))));break;case 22:if(d=l.memoizedState!==null||ki,!d){a=a!==null&&a.memoizedState!==null||cn,g=ki;var y=cn;ki=d,(cn=a)&&!y?Ta(r,l,(l.subtreeFlags&8772)!==0):wa(r,l),ki=g,cn=y}break;case 30:break;default:wa(r,l)}}function Yw(r){var a=r.alternate;a!==null&&(r.alternate=null,Yw(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&pi(a)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Bt=null,gs=!1;function ji(r,a,l){for(l=l.child;l!==null;)Xw(r,a,l),l=l.sibling}function Xw(r,a,l){if(ht&&typeof ht.onCommitFiberUnmount=="function")try{ht.onCommitFiberUnmount(Ft,l)}catch{}switch(l.tag){case 26:cn||Kr(l,a),ji(r,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:cn||Kr(l,a);var d=Bt,g=gs;Ra(l.type)&&(Bt=l.stateNode,gs=!1),ji(r,a,l),vd(l.stateNode),Bt=d,gs=g;break;case 5:cn||Kr(l,a);case 6:if(d=Bt,g=gs,Bt=null,ji(r,a,l),Bt=d,gs=g,Bt!==null)if(gs)try{(Bt.nodeType===9?Bt.body:Bt.nodeName==="HTML"?Bt.ownerDocument.body:Bt).removeChild(l.stateNode)}catch(y){Rt(l,a,y)}else try{Bt.removeChild(l.stateNode)}catch(y){Rt(l,a,y)}break;case 18:Bt!==null&&(gs?(r=Bt,UT(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,l.stateNode),Nd(r)):UT(Bt,l.stateNode));break;case 4:d=Bt,g=gs,Bt=l.stateNode.containerInfo,gs=!0,ji(r,a,l),Bt=d,gs=g;break;case 0:case 11:case 14:case 15:cn||ba(2,l,a),cn||ba(4,l,a),ji(r,a,l);break;case 1:cn||(Kr(l,a),d=l.stateNode,typeof d.componentWillUnmount=="function"&&Hw(l,a,d)),ji(r,a,l);break;case 21:ji(r,a,l);break;case 22:cn=(d=cn)||l.memoizedState!==null,ji(r,a,l),cn=d;break;default:ji(r,a,l)}}function Jw(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Nd(r)}catch(l){Rt(a,a.return,l)}}function CC(r){switch(r.tag){case 13:case 19:var a=r.stateNode;return a===null&&(a=r.stateNode=new Qw),a;case 22:return r=r.stateNode,a=r._retryCache,a===null&&(a=r._retryCache=new Qw),a;default:throw Error(s(435,r.tag))}}function My(r,a){var l=CC(r);a.forEach(function(d){var g=UC.bind(null,r,d);l.has(d)||(l.add(d),d.then(g,g))})}function Cs(r,a){var l=a.deletions;if(l!==null)for(var d=0;d<l.length;d++){var g=l[d],y=r,T=a,R=T;e:for(;R!==null;){switch(R.tag){case 27:if(Ra(R.type)){Bt=R.stateNode,gs=!1;break e}break;case 5:Bt=R.stateNode,gs=!1;break e;case 3:case 4:Bt=R.stateNode.containerInfo,gs=!0;break e}R=R.return}if(Bt===null)throw Error(s(160));Xw(y,T,g),Bt=null,gs=!1,y=g.alternate,y!==null&&(y.return=null),g.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)Zw(a,r),a=a.sibling}var br=null;function Zw(r,a){var l=r.alternate,d=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Cs(a,r),Ds(r),d&4&&(ba(3,r,r.return),cd(3,r),ba(5,r,r.return));break;case 1:Cs(a,r),Ds(r),d&512&&(cn||l===null||Kr(l,l.return)),d&64&&ki&&(r=r.updateQueue,r!==null&&(d=r.callbacks,d!==null&&(l=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=l===null?d:l.concat(d))));break;case 26:var g=br;if(Cs(a,r),Ds(r),d&512&&(cn||l===null||Kr(l,l.return)),d&4){var y=l!==null?l.memoizedState:null;if(d=r.memoizedState,l===null)if(d===null)if(r.stateNode===null){e:{d=r.type,l=r.memoizedProps,g=g.ownerDocument||g;t:switch(d){case"title":y=g.getElementsByTagName("title")[0],(!y||y[la]||y[mn]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=g.createElement(d),g.head.insertBefore(y,g.querySelector("head > title"))),Bn(y,d,l),y[mn]=r,Xt(y),d=y;break e;case"link":var T=KT("link","href",g).get(d+(l.href||""));if(T){for(var R=0;R<T.length;R++)if(y=T[R],y.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&y.getAttribute("rel")===(l.rel==null?null:l.rel)&&y.getAttribute("title")===(l.title==null?null:l.title)&&y.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){T.splice(R,1);break t}}y=g.createElement(d),Bn(y,d,l),g.head.appendChild(y);break;case"meta":if(T=KT("meta","content",g).get(d+(l.content||""))){for(R=0;R<T.length;R++)if(y=T[R],y.getAttribute("content")===(l.content==null?null:""+l.content)&&y.getAttribute("name")===(l.name==null?null:l.name)&&y.getAttribute("property")===(l.property==null?null:l.property)&&y.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&y.getAttribute("charset")===(l.charSet==null?null:l.charSet)){T.splice(R,1);break t}}y=g.createElement(d),Bn(y,d,l),g.head.appendChild(y);break;default:throw Error(s(468,d))}y[mn]=r,Xt(y),d=y}r.stateNode=d}else QT(g,r.type,r.stateNode);else r.stateNode=$T(g,d,r.memoizedProps);else y!==d?(y===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):y.count--,d===null?QT(g,r.type,r.stateNode):$T(g,d,r.memoizedProps)):d===null&&r.stateNode!==null&&ky(r,r.memoizedProps,l.memoizedProps)}break;case 27:Cs(a,r),Ds(r),d&512&&(cn||l===null||Kr(l,l.return)),l!==null&&d&4&&ky(r,r.memoizedProps,l.memoizedProps);break;case 5:if(Cs(a,r),Ds(r),d&512&&(cn||l===null||Kr(l,l.return)),r.flags&32){g=r.stateNode;try{Rn(g,"")}catch(re){Rt(r,r.return,re)}}d&4&&r.stateNode!=null&&(g=r.memoizedProps,ky(r,g,l!==null?l.memoizedProps:g)),d&1024&&(Oy=!0);break;case 6:if(Cs(a,r),Ds(r),d&4){if(r.stateNode===null)throw Error(s(162));d=r.memoizedProps,l=r.stateNode;try{l.nodeValue=d}catch(re){Rt(r,r.return,re)}}break;case 3:if(xm=null,g=br,br=gm(a.containerInfo),Cs(a,r),br=g,Ds(r),d&4&&l!==null&&l.memoizedState.isDehydrated)try{Nd(a.containerInfo)}catch(re){Rt(r,r.return,re)}Oy&&(Oy=!1,eT(r));break;case 4:d=br,br=gm(r.stateNode.containerInfo),Cs(a,r),Ds(r),br=d;break;case 12:Cs(a,r),Ds(r);break;case 13:Cs(a,r),Ds(r),r.child.flags&8192&&r.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(zy=Yt()),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,My(r,d)));break;case 22:g=r.memoizedState!==null;var H=l!==null&&l.memoizedState!==null,ee=ki,ce=cn;if(ki=ee||g,cn=ce||H,Cs(a,r),cn=ce,ki=ee,Ds(r),d&8192)e:for(a=r.stateNode,a._visibility=g?a._visibility&-2:a._visibility|1,g&&(l===null||H||ki||cn||Ho(r)),l=null,a=r;;){if(a.tag===5||a.tag===26){if(l===null){H=l=a;try{if(y=H.stateNode,g)T=y.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{R=H.stateNode;var fe=H.memoizedProps.style,se=fe!=null&&fe.hasOwnProperty("display")?fe.display:null;R.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(re){Rt(H,H.return,re)}}}else if(a.tag===6){if(l===null){H=a;try{H.stateNode.nodeValue=g?"":H.memoizedProps}catch(re){Rt(H,H.return,re)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===r)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break e;for(;a.sibling===null;){if(a.return===null||a.return===r)break e;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}d&4&&(d=r.updateQueue,d!==null&&(l=d.retryQueue,l!==null&&(d.retryQueue=null,My(r,l))));break;case 19:Cs(a,r),Ds(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,My(r,d)));break;case 30:break;case 21:break;default:Cs(a,r),Ds(r)}}function Ds(r){var a=r.flags;if(a&2){try{for(var l,d=r.return;d!==null;){if($w(d)){l=d;break}d=d.return}if(l==null)throw Error(s(160));switch(l.tag){case 27:var g=l.stateNode,y=jy(r);sm(r,y,g);break;case 5:var T=l.stateNode;l.flags&32&&(Rn(T,""),l.flags&=-33);var R=jy(r);sm(r,R,T);break;case 3:case 4:var H=l.stateNode.containerInfo,ee=jy(r);Py(r,ee,H);break;default:throw Error(s(161))}}catch(ce){Rt(r,r.return,ce)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function eT(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var a=r;eT(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),r=r.sibling}}function wa(r,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Ww(r,a.alternate,a),a=a.sibling}function Ho(r){for(r=r.child;r!==null;){var a=r;switch(a.tag){case 0:case 11:case 14:case 15:ba(4,a,a.return),Ho(a);break;case 1:Kr(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&Hw(a,a.return,l),Ho(a);break;case 27:vd(a.stateNode);case 26:case 5:Kr(a,a.return),Ho(a);break;case 22:a.memoizedState===null&&Ho(a);break;case 30:Ho(a);break;default:Ho(a)}r=r.sibling}}function Ta(r,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var d=a.alternate,g=r,y=a,T=y.flags;switch(y.tag){case 0:case 11:case 15:Ta(g,y,l),cd(4,y);break;case 1:if(Ta(g,y,l),d=y,g=d.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(ee){Rt(d,d.return,ee)}if(d=y,g=d.updateQueue,g!==null){var R=d.stateNode;try{var H=g.shared.hiddenCallbacks;if(H!==null)for(g.shared.hiddenCallbacks=null,g=0;g<H.length;g++)Rb(H[g],R)}catch(ee){Rt(d,d.return,ee)}}l&&T&64&&qw(y),ud(y,y.return);break;case 27:Kw(y);case 26:case 5:Ta(g,y,l),l&&d===null&&T&4&&Gw(y),ud(y,y.return);break;case 12:Ta(g,y,l);break;case 13:Ta(g,y,l),l&&T&4&&Jw(g,y);break;case 22:y.memoizedState===null&&Ta(g,y,l),ud(y,y.return);break;case 30:break;default:Ta(g,y,l)}a=a.sibling}}function Vy(r,a){var l=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),r=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(r=a.memoizedState.cachePool.pool),r!==l&&(r!=null&&r.refCount++,l!=null&&Wu(l))}function Ly(r,a){r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Wu(r))}function Qr(r,a,l,d){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)tT(r,a,l,d),a=a.sibling}function tT(r,a,l,d){var g=a.flags;switch(a.tag){case 0:case 11:case 15:Qr(r,a,l,d),g&2048&&cd(9,a);break;case 1:Qr(r,a,l,d);break;case 3:Qr(r,a,l,d),g&2048&&(r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Wu(r)));break;case 12:if(g&2048){Qr(r,a,l,d),r=a.stateNode;try{var y=a.memoizedProps,T=y.id,R=y.onPostCommit;typeof R=="function"&&R(T,a.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(H){Rt(a,a.return,H)}}else Qr(r,a,l,d);break;case 13:Qr(r,a,l,d);break;case 23:break;case 22:y=a.stateNode,T=a.alternate,a.memoizedState!==null?y._visibility&2?Qr(r,a,l,d):dd(r,a):y._visibility&2?Qr(r,a,l,d):(y._visibility|=2,ac(r,a,l,d,(a.subtreeFlags&10256)!==0)),g&2048&&Vy(T,a);break;case 24:Qr(r,a,l,d),g&2048&&Ly(a.alternate,a);break;default:Qr(r,a,l,d)}}function ac(r,a,l,d,g){for(g=g&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var y=r,T=a,R=l,H=d,ee=T.flags;switch(T.tag){case 0:case 11:case 15:ac(y,T,R,H,g),cd(8,T);break;case 23:break;case 22:var ce=T.stateNode;T.memoizedState!==null?ce._visibility&2?ac(y,T,R,H,g):dd(y,T):(ce._visibility|=2,ac(y,T,R,H,g)),g&&ee&2048&&Vy(T.alternate,T);break;case 24:ac(y,T,R,H,g),g&&ee&2048&&Ly(T.alternate,T);break;default:ac(y,T,R,H,g)}a=a.sibling}}function dd(r,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=r,d=a,g=d.flags;switch(d.tag){case 22:dd(l,d),g&2048&&Vy(d.alternate,d);break;case 24:dd(l,d),g&2048&&Ly(d.alternate,d);break;default:dd(l,d)}a=a.sibling}}var hd=8192;function oc(r){if(r.subtreeFlags&hd)for(r=r.child;r!==null;)nT(r),r=r.sibling}function nT(r){switch(r.tag){case 26:oc(r),r.flags&hd&&r.memoizedState!==null&&pD(br,r.memoizedState,r.memoizedProps);break;case 5:oc(r);break;case 3:case 4:var a=br;br=gm(r.stateNode.containerInfo),oc(r),br=a;break;case 22:r.memoizedState===null&&(a=r.alternate,a!==null&&a.memoizedState!==null?(a=hd,hd=16777216,oc(r),hd=a):oc(r));break;default:oc(r)}}function sT(r){var a=r.alternate;if(a!==null&&(r=a.child,r!==null)){a.child=null;do a=r.sibling,r.sibling=null,r=a;while(r!==null)}}function fd(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var d=a[l];jn=d,iT(d,r)}sT(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)rT(r),r=r.sibling}function rT(r){switch(r.tag){case 0:case 11:case 15:fd(r),r.flags&2048&&ba(9,r,r.return);break;case 3:fd(r);break;case 12:fd(r);break;case 22:var a=r.stateNode;r.memoizedState!==null&&a._visibility&2&&(r.return===null||r.return.tag!==13)?(a._visibility&=-3,rm(r)):fd(r);break;default:fd(r)}}function rm(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var d=a[l];jn=d,iT(d,r)}sT(r)}for(r=r.child;r!==null;){switch(a=r,a.tag){case 0:case 11:case 15:ba(8,a,a.return),rm(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,rm(a));break;default:rm(a)}r=r.sibling}}function iT(r,a){for(;jn!==null;){var l=jn;switch(l.tag){case 0:case 11:case 15:ba(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var d=l.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Wu(l.memoizedState.cache)}if(d=l.child,d!==null)d.return=l,jn=d;else e:for(l=r;jn!==null;){d=jn;var g=d.sibling,y=d.return;if(Yw(d),d===l){jn=null;break e}if(g!==null){g.return=y,jn=g;break e}jn=y}}}var DC={getCacheForType:function(r){var a=Qn(wn),l=a.data.get(r);return l===void 0&&(l=r(),a.data.set(r,l)),l}},kC=typeof WeakMap=="function"?WeakMap:Map,bt=0,kt=null,Ze=null,ot=0,wt=0,ks=null,Ea=!1,lc=!1,Uy=!1,Pi=0,Zt=0,Ia=0,Go=0,Fy=0,Zs=0,cc=0,md=null,ys=null,By=!1,zy=0,im=1/0,am=null,Sa=null,Fn=0,Na=null,uc=null,dc=0,qy=0,Hy=null,aT=null,pd=0,Gy=null;function js(){if((bt&2)!==0&&ot!==0)return ot&-ot;if(J.T!==null){var r=Jl;return r!==0?r:Jy()}return mr()}function oT(){Zs===0&&(Zs=(ot&536870912)===0||yt?_o():536870912);var r=Js.current;return r!==null&&(r.flags|=32),Zs}function Ps(r,a,l){(r===kt&&(wt===2||wt===9)||r.cancelPendingCommit!==null)&&(hc(r,0),Aa(r,ot,Zs,!1)),fr(r,l),((bt&2)===0||r!==kt)&&(r===kt&&((bt&2)===0&&(Go|=l),Zt===4&&Aa(r,ot,Zs,!1)),Wr(r))}function lT(r,a,l){if((bt&6)!==0)throw Error(s(327));var d=!l&&(a&124)===0&&(a&r.expiredLanes)===0||fi(r,a),g=d?OC(r,a):Qy(r,a,!0),y=d;do{if(g===0){lc&&!d&&Aa(r,a,0,!1);break}else{if(l=r.current.alternate,y&&!jC(l)){g=Qy(r,a,!1),y=!1;continue}if(g===2){if(y=a,r.errorRecoveryDisabledLanes&y)var T=0;else T=r.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){a=T;e:{var R=r;g=md;var H=R.current.memoizedState.isDehydrated;if(H&&(hc(R,T).flags|=256),T=Qy(R,T,!1),T!==2){if(Uy&&!H){R.errorRecoveryDisabledLanes|=y,Go|=y,g=4;break e}y=ys,ys=g,y!==null&&(ys===null?ys=y:ys.push.apply(ys,y))}g=T}if(y=!1,g!==2)continue}}if(g===1){hc(r,0),Aa(r,a,0,!0);break}e:{switch(d=r,y=g,y){case 0:case 1:throw Error(s(345));case 4:if((a&4194048)!==a)break;case 6:Aa(d,a,Zs,!Ea);break e;case 2:ys=null;break;case 3:case 5:break;default:throw Error(s(329))}if((a&62914560)===a&&(g=zy+300-Yt(),10<g)){if(Aa(d,a,Zs,!Ea),aa(d,0,!0)!==0)break e;d.timeoutHandle=VT(cT.bind(null,d,l,ys,am,By,a,Zs,Go,cc,Ea,y,2,-0,0),g);break e}cT(d,l,ys,am,By,a,Zs,Go,cc,Ea,y,0,-0,0)}}break}while(!0);Wr(r)}function cT(r,a,l,d,g,y,T,R,H,ee,ce,fe,se,re){if(r.timeoutHandle=-1,fe=a.subtreeFlags,(fe&8192||(fe&16785408)===16785408)&&(wd={stylesheets:null,count:0,unsuspend:mD},nT(a),fe=gD(),fe!==null)){r.cancelPendingCommit=fe(gT.bind(null,r,a,y,l,d,g,T,R,H,ce,1,se,re)),Aa(r,y,T,!ee);return}gT(r,a,y,l,d,g,T,R,H)}function jC(r){for(var a=r;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var d=0;d<l.length;d++){var g=l[d],y=g.getSnapshot;g=g.value;try{if(!As(y(),g))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Aa(r,a,l,d){a&=~Fy,a&=~Go,r.suspendedLanes|=a,r.pingedLanes&=~a,d&&(r.warmLanes|=a),d=r.expirationTimes;for(var g=a;0<g;){var y=31-Nn(g),T=1<<y;d[y]=-1,g&=~T}l!==0&&an(r,l,a)}function om(){return(bt&6)===0?(gd(0),!1):!0}function $y(){if(Ze!==null){if(wt===0)var r=Ze.return;else r=Ze,Si=Uo=null,cy(r),rc=null,ad=0,r=Ze;for(;r!==null;)zw(r.alternate,r),r=r.return;Ze=null}}function hc(r,a){var l=r.timeoutHandle;l!==-1&&(r.timeoutHandle=-1,XC(l)),l=r.cancelPendingCommit,l!==null&&(r.cancelPendingCommit=null,l()),$y(),kt=r,Ze=l=Ti(r.current,null),ot=a,wt=0,ks=null,Ea=!1,lc=fi(r,a),Uy=!1,cc=Zs=Fy=Go=Ia=Zt=0,ys=md=null,By=!1,(a&8)!==0&&(a|=a&32);var d=r.entangledLanes;if(d!==0)for(r=r.entanglements,d&=a;0<d;){var g=31-Nn(d),y=1<<g;a|=r[g],d&=~y}return Pi=a,Rf(),l}function uT(r,a){We=null,J.H=Qf,a===Xu||a===Lf?(a=Nb(),wt=3):a===Eb?(a=Nb(),wt=4):wt=a===Aw?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,ks=a,Ze===null&&(Zt=1,Zf(r,Qs(a,r.current)))}function dT(){var r=J.H;return J.H=Qf,r===null?Qf:r}function hT(){var r=J.A;return J.A=DC,r}function Ky(){Zt=4,Ea||(ot&4194048)!==ot&&Js.current!==null||(lc=!0),(Ia&134217727)===0&&(Go&134217727)===0||kt===null||Aa(kt,ot,Zs,!1)}function Qy(r,a,l){var d=bt;bt|=2;var g=dT(),y=hT();(kt!==r||ot!==a)&&(am=null,hc(r,a)),a=!1;var T=Zt;e:do try{if(wt!==0&&Ze!==null){var R=Ze,H=ks;switch(wt){case 8:$y(),T=6;break e;case 3:case 2:case 9:case 6:Js.current===null&&(a=!0);var ee=wt;if(wt=0,ks=null,fc(r,R,H,ee),l&&lc){T=0;break e}break;default:ee=wt,wt=0,ks=null,fc(r,R,H,ee)}}PC(),T=Zt;break}catch(ce){uT(r,ce)}while(!0);return a&&r.shellSuspendCounter++,Si=Uo=null,bt=d,J.H=g,J.A=y,Ze===null&&(kt=null,ot=0,Rf()),T}function PC(){for(;Ze!==null;)fT(Ze)}function OC(r,a){var l=bt;bt|=2;var d=dT(),g=hT();kt!==r||ot!==a?(am=null,im=Yt()+500,hc(r,a)):lc=fi(r,a);e:do try{if(wt!==0&&Ze!==null){a=Ze;var y=ks;t:switch(wt){case 1:wt=0,ks=null,fc(r,a,y,1);break;case 2:case 9:if(Ib(y)){wt=0,ks=null,mT(a);break}a=function(){wt!==2&&wt!==9||kt!==r||(wt=7),Wr(r)},y.then(a,a);break e;case 3:wt=7;break e;case 4:wt=5;break e;case 7:Ib(y)?(wt=0,ks=null,mT(a)):(wt=0,ks=null,fc(r,a,y,7));break;case 5:var T=null;switch(Ze.tag){case 26:T=Ze.memoizedState;case 5:case 27:var R=Ze;if(!T||WT(T)){wt=0,ks=null;var H=R.sibling;if(H!==null)Ze=H;else{var ee=R.return;ee!==null?(Ze=ee,lm(ee)):Ze=null}break t}}wt=0,ks=null,fc(r,a,y,5);break;case 6:wt=0,ks=null,fc(r,a,y,6);break;case 8:$y(),Zt=6;break e;default:throw Error(s(462))}}MC();break}catch(ce){uT(r,ce)}while(!0);return Si=Uo=null,J.H=d,J.A=g,bt=l,Ze!==null?0:(kt=null,ot=0,Rf(),Zt)}function MC(){for(;Ze!==null&&!Je();)fT(Ze)}function fT(r){var a=Fw(r.alternate,r,Pi);r.memoizedProps=r.pendingProps,a===null?lm(r):Ze=a}function mT(r){var a=r,l=a.alternate;switch(a.tag){case 15:case 0:a=Pw(l,a,a.pendingProps,a.type,void 0,ot);break;case 11:a=Pw(l,a,a.pendingProps,a.type.render,a.ref,ot);break;case 5:cy(a);default:zw(l,a),a=Ze=pb(a,Pi),a=Fw(l,a,Pi)}r.memoizedProps=r.pendingProps,a===null?lm(r):Ze=a}function fc(r,a,l,d){Si=Uo=null,cy(a),rc=null,ad=0;var g=a.return;try{if(IC(r,g,a,l,ot)){Zt=1,Zf(r,Qs(l,r.current)),Ze=null;return}}catch(y){if(g!==null)throw Ze=g,y;Zt=1,Zf(r,Qs(l,r.current)),Ze=null;return}a.flags&32768?(yt||d===1?r=!0:lc||(ot&536870912)!==0?r=!1:(Ea=r=!0,(d===2||d===9||d===3||d===6)&&(d=Js.current,d!==null&&d.tag===13&&(d.flags|=16384))),pT(a,r)):lm(a)}function lm(r){var a=r;do{if((a.flags&32768)!==0){pT(a,Ea);return}r=a.return;var l=NC(a.alternate,a,Pi);if(l!==null){Ze=l;return}if(a=a.sibling,a!==null){Ze=a;return}Ze=a=r}while(a!==null);Zt===0&&(Zt=5)}function pT(r,a){do{var l=AC(r.alternate,r);if(l!==null){l.flags&=32767,Ze=l;return}if(l=r.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(r=r.sibling,r!==null)){Ze=r;return}Ze=r=l}while(r!==null);Zt=6,Ze=null}function gT(r,a,l,d,g,y,T,R,H){r.cancelPendingCommit=null;do cm();while(Fn!==0);if((bt&6)!==0)throw Error(s(327));if(a!==null){if(a===r.current)throw Error(s(177));if(y=a.lanes|a.childLanes,y|=Lg,wo(r,l,y,T,R,H),r===kt&&(Ze=kt=null,ot=0),uc=a,Na=r,dc=l,qy=y,Hy=g,aT=d,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,FC(cr,function(){return bT(),null})):(r.callbackNode=null,r.callbackPriority=0),d=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||d){d=J.T,J.T=null,g=ge.p,ge.p=2,T=bt,bt|=4;try{RC(r,a,l)}finally{bt=T,ge.p=g,J.T=d}}Fn=1,yT(),xT(),vT()}}function yT(){if(Fn===1){Fn=0;var r=Na,a=uc,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=J.T,J.T=null;var d=ge.p;ge.p=2;var g=bt;bt|=4;try{Zw(a,r);var y=a0,T=ib(r.containerInfo),R=y.focusedElem,H=y.selectionRange;if(T!==R&&R&&R.ownerDocument&&rb(R.ownerDocument.documentElement,R)){if(H!==null&&jg(R)){var ee=H.start,ce=H.end;if(ce===void 0&&(ce=ee),"selectionStart"in R)R.selectionStart=ee,R.selectionEnd=Math.min(ce,R.value.length);else{var fe=R.ownerDocument||document,se=fe&&fe.defaultView||window;if(se.getSelection){var re=se.getSelection(),Ge=R.textContent.length,qe=Math.min(H.start,Ge),At=H.end===void 0?qe:Math.min(H.end,Ge);!re.extend&&qe>At&&(T=At,At=qe,qe=T);var Q=sb(R,qe),$=sb(R,At);if(Q&&$&&(re.rangeCount!==1||re.anchorNode!==Q.node||re.anchorOffset!==Q.offset||re.focusNode!==$.node||re.focusOffset!==$.offset)){var X=fe.createRange();X.setStart(Q.node,Q.offset),re.removeAllRanges(),qe>At?(re.addRange(X),re.extend($.node,$.offset)):(X.setEnd($.node,$.offset),re.addRange(X))}}}}for(fe=[],re=R;re=re.parentNode;)re.nodeType===1&&fe.push({element:re,left:re.scrollLeft,top:re.scrollTop});for(typeof R.focus=="function"&&R.focus(),R=0;R<fe.length;R++){var de=fe[R];de.element.scrollLeft=de.left,de.element.scrollTop=de.top}}bm=!!i0,a0=i0=null}finally{bt=g,ge.p=d,J.T=l}}r.current=a,Fn=2}}function xT(){if(Fn===2){Fn=0;var r=Na,a=uc,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=J.T,J.T=null;var d=ge.p;ge.p=2;var g=bt;bt|=4;try{Ww(r,a.alternate,a)}finally{bt=g,ge.p=d,J.T=l}}Fn=3}}function vT(){if(Fn===4||Fn===3){Fn=0,ct();var r=Na,a=uc,l=dc,d=aT;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Fn=5:(Fn=0,uc=Na=null,_T(r,r.pendingLanes));var g=r.pendingLanes;if(g===0&&(Sa=null),oa(l),a=a.stateNode,ht&&typeof ht.onCommitFiberRoot=="function")try{ht.onCommitFiberRoot(Ft,a,void 0,(a.current.flags&128)===128)}catch{}if(d!==null){a=J.T,g=ge.p,ge.p=2,J.T=null;try{for(var y=r.onRecoverableError,T=0;T<d.length;T++){var R=d[T];y(R.value,{componentStack:R.stack})}}finally{J.T=a,ge.p=g}}(dc&3)!==0&&cm(),Wr(r),g=r.pendingLanes,(l&4194090)!==0&&(g&42)!==0?r===Gy?pd++:(pd=0,Gy=r):pd=0,gd(0)}}function _T(r,a){(r.pooledCacheLanes&=a)===0&&(a=r.pooledCache,a!=null&&(r.pooledCache=null,Wu(a)))}function cm(r){return yT(),xT(),vT(),bT()}function bT(){if(Fn!==5)return!1;var r=Na,a=qy;qy=0;var l=oa(dc),d=J.T,g=ge.p;try{ge.p=32>l?32:l,J.T=null,l=Hy,Hy=null;var y=Na,T=dc;if(Fn=0,uc=Na=null,dc=0,(bt&6)!==0)throw Error(s(331));var R=bt;if(bt|=4,rT(y.current),tT(y,y.current,T,l),bt=R,gd(0,!1),ht&&typeof ht.onPostCommitFiberRoot=="function")try{ht.onPostCommitFiberRoot(Ft,y)}catch{}return!0}finally{ge.p=g,J.T=d,_T(r,a)}}function wT(r,a,l){a=Qs(l,a),a=Ty(r.stateNode,a,2),r=ya(r,a,2),r!==null&&(fr(r,2),Wr(r))}function Rt(r,a,l){if(r.tag===3)wT(r,r,l);else for(;a!==null;){if(a.tag===3){wT(a,r,l);break}else if(a.tag===1){var d=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Sa===null||!Sa.has(d))){r=Qs(l,r),l=Sw(2),d=ya(a,l,2),d!==null&&(Nw(l,d,a,r),fr(d,2),Wr(d));break}}a=a.return}}function Wy(r,a,l){var d=r.pingCache;if(d===null){d=r.pingCache=new kC;var g=new Set;d.set(a,g)}else g=d.get(a),g===void 0&&(g=new Set,d.set(a,g));g.has(l)||(Uy=!0,g.add(l),r=VC.bind(null,r,a,l),a.then(r,r))}function VC(r,a,l){var d=r.pingCache;d!==null&&d.delete(a),r.pingedLanes|=r.suspendedLanes&l,r.warmLanes&=~l,kt===r&&(ot&l)===l&&(Zt===4||Zt===3&&(ot&62914560)===ot&&300>Yt()-zy?(bt&2)===0&&hc(r,0):Fy|=l,cc===ot&&(cc=0)),Wr(r)}function TT(r,a){a===0&&(a=bo()),r=Ql(r,a),r!==null&&(fr(r,a),Wr(r))}function LC(r){var a=r.memoizedState,l=0;a!==null&&(l=a.retryLane),TT(r,l)}function UC(r,a){var l=0;switch(r.tag){case 13:var d=r.stateNode,g=r.memoizedState;g!==null&&(l=g.retryLane);break;case 19:d=r.stateNode;break;case 22:d=r.stateNode._retryCache;break;default:throw Error(s(314))}d!==null&&d.delete(a),TT(r,l)}function FC(r,a){return lr(r,a)}var um=null,mc=null,Yy=!1,dm=!1,Xy=!1,$o=0;function Wr(r){r!==mc&&r.next===null&&(mc===null?um=mc=r:mc=mc.next=r),dm=!0,Yy||(Yy=!0,zC())}function gd(r,a){if(!Xy&&dm){Xy=!0;do for(var l=!1,d=um;d!==null;){if(r!==0){var g=d.pendingLanes;if(g===0)var y=0;else{var T=d.suspendedLanes,R=d.pingedLanes;y=(1<<31-Nn(42|r)+1)-1,y&=g&~(T&~R),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(l=!0,NT(d,y))}else y=ot,y=aa(d,d===kt?y:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(y&3)===0||fi(d,y)||(l=!0,NT(d,y));d=d.next}while(l);Xy=!1}}function BC(){ET()}function ET(){dm=Yy=!1;var r=0;$o!==0&&(YC()&&(r=$o),$o=0);for(var a=Yt(),l=null,d=um;d!==null;){var g=d.next,y=IT(d,a);y===0?(d.next=null,l===null?um=g:l.next=g,g===null&&(mc=l)):(l=d,(r!==0||(y&3)!==0)&&(dm=!0)),d=g}gd(r)}function IT(r,a){for(var l=r.suspendedLanes,d=r.pingedLanes,g=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var T=31-Nn(y),R=1<<T,H=g[T];H===-1?((R&l)===0||(R&d)!==0)&&(g[T]=vo(R,a)):H<=a&&(r.expiredLanes|=R),y&=~R}if(a=kt,l=ot,l=aa(r,r===a?l:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d=r.callbackNode,l===0||r===a&&(wt===2||wt===9)||r.cancelPendingCommit!==null)return d!==null&&d!==null&&Ne(d),r.callbackNode=null,r.callbackPriority=0;if((l&3)===0||fi(r,l)){if(a=l&-l,a===r.callbackPriority)return a;switch(d!==null&&Ne(d),oa(l)){case 2:case 8:l=rn;break;case 32:l=cr;break;case 268435456:l=ur;break;default:l=cr}return d=ST.bind(null,r),l=lr(l,d),r.callbackPriority=a,r.callbackNode=l,a}return d!==null&&d!==null&&Ne(d),r.callbackPriority=2,r.callbackNode=null,2}function ST(r,a){if(Fn!==0&&Fn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var l=r.callbackNode;if(cm()&&r.callbackNode!==l)return null;var d=ot;return d=aa(r,r===kt?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d===0?null:(lT(r,d,a),IT(r,Yt()),r.callbackNode!=null&&r.callbackNode===l?ST.bind(null,r):null)}function NT(r,a){if(cm())return null;lT(r,a,!0)}function zC(){JC(function(){(bt&6)!==0?lr(dt,BC):ET()})}function Jy(){return $o===0&&($o=_o()),$o}function AT(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Ml(""+r)}function RT(r,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,r.id&&l.setAttribute("form",r.id),a.parentNode.insertBefore(l,a),r=new FormData(r),l.parentNode.removeChild(l),r}function qC(r,a,l,d,g){if(a==="submit"&&l&&l.stateNode===g){var y=AT((g[on]||null).action),T=d.submitter;T&&(a=(a=T[on]||null)?AT(a.formAction):T.getAttribute("formAction"),a!==null&&(y=a,T=null));var R=new Vl("action","action",null,d,g);r.push({event:R,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if($o!==0){var H=T?RT(g,T):new FormData(g);xy(l,{pending:!0,data:H,method:g.method,action:y},null,H)}}else typeof y=="function"&&(R.preventDefault(),H=T?RT(g,T):new FormData(g),xy(l,{pending:!0,data:H,method:g.method,action:y},y,H))},currentTarget:g}]})}}for(var Zy=0;Zy<Vg.length;Zy++){var e0=Vg[Zy],HC=e0.toLowerCase(),GC=e0[0].toUpperCase()+e0.slice(1);_r(HC,"on"+GC)}_r(lb,"onAnimationEnd"),_r(cb,"onAnimationIteration"),_r(ub,"onAnimationStart"),_r("dblclick","onDoubleClick"),_r("focusin","onFocus"),_r("focusout","onBlur"),_r(lC,"onTransitionRun"),_r(cC,"onTransitionStart"),_r(uC,"onTransitionCancel"),_r(db,"onTransitionEnd"),Or("onMouseEnter",["mouseout","mouseover"]),Or("onMouseLeave",["mouseout","mouseover"]),Or("onPointerEnter",["pointerout","pointerover"]),Or("onPointerLeave",["pointerout","pointerover"]),qs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),qs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),qs("onBeforeInput",["compositionend","keypress","textInput","paste"]),qs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),qs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),qs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$C=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(yd));function CT(r,a){a=(a&4)!==0;for(var l=0;l<r.length;l++){var d=r[l],g=d.event;d=d.listeners;e:{var y=void 0;if(a)for(var T=d.length-1;0<=T;T--){var R=d[T],H=R.instance,ee=R.currentTarget;if(R=R.listener,H!==y&&g.isPropagationStopped())break e;y=R,g.currentTarget=ee;try{y(g)}catch(ce){Jf(ce)}g.currentTarget=null,y=H}else for(T=0;T<d.length;T++){if(R=d[T],H=R.instance,ee=R.currentTarget,R=R.listener,H!==y&&g.isPropagationStopped())break e;y=R,g.currentTarget=ee;try{y(g)}catch(ce){Jf(ce)}g.currentTarget=null,y=H}}}}function et(r,a){var l=a[Pl];l===void 0&&(l=a[Pl]=new Set);var d=r+"__bubble";l.has(d)||(DT(a,r,2,!1),l.add(d))}function t0(r,a,l){var d=0;a&&(d|=4),DT(l,r,d,a)}var hm="_reactListening"+Math.random().toString(36).slice(2);function n0(r){if(!r[hm]){r[hm]=!0,Ol.forEach(function(l){l!=="selectionchange"&&($C.has(l)||t0(l,!1,r),t0(l,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[hm]||(a[hm]=!0,t0("selectionchange",!1,a))}}function DT(r,a,l,d){switch(tE(a)){case 2:var g=vD;break;case 8:g=_D;break;default:g=g0}l=g.bind(null,a,l,r),g=void 0,!$s||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(g=!0),d?g!==void 0?r.addEventListener(a,l,{capture:!0,passive:g}):r.addEventListener(a,l,!0):g!==void 0?r.addEventListener(a,l,{passive:g}):r.addEventListener(a,l,!1)}function s0(r,a,l,d,g){var y=d;if((a&1)===0&&(a&2)===0&&d!==null)e:for(;;){if(d===null)return;var T=d.tag;if(T===3||T===4){var R=d.stateNode.containerInfo;if(R===g)break;if(T===4)for(T=d.return;T!==null;){var H=T.tag;if((H===3||H===4)&&T.stateNode.containerInfo===g)return;T=T.return}for(;R!==null;){if(T=Pr(R),T===null)return;if(H=T.tag,H===5||H===6||H===26||H===27){d=y=T;continue e}R=R.parentNode}}d=d.return}mf(function(){var ee=y,ce=Gs(l),fe=[];e:{var se=hb.get(r);if(se!==void 0){var re=Vl,Ge=r;switch(r){case"keypress":if(Fr(l)===0)break e;case"keydown":case"keyup":re=ql;break;case"focusin":Ge="focus",re=Fl;break;case"focusout":Ge="blur",re=Fl;break;case"beforeblur":case"afterblur":re=Fl;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":re=Ks;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":re=Rg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":re=wf;break;case lb:case cb:case ub:re=Bl;break;case db:re=Ef;break;case"scroll":case"scrollend":re=pf;break;case"wheel":re=Hl;break;case"copy":case"cut":case"paste":re=zl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":re=Bu;break;case"toggle":case"beforetoggle":re=Sf}var qe=(a&4)!==0,At=!qe&&(r==="scroll"||r==="scrollend"),Q=qe?se!==null?se+"Capture":null:se;qe=[];for(var $=ee,X;$!==null;){var de=$;if(X=de.stateNode,de=de.tag,de!==5&&de!==26&&de!==27||X===null||Q===null||(de=Io($,Q),de!=null&&qe.push(xd($,de,X))),At)break;$=$.return}0<qe.length&&(se=new re(se,Ge,null,l,ce),fe.push({event:se,listeners:qe}))}}if((a&7)===0){e:{if(se=r==="mouseover"||r==="pointerover",re=r==="mouseout"||r==="pointerout",se&&l!==yi&&(Ge=l.relatedTarget||l.fromElement)&&(Pr(Ge)||Ge[Ns]))break e;if((re||se)&&(se=ce.window===ce?ce:(se=ce.ownerDocument)?se.defaultView||se.parentWindow:window,re?(Ge=l.relatedTarget||l.toElement,re=ee,Ge=Ge?Pr(Ge):null,Ge!==null&&(At=o(Ge),qe=Ge.tag,Ge!==At||qe!==5&&qe!==27&&qe!==6)&&(Ge=null)):(re=null,Ge=ee),re!==Ge)){if(qe=Ks,de="onMouseLeave",Q="onMouseEnter",$="mouse",(r==="pointerout"||r==="pointerover")&&(qe=Bu,de="onPointerLeave",Q="onPointerEnter",$="pointer"),At=re==null?se:gr(re),X=Ge==null?se:gr(Ge),se=new qe(de,$+"leave",re,l,ce),se.target=At,se.relatedTarget=X,de=null,Pr(ce)===ee&&(qe=new qe(Q,$+"enter",Ge,l,ce),qe.target=X,qe.relatedTarget=At,de=qe),At=de,re&&Ge)t:{for(qe=re,Q=Ge,$=0,X=qe;X;X=pc(X))$++;for(X=0,de=Q;de;de=pc(de))X++;for(;0<$-X;)qe=pc(qe),$--;for(;0<X-$;)Q=pc(Q),X--;for(;$--;){if(qe===Q||Q!==null&&qe===Q.alternate)break t;qe=pc(qe),Q=pc(Q)}qe=null}else qe=null;re!==null&&kT(fe,se,re,qe,!1),Ge!==null&&At!==null&&kT(fe,At,Ge,qe,!0)}}e:{if(se=ee?gr(ee):window,re=se.nodeName&&se.nodeName.toLowerCase(),re==="select"||re==="input"&&se.type==="file")var De=X_;else if(bn(se))if(J_)De=iC;else{De=sC;var Xe=nC}else re=se.nodeName,!re||re.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?ee&&Pu(ee.elementType)&&(De=X_):De=rC;if(De&&(De=De(r,ee))){wi(fe,De,l,ce);break e}Xe&&Xe(r,se,ee),r==="focusout"&&ee&&se.type==="number"&&ee.memoizedProps.value!=null&&ut(se,"number",se.value)}switch(Xe=ee?gr(ee):window,r){case"focusin":(bn(Xe)||Xe.contentEditable==="true")&&(Gl=Xe,Pg=ee,Hu=null);break;case"focusout":Hu=Pg=Gl=null;break;case"mousedown":Og=!0;break;case"contextmenu":case"mouseup":case"dragend":Og=!1,ab(fe,l,ce);break;case"selectionchange":if(oC)break;case"keydown":case"keyup":ab(fe,l,ce)}var Fe;if(qr)e:{switch(r){case"compositionstart":var He="onCompositionStart";break e;case"compositionend":He="onCompositionEnd";break e;case"compositionupdate":He="onCompositionUpdate";break e}He=void 0}else it?ae(r,l)&&(He="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&(He="onCompositionStart");He&&(w&&l.locale!=="ko"&&(it||He!=="onCompositionStart"?He==="onCompositionEnd"&&it&&(Fe=Mu()):(Ur=ce,fa="value"in Ur?Ur.value:Ur.textContent,it=!0)),Xe=fm(ee,He),0<Xe.length&&(He=new Uu(He,r,null,l,ce),fe.push({event:He,listeners:Xe}),Fe?He.data=Fe:(Fe=be(l),Fe!==null&&(He.data=Fe)))),(Fe=_?_n(r,l):at(r,l))&&(He=fm(ee,"onBeforeInput"),0<He.length&&(Xe=new Uu("onBeforeInput","beforeinput",null,l,ce),fe.push({event:Xe,listeners:He}),Xe.data=Fe)),qC(fe,r,ee,l,ce)}CT(fe,a)})}function xd(r,a,l){return{instance:r,listener:a,currentTarget:l}}function fm(r,a){for(var l=a+"Capture",d=[];r!==null;){var g=r,y=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||y===null||(g=Io(r,l),g!=null&&d.unshift(xd(r,g,y)),g=Io(r,a),g!=null&&d.push(xd(r,g,y))),r.tag===3)return d;r=r.return}return[]}function pc(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function kT(r,a,l,d,g){for(var y=a._reactName,T=[];l!==null&&l!==d;){var R=l,H=R.alternate,ee=R.stateNode;if(R=R.tag,H!==null&&H===d)break;R!==5&&R!==26&&R!==27||ee===null||(H=ee,g?(ee=Io(l,y),ee!=null&&T.unshift(xd(l,ee,H))):g||(ee=Io(l,y),ee!=null&&T.push(xd(l,ee,H)))),l=l.return}T.length!==0&&r.push({event:a,listeners:T})}var KC=/\r\n?/g,QC=/\u0000|\uFFFD/g;function jT(r){return(typeof r=="string"?r:""+r).replace(KC,`
`).replace(QC,"")}function PT(r,a){return a=jT(a),jT(r)===a}function mm(){}function Nt(r,a,l,d,g,y){switch(l){case"children":typeof d=="string"?a==="body"||a==="textarea"&&d===""||Rn(r,d):(typeof d=="number"||typeof d=="bigint")&&a!=="body"&&Rn(r,""+d);break;case"className":yr(r,"class",d);break;case"tabIndex":yr(r,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":yr(r,l,d);break;case"style":xr(r,d,y);break;case"data":if(a!=="object"){yr(r,"data",d);break}case"src":case"href":if(d===""&&(a!=="a"||l!=="href")){r.removeAttribute(l);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(l);break}d=Ml(""+d),r.setAttribute(l,d);break;case"action":case"formAction":if(typeof d=="function"){r.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(l==="formAction"?(a!=="input"&&Nt(r,a,"name",g.name,g,null),Nt(r,a,"formEncType",g.formEncType,g,null),Nt(r,a,"formMethod",g.formMethod,g,null),Nt(r,a,"formTarget",g.formTarget,g,null)):(Nt(r,a,"encType",g.encType,g,null),Nt(r,a,"method",g.method,g,null),Nt(r,a,"target",g.target,g,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(l);break}d=Ml(""+d),r.setAttribute(l,d);break;case"onClick":d!=null&&(r.onclick=mm);break;case"onScroll":d!=null&&et("scroll",r);break;case"onScrollEnd":d!=null&&et("scrollend",r);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(s(61));if(l=d.__html,l!=null){if(g.children!=null)throw Error(s(60));r.innerHTML=l}}break;case"multiple":r.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":r.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){r.removeAttribute("xlink:href");break}l=Ml(""+d),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(l,""+d):r.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(l,""):r.removeAttribute(l);break;case"capture":case"download":d===!0?r.setAttribute(l,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(l,d):r.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?r.setAttribute(l,d):r.removeAttribute(l);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?r.removeAttribute(l):r.setAttribute(l,d);break;case"popover":et("beforetoggle",r),et("toggle",r),gi(r,"popover",d);break;case"xlinkActuate":An(r,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":An(r,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":An(r,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":An(r,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":An(r,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":An(r,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":An(r,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":An(r,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":An(r,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":gi(r,"is",d);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Ng.get(l)||l,gi(r,l,d))}}function r0(r,a,l,d,g,y){switch(l){case"style":xr(r,d,y);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(s(61));if(l=d.__html,l!=null){if(g.children!=null)throw Error(s(60));r.innerHTML=l}}break;case"children":typeof d=="string"?Rn(r,d):(typeof d=="number"||typeof d=="bigint")&&Rn(r,""+d);break;case"onScroll":d!=null&&et("scroll",r);break;case"onScrollEnd":d!=null&&et("scrollend",r);break;case"onClick":d!=null&&(r.onclick=mm);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Eo.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(g=l.endsWith("Capture"),a=l.slice(2,g?l.length-7:void 0),y=r[on]||null,y=y!=null?y[l]:null,typeof y=="function"&&r.removeEventListener(a,y,g),typeof d=="function")){typeof y!="function"&&y!==null&&(l in r?r[l]=null:r.hasAttribute(l)&&r.removeAttribute(l)),r.addEventListener(a,d,g);break e}l in r?r[l]=d:d===!0?r.setAttribute(l,""):gi(r,l,d)}}}function Bn(r,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":et("error",r),et("load",r);var d=!1,g=!1,y;for(y in l)if(l.hasOwnProperty(y)){var T=l[y];if(T!=null)switch(y){case"src":d=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,a));default:Nt(r,a,y,T,l,null)}}g&&Nt(r,a,"srcSet",l.srcSet,l,null),d&&Nt(r,a,"src",l.src,l,null);return;case"input":et("invalid",r);var R=y=T=g=null,H=null,ee=null;for(d in l)if(l.hasOwnProperty(d)){var ce=l[d];if(ce!=null)switch(d){case"name":g=ce;break;case"type":T=ce;break;case"checked":H=ce;break;case"defaultChecked":ee=ce;break;case"value":y=ce;break;case"defaultValue":R=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(s(137,a));break;default:Nt(r,a,d,ce,l,null)}}Dt(r,y,R,H,ee,T,g,!1),Le(r);return;case"select":et("invalid",r),d=T=y=null;for(g in l)if(l.hasOwnProperty(g)&&(R=l[g],R!=null))switch(g){case"value":y=R;break;case"defaultValue":T=R;break;case"multiple":d=R;default:Nt(r,a,g,R,l,null)}a=y,l=T,r.multiple=!!d,a!=null?Ye(r,!!d,a,!1):l!=null&&Ye(r,!!d,l,!0);return;case"textarea":et("invalid",r),y=g=d=null;for(T in l)if(l.hasOwnProperty(T)&&(R=l[T],R!=null))switch(T){case"value":d=R;break;case"defaultValue":g=R;break;case"children":y=R;break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(s(91));break;default:Nt(r,a,T,R,l,null)}Hs(r,d,g,y),Le(r);return;case"option":for(H in l)if(l.hasOwnProperty(H)&&(d=l[H],d!=null))switch(H){case"selected":r.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:Nt(r,a,H,d,l,null)}return;case"dialog":et("beforetoggle",r),et("toggle",r),et("cancel",r),et("close",r);break;case"iframe":case"object":et("load",r);break;case"video":case"audio":for(d=0;d<yd.length;d++)et(yd[d],r);break;case"image":et("error",r),et("load",r);break;case"details":et("toggle",r);break;case"embed":case"source":case"link":et("error",r),et("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ee in l)if(l.hasOwnProperty(ee)&&(d=l[ee],d!=null))switch(ee){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,a));default:Nt(r,a,ee,d,l,null)}return;default:if(Pu(a)){for(ce in l)l.hasOwnProperty(ce)&&(d=l[ce],d!==void 0&&r0(r,a,ce,d,l,void 0));return}}for(R in l)l.hasOwnProperty(R)&&(d=l[R],d!=null&&Nt(r,a,R,d,l,null))}function WC(r,a,l,d){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,y=null,T=null,R=null,H=null,ee=null,ce=null;for(re in l){var fe=l[re];if(l.hasOwnProperty(re)&&fe!=null)switch(re){case"checked":break;case"value":break;case"defaultValue":H=fe;default:d.hasOwnProperty(re)||Nt(r,a,re,null,d,fe)}}for(var se in d){var re=d[se];if(fe=l[se],d.hasOwnProperty(se)&&(re!=null||fe!=null))switch(se){case"type":y=re;break;case"name":g=re;break;case"checked":ee=re;break;case"defaultChecked":ce=re;break;case"value":T=re;break;case"defaultValue":R=re;break;case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(s(137,a));break;default:re!==fe&&Nt(r,a,se,re,d,fe)}}Be(r,T,R,H,ee,ce,y,g);return;case"select":re=T=R=se=null;for(y in l)if(H=l[y],l.hasOwnProperty(y)&&H!=null)switch(y){case"value":break;case"multiple":re=H;default:d.hasOwnProperty(y)||Nt(r,a,y,null,d,H)}for(g in d)if(y=d[g],H=l[g],d.hasOwnProperty(g)&&(y!=null||H!=null))switch(g){case"value":se=y;break;case"defaultValue":R=y;break;case"multiple":T=y;default:y!==H&&Nt(r,a,g,y,d,H)}a=R,l=T,d=re,se!=null?Ye(r,!!l,se,!1):!!d!=!!l&&(a!=null?Ye(r,!!l,a,!0):Ye(r,!!l,l?[]:"",!1));return;case"textarea":re=se=null;for(R in l)if(g=l[R],l.hasOwnProperty(R)&&g!=null&&!d.hasOwnProperty(R))switch(R){case"value":break;case"children":break;default:Nt(r,a,R,null,d,g)}for(T in d)if(g=d[T],y=l[T],d.hasOwnProperty(T)&&(g!=null||y!=null))switch(T){case"value":se=g;break;case"defaultValue":re=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(s(91));break;default:g!==y&&Nt(r,a,T,g,d,y)}ze(r,se,re);return;case"option":for(var Ge in l)if(se=l[Ge],l.hasOwnProperty(Ge)&&se!=null&&!d.hasOwnProperty(Ge))switch(Ge){case"selected":r.selected=!1;break;default:Nt(r,a,Ge,null,d,se)}for(H in d)if(se=d[H],re=l[H],d.hasOwnProperty(H)&&se!==re&&(se!=null||re!=null))switch(H){case"selected":r.selected=se&&typeof se!="function"&&typeof se!="symbol";break;default:Nt(r,a,H,se,d,re)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var qe in l)se=l[qe],l.hasOwnProperty(qe)&&se!=null&&!d.hasOwnProperty(qe)&&Nt(r,a,qe,null,d,se);for(ee in d)if(se=d[ee],re=l[ee],d.hasOwnProperty(ee)&&se!==re&&(se!=null||re!=null))switch(ee){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(s(137,a));break;default:Nt(r,a,ee,se,d,re)}return;default:if(Pu(a)){for(var At in l)se=l[At],l.hasOwnProperty(At)&&se!==void 0&&!d.hasOwnProperty(At)&&r0(r,a,At,void 0,d,se);for(ce in d)se=d[ce],re=l[ce],!d.hasOwnProperty(ce)||se===re||se===void 0&&re===void 0||r0(r,a,ce,se,d,re);return}}for(var Q in l)se=l[Q],l.hasOwnProperty(Q)&&se!=null&&!d.hasOwnProperty(Q)&&Nt(r,a,Q,null,d,se);for(fe in d)se=d[fe],re=l[fe],!d.hasOwnProperty(fe)||se===re||se==null&&re==null||Nt(r,a,fe,se,d,re)}var i0=null,a0=null;function pm(r){return r.nodeType===9?r:r.ownerDocument}function OT(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function MT(r,a){if(r===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&a==="foreignObject"?0:r}function o0(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var l0=null;function YC(){var r=window.event;return r&&r.type==="popstate"?r===l0?!1:(l0=r,!0):(l0=null,!1)}var VT=typeof setTimeout=="function"?setTimeout:void 0,XC=typeof clearTimeout=="function"?clearTimeout:void 0,LT=typeof Promise=="function"?Promise:void 0,JC=typeof queueMicrotask=="function"?queueMicrotask:typeof LT<"u"?function(r){return LT.resolve(null).then(r).catch(ZC)}:VT;function ZC(r){setTimeout(function(){throw r})}function Ra(r){return r==="head"}function UT(r,a){var l=a,d=0,g=0;do{var y=l.nextSibling;if(r.removeChild(l),y&&y.nodeType===8)if(l=y.data,l==="/$"){if(0<d&&8>d){l=d;var T=r.ownerDocument;if(l&1&&vd(T.documentElement),l&2&&vd(T.body),l&4)for(l=T.head,vd(l),T=l.firstChild;T;){var R=T.nextSibling,H=T.nodeName;T[la]||H==="SCRIPT"||H==="STYLE"||H==="LINK"&&T.rel.toLowerCase()==="stylesheet"||l.removeChild(T),T=R}}if(g===0){r.removeChild(y),Nd(a);return}g--}else l==="$"||l==="$?"||l==="$!"?g++:d=l.charCodeAt(0)-48;else d=0;l=y}while(l);Nd(a)}function c0(r){var a=r.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":c0(l),pi(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}r.removeChild(l)}}function eD(r,a,l,d){for(;r.nodeType===1;){var g=l;if(r.nodeName.toLowerCase()!==a.toLowerCase()){if(!d&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(d){if(!r[la])switch(a){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==g.rel||r.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||r.getAttribute("title")!==(g.title==null?null:g.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(g.src==null?null:g.src)||r.getAttribute("type")!==(g.type==null?null:g.type)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(a==="input"&&r.type==="hidden"){var y=g.name==null?null:""+g.name;if(g.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=wr(r.nextSibling),r===null)break}return null}function tD(r,a,l){if(a==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=wr(r.nextSibling),r===null))return null;return r}function u0(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function nD(r,a){var l=r.ownerDocument;if(r.data!=="$?"||l.readyState==="complete")a();else{var d=function(){a(),l.removeEventListener("DOMContentLoaded",d)};l.addEventListener("DOMContentLoaded",d),r._reactRetry=d}}function wr(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return r}var d0=null;function FT(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"){if(a===0)return r;a--}else l==="/$"&&a++}r=r.previousSibling}return null}function BT(r,a,l){switch(a=pm(l),r){case"html":if(r=a.documentElement,!r)throw Error(s(452));return r;case"head":if(r=a.head,!r)throw Error(s(453));return r;case"body":if(r=a.body,!r)throw Error(s(454));return r;default:throw Error(s(451))}}function vd(r){for(var a=r.attributes;a.length;)r.removeAttributeNode(a[0]);pi(r)}var er=new Map,zT=new Set;function gm(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Oi=ge.d;ge.d={f:sD,r:rD,D:iD,C:aD,L:oD,m:lD,X:uD,S:cD,M:dD};function sD(){var r=Oi.f(),a=om();return r||a}function rD(r){var a=pr(r);a!==null&&a.tag===5&&a.type==="form"?lw(a):Oi.r(r)}var gc=typeof document>"u"?null:document;function qT(r,a,l){var d=gc;if(d&&typeof a=="string"&&a){var g=ft(a);g='link[rel="'+r+'"][href="'+g+'"]',typeof l=="string"&&(g+='[crossorigin="'+l+'"]'),zT.has(g)||(zT.add(g),r={rel:r,crossOrigin:l,href:a},d.querySelector(g)===null&&(a=d.createElement("link"),Bn(a,"link",r),Xt(a),d.head.appendChild(a)))}}function iD(r){Oi.D(r),qT("dns-prefetch",r,null)}function aD(r,a){Oi.C(r,a),qT("preconnect",r,a)}function oD(r,a,l){Oi.L(r,a,l);var d=gc;if(d&&r&&a){var g='link[rel="preload"][as="'+ft(a)+'"]';a==="image"&&l&&l.imageSrcSet?(g+='[imagesrcset="'+ft(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(g+='[imagesizes="'+ft(l.imageSizes)+'"]')):g+='[href="'+ft(r)+'"]';var y=g;switch(a){case"style":y=yc(r);break;case"script":y=xc(r)}er.has(y)||(r=x({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:r,as:a},l),er.set(y,r),d.querySelector(g)!==null||a==="style"&&d.querySelector(_d(y))||a==="script"&&d.querySelector(bd(y))||(a=d.createElement("link"),Bn(a,"link",r),Xt(a),d.head.appendChild(a)))}}function lD(r,a){Oi.m(r,a);var l=gc;if(l&&r){var d=a&&typeof a.as=="string"?a.as:"script",g='link[rel="modulepreload"][as="'+ft(d)+'"][href="'+ft(r)+'"]',y=g;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=xc(r)}if(!er.has(y)&&(r=x({rel:"modulepreload",href:r},a),er.set(y,r),l.querySelector(g)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(bd(y)))return}d=l.createElement("link"),Bn(d,"link",r),Xt(d),l.head.appendChild(d)}}}function cD(r,a,l){Oi.S(r,a,l);var d=gc;if(d&&r){var g=Kn(d).hoistableStyles,y=yc(r);a=a||"default";var T=g.get(y);if(!T){var R={loading:0,preload:null};if(T=d.querySelector(_d(y)))R.loading=5;else{r=x({rel:"stylesheet",href:r,"data-precedence":a},l),(l=er.get(y))&&h0(r,l);var H=T=d.createElement("link");Xt(H),Bn(H,"link",r),H._p=new Promise(function(ee,ce){H.onload=ee,H.onerror=ce}),H.addEventListener("load",function(){R.loading|=1}),H.addEventListener("error",function(){R.loading|=2}),R.loading|=4,ym(T,a,d)}T={type:"stylesheet",instance:T,count:1,state:R},g.set(y,T)}}}function uD(r,a){Oi.X(r,a);var l=gc;if(l&&r){var d=Kn(l).hoistableScripts,g=xc(r),y=d.get(g);y||(y=l.querySelector(bd(g)),y||(r=x({src:r,async:!0},a),(a=er.get(g))&&f0(r,a),y=l.createElement("script"),Xt(y),Bn(y,"link",r),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(g,y))}}function dD(r,a){Oi.M(r,a);var l=gc;if(l&&r){var d=Kn(l).hoistableScripts,g=xc(r),y=d.get(g);y||(y=l.querySelector(bd(g)),y||(r=x({src:r,async:!0,type:"module"},a),(a=er.get(g))&&f0(r,a),y=l.createElement("script"),Xt(y),Bn(y,"link",r),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(g,y))}}function HT(r,a,l,d){var g=(g=Pe.current)?gm(g):null;if(!g)throw Error(s(446));switch(r){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=yc(l.href),l=Kn(g).hoistableStyles,d=l.get(a),d||(d={type:"style",instance:null,count:0,state:null},l.set(a,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){r=yc(l.href);var y=Kn(g).hoistableStyles,T=y.get(r);if(T||(g=g.ownerDocument||g,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,T),(y=g.querySelector(_d(r)))&&!y._p&&(T.instance=y,T.state.loading=5),er.has(r)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},er.set(r,l),y||hD(g,r,l,T.state))),a&&d===null)throw Error(s(528,""));return T}if(a&&d!==null)throw Error(s(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=xc(l),l=Kn(g).hoistableScripts,d=l.get(a),d||(d={type:"script",instance:null,count:0,state:null},l.set(a,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,r))}}function yc(r){return'href="'+ft(r)+'"'}function _d(r){return'link[rel="stylesheet"]['+r+"]"}function GT(r){return x({},r,{"data-precedence":r.precedence,precedence:null})}function hD(r,a,l,d){r.querySelector('link[rel="preload"][as="style"]['+a+"]")?d.loading=1:(a=r.createElement("link"),d.preload=a,a.addEventListener("load",function(){return d.loading|=1}),a.addEventListener("error",function(){return d.loading|=2}),Bn(a,"link",l),Xt(a),r.head.appendChild(a))}function xc(r){return'[src="'+ft(r)+'"]'}function bd(r){return"script[async]"+r}function $T(r,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var d=r.querySelector('style[data-href~="'+ft(l.href)+'"]');if(d)return a.instance=d,Xt(d),d;var g=x({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return d=(r.ownerDocument||r).createElement("style"),Xt(d),Bn(d,"style",g),ym(d,l.precedence,r),a.instance=d;case"stylesheet":g=yc(l.href);var y=r.querySelector(_d(g));if(y)return a.state.loading|=4,a.instance=y,Xt(y),y;d=GT(l),(g=er.get(g))&&h0(d,g),y=(r.ownerDocument||r).createElement("link"),Xt(y);var T=y;return T._p=new Promise(function(R,H){T.onload=R,T.onerror=H}),Bn(y,"link",d),a.state.loading|=4,ym(y,l.precedence,r),a.instance=y;case"script":return y=xc(l.src),(g=r.querySelector(bd(y)))?(a.instance=g,Xt(g),g):(d=l,(g=er.get(y))&&(d=x({},l),f0(d,g)),r=r.ownerDocument||r,g=r.createElement("script"),Xt(g),Bn(g,"link",d),r.head.appendChild(g),a.instance=g);case"void":return null;default:throw Error(s(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(d=a.instance,a.state.loading|=4,ym(d,l.precedence,r));return a.instance}function ym(r,a,l){for(var d=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=d.length?d[d.length-1]:null,y=g,T=0;T<d.length;T++){var R=d[T];if(R.dataset.precedence===a)y=R;else if(y!==g)break}y?y.parentNode.insertBefore(r,y.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(r,a.firstChild))}function h0(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.title==null&&(r.title=a.title)}function f0(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.integrity==null&&(r.integrity=a.integrity)}var xm=null;function KT(r,a,l){if(xm===null){var d=new Map,g=xm=new Map;g.set(l,d)}else g=xm,d=g.get(l),d||(d=new Map,g.set(l,d));if(d.has(r))return d;for(d.set(r,null),l=l.getElementsByTagName(r),g=0;g<l.length;g++){var y=l[g];if(!(y[la]||y[mn]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var T=y.getAttribute(a)||"";T=r+T;var R=d.get(T);R?R.push(y):d.set(T,[y])}}return d}function QT(r,a,l){r=r.ownerDocument||r,r.head.insertBefore(l,a==="title"?r.querySelector("head > title"):null)}function fD(r,a,l){if(l===1||a.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return r=a.disabled,typeof a.precedence=="string"&&r==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function WT(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var wd=null;function mD(){}function pD(r,a,l){if(wd===null)throw Error(s(475));var d=wd;if(a.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var g=yc(l.href),y=r.querySelector(_d(g));if(y){r=y._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(d.count++,d=vm.bind(d),r.then(d,d)),a.state.loading|=4,a.instance=y,Xt(y);return}y=r.ownerDocument||r,l=GT(l),(g=er.get(g))&&h0(l,g),y=y.createElement("link"),Xt(y);var T=y;T._p=new Promise(function(R,H){T.onload=R,T.onerror=H}),Bn(y,"link",l),a.instance=y}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(a,r),(r=a.state.preload)&&(a.state.loading&3)===0&&(d.count++,a=vm.bind(d),r.addEventListener("load",a),r.addEventListener("error",a))}}function gD(){if(wd===null)throw Error(s(475));var r=wd;return r.stylesheets&&r.count===0&&m0(r,r.stylesheets),0<r.count?function(a){var l=setTimeout(function(){if(r.stylesheets&&m0(r,r.stylesheets),r.unsuspend){var d=r.unsuspend;r.unsuspend=null,d()}},6e4);return r.unsuspend=a,function(){r.unsuspend=null,clearTimeout(l)}}:null}function vm(){if(this.count--,this.count===0){if(this.stylesheets)m0(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var _m=null;function m0(r,a){r.stylesheets=null,r.unsuspend!==null&&(r.count++,_m=new Map,a.forEach(yD,r),_m=null,vm.call(r))}function yD(r,a){if(!(a.state.loading&4)){var l=_m.get(r);if(l)var d=l.get(null);else{l=new Map,_m.set(r,l);for(var g=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<g.length;y++){var T=g[y];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(l.set(T.dataset.precedence,T),d=T)}d&&l.set(null,d)}g=a.instance,T=g.getAttribute("data-precedence"),y=l.get(T)||d,y===d&&l.set(null,g),l.set(T,g),this.count++,d=vm.bind(this),g.addEventListener("load",d),g.addEventListener("error",d),y?y.parentNode.insertBefore(g,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(g,r.firstChild)),a.state.loading|=4}}var Td={$$typeof:P,Provider:null,Consumer:null,_currentValue:le,_currentValue2:le,_threadCount:0};function xD(r,a,l,d,g,y,T,R){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=hr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hr(0),this.hiddenUpdates=hr(null),this.identifierPrefix=d,this.onUncaughtError=g,this.onCaughtError=y,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=R,this.incompleteTransitions=new Map}function YT(r,a,l,d,g,y,T,R,H,ee,ce,fe){return r=new xD(r,a,l,T,R,H,ee,fe),a=1,y===!0&&(a|=24),y=Rs(3,null,null,a),r.current=y,y.stateNode=r,a=Wg(),a.refCount++,r.pooledCache=a,a.refCount++,y.memoizedState={element:d,isDehydrated:l,cache:a},Zg(y),r}function XT(r){return r?(r=Wl,r):Wl}function JT(r,a,l,d,g,y){g=XT(g),d.context===null?d.context=g:d.pendingContext=g,d=ga(a),d.payload={element:l},y=y===void 0?null:y,y!==null&&(d.callback=y),l=ya(r,d,a),l!==null&&(Ps(l,r,a),Zu(l,r,a))}function ZT(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<a?l:a}}function p0(r,a){ZT(r,a),(r=r.alternate)&&ZT(r,a)}function eE(r){if(r.tag===13){var a=Ql(r,67108864);a!==null&&Ps(a,r,67108864),p0(r,67108864)}}var bm=!0;function vD(r,a,l,d){var g=J.T;J.T=null;var y=ge.p;try{ge.p=2,g0(r,a,l,d)}finally{ge.p=y,J.T=g}}function _D(r,a,l,d){var g=J.T;J.T=null;var y=ge.p;try{ge.p=8,g0(r,a,l,d)}finally{ge.p=y,J.T=g}}function g0(r,a,l,d){if(bm){var g=y0(d);if(g===null)s0(r,a,d,wm,l),nE(r,d);else if(wD(g,r,a,l,d))d.stopPropagation();else if(nE(r,d),a&4&&-1<bD.indexOf(r)){for(;g!==null;){var y=pr(g);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var T=Ss(y.pendingLanes);if(T!==0){var R=y;for(R.pendingLanes|=2,R.entangledLanes|=2;T;){var H=1<<31-Nn(T);R.entanglements[1]|=H,T&=~H}Wr(y),(bt&6)===0&&(im=Yt()+500,gd(0))}}break;case 13:R=Ql(y,2),R!==null&&Ps(R,y,2),om(),p0(y,2)}if(y=y0(d),y===null&&s0(r,a,d,wm,l),y===g)break;g=y}g!==null&&d.stopPropagation()}else s0(r,a,d,null,l)}}function y0(r){return r=Gs(r),x0(r)}var wm=null;function x0(r){if(wm=null,r=Pr(r),r!==null){var a=o(r);if(a===null)r=null;else{var l=a.tag;if(l===13){if(r=u(a),r!==null)return r;r=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null)}}return wm=r,null}function tE(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(It()){case dt:return 2;case rn:return 8;case cr:case yo:return 32;case ur:return 268435456;default:return 32}default:return 32}}var v0=!1,Ca=null,Da=null,ka=null,Ed=new Map,Id=new Map,ja=[],bD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function nE(r,a){switch(r){case"focusin":case"focusout":Ca=null;break;case"dragenter":case"dragleave":Da=null;break;case"mouseover":case"mouseout":ka=null;break;case"pointerover":case"pointerout":Ed.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Id.delete(a.pointerId)}}function Sd(r,a,l,d,g,y){return r===null||r.nativeEvent!==y?(r={blockedOn:a,domEventName:l,eventSystemFlags:d,nativeEvent:y,targetContainers:[g]},a!==null&&(a=pr(a),a!==null&&eE(a)),r):(r.eventSystemFlags|=d,a=r.targetContainers,g!==null&&a.indexOf(g)===-1&&a.push(g),r)}function wD(r,a,l,d,g){switch(a){case"focusin":return Ca=Sd(Ca,r,a,l,d,g),!0;case"dragenter":return Da=Sd(Da,r,a,l,d,g),!0;case"mouseover":return ka=Sd(ka,r,a,l,d,g),!0;case"pointerover":var y=g.pointerId;return Ed.set(y,Sd(Ed.get(y)||null,r,a,l,d,g)),!0;case"gotpointercapture":return y=g.pointerId,Id.set(y,Sd(Id.get(y)||null,r,a,l,d,g)),!0}return!1}function sE(r){var a=Pr(r.target);if(a!==null){var l=o(a);if(l!==null){if(a=l.tag,a===13){if(a=u(l),a!==null){r.blockedOn=a,Au(r.priority,function(){if(l.tag===13){var d=js();d=jr(d);var g=Ql(l,d);g!==null&&Ps(g,l,d),p0(l,d)}});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Tm(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var l=y0(r.nativeEvent);if(l===null){l=r.nativeEvent;var d=new l.constructor(l.type,l);yi=d,l.target.dispatchEvent(d),yi=null}else return a=pr(l),a!==null&&eE(a),r.blockedOn=l,!1;a.shift()}return!0}function rE(r,a,l){Tm(r)&&l.delete(a)}function TD(){v0=!1,Ca!==null&&Tm(Ca)&&(Ca=null),Da!==null&&Tm(Da)&&(Da=null),ka!==null&&Tm(ka)&&(ka=null),Ed.forEach(rE),Id.forEach(rE)}function Em(r,a){r.blockedOn===a&&(r.blockedOn=null,v0||(v0=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,TD)))}var Im=null;function iE(r){Im!==r&&(Im=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Im===r&&(Im=null);for(var a=0;a<r.length;a+=3){var l=r[a],d=r[a+1],g=r[a+2];if(typeof d!="function"){if(x0(d||l)===null)continue;break}var y=pr(l);y!==null&&(r.splice(a,3),a-=3,xy(y,{pending:!0,data:g,method:l.method,action:d},d,g))}}))}function Nd(r){function a(H){return Em(H,r)}Ca!==null&&Em(Ca,r),Da!==null&&Em(Da,r),ka!==null&&Em(ka,r),Ed.forEach(a),Id.forEach(a);for(var l=0;l<ja.length;l++){var d=ja[l];d.blockedOn===r&&(d.blockedOn=null)}for(;0<ja.length&&(l=ja[0],l.blockedOn===null);)sE(l),l.blockedOn===null&&ja.shift();if(l=(r.ownerDocument||r).$$reactFormReplay,l!=null)for(d=0;d<l.length;d+=3){var g=l[d],y=l[d+1],T=g[on]||null;if(typeof y=="function")T||iE(l);else if(T){var R=null;if(y&&y.hasAttribute("formAction")){if(g=y,T=y[on]||null)R=T.formAction;else if(x0(g)!==null)continue}else R=T.action;typeof R=="function"?l[d+1]=R:(l.splice(d,3),d-=3),iE(l)}}}function _0(r){this._internalRoot=r}Sm.prototype.render=_0.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(s(409));var l=a.current,d=js();JT(l,d,r,a,null,null)},Sm.prototype.unmount=_0.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;JT(r.current,2,null,r,null,null),om(),a[Ns]=null}};function Sm(r){this._internalRoot=r}Sm.prototype.unstable_scheduleHydration=function(r){if(r){var a=mr();r={blockedOn:null,target:r,priority:a};for(var l=0;l<ja.length&&a!==0&&a<ja[l].priority;l++);ja.splice(l,0,r),l===0&&sE(r)}};var aE=e.version;if(aE!=="19.1.0")throw Error(s(527,aE,"19.1.0"));ge.findDOMNode=function(r){var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(s(188)):(r=Object.keys(r).join(","),Error(s(268,r)));return r=f(a),r=r!==null?p(r):null,r=r===null?null:r.stateNode,r};var ED={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nm.isDisabled&&Nm.supportsFiber)try{Ft=Nm.inject(ED),ht=Nm}catch{}}return Rd.createRoot=function(r,a){if(!i(r))throw Error(s(299));var l=!1,d="",g=ww,y=Tw,T=Ew,R=null;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onUncaughtError!==void 0&&(g=a.onUncaughtError),a.onCaughtError!==void 0&&(y=a.onCaughtError),a.onRecoverableError!==void 0&&(T=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(R=a.unstable_transitionCallbacks)),a=YT(r,1,!1,null,null,l,d,g,y,T,R,null),r[Ns]=a.current,n0(r),new _0(a)},Rd.hydrateRoot=function(r,a,l){if(!i(r))throw Error(s(299));var d=!1,g="",y=ww,T=Tw,R=Ew,H=null,ee=null;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(y=l.onUncaughtError),l.onCaughtError!==void 0&&(T=l.onCaughtError),l.onRecoverableError!==void 0&&(R=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(H=l.unstable_transitionCallbacks),l.formState!==void 0&&(ee=l.formState)),a=YT(r,1,!0,a,l??null,d,g,y,T,R,H,ee),a.context=XT(null),l=a.current,d=js(),d=jr(d),g=ga(d),g.callback=null,ya(l,g,d),l=d,a.current.lanes=l,fr(a,l),Wr(a),r[Ns]=a.current,n0(r),new Sm(a)},Rd.version="19.1.0",Rd}var gE;function PD(){if(gE)return T0.exports;gE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),T0.exports=jD(),T0.exports}var OD=PD();const MD=$S(OD);/**
 * react-router v7.7.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var yE="popstate";function VD(n={}){function e(i,o){let{pathname:u="/",search:h="",hash:f=""}=Il(i.location.hash.substring(1));return!u.startsWith("/")&&!u.startsWith(".")&&(u="/"+u),ex("",{pathname:u,search:h,hash:f},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function t(i,o){let u=i.document.querySelector("base"),h="";if(u&&u.getAttribute("href")){let f=i.location.href,p=f.indexOf("#");h=p===-1?f:f.slice(0,p)}return h+"#"+(typeof o=="string"?o:fh(o))}function s(i,o){rr(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(o)})`)}return UD(e,t,s,n)}function Gt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function rr(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function LD(){return Math.random().toString(36).substring(2,10)}function xE(n,e){return{usr:n.state,key:n.key,idx:e}}function ex(n,e,t=null,s){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Il(e):e,state:t,key:e&&e.key||s||LD()}}function fh({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Il(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substring(s),n=n.substring(0,s)),n&&(e.pathname=n)}return e}function UD(n,e,t,s={}){let{window:i=document.defaultView,v5Compat:o=!1}=s,u=i.history,h="POP",f=null,p=x();p==null&&(p=0,u.replaceState({...u.state,idx:p},""));function x(){return(u.state||{idx:null}).idx}function v(){h="POP";let A=x(),C=A==null?null:A-p;p=A,f&&f({action:h,location:E.location,delta:C})}function b(A,C){h="PUSH";let q=ex(E.location,A,C);t&&t(q,A),p=x()+1;let P=xE(q,p),V=E.createHref(q);try{u.pushState(P,"",V)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;i.location.assign(V)}o&&f&&f({action:h,location:E.location,delta:1})}function I(A,C){h="REPLACE";let q=ex(E.location,A,C);t&&t(q,A),p=x();let P=xE(q,p),V=E.createHref(q);u.replaceState(P,"",V),o&&f&&f({action:h,location:E.location,delta:0})}function N(A){return FD(A)}let E={get action(){return h},get location(){return n(i,u)},listen(A){if(f)throw new Error("A history only accepts one active listener");return i.addEventListener(yE,v),f=A,()=>{i.removeEventListener(yE,v),f=null}},createHref(A){return e(i,A)},createURL:N,encodeLocation(A){let C=N(A);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:b,replace:I,go(A){return u.go(A)}};return E}function FD(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Gt(t,"No window.location.(origin|href) available to create URL");let s=typeof n=="string"?n:fh(n);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=t+s),new URL(s,t)}function KS(n,e,t="/"){return BD(n,e,t,!1)}function BD(n,e,t,s){let i=typeof e=="string"?Il(e):e,o=zi(i.pathname||"/",t);if(o==null)return null;let u=QS(n);zD(u);let h=null;for(let f=0;h==null&&f<u.length;++f){let p=ZD(o);h=XD(u[f],p,s)}return h}function QS(n,e=[],t=[],s=""){let i=(o,u,h)=>{let f={relativePath:h===void 0?o.path||"":h,caseSensitive:o.caseSensitive===!0,childrenIndex:u,route:o};f.relativePath.startsWith("/")&&(Gt(f.relativePath.startsWith(s),`Absolute route path "${f.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(s.length));let p=Ui([s,f.relativePath]),x=t.concat(f);o.children&&o.children.length>0&&(Gt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),QS(o.children,e,x,p)),!(o.path==null&&!o.index)&&e.push({path:p,score:WD(p,o.index),routesMeta:x})};return n.forEach((o,u)=>{if(o.path===""||!o.path?.includes("?"))i(o,u);else for(let h of WS(o.path))i(o,u,h)}),e}function WS(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,i=t.endsWith("?"),o=t.replace(/\?$/,"");if(s.length===0)return i?[o,""]:[o];let u=WS(s.join("/")),h=[];return h.push(...u.map(f=>f===""?o:[o,f].join("/"))),i&&h.push(...u),h.map(f=>n.startsWith("/")&&f===""?"/":f)}function zD(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:YD(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}var qD=/^:[\w-]+$/,HD=3,GD=2,$D=1,KD=10,QD=-2,vE=n=>n==="*";function WD(n,e){let t=n.split("/"),s=t.length;return t.some(vE)&&(s+=QD),e&&(s+=GD),t.filter(i=>!vE(i)).reduce((i,o)=>i+(qD.test(o)?HD:o===""?$D:KD),s)}function YD(n,e){return n.length===e.length&&n.slice(0,-1).every((s,i)=>s===e[i])?n[n.length-1]-e[e.length-1]:0}function XD(n,e,t=!1){let{routesMeta:s}=n,i={},o="/",u=[];for(let h=0;h<s.length;++h){let f=s[h],p=h===s.length-1,x=o==="/"?e:e.slice(o.length)||"/",v=rp({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},x),b=f.route;if(!v&&p&&t&&!s[s.length-1].route.index&&(v=rp({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},x)),!v)return null;Object.assign(i,v.params),u.push({params:i,pathname:Ui([o,v.pathname]),pathnameBase:sk(Ui([o,v.pathnameBase])),route:b}),v.pathnameBase!=="/"&&(o=Ui([o,v.pathnameBase]))}return u}function rp(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=JD(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let o=i[0],u=o.replace(/(.)\/+$/,"$1"),h=i.slice(1);return{params:s.reduce((p,{paramName:x,isOptional:v},b)=>{if(x==="*"){let N=h[b]||"";u=o.slice(0,o.length-N.length).replace(/(.)\/+$/,"$1")}const I=h[b];return v&&!I?p[x]=void 0:p[x]=(I||"").replace(/%2F/g,"/"),p},{}),pathname:o,pathnameBase:u,pattern:n}}function JD(n,e=!1,t=!0){rr(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let s=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,h,f)=>(s.push({paramName:h,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),s]}function ZD(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return rr(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function zi(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}function ek(n,e="/"){let{pathname:t,search:s="",hash:i=""}=typeof n=="string"?Il(n):n;return{pathname:t?t.startsWith("/")?t:tk(t,e):e,search:rk(s),hash:ik(i)}}function tk(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function N0(n,e,t,s){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function nk(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function $x(n){let e=nk(n);return e.map((t,s)=>s===e.length-1?t.pathname:t.pathnameBase)}function Kx(n,e,t,s=!1){let i;typeof n=="string"?i=Il(n):(i={...n},Gt(!i.pathname||!i.pathname.includes("?"),N0("?","pathname","search",i)),Gt(!i.pathname||!i.pathname.includes("#"),N0("#","pathname","hash",i)),Gt(!i.search||!i.search.includes("#"),N0("#","search","hash",i)));let o=n===""||i.pathname==="",u=o?"/":i.pathname,h;if(u==null)h=t;else{let v=e.length-1;if(!s&&u.startsWith("..")){let b=u.split("/");for(;b[0]==="..";)b.shift(),v-=1;i.pathname=b.join("/")}h=v>=0?e[v]:"/"}let f=ek(i,h),p=u&&u!=="/"&&u.endsWith("/"),x=(o||u===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(p||x)&&(f.pathname+="/"),f}var Ui=n=>n.join("/").replace(/\/\/+/g,"/"),sk=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),rk=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,ik=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function ak(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var YS=["POST","PUT","PATCH","DELETE"];new Set(YS);var ok=["GET",...YS];new Set(ok);var hu=S.createContext(null);hu.displayName="DataRouter";var jp=S.createContext(null);jp.displayName="DataRouterState";S.createContext(!1);var XS=S.createContext({isTransitioning:!1});XS.displayName="ViewTransition";var lk=S.createContext(new Map);lk.displayName="Fetchers";var ck=S.createContext(null);ck.displayName="Await";var Cr=S.createContext(null);Cr.displayName="Navigation";var Lh=S.createContext(null);Lh.displayName="Location";var or=S.createContext({outlet:null,matches:[],isDataRoute:!1});or.displayName="Route";var Qx=S.createContext(null);Qx.displayName="RouteError";function uk(n,{relative:e}={}){Gt(fu(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:s}=S.useContext(Cr),{hash:i,pathname:o,search:u}=Uh(n,{relative:e}),h=o;return t!=="/"&&(h=o==="/"?t:Ui([t,o])),s.createHref({pathname:h,search:u,hash:i})}function fu(){return S.useContext(Lh)!=null}function Yi(){return Gt(fu(),"useLocation() may be used only in the context of a <Router> component."),S.useContext(Lh).location}var JS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ZS(n){S.useContext(Cr).static||S.useLayoutEffect(n)}function Xi(){let{isDataRoute:n}=S.useContext(or);return n?Sk():dk()}function dk(){Gt(fu(),"useNavigate() may be used only in the context of a <Router> component.");let n=S.useContext(hu),{basename:e,navigator:t}=S.useContext(Cr),{matches:s}=S.useContext(or),{pathname:i}=Yi(),o=JSON.stringify($x(s)),u=S.useRef(!1);return ZS(()=>{u.current=!0}),S.useCallback((f,p={})=>{if(rr(u.current,JS),!u.current)return;if(typeof f=="number"){t.go(f);return}let x=Kx(f,JSON.parse(o),i,p.relative==="path");n==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:Ui([e,x.pathname])),(p.replace?t.replace:t.push)(x,p.state,p)},[e,t,o,i,n])}var hk=S.createContext(null);function fk(n){let e=S.useContext(or).outlet;return e&&S.createElement(hk.Provider,{value:n},e)}function mk(){let{matches:n}=S.useContext(or),e=n[n.length-1];return e?e.params:{}}function Uh(n,{relative:e}={}){let{matches:t}=S.useContext(or),{pathname:s}=Yi(),i=JSON.stringify($x(t));return S.useMemo(()=>Kx(n,JSON.parse(i),s,e==="path"),[n,i,s,e])}function pk(n,e){return eN(n,e)}function eN(n,e,t,s){Gt(fu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=S.useContext(Cr),{matches:o}=S.useContext(or),u=o[o.length-1],h=u?u.params:{},f=u?u.pathname:"/",p=u?u.pathnameBase:"/",x=u&&u.route;{let C=x&&x.path||"";tN(f,!x||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let v=Yi(),b;if(e){let C=typeof e=="string"?Il(e):e;Gt(p==="/"||C.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${C.pathname}" was given in the \`location\` prop.`),b=C}else b=v;let I=b.pathname||"/",N=I;if(p!=="/"){let C=p.replace(/^\//,"").split("/");N="/"+I.replace(/^\//,"").split("/").slice(C.length).join("/")}let E=KS(n,{pathname:N});rr(x||E!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),rr(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let A=_k(E&&E.map(C=>Object.assign({},C,{params:Object.assign({},h,C.params),pathname:Ui([p,i.encodeLocation?i.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?p:Ui([p,i.encodeLocation?i.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),o,t,s);return e&&A?S.createElement(Lh.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},A):A}function gk(){let n=Ik(),e=ak(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:s},o={padding:"2px 4px",backgroundColor:s},u=null;return console.error("Error handled by React Router default ErrorBoundary:",n),u=S.createElement(S.Fragment,null,S.createElement("p",null," Hey developer "),S.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",S.createElement("code",{style:o},"ErrorBoundary")," or"," ",S.createElement("code",{style:o},"errorElement")," prop on your route.")),S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},e),t?S.createElement("pre",{style:i},t):null,u)}var yk=S.createElement(gk,null),xk=class extends S.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?S.createElement(or.Provider,{value:this.props.routeContext},S.createElement(Qx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function vk({routeContext:n,match:e,children:t}){let s=S.useContext(hu);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),S.createElement(or.Provider,{value:n},t)}function _k(n,e=[],t=null,s=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let i=n,o=t?.errors;if(o!=null){let f=i.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);Gt(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,f+1))}let u=!1,h=-1;if(t)for(let f=0;f<i.length;f++){let p=i[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(h=f),p.route.id){let{loaderData:x,errors:v}=t,b=p.route.loader&&!x.hasOwnProperty(p.route.id)&&(!v||v[p.route.id]===void 0);if(p.route.lazy||b){u=!0,h>=0?i=i.slice(0,h+1):i=[i[0]];break}}}return i.reduceRight((f,p,x)=>{let v,b=!1,I=null,N=null;t&&(v=o&&p.route.id?o[p.route.id]:void 0,I=p.route.errorElement||yk,u&&(h<0&&x===0?(tN("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,N=null):h===x&&(b=!0,N=p.route.hydrateFallbackElement||null)));let E=e.concat(i.slice(0,x+1)),A=()=>{let C;return v?C=I:b?C=N:p.route.Component?C=S.createElement(p.route.Component,null):p.route.element?C=p.route.element:C=f,S.createElement(vk,{match:p,routeContext:{outlet:f,matches:E,isDataRoute:t!=null},children:C})};return t&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?S.createElement(xk,{location:t.location,revalidation:t.revalidation,component:I,error:v,children:A(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):A()},null)}function Wx(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function bk(n){let e=S.useContext(hu);return Gt(e,Wx(n)),e}function wk(n){let e=S.useContext(jp);return Gt(e,Wx(n)),e}function Tk(n){let e=S.useContext(or);return Gt(e,Wx(n)),e}function Yx(n){let e=Tk(n),t=e.matches[e.matches.length-1];return Gt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function Ek(){return Yx("useRouteId")}function Ik(){let n=S.useContext(Qx),e=wk("useRouteError"),t=Yx("useRouteError");return n!==void 0?n:e.errors?.[t]}function Sk(){let{router:n}=bk("useNavigate"),e=Yx("useNavigate"),t=S.useRef(!1);return ZS(()=>{t.current=!0}),S.useCallback(async(i,o={})=>{rr(t.current,JS),t.current&&(typeof i=="number"?n.navigate(i):await n.navigate(i,{fromRouteId:e,...o}))},[n,e])}var _E={};function tN(n,e,t){!e&&!_E[n]&&(_E[n]=!0,rr(!1,t))}S.memo(Nk);function Nk({routes:n,future:e,state:t}){return eN(n,void 0,t,e)}function ip({to:n,replace:e,state:t,relative:s}){Gt(fu(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=S.useContext(Cr);rr(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=S.useContext(or),{pathname:u}=Yi(),h=Xi(),f=Kx(n,$x(o),u,s==="path"),p=JSON.stringify(f);return S.useEffect(()=>{h(JSON.parse(p),{replace:e,state:t,relative:s})},[h,p,s,e,t]),null}function nN(n){return fk(n.context)}function Os(n){Gt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ak({basename:n="/",children:e=null,location:t,navigationType:s="POP",navigator:i,static:o=!1}){Gt(!fu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=n.replace(/^\/*/,"/"),h=S.useMemo(()=>({basename:u,navigator:i,static:o,future:{}}),[u,i,o]);typeof t=="string"&&(t=Il(t));let{pathname:f="/",search:p="",hash:x="",state:v=null,key:b="default"}=t,I=S.useMemo(()=>{let N=zi(f,u);return N==null?null:{location:{pathname:N,search:p,hash:x,state:v,key:b},navigationType:s}},[u,f,p,x,v,b,s]);return rr(I!=null,`<Router basename="${u}"> is not able to match the URL "${f}${p}${x}" because it does not start with the basename, so the <Router> won't render anything.`),I==null?null:S.createElement(Cr.Provider,{value:h},S.createElement(Lh.Provider,{children:e,value:I}))}function Rk({children:n,location:e}){return pk(tx(n),e)}function tx(n,e=[]){let t=[];return S.Children.forEach(n,(s,i)=>{if(!S.isValidElement(s))return;let o=[...e,i];if(s.type===S.Fragment){t.push.apply(t,tx(s.props.children,o));return}Gt(s.type===Os,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Gt(!s.props.index||!s.props.children,"An index route cannot have child routes.");let u={id:s.props.id||o.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(u.children=tx(s.props.children,o)),t.push(u)}),t}var Bm="get",zm="application/x-www-form-urlencoded";function Pp(n){return n!=null&&typeof n.tagName=="string"}function Ck(n){return Pp(n)&&n.tagName.toLowerCase()==="button"}function Dk(n){return Pp(n)&&n.tagName.toLowerCase()==="form"}function kk(n){return Pp(n)&&n.tagName.toLowerCase()==="input"}function jk(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Pk(n,e){return n.button===0&&(!e||e==="_self")&&!jk(n)}var Am=null;function Ok(){if(Am===null)try{new FormData(document.createElement("form"),0),Am=!1}catch{Am=!0}return Am}var Mk=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function A0(n){return n!=null&&!Mk.has(n)?(rr(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${zm}"`),null):n}function Vk(n,e){let t,s,i,o,u;if(Dk(n)){let h=n.getAttribute("action");s=h?zi(h,e):null,t=n.getAttribute("method")||Bm,i=A0(n.getAttribute("enctype"))||zm,o=new FormData(n)}else if(Ck(n)||kk(n)&&(n.type==="submit"||n.type==="image")){let h=n.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=n.getAttribute("formaction")||h.getAttribute("action");if(s=f?zi(f,e):null,t=n.getAttribute("formmethod")||h.getAttribute("method")||Bm,i=A0(n.getAttribute("formenctype"))||A0(h.getAttribute("enctype"))||zm,o=new FormData(h,n),!Ok()){let{name:p,type:x,value:v}=n;if(x==="image"){let b=p?`${p}.`:"";o.append(`${b}x`,"0"),o.append(`${b}y`,"0")}else p&&o.append(p,v)}}else{if(Pp(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Bm,s=null,i=zm,u=n}return o&&i==="text/plain"&&(u=o,o=void 0),{action:s,method:t.toLowerCase(),encType:i,formData:o,body:u}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Xx(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Lk(n,e,t){let s=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return s.pathname==="/"?s.pathname=`_root.${t}`:e&&zi(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${t}`,s}async function Uk(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Fk(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function Bk(n,e,t){let s=await Promise.all(n.map(async i=>{let o=e.routes[i.route.id];if(o){let u=await Uk(o,t);return u.links?u.links():[]}return[]}));return Gk(s.flat(1).filter(Fk).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function bE(n,e,t,s,i,o){let u=(f,p)=>t[p]?f.route.id!==t[p].route.id:!0,h=(f,p)=>t[p].pathname!==f.pathname||t[p].route.path?.endsWith("*")&&t[p].params["*"]!==f.params["*"];return o==="assets"?e.filter((f,p)=>u(f,p)||h(f,p)):o==="data"?e.filter((f,p)=>{let x=s.routes[f.route.id];if(!x||!x.hasLoader)return!1;if(u(f,p)||h(f,p))return!0;if(f.route.shouldRevalidate){let v=f.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function zk(n,e,{includeHydrateFallback:t}={}){return qk(n.map(s=>{let i=e.routes[s.route.id];if(!i)return[];let o=[i.module];return i.clientActionModule&&(o=o.concat(i.clientActionModule)),i.clientLoaderModule&&(o=o.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(o=o.concat(i.hydrateFallbackModule)),i.imports&&(o=o.concat(i.imports)),o}).flat(1))}function qk(n){return[...new Set(n)]}function Hk(n){let e={},t=Object.keys(n).sort();for(let s of t)e[s]=n[s];return e}function Gk(n,e){let t=new Set;return new Set(e),n.reduce((s,i)=>{let o=JSON.stringify(Hk(i));return t.has(o)||(t.add(o),s.push({key:o,link:i})),s},[])}function sN(){let n=S.useContext(hu);return Xx(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function $k(){let n=S.useContext(jp);return Xx(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Jx=S.createContext(void 0);Jx.displayName="FrameworkContext";function rN(){let n=S.useContext(Jx);return Xx(n,"You must render this element inside a <HydratedRouter> element"),n}function Kk(n,e){let t=S.useContext(Jx),[s,i]=S.useState(!1),[o,u]=S.useState(!1),{onFocus:h,onBlur:f,onMouseEnter:p,onMouseLeave:x,onTouchStart:v}=e,b=S.useRef(null);S.useEffect(()=>{if(n==="render"&&u(!0),n==="viewport"){let E=C=>{C.forEach(q=>{u(q.isIntersecting)})},A=new IntersectionObserver(E,{threshold:.5});return b.current&&A.observe(b.current),()=>{A.disconnect()}}},[n]),S.useEffect(()=>{if(s){let E=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(E)}}},[s]);let I=()=>{i(!0)},N=()=>{i(!1),u(!1)};return t?n!=="intent"?[o,b,{}]:[o,b,{onFocus:Cd(h,I),onBlur:Cd(f,N),onMouseEnter:Cd(p,I),onMouseLeave:Cd(x,N),onTouchStart:Cd(v,I)}]:[!1,b,{}]}function Cd(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function Qk({page:n,...e}){let{router:t}=sN(),s=S.useMemo(()=>KS(t.routes,n,t.basename),[t.routes,n,t.basename]);return s?S.createElement(Yk,{page:n,matches:s,...e}):null}function Wk(n){let{manifest:e,routeModules:t}=rN(),[s,i]=S.useState([]);return S.useEffect(()=>{let o=!1;return Bk(n,e,t).then(u=>{o||i(u)}),()=>{o=!0}},[n,e,t]),s}function Yk({page:n,matches:e,...t}){let s=Yi(),{manifest:i,routeModules:o}=rN(),{basename:u}=sN(),{loaderData:h,matches:f}=$k(),p=S.useMemo(()=>bE(n,e,f,i,s,"data"),[n,e,f,i,s]),x=S.useMemo(()=>bE(n,e,f,i,s,"assets"),[n,e,f,i,s]),v=S.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let N=new Set,E=!1;if(e.forEach(C=>{let q=i.routes[C.route.id];!q||!q.hasLoader||(!p.some(P=>P.route.id===C.route.id)&&C.route.id in h&&o[C.route.id]?.shouldRevalidate||q.hasClientLoader?E=!0:N.add(C.route.id))}),N.size===0)return[];let A=Lk(n,u,"data");return E&&N.size>0&&A.searchParams.set("_routes",e.filter(C=>N.has(C.route.id)).map(C=>C.route.id).join(",")),[A.pathname+A.search]},[u,h,s,i,p,e,n,o]),b=S.useMemo(()=>zk(x,i),[x,i]),I=Wk(x);return S.createElement(S.Fragment,null,v.map(N=>S.createElement("link",{key:N,rel:"prefetch",as:"fetch",href:N,...t})),b.map(N=>S.createElement("link",{key:N,rel:"modulepreload",href:N,...t})),I.map(({key:N,link:E})=>S.createElement("link",{key:N,...E})))}function Xk(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var iN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{iN&&(window.__reactRouterVersion="7.7.1")}catch{}function Jk({basename:n,children:e,window:t}){let s=S.useRef();s.current==null&&(s.current=VD({window:t,v5Compat:!0}));let i=s.current,[o,u]=S.useState({action:i.action,location:i.location}),h=S.useCallback(f=>{S.startTransition(()=>u(f))},[u]);return S.useLayoutEffect(()=>i.listen(h),[i,h]),S.createElement(Ak,{basename:n,children:e,location:o.location,navigationType:o.action,navigator:i})}var aN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zc=S.forwardRef(function({onClick:e,discover:t="render",prefetch:s="none",relative:i,reloadDocument:o,replace:u,state:h,target:f,to:p,preventScrollReset:x,viewTransition:v,...b},I){let{basename:N}=S.useContext(Cr),E=typeof p=="string"&&aN.test(p),A,C=!1;if(typeof p=="string"&&E&&(A=p,iN))try{let D=new URL(window.location.href),M=p.startsWith("//")?new URL(D.protocol+p):new URL(p),B=zi(M.pathname,N);M.origin===D.origin&&B!=null?p=B+M.search+M.hash:C=!0}catch{rr(!1,`<Link to="${p}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let q=uk(p,{relative:i}),[P,V,F]=Kk(s,b),K=tj(p,{replace:u,state:h,target:f,preventScrollReset:x,relative:i,viewTransition:v});function L(D){e&&e(D),D.defaultPrevented||K(D)}let k=S.createElement("a",{...b,...F,href:A||q,onClick:C||o?e:L,ref:Xk(I,V),target:f,"data-discover":!E&&t==="render"?"true":void 0});return P&&!E?S.createElement(S.Fragment,null,k,S.createElement(Qk,{page:q})):k});zc.displayName="Link";var Xo=S.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:i=!1,style:o,to:u,viewTransition:h,children:f,...p},x){let v=Uh(u,{relative:p.relative}),b=Yi(),I=S.useContext(jp),{navigator:N,basename:E}=S.useContext(Cr),A=I!=null&&aj(v)&&h===!0,C=N.encodeLocation?N.encodeLocation(v).pathname:v.pathname,q=b.pathname,P=I&&I.navigation&&I.navigation.location?I.navigation.location.pathname:null;t||(q=q.toLowerCase(),P=P?P.toLowerCase():null,C=C.toLowerCase()),P&&E&&(P=zi(P,E)||P);const V=C!=="/"&&C.endsWith("/")?C.length-1:C.length;let F=q===C||!i&&q.startsWith(C)&&q.charAt(V)==="/",K=P!=null&&(P===C||!i&&P.startsWith(C)&&P.charAt(C.length)==="/"),L={isActive:F,isPending:K,isTransitioning:A},k=F?e:void 0,D;typeof s=="function"?D=s(L):D=[s,F?"active":null,K?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let M=typeof o=="function"?o(L):o;return S.createElement(zc,{...p,"aria-current":k,className:D,ref:x,style:M,to:u,viewTransition:h},typeof f=="function"?f(L):f)});Xo.displayName="NavLink";var Zk=S.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:s,replace:i,state:o,method:u=Bm,action:h,onSubmit:f,relative:p,preventScrollReset:x,viewTransition:v,...b},I)=>{let N=rj(),E=ij(h,{relative:p}),A=u.toLowerCase()==="get"?"get":"post",C=typeof h=="string"&&aN.test(h),q=P=>{if(f&&f(P),P.defaultPrevented)return;P.preventDefault();let V=P.nativeEvent.submitter,F=V?.getAttribute("formmethod")||u;N(V||P.currentTarget,{fetcherKey:e,method:F,navigate:t,replace:i,state:o,relative:p,preventScrollReset:x,viewTransition:v})};return S.createElement("form",{ref:I,method:A,action:E,onSubmit:s?f:q,...b,"data-discover":!C&&n==="render"?"true":void 0})});Zk.displayName="Form";function ej(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function oN(n){let e=S.useContext(hu);return Gt(e,ej(n)),e}function tj(n,{target:e,replace:t,state:s,preventScrollReset:i,relative:o,viewTransition:u}={}){let h=Xi(),f=Yi(),p=Uh(n,{relative:o});return S.useCallback(x=>{if(Pk(x,e)){x.preventDefault();let v=t!==void 0?t:fh(f)===fh(p);h(n,{replace:v,state:s,preventScrollReset:i,relative:o,viewTransition:u})}},[f,h,p,t,s,e,n,i,o,u])}var nj=0,sj=()=>`__${String(++nj)}__`;function rj(){let{router:n}=oN("useSubmit"),{basename:e}=S.useContext(Cr),t=Ek();return S.useCallback(async(s,i={})=>{let{action:o,method:u,encType:h,formData:f,body:p}=Vk(s,e);if(i.navigate===!1){let x=i.fetcherKey||sj();await n.fetch(x,t,i.action||o,{preventScrollReset:i.preventScrollReset,formData:f,body:p,formMethod:i.method||u,formEncType:i.encType||h,flushSync:i.flushSync})}else await n.navigate(i.action||o,{preventScrollReset:i.preventScrollReset,formData:f,body:p,formMethod:i.method||u,formEncType:i.encType||h,replace:i.replace,state:i.state,fromRouteId:t,flushSync:i.flushSync,viewTransition:i.viewTransition})},[n,e,t])}function ij(n,{relative:e}={}){let{basename:t}=S.useContext(Cr),s=S.useContext(or);Gt(s,"useFormAction must be used inside a RouteContext");let[i]=s.matches.slice(-1),o={...Uh(n||".",{relative:e})},u=Yi();if(n==null){o.search=u.search;let h=new URLSearchParams(o.search),f=h.getAll("index");if(f.some(x=>x==="")){h.delete("index"),f.filter(v=>v).forEach(v=>h.append("index",v));let x=h.toString();o.search=x?`?${x}`:""}}return(!n||n===".")&&i.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:Ui([t,o.pathname])),fh(o)}function aj(n,{relative:e}={}){let t=S.useContext(XS);Gt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=oN("useViewTransitionState"),i=Uh(n,{relative:e});if(!t.isTransitioning)return!1;let o=zi(t.currentLocation.pathname,s)||t.currentLocation.pathname,u=zi(t.nextLocation.pathname,s)||t.nextLocation.pathname;return rp(i.pathname,u)!=null||rp(i.pathname,o)!=null}const oj=()=>{};var wE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lN=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let i=n.charCodeAt(s);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},lj=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const i=n[t++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const o=n[t++];e[s++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=n[t++],u=n[t++],h=n[t++],f=((i&7)<<18|(o&63)<<12|(u&63)<<6|h&63)-65536;e[s++]=String.fromCharCode(55296+(f>>10)),e[s++]=String.fromCharCode(56320+(f&1023))}else{const o=n[t++],u=n[t++];e[s++]=String.fromCharCode((i&15)<<12|(o&63)<<6|u&63)}}return e.join("")},cN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<n.length;i+=3){const o=n[i],u=i+1<n.length,h=u?n[i+1]:0,f=i+2<n.length,p=f?n[i+2]:0,x=o>>2,v=(o&3)<<4|h>>4;let b=(h&15)<<2|p>>6,I=p&63;f||(I=64,u||(b=64)),s.push(t[x],t[v],t[b],t[I])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(lN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):lj(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<n.length;){const o=t[n.charAt(i++)],h=i<n.length?t[n.charAt(i)]:0;++i;const p=i<n.length?t[n.charAt(i)]:64;++i;const v=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||h==null||p==null||v==null)throw new cj;const b=o<<2|h>>4;if(s.push(b),p!==64){const I=h<<4&240|p>>2;if(s.push(I),v!==64){const N=p<<6&192|v;s.push(N)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class cj extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const uj=function(n){const e=lN(n);return cN.encodeByteArray(e,!0)},ap=function(n){return uj(n).replace(/\./g,"")},Zx=function(n){try{return cN.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function op(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!dj(t)||(n[t]=op(n[t],e[t]));return n}function dj(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ev(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hj=()=>ev().__FIREBASE_DEFAULTS__,fj=()=>{if(typeof process>"u"||typeof wE>"u")return;const n=wE.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},mj=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Zx(n[1]);return e&&JSON.parse(e)},tv=()=>{try{return oj()||hj()||fj()||mj()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},nv=()=>tv()?.config,pj=n=>tv()?.[`_${n}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gj{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function sv(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uN(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...n};return[ap(JSON.stringify(t)),ap(JSON.stringify(u)),""].join(".")}const Xd={};function yj(){const n={prod:[],emulator:[]};for(const e of Object.keys(Xd))Xd[e]?n.emulator.push(e):n.prod.push(e);return n}function xj(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let TE=!1;function rv(n,e){if(typeof window>"u"||typeof document>"u"||!lo(window.location.host)||Xd[n]===e||Xd[n]||TE)return;Xd[n]=e;function t(b){return`__firebase__banner__${b}`}const s="__firebase__banner",o=yj().prod.length>0;function u(){const b=document.getElementById(s);b&&b.remove()}function h(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function f(b,I){b.setAttribute("width","24"),b.setAttribute("id",I),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function p(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{TE=!0,u()},b}function x(b,I){b.setAttribute("id",I),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function v(){const b=xj(s),I=t("text"),N=document.getElementById(I)||document.createElement("span"),E=t("learnmore"),A=document.getElementById(E)||document.createElement("a"),C=t("preprendIcon"),q=document.getElementById(C)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const P=b.element;h(P),x(A,E);const V=p();f(q,C),P.append(q,N,A,V),document.body.appendChild(P)}o?(N.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,N.innerText="Preview backend running in this workspace."),N.setAttribute("id",I)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function vj(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Kt())}function Op(){const n=tv()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _j(){return typeof window<"u"||dN()}function dN(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function bj(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function hN(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function iv(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function fN(){const n=Kt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function mN(){return!Op()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function pN(){return!Op()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function mh(){try{return typeof indexedDB=="object"}catch{return!1}}function wj(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tj="FirebaseError";class ts extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=Tj,Object.setPrototypeOf(this,ts.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Sl.prototype.create)}}class Sl{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],u=o?Ej(o,s):"Error",h=`${this.serviceName}: ${u} (${i}).`;return new ts(i,h,s)}}function Ej(n,e){return n.replace(Ij,(t,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const Ij=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EE(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Sj(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ya(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const i of t){if(!s.includes(i))return!1;const o=n[i],u=e[i];if(IE(o)&&IE(u)){if(!Ya(o,u))return!1}else if(o!==u)return!1}for(const i of s)if(!t.includes(i))return!1;return!0}function IE(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mu(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function jc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[i,o]=s.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function qd(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function gN(n,e){const t=new Nj(n,e);return t.subscribe.bind(t)}class Nj{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let i;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");Aj(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:s},i.next===void 0&&(i.next=R0),i.error===void 0&&(i.error=R0),i.complete===void 0&&(i.complete=R0);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Aj(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function R0(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oe(n){return n&&n._delegate?n._delegate:n}class ir{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rj{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new gj;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Dj(e))try{this.getOrInitializeService({instanceIdentifier:Qo})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:i});s.resolve(o)}catch{}}}}clearInstance(e=Qo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Qo){return this.instances.has(e)}getOptions(e=Qo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[o,u]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(o);s===h&&u.resolve(i)}return i}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(s)??new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const i of s)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:Cj(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Qo){return this.component?this.component.multipleInstances?e:Qo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Cj(n){return n===Qo?void 0:n}function Dj(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Rj(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const av=[];var tt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(tt||(tt={}));const xN={debug:tt.DEBUG,verbose:tt.VERBOSE,info:tt.INFO,warn:tt.WARN,error:tt.ERROR,silent:tt.SILENT},kj=tt.INFO,jj={[tt.DEBUG]:"log",[tt.VERBOSE]:"log",[tt.INFO]:"info",[tt.WARN]:"warn",[tt.ERROR]:"error"},Pj=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),i=jj[e];if(i)console[i](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Mp{constructor(e){this.name=e,this._logLevel=kj,this._logHandler=Pj,this._userLogHandler=null,av.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in tt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?xN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,tt.DEBUG,...e),this._logHandler(this,tt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,tt.VERBOSE,...e),this._logHandler(this,tt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,tt.INFO,...e),this._logHandler(this,tt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,tt.WARN,...e),this._logHandler(this,tt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,tt.ERROR,...e),this._logHandler(this,tt.ERROR,...e)}}function Oj(n){av.forEach(e=>{e.setLogLevel(n)})}function Mj(n,e){for(const t of av){let s=null;e&&e.level&&(s=xN[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,o,...u)=>{const h=u.map(f=>{if(f==null)return null;if(typeof f=="string")return f;if(typeof f=="number"||typeof f=="boolean")return f.toString();if(f instanceof Error)return f.message;try{return JSON.stringify(f)}catch{return null}}).filter(f=>f).join(" ");o>=(s??i.logLevel)&&n({level:tt[o].toLowerCase(),message:h,args:u,type:i.name})}}}const Vj=(n,e)=>e.some(t=>n instanceof t);let SE,NE;function Lj(){return SE||(SE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Uj(){return NE||(NE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const vN=new WeakMap,nx=new WeakMap,_N=new WeakMap,C0=new WeakMap,ov=new WeakMap;function Fj(n){const e=new Promise((t,s)=>{const i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",u)},o=()=>{t(Ha(n.result)),i()},u=()=>{s(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&vN.set(t,n)}).catch(()=>{}),ov.set(e,n),e}function Bj(n){if(nx.has(n))return;const e=new Promise((t,s)=>{const i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",u),n.removeEventListener("abort",u)},o=()=>{t(),i()},u=()=>{s(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",u),n.addEventListener("abort",u)});nx.set(n,e)}let sx={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return nx.get(n);if(e==="objectStoreNames")return n.objectStoreNames||_N.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ha(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function zj(n){sx=n(sx)}function qj(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(D0(this),e,...t);return _N.set(s,e.sort?e.sort():[e]),Ha(s)}:Uj().includes(n)?function(...e){return n.apply(D0(this),e),Ha(vN.get(this))}:function(...e){return Ha(n.apply(D0(this),e))}}function Hj(n){return typeof n=="function"?qj(n):(n instanceof IDBTransaction&&Bj(n),Vj(n,Lj())?new Proxy(n,sx):n)}function Ha(n){if(n instanceof IDBRequest)return Fj(n);if(C0.has(n))return C0.get(n);const e=Hj(n);return e!==n&&(C0.set(n,e),ov.set(e,n)),e}const D0=n=>ov.get(n);function Gj(n,e,{blocked:t,upgrade:s,blocking:i,terminated:o}={}){const u=indexedDB.open(n,e),h=Ha(u);return s&&u.addEventListener("upgradeneeded",f=>{s(Ha(u.result),f.oldVersion,f.newVersion,Ha(u.transaction),f)}),t&&u.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),h.then(f=>{o&&f.addEventListener("close",()=>o()),i&&f.addEventListener("versionchange",p=>i(p.oldVersion,p.newVersion,p))}).catch(()=>{}),h}const $j=["get","getKey","getAll","getAllKeys","count"],Kj=["put","add","delete","clear"],k0=new Map;function AE(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(k0.get(e))return k0.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,i=Kj.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(i||$j.includes(t)))return;const o=async function(u,...h){const f=this.transaction(u,i?"readwrite":"readonly");let p=f.store;return s&&(p=p.index(h.shift())),(await Promise.all([p[t](...h),i&&f.done]))[0]};return k0.set(e,o),o}zj(n=>({...n,get:(e,t,s)=>AE(e,t)||n.get(e,t,s),has:(e,t)=>!!AE(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qj{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Wj(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function Wj(n){return n.getComponent()?.type==="VERSION"}const lp="@firebase/app",rx="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qi=new Mp("@firebase/app"),Yj="@firebase/app-compat",Xj="@firebase/analytics-compat",Jj="@firebase/analytics",Zj="@firebase/app-check-compat",e4="@firebase/app-check",t4="@firebase/auth",n4="@firebase/auth-compat",s4="@firebase/database",r4="@firebase/data-connect",i4="@firebase/database-compat",a4="@firebase/functions",o4="@firebase/functions-compat",l4="@firebase/installations",c4="@firebase/installations-compat",u4="@firebase/messaging",d4="@firebase/messaging-compat",h4="@firebase/performance",f4="@firebase/performance-compat",m4="@firebase/remote-config",p4="@firebase/remote-config-compat",g4="@firebase/storage",y4="@firebase/storage-compat",x4="@firebase/firestore",v4="@firebase/ai",_4="@firebase/firestore-compat",b4="firebase",w4="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xa="[DEFAULT]",T4={[lp]:"fire-core",[Yj]:"fire-core-compat",[Jj]:"fire-analytics",[Xj]:"fire-analytics-compat",[e4]:"fire-app-check",[Zj]:"fire-app-check-compat",[t4]:"fire-auth",[n4]:"fire-auth-compat",[s4]:"fire-rtdb",[r4]:"fire-data-connect",[i4]:"fire-rtdb-compat",[a4]:"fire-fn",[o4]:"fire-fn-compat",[l4]:"fire-iid",[c4]:"fire-iid-compat",[u4]:"fire-fcm",[d4]:"fire-fcm-compat",[h4]:"fire-perf",[f4]:"fire-perf-compat",[m4]:"fire-rc",[p4]:"fire-rc-compat",[g4]:"fire-gcs",[y4]:"fire-gcs-compat",[x4]:"fire-fst",[_4]:"fire-fst-compat",[v4]:"fire-vertex","fire-js":"fire-js",[b4]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ja=new Map,qc=new Map,Hc=new Map;function ph(n,e){try{n.container.addComponent(e)}catch(t){qi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function bN(n,e){n.container.addOrOverwriteComponent(e)}function Hi(n){const e=n.name;if(Hc.has(e))return qi.debug(`There were multiple attempts to register component ${e}.`),!1;Hc.set(e,n);for(const t of Ja.values())ph(t,n);for(const t of qc.values())ph(t,n);return!0}function wN(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function E4(n,e,t=Xa){wN(n,e).clearInstance(t)}function lv(n){return n.options!==void 0}function TN(n){return lv(n)?!1:"authIdToken"in n||"appCheckToken"in n||"releaseOnDeref"in n||"automaticDataCollectionEnabled"in n}function Lt(n){return n==null?!1:n.settings!==void 0}function I4(){Hc.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S4={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Us=new Sl("app","Firebase",S4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let EN=class{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new ir("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Us.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RE(n,e){const t=Zx(n.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const i=JSON.parse(t).exp*1e3,o=new Date().getTime();i-o<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class N4 extends EN{constructor(e,t,s,i){const o=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,u={name:s,automaticDataCollectionEnabled:o};if(e.apiKey!==void 0)super(e,u,i);else{const h=e;super(h.options,u,i)}this._serverConfig={automaticDataCollectionEnabled:o,...t},this._serverConfig.authIdToken&&RE(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&RE(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Fs(lp,rx,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){uv(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Us.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ji=w4;function cv(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:Xa,automaticDataCollectionEnabled:!0,...e},i=s.name;if(typeof i!="string"||!i)throw Us.create("bad-app-name",{appName:String(i)});if(t||(t=nv()),!t)throw Us.create("no-options");const o=Ja.get(i);if(o){if(Ya(t,o.options)&&Ya(s,o.config))return o;throw Us.create("duplicate-app",{appName:i})}const u=new yN(i);for(const f of Hc.values())u.addComponent(f);const h=new EN(t,s,u);return Ja.set(i,h),h}function A4(n,e={}){if(_j()&&!dN())throw Us.create("invalid-server-app-environment");let t,s=e||{};if(n&&(lv(n)?t=n.options:TN(n)?s=n:t=n),s.automaticDataCollectionEnabled===void 0&&(s.automaticDataCollectionEnabled=!0),t||(t=nv()),!t)throw Us.create("no-options");const i={...s,...t};i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;const o=x=>[...x].reduce((v,b)=>Math.imul(31,v)+b.charCodeAt(0)|0,0);if(s.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Us.create("finalization-registry-not-supported",{});const u=""+o(JSON.stringify(i)),h=qc.get(u);if(h)return h.incRefCount(s.releaseOnDeref),h;const f=new yN(u);for(const x of Hc.values())f.addComponent(x);const p=new N4(t,s,u,f);return qc.set(u,p),p}function R4(n=Xa){const e=Ja.get(n);if(!e&&n===Xa&&nv())return cv();if(!e)throw Us.create("no-app",{appName:n});return e}function C4(){return Array.from(Ja.values())}async function uv(n){let e=!1;const t=n.name;Ja.has(t)?(e=!0,Ja.delete(t)):qc.has(t)&&n.decRefCount()<=0&&(qc.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(s=>s.delete())),n.isDeleted=!0)}function Fs(n,e,t){let s=T4[n]??n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const u=[`Unable to register library "${s}" with version "${e}":`];i&&u.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&u.push("and"),o&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),qi.warn(u.join(" "));return}Hi(new ir(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}function IN(n,e){if(n!==null&&typeof n!="function")throw Us.create("invalid-log-argument");Mj(n,e)}function SN(n){Oj(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D4="firebase-heartbeat-database",k4=1,gh="firebase-heartbeat-store";let j0=null;function NN(){return j0||(j0=Gj(D4,k4,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(gh)}catch(t){console.warn(t)}}}}).catch(n=>{throw Us.create("idb-open",{originalErrorMessage:n.message})})),j0}async function j4(n){try{const t=(await NN()).transaction(gh),s=await t.objectStore(gh).get(AN(n));return await t.done,s}catch(e){if(e instanceof ts)qi.warn(e.message);else{const t=Us.create("idb-get",{originalErrorMessage:e?.message});qi.warn(t.message)}}}async function CE(n,e){try{const s=(await NN()).transaction(gh,"readwrite");await s.objectStore(gh).put(e,AN(n)),await s.done}catch(t){if(t instanceof ts)qi.warn(t.message);else{const s=Us.create("idb-set",{originalErrorMessage:t?.message});qi.warn(s.message)}}}function AN(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P4=1024,O4=30;class M4{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new L4(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=DE();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(i=>i.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:t}),this._heartbeatsCache.heartbeats.length>O4){const i=U4(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){qi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=DE(),{heartbeatsToSend:t,unsentEntries:s}=V4(this._heartbeatsCache.heartbeats),i=ap(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return qi.warn(e),""}}}function DE(){return new Date().toISOString().substring(0,10)}function V4(n,e=P4){const t=[];let s=n.slice();for(const i of n){const o=t.find(u=>u.agent===i.agent);if(o){if(o.dates.push(i.date),kE(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),kE(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class L4{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return mh()?wj().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await j4(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return CE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return CE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function kE(n){return ap(JSON.stringify({version:2,heartbeats:n})).length}function U4(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F4(n){Hi(new ir("platform-logger",e=>new Qj(e),"PRIVATE")),Hi(new ir("heartbeat",e=>new M4(e),"PRIVATE")),Fs(lp,rx,n),Fs(lp,rx,"esm2020"),Fs("fire-js","")}F4("");const B4=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:ts,SDK_VERSION:Ji,_DEFAULT_ENTRY_NAME:Xa,_addComponent:ph,_addOrOverwriteComponent:bN,_apps:Ja,_clearComponents:I4,_components:Hc,_getProvider:wN,_isFirebaseApp:lv,_isFirebaseServerApp:Lt,_isFirebaseServerAppSettings:TN,_registerComponent:Hi,_removeServiceInstance:E4,_serverApps:qc,deleteApp:uv,getApp:R4,getApps:C4,initializeApp:cv,initializeServerApp:A4,onLog:IN,registerVersion:Fs,setLogLevel:SN},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(e,t){this._delegate=e,this.firebase=t,ph(e,new ir("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),uv(this._delegate)))}_getService(e,t=Xa){this._delegate.checkDestroyed();const s=this._delegate.container.getProvider(e);return!s.isInitialized()&&s.getComponent()?.instantiationMode==="EXPLICIT"&&s.initialize(),s.getImmediate({identifier:t})}_removeServiceInstance(e,t=Xa){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){ph(this._delegate,e)}_addOrOverwriteComponent(e){bN(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q4={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},jE=new Sl("app-compat","Firebase",q4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H4(n){const e={},t={__esModule:!0,initializeApp:o,app:i,registerVersion:Fs,setLogLevel:SN,onLog:IN,apps:null,SDK_VERSION:Ji,INTERNAL:{registerComponent:h,removeApp:s,useAsService:f,modularAPIs:B4}};t.default=t,Object.defineProperty(t,"apps",{get:u});function s(p){delete e[p]}function i(p){if(p=p||Xa,!EE(e,p))throw jE.create("no-app",{appName:p});return e[p]}i.App=n;function o(p,x={}){const v=cv(p,x);if(EE(e,v.name))return e[v.name];const b=new n(v,t);return e[v.name]=b,b}function u(){return Object.keys(e).map(p=>e[p])}function h(p){const x=p.name,v=x.replace("-compat","");if(Hi(p)&&p.type==="PUBLIC"){const b=(I=i())=>{if(typeof I[v]!="function")throw jE.create("invalid-app-argument",{appName:x});return I[v]()};p.serviceProps!==void 0&&op(b,p.serviceProps),t[v]=b,n.prototype[v]=function(...I){return this._getService.bind(this,x).apply(this,p.multipleInstances?I:[])}}return p.type==="PUBLIC"?t[v]:null}function f(p,x){return x==="serverAuth"?null:x}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RN(){const n=H4(z4);n.INTERNAL={...n.INTERNAL,createFirebaseNamespace:RN,extendNamespace:e,createSubscribe:gN,ErrorFactory:Sl,deepExtend:op};function e(t){op(n,t)}return n}const G4=RN();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PE=new Mp("@firebase/app-compat"),$4="@firebase/app-compat",K4="0.5.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q4(n){Fs($4,K4,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=ev();if(n.firebase!==void 0){PE.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&PE.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const Zn=G4;Q4();var W4="firebase",Y4="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zn.registerVersion(W4,Y4,"app-compat");const Dd={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},vc={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X4(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function CN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const J4=X4,Z4=CN,DN=new Sl("auth","Firebase",CN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cp=new Mp("@firebase/auth");function eP(n,...e){cp.logLevel<=tt.WARN&&cp.warn(`Auth (${Ji}): ${n}`,...e)}function qm(n,...e){cp.logLevel<=tt.ERROR&&cp.error(`Auth (${Ji}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gn(n,...e){throw hv(n,...e)}function En(n,...e){return hv(n,...e)}function dv(n,e,t){const s={...Z4(),[e]:t};return new Sl("auth","Firebase",s).create(e,{appName:n.name})}function Vn(n){return dv(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function pu(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&Gn(n,"argument-error"),dv(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function hv(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return DN.create(n,...e)}function _e(n,e,...t){if(!n)throw hv(e,...t)}function si(n){const e="INTERNAL ASSERTION FAILED: "+n;throw qm(e),new Error(e)}function Ar(n,e){n||si(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yh(){return typeof self<"u"&&self.location?.href||""}function fv(){return OE()==="http:"||OE()==="https:"}function OE(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(fv()||hN()||"connection"in navigator)?navigator.onLine:!0}function nP(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ar(t>e,"Short delay should be less than long delay!"),this.isMobile=vj()||iv()}get(){return tP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mv(n,e){Ar(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;si("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;si("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;si("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rP=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],iP=new Fh(3e4,6e4);function tn(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function nn(n,e,t,s,i={}){return jN(n,i,async()=>{let o={},u={};s&&(e==="GET"?u=s:o={body:JSON.stringify(s)});const h=mu({key:n.config.apiKey,...u}).slice(1),f=await n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:f,...o};return bj()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&lo(n.emulatorConfig.host)&&(p.credentials="include"),kN.fetch()(await PN(n,n.config.apiHost,t,h),p)})}async function jN(n,e,t){n._canInitEmulator=!1;const s={...sP,...e};try{const i=new oP(n),o=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const u=await o.json();if("needConfirmation"in u)throw Hd(n,"account-exists-with-different-credential",u);if(o.ok&&!("errorMessage"in u))return u;{const h=o.ok?u.errorMessage:u.error.message,[f,p]=h.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Hd(n,"credential-already-in-use",u);if(f==="EMAIL_EXISTS")throw Hd(n,"email-already-in-use",u);if(f==="USER_DISABLED")throw Hd(n,"user-disabled",u);const x=s[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw dv(n,x,p);Gn(n,x)}}catch(i){if(i instanceof ts)throw i;Gn(n,"network-request-failed",{message:String(i)})}}async function Zi(n,e,t,s,i={}){const o=await nn(n,e,t,s,i);return"mfaPendingCredential"in o&&Gn(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function PN(n,e,t,s){const i=`${e}${t}?${s}`,o=n,u=o.config.emulator?mv(n.config,i):`${n.config.apiScheme}://${i}`;return rP.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(u).toString():u}function aP(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class oP{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(En(this.auth,"network-request-failed")),iP.get())})}}function Hd(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const i=En(n,e,s);return i.customData._tokenResponse=t,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ME(n){return n!==void 0&&n.getResponse!==void 0}function VE(n){return n!==void 0&&n.enterprise!==void 0}class ON{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return aP(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lP(n){return(await nn(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function MN(n,e){return nn(n,"GET","/v2/recaptchaConfig",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cP(n,e){return nn(n,"POST","/v1/accounts:delete",e)}async function uP(n,e){return nn(n,"POST","/v1/accounts:update",e)}async function up(n,e){return nn(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jd(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function dP(n,e=!1){const t=Oe(n),s=await t.getIdToken(e),i=Vp(s);_e(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,u=o?.sign_in_provider;return{claims:i,token:s,authTime:Jd(P0(i.auth_time)),issuedAtTime:Jd(P0(i.iat)),expirationTime:Jd(P0(i.exp)),signInProvider:u||null,signInSecondFactor:o?.sign_in_second_factor||null}}function P0(n){return Number(n)*1e3}function Vp(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return qm("JWT malformed, contained fewer than 3 sections"),null;try{const i=Zx(t);return i?JSON.parse(i):(qm("Failed to decode base64 JWT payload"),null)}catch(i){return qm("Caught error parsing JWT payload as JSON",i?.toString()),null}}function LE(n){const e=Vp(n);return _e(e,"internal-error"),_e(typeof e.exp<"u","internal-error"),_e(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gi(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof ts&&hP(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function hP({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ix{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Jd(this.lastLoginAt),this.creationTime=Jd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xh(n){const e=n.auth,t=await n.getIdToken(),s=await Gi(n,up(e,{idToken:t}));_e(s?.users.length,e,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=i.providerUserInfo?.length?VN(i.providerUserInfo):[],u=pP(n.providerData,o),h=n.isAnonymous,f=!(n.email&&i.passwordHash)&&!u?.length,p=h?f:!1,x={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:u,metadata:new ix(i.createdAt,i.lastLoginAt),isAnonymous:p};Object.assign(n,x)}async function mP(n){const e=Oe(n);await xh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function pP(n,e){return[...n.filter(s=>!e.some(i=>i.providerId===s.providerId)),...e]}function VN(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gP(n,e){const t=await jN(n,{},async()=>{const s=mu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,u=await PN(n,i,"/v1/token",`key=${o}`),h=await n._getAdditionalHeaders();h["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:h,body:s};return n.emulatorConfig&&lo(n.emulatorConfig.host)&&(f.credentials="include"),kN.fetch()(u,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function yP(n,e){return nn(n,"POST","/v2/accounts:revokeToken",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_e(e.idToken,"internal-error"),_e(typeof e.idToken<"u","internal-error"),_e(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):LE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){_e(e.length!==0,"internal-error");const t=LE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(_e(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:i,expiresIn:o}=await gP(e,t);this.updateTokensAndExpiration(s,i,Number(o))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:i,expirationTime:o}=t,u=new Pc;return s&&(_e(typeof s=="string","internal-error",{appName:e}),u.refreshToken=s),i&&(_e(typeof i=="string","internal-error",{appName:e}),u.accessToken=i),o&&(_e(typeof o=="number","internal-error",{appName:e}),u.expirationTime=o),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Pc,this.toJSON())}_performRefresh(){return si("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oa(n,e){_e(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Er{constructor({uid:e,auth:t,stsTokenManager:s,...i}){this.providerId="firebase",this.proactiveRefresh=new fP(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new ix(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Gi(this,this.stsTokenManager.getToken(this.auth,e));return _e(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return dP(this,e)}reload(){return mP(this)}_assign(e){this!==e&&(_e(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Er({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){_e(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await xh(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Lt(this.auth.app))return Promise.reject(Vn(this.auth));const e=await this.getIdToken();return await Gi(this,cP(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const s=t.displayName??void 0,i=t.email??void 0,o=t.phoneNumber??void 0,u=t.photoURL??void 0,h=t.tenantId??void 0,f=t._redirectEventId??void 0,p=t.createdAt??void 0,x=t.lastLoginAt??void 0,{uid:v,emailVerified:b,isAnonymous:I,providerData:N,stsTokenManager:E}=t;_e(v&&E,e,"internal-error");const A=Pc.fromJSON(this.name,E);_e(typeof v=="string",e,"internal-error"),Oa(s,e.name),Oa(i,e.name),_e(typeof b=="boolean",e,"internal-error"),_e(typeof I=="boolean",e,"internal-error"),Oa(o,e.name),Oa(u,e.name),Oa(h,e.name),Oa(f,e.name),Oa(p,e.name),Oa(x,e.name);const C=new Er({uid:v,auth:e,email:i,emailVerified:b,displayName:s,isAnonymous:I,photoURL:u,phoneNumber:o,tenantId:h,stsTokenManager:A,createdAt:p,lastLoginAt:x});return N&&Array.isArray(N)&&(C.providerData=N.map(q=>({...q}))),f&&(C._redirectEventId=f),C}static async _fromIdTokenResponse(e,t,s=!1){const i=new Pc;i.updateFromServerResponse(t);const o=new Er({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:s});return await xh(o),o}static async _fromGetAccountInfoResponse(e,t,s){const i=t.users[0];_e(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?VN(i.providerUserInfo):[],u=!(i.email&&i.passwordHash)&&!o?.length,h=new Pc;h.updateFromIdToken(s);const f=new Er({uid:i.localId,auth:e,stsTokenManager:h,isAnonymous:u}),p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new ix(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(f,p),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UE=new Map;function Ls(n){Ar(n instanceof Function,"Expected a class definition");let e=UE.get(n);return e?(Ar(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,UE.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}LN.type="NONE";const Gc=LN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ol(n,e,t){return`firebase:${n}:${e}:${t}`}class Oc{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:i,name:o}=this.auth;this.fullUserKey=ol(this.userKey,i.apiKey,o),this.fullPersistenceKey=ol("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await up(this.auth,{idToken:e}).catch(()=>{});return t?Er._fromGetAccountInfoResponse(this.auth,t,e):null}return Er._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new Oc(Ls(Gc),e,s);const i=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let o=i[0]||Ls(Gc);const u=ol(s,e.config.apiKey,e.name);let h=null;for(const p of t)try{const x=await p._get(u);if(x){let v;if(typeof x=="string"){const b=await up(e,{idToken:x}).catch(()=>{});if(!b)break;v=await Er._fromGetAccountInfoResponse(e,b,x)}else v=Er._fromJSON(e,x);p!==o&&(h=v),o=p;break}}catch{}const f=i.filter(p=>p._shouldAllowMigration);return!o._shouldAllowMigration||!f.length?new Oc(o,e,s):(o=f[0],h&&await o._set(u,h.toJSON()),await Promise.all(t.map(async p=>{if(p!==o)try{await p._remove(u)}catch{}})),new Oc(o,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FE(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(zN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(UN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(qN(e))return"Blackberry";if(HN(e))return"Webos";if(FN(e))return"Safari";if((e.includes("chrome/")||BN(e))&&!e.includes("edge/"))return"Chrome";if(Bh(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if(s?.length===2)return s[1]}return"Other"}function UN(n=Kt()){return/firefox\//i.test(n)}function FN(n=Kt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function BN(n=Kt()){return/crios\//i.test(n)}function zN(n=Kt()){return/iemobile/i.test(n)}function Bh(n=Kt()){return/android/i.test(n)}function qN(n=Kt()){return/blackberry/i.test(n)}function HN(n=Kt()){return/webos/i.test(n)}function zh(n=Kt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function xP(n=Kt()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function vP(n=Kt()){return zh(n)&&!!window.navigator?.standalone}function _P(){return fN()&&document.documentMode===10}function GN(n=Kt()){return zh(n)||Bh(n)||HN(n)||qN(n)||/windows phone/i.test(n)||zN(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $N(n,e=[]){let t;switch(n){case"Browser":t=FE(Kt());break;case"Worker":t=`${FE(Kt())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ji}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=o=>new Promise((u,h)=>{try{const f=e(o);u(f)}catch(f){h(f)}});s.onAbort=t,this.queue.push(s);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wP(n,e={}){return nn(n,"GET","/v2/passwordPolicy",tn(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TP=6;class EP{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??TP,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let i=0;i<e.length;i++)s=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(e,t,s,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new BE(this),this.idTokenSubscription=new BE(this),this.beforeStateQueue=new bP(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=DN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ls(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Oc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await up(this,{idToken:e}),s=await Er._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Lt(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let s=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,u=s?._redirectEventId,h=await this.tryRedirectSignIn(e);(!o||o===u)&&h?.user&&(s=h.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return _e(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await xh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=nP()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Lt(this.app))return Promise.reject(Vn(this));const t=e?Oe(e):null;return t&&_e(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&_e(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Lt(this.app)?Promise.reject(Vn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Lt(this.app)?Promise.reject(Vn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ls(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await wP(this),t=new EP(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Sl("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await yP(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ls(e)||this._popupRedirectResolver;_e(t,this,"argument-error"),this.redirectPersistenceManager=await Oc.create(this,[Ls(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,i){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let u=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(_e(h,this,"internal-error"),h.then(()=>{u||o(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,s,i);return()=>{u=!0,f()}}else{const f=e.addObserver(t);return()=>{u=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _e(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=$N(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(Lt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&eP(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Qt(n){return Oe(n)}class BE{constructor(e){this.auth=e,this.observer=null,this.addObserver=gN(t=>this.observer=t)}get next(){return _e(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function SP(n){qh=n}function pv(n){return qh.loadJS(n)}function NP(){return qh.recaptchaV2Script}function AP(){return qh.recaptchaEnterpriseScript}function RP(){return qh.gapiScript}function KN(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CP=500,DP=6e4,Rm=1e12;class kP{constructor(e){this.auth=e,this.counter=Rm,this._widgets=new Map}render(e,t){const s=this.counter;return this._widgets.set(s,new OP(e,this.auth.name,t||{})),this.counter++,s}reset(e){const t=e||Rm;this._widgets.get(t)?.delete(),this._widgets.delete(t)}getResponse(e){const t=e||Rm;return this._widgets.get(t)?.getResponse()||""}async execute(e){const t=e||Rm;return this._widgets.get(t)?.execute(),""}}class jP{constructor(){this.enterprise=new PP}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class PP{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class OP{constructor(e,t,s){this.params=s,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;_e(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=MP(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},DP)},CP))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function MP(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let s=0;s<n;s++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const VP="recaptcha-enterprise",Zd="NO_RECAPTCHA";class QN{constructor(e){this.type=VP,this.auth=Qt(e)}async verify(e="verify",t=!1){async function s(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(u,h)=>{MN(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const p=new ON(f);return o.tenantId==null?o._agentRecaptchaConfig=p:o._tenantRecaptchaConfigs[o.tenantId]=p,u(p.siteKey)}}).catch(f=>{h(f)})})}function i(o,u,h){const f=window.grecaptcha;VE(f)?f.enterprise.ready(()=>{f.enterprise.execute(o,{action:e}).then(p=>{u(p)}).catch(()=>{u(Zd)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new jP().execute("siteKey",{action:"verify"}):new Promise((o,u)=>{s(this.auth).then(h=>{if(!t&&VE(window.grecaptcha))i(h,o,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let f=AP();f.length!==0&&(f+=h),pv(f).then(()=>{i(h,o,u)}).catch(p=>{u(p)})}}).catch(h=>{u(h)})})}}async function kd(n,e,t,s=!1,i=!1){const o=new QN(n);let u;if(i)u=Zd;else try{u=await o.verify(t)}catch{u=await o.verify(t,!0)}const h={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in h){const f=h.phoneEnrollmentInfo.phoneNumber,p=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:p,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){const f=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return s?Object.assign(h,{captchaResp:u}):Object.assign(h,{captchaResponse:u}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function Ga(n,e,t,s,i){if(i==="EMAIL_PASSWORD_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await kd(n,e,t,t==="getOobCode");return s(n,o)}else return s(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await kd(n,e,t,t==="getOobCode");return s(n,u)}else return Promise.reject(o)});else if(i==="PHONE_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const o=await kd(n,e,t);return s(n,o).catch(async u=>{if(n._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(u.code==="auth/missing-recaptcha-token"||u.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const h=await kd(n,e,t,!1,!0);return s(n,h)}return Promise.reject(u)})}else{const o=await kd(n,e,t,!1,!0);return s(n,o)}else return Promise.reject(i+" provider is not supported.")}async function LP(n){const e=Qt(n),t=await MN(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),s=new ON(t);e.tenantId==null?e._agentRecaptchaConfig=s:e._tenantRecaptchaConfigs[e.tenantId]=s,s.isAnyProviderEnabled()&&new QN(e).verify()}function UP(n,e){const t=e?.persistence||[],s=(Array.isArray(t)?t:[t]).map(Ls);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e?.popupRedirectResolver)}function FP(n,e,t){const s=Qt(n);_e(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const i=!!t?.disableWarnings,o=WN(e),{host:u,port:h}=BP(e),f=h===null?"":`:${h}`,p={url:`${o}//${u}${f}/`},x=Object.freeze({host:u,port:h,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!s._canInitEmulator){_e(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),_e(Ya(p,s.config.emulator)&&Ya(x,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=p,s.emulatorConfig=x,s.settings.appVerificationDisabledForTesting=!0,lo(u)?(sv(`${o}//${u}${f}`),rv("Auth",!0)):i||zP()}function WN(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function BP(n){const e=WN(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(s);if(i){const o=i[1];return{host:o,port:zE(s.substr(o.length+1))}}else{const[o,u]=s.split(":");return{host:o,port:zE(u)}}}function zE(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function zP(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return si("not implemented")}_getIdTokenResponse(e){return si("not implemented")}_linkToIdToken(e,t){return si("not implemented")}_getReauthenticationResolver(e){return si("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YN(n,e){return nn(n,"POST","/v1/accounts:resetPassword",tn(n,e))}async function qP(n,e){return nn(n,"POST","/v1/accounts:update",e)}async function HP(n,e){return nn(n,"POST","/v1/accounts:signUp",e)}async function GP(n,e){return nn(n,"POST","/v1/accounts:update",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $P(n,e){return Zi(n,"POST","/v1/accounts:signInWithPassword",tn(n,e))}async function Lp(n,e){return nn(n,"POST","/v1/accounts:sendOobCode",tn(n,e))}async function KP(n,e){return Lp(n,e)}async function QP(n,e){return Lp(n,e)}async function WP(n,e){return Lp(n,e)}async function YP(n,e){return Lp(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XP(n,e){return Zi(n,"POST","/v1/accounts:signInWithEmailLink",tn(n,e))}async function JP(n,e){return Zi(n,"POST","/v1/accounts:signInWithEmailLink",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh extends gu{constructor(e,t,s,i=null){super("password",s),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new vh(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new vh(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ga(e,t,"signInWithPassword",$P,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return XP(e,{email:this._email,oobCode:this._password});default:Gn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ga(e,s,"signUpPassword",HP,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return JP(e,{idToken:t,email:this._email,oobCode:this._password});default:Gn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fi(n,e){return Zi(n,"POST","/v1/accounts:signInWithIdp",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZP="http://localhost";class ui extends gu{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ui(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Gn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:i,...o}=t;if(!s||!i)return null;const u=new ui(s,i);return u.idToken=o.idToken||void 0,u.accessToken=o.accessToken||void 0,u.secret=o.secret,u.nonce=o.nonce,u.pendingToken=o.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return Fi(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Fi(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Fi(e,t)}buildRequest(){const e={requestUri:ZP,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=mu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qE(n,e){return nn(n,"POST","/v1/accounts:sendVerificationCode",tn(n,e))}async function eO(n,e){return Zi(n,"POST","/v1/accounts:signInWithPhoneNumber",tn(n,e))}async function tO(n,e){const t=await Zi(n,"POST","/v1/accounts:signInWithPhoneNumber",tn(n,e));if(t.temporaryProof)throw Hd(n,"account-exists-with-different-credential",t);return t}const nO={USER_NOT_FOUND:"user-not-found"};async function sO(n,e){const t={...e,operation:"REAUTH"};return Zi(n,"POST","/v1/accounts:signInWithPhoneNumber",tn(n,t),nO)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll extends gu{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new ll({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new ll({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return eO(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return tO(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return sO(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:s,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:s,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:s,phoneNumber:i,temporaryProof:o}=e;return!s&&!t&&!i&&!o?null:new ll({verificationId:t,verificationCode:s,phoneNumber:i,temporaryProof:o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rO(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function iO(n){const e=jc(qd(n)).link,t=e?jc(qd(e)).deep_link_id:null,s=jc(qd(n)).deep_link_id;return(s?jc(qd(s)).link:null)||s||t||e||n}class Up{constructor(e){const t=jc(qd(e)),s=t.apiKey??null,i=t.oobCode??null,o=rO(t.mode??null);_e(s&&i&&o,"argument-error"),this.apiKey=s,this.operation=o,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=iO(e);try{return new Up(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(){this.providerId=co.PROVIDER_ID}static credential(e,t){return vh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=Up.parseLink(t);return _e(s,"argument-error"),vh._fromEmailAndCode(e,s.code,s.tenantId)}}co.PROVIDER_ID="password";co.EMAIL_PASSWORD_SIGN_IN_METHOD="password";co.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu extends ea{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Mc extends yu{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return _e("providerId"in t&&"signInMethod"in t,"argument-error"),ui._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return _e(e.idToken||e.accessToken,"argument-error"),ui._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return Mc.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Mc.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s,oauthTokenSecret:i,pendingToken:o,nonce:u,providerId:h}=e;if(!s&&!i&&!t&&!o||!h)return null;try{return new Mc(h)._credential({idToken:t,accessToken:s,nonce:u,pendingToken:o})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr extends yu{constructor(){super("facebook.com")}static credential(e){return ui._fromParams({providerId:Jr.PROVIDER_ID,signInMethod:Jr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Jr.credentialFromTaggedObject(e)}static credentialFromError(e){return Jr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Jr.credential(e.oauthAccessToken)}catch{return null}}}Jr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Jr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr extends yu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ui._fromParams({providerId:Zr.PROVIDER_ID,signInMethod:Zr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Zr.credentialFromTaggedObject(e)}static credentialFromError(e){return Zr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return Zr.credential(t,s)}catch{return null}}}Zr.GOOGLE_SIGN_IN_METHOD="google.com";Zr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei extends yu{constructor(){super("github.com")}static credential(e){return ui._fromParams({providerId:ei.PROVIDER_ID,signInMethod:ei.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ei.credentialFromTaggedObject(e)}static credentialFromError(e){return ei.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ei.credential(e.oauthAccessToken)}catch{return null}}}ei.GITHUB_SIGN_IN_METHOD="github.com";ei.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aO="http://localhost";class $c extends gu{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return Fi(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Fi(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Fi(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:i,pendingToken:o}=t;return!s||!i||!o||s!==i?null:new $c(s,o)}static _create(e,t){return new $c(e,t)}buildRequest(){return{requestUri:aO,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oO="saml.";class dp extends ea{constructor(e){_e(e.startsWith(oO),"argument-error"),super(e)}static credentialFromResult(e){return dp.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return dp.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=$c.fromJSON(e);return _e(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:s}=e;if(!t||!s)return null;try{return $c._create(s,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti extends yu{constructor(){super("twitter.com")}static credential(e,t){return ui._fromParams({providerId:ti.PROVIDER_ID,signInMethod:ti.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ti.credentialFromTaggedObject(e)}static credentialFromError(e){return ti.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return ti.credential(t,s)}catch{return null}}}ti.TWITTER_SIGN_IN_METHOD="twitter.com";ti.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XN(n,e){return Zi(n,"POST","/v1/accounts:signUp",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,i=!1){const o=await Er._fromIdTokenResponse(e,s,i),u=HE(s);return new ar({user:o,providerId:u,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const i=HE(s);return new ar({user:e,providerId:i,_tokenResponse:s,operationType:t})}}function HE(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lO(n){if(Lt(n.app))return Promise.reject(Vn(n));const e=Qt(n);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new ar({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await XN(e,{returnSecureToken:!0}),s=await ar._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp extends ts{constructor(e,t,s,i){super(t.code,t.message),this.operationType=s,this.user=i,Object.setPrototypeOf(this,hp.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,i){return new hp(e,t,s,i)}}function JN(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?hp._fromErrorAndOperation(n,o,e,s):o})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZN(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cO(n,e){const t=Oe(n);await Fp(!0,t,e);const{providerUserInfo:s}=await uP(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),i=ZN(s||[]);return t.providerData=t.providerData.filter(o=>i.has(o.providerId)),i.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function gv(n,e,t=!1){const s=await Gi(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return ar._forOperation(n,"link",s)}async function Fp(n,e,t){await xh(e);const s=ZN(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";_e(s.has(t)===n,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eA(n,e,t=!1){const{auth:s}=n;if(Lt(s.app))return Promise.reject(Vn(s));const i="reauthenticate";try{const o=await Gi(n,JN(s,i,e,n),t);_e(o.idToken,s,"internal-error");const u=Vp(o.idToken);_e(u,s,"internal-error");const{sub:h}=u;return _e(n.uid===h,s,"user-mismatch"),ar._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&Gn(s,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tA(n,e,t=!1){if(Lt(n.app))return Promise.reject(Vn(n));const s="signIn",i=await JN(n,s,e),o=await ar._fromIdTokenResponse(n,s,i);return t||await n._updateCurrentUser(o.user),o}async function Bp(n,e){return tA(Qt(n),e)}async function nA(n,e){const t=Oe(n);return await Fp(!1,t,e.providerId),gv(t,e)}async function sA(n,e){return eA(Oe(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uO(n,e){return Zi(n,"POST","/v1/accounts:signInWithCustomToken",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dO(n,e){if(Lt(n.app))return Promise.reject(Vn(n));const t=Qt(n),s=await uO(t,{token:e,returnSecureToken:!0}),i=await ar._fromIdTokenResponse(t,"signIn",s);return await t._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?yv._fromServerResponse(e,t):"totpInfo"in t?xv._fromServerResponse(e,t):Gn(e,"internal-error")}}class yv extends Hh{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new yv(t)}}class xv extends Hh{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new xv(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zp(n,e,t){_e(t.url?.length>0,n,"invalid-continue-uri"),_e(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),_e(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(_e(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(_e(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vv(n){const e=Qt(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function hO(n,e,t){const s=Qt(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&zp(s,i,t),await Ga(s,i,"getOobCode",QP,"EMAIL_PASSWORD_PROVIDER")}async function fO(n,e,t){await YN(Oe(n),{oobCode:e,newPassword:t}).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&vv(n),s})}async function mO(n,e){await GP(Oe(n),{oobCode:e})}async function rA(n,e){const t=Oe(n),s=await YN(t,{oobCode:e}),i=s.requestType;switch(_e(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":_e(s.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":_e(s.mfaInfo,t,"internal-error");default:_e(s.email,t,"internal-error")}let o=null;return s.mfaInfo&&(o=Hh._fromServerResponse(Qt(t),s.mfaInfo)),{data:{email:(s.requestType==="VERIFY_AND_CHANGE_EMAIL"?s.newEmail:s.email)||null,previousEmail:(s.requestType==="VERIFY_AND_CHANGE_EMAIL"?s.email:s.newEmail)||null,multiFactorInfo:o},operation:i}}async function pO(n,e){const{data:t}=await rA(Oe(n),e);return t.email}async function gO(n,e,t){if(Lt(n.app))return Promise.reject(Vn(n));const s=Qt(n),u=await Ga(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",XN,"EMAIL_PASSWORD_PROVIDER").catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&vv(n),f}),h=await ar._fromIdTokenResponse(s,"signIn",u);return await s._updateCurrentUser(h.user),h}function yO(n,e,t){return Lt(n.app)?Promise.reject(Vn(n)):Bp(Oe(n),co.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&vv(n),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xO(n,e,t){const s=Qt(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function o(u,h){_e(h.handleCodeInApp,s,"argument-error"),h&&zp(s,u,h)}o(i,t),await Ga(s,i,"getOobCode",WP,"EMAIL_PASSWORD_PROVIDER")}function vO(n,e){return Up.parseLink(e)?.operation==="EMAIL_SIGNIN"}async function _O(n,e,t){if(Lt(n.app))return Promise.reject(Vn(n));const s=Oe(n),i=co.credentialWithLink(e,t||yh());return _e(i._tenantId===(s.tenantId||null),s,"tenant-id-mismatch"),Bp(s,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bO(n,e){return nn(n,"POST","/v1/accounts:createAuthUri",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wO(n,e){const t=fv()?yh():"http://localhost",s={identifier:e,continueUri:t},{signinMethods:i}=await bO(Oe(n),s);return i||[]}async function TO(n,e){const t=Oe(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&zp(t.auth,i,e);const{email:o}=await KP(t.auth,i);o!==n.email&&await n.reload()}async function EO(n,e,t){const s=Oe(n),o={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&zp(s.auth,o,t);const{email:u}=await YP(s.auth,o);u!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IO(n,e){return nn(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SO(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const s=Oe(n),o={idToken:await s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},u=await Gi(s,IO(s.auth,o));s.displayName=u.displayName||null,s.photoURL=u.photoUrl||null;const h=s.providerData.find(({providerId:f})=>f==="password");h&&(h.displayName=s.displayName,h.photoURL=s.photoURL),await s._updateTokensIfNecessary(u)}function NO(n,e){const t=Oe(n);return Lt(t.auth.app)?Promise.reject(Vn(t.auth)):iA(t,e,null)}function AO(n,e){return iA(Oe(n),null,e)}async function iA(n,e,t){const{auth:s}=n,o={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(o.email=e),t&&(o.password=t);const u=await Gi(n,qP(s,o));await n._updateTokensIfNecessary(u,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RO(n){if(!n)return null;const{providerId:e}=n,t=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&n?.idToken){const i=Vp(n.idToken)?.firebase?.sign_in_provider;if(i){const o=i!=="anonymous"&&i!=="custom"?i:null;return new Vc(s,o)}}if(!e)return null;switch(e){case"facebook.com":return new CO(s,t);case"github.com":return new DO(s,t);case"google.com":return new kO(s,t);case"twitter.com":return new jO(s,t,n.screenName||null);case"custom":case"anonymous":return new Vc(s,null);default:return new Vc(s,e,t)}}class Vc{constructor(e,t,s={}){this.isNewUser=e,this.providerId=t,this.profile=s}}class aA extends Vc{constructor(e,t,s,i){super(e,t,s),this.username=i}}class CO extends Vc{constructor(e,t){super(e,"facebook.com",t)}}class DO extends aA{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}}class kO extends Vc{constructor(e,t){super(e,"google.com",t)}}class jO extends aA{constructor(e,t,s){super(e,"twitter.com",t,s)}}function PO(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:RO(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{constructor(e,t,s){this.type=e,this.credential=t,this.user=s}static _fromIdtoken(e,t){return new sl("enroll",e,t)}static _fromMfaPendingCredential(e){return new sl("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){if(e?.multiFactorSession){if(e.multiFactorSession?.pendingCredential)return sl._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(e.multiFactorSession?.idToken)return sl._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e,t,s){this.session=e,this.hints=t,this.signInResolver=s}static _fromError(e,t){const s=Qt(e),i=t.customData._serverResponse,o=(i.mfaInfo||[]).map(h=>Hh._fromServerResponse(s,h));_e(i.mfaPendingCredential,s,"internal-error");const u=sl._fromMfaPendingCredential(i.mfaPendingCredential);return new _v(u,o,async h=>{const f=await h._process(s,u);delete i.mfaInfo,delete i.mfaPendingCredential;const p={...i,idToken:f.idToken,refreshToken:f.refreshToken};switch(t.operationType){case"signIn":const x=await ar._fromIdTokenResponse(s,t.operationType,p);return await s._updateCurrentUser(x.user),x;case"reauthenticate":return _e(t.user,s,"internal-error"),ar._forOperation(t.user,t.operationType,p);default:Gn(s,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function OO(n,e){const t=Oe(n),s=e;return _e(e.customData.operationType,t,"argument-error"),_e(s.customData._serverResponse?.mfaPendingCredential,t,"argument-error"),_v._fromError(t,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GE(n,e){return nn(n,"POST","/v2/accounts/mfaEnrollment:start",tn(n,e))}function MO(n,e){return nn(n,"POST","/v2/accounts/mfaEnrollment:finalize",tn(n,e))}function VO(n,e){return nn(n,"POST","/v2/accounts/mfaEnrollment:withdraw",tn(n,e))}class bv{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(s=>Hh._fromServerResponse(e.auth,s)))})}static _fromUser(e){return new bv(e)}async getSession(){return sl._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const s=e,i=await this.getSession(),o=await Gi(this.user,s._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(o),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,s=await this.user.getIdToken();try{const i=await Gi(this.user,VO(this.user.auth,{idToken:s,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:o})=>o!==t),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}}const O0=new WeakMap;function LO(n){const e=Oe(n);return O0.has(e)||O0.set(e,bv._fromUser(e)),O0.get(e)}const fp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(fp,"1"),this.storage.removeItem(fp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UO=1e3,FO=10;class lA extends oA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=GN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),i=this.localCache[t];s!==i&&e(t,i,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,h,f)=>{this.notifyListeners(u,f)});return}const s=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const u=this.storage.getItem(s);!t&&this.localCache[s]===u||this.notifyListeners(s,u)},o=this.storage.getItem(s);_P()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,FO):i()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},UO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}lA.type="LOCAL";const wv=lA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA extends oA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}cA.type="SESSION";const dl=cA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BO(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const s=new qp(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:i,data:o}=t.data,u=this.handlersMap[i];if(!u?.size)return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:i});const h=Array.from(u).map(async p=>p(t.origin,o)),f=await BO(h);t.ports[0].postMessage({status:"done",eventId:s,eventType:i,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}qp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gh(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,u;return new Promise((h,f)=>{const p=Gh("",20);i.port1.start();const x=setTimeout(()=>{f(new Error("unsupported_event"))},s);u={messageChannel:i,onMessage(v){const b=v;if(b.data.eventId===p)switch(b.data.status){case"ack":clearTimeout(x),o=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),h(b.data.response);break;default:clearTimeout(x),clearTimeout(o),f(new Error("invalid_response"));break}}},this.handlers.add(u),i.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[i.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xn(){return window}function qO(n){xn().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tv(){return typeof xn().WorkerGlobalScope<"u"&&typeof xn().importScripts=="function"}async function HO(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function GO(){return navigator?.serviceWorker?.controller||null}function $O(){return Tv()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA="firebaseLocalStorageDb",KO=1,mp="firebaseLocalStorage",dA="fbase_key";class $h{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Hp(n,e){return n.transaction([mp],e?"readwrite":"readonly").objectStore(mp)}function QO(){const n=indexedDB.deleteDatabase(uA);return new $h(n).toPromise()}function ax(){const n=indexedDB.open(uA,KO);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(mp,{keyPath:dA})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(mp)?e(s):(s.close(),await QO(),e(await ax()))})})}async function $E(n,e,t){const s=Hp(n,!0).put({[dA]:e,value:t});return new $h(s).toPromise()}async function WO(n,e){const t=Hp(n,!1).get(e),s=await new $h(t).toPromise();return s===void 0?null:s.value}function KE(n,e){const t=Hp(n,!0).delete(e);return new $h(t).toPromise()}const YO=800,XO=3;class hA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ax(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>XO)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Tv()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=qp._getInstance($O()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await HO(),!this.activeServiceWorker)return;this.sender=new zO(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||GO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ax();return await $E(e,fp,"1"),await KE(e,fp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>$E(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>WO(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>KE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Hp(i,!1).getAll();return new $h(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)s.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!s.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),YO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}hA.type="LOCAL";const _h=hA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QE(n,e){return nn(n,"POST","/v2/accounts/mfaSignIn:start",tn(n,e))}function JO(n,e){return nn(n,"POST","/v2/accounts/mfaSignIn:finalize",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M0=KN("rcb"),ZO=new Fh(3e4,6e4);class eM{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!xn().grecaptcha?.render}load(e,t=""){return _e(tM(t),e,"argument-error"),this.shouldResolveImmediately(t)&&ME(xn().grecaptcha)?Promise.resolve(xn().grecaptcha):new Promise((s,i)=>{const o=xn().setTimeout(()=>{i(En(e,"network-request-failed"))},ZO.get());xn()[M0]=()=>{xn().clearTimeout(o),delete xn()[M0];const h=xn().grecaptcha;if(!h||!ME(h)){i(En(e,"internal-error"));return}const f=h.render;h.render=(p,x)=>{const v=f(p,x);return this.counter++,v},this.hostLanguage=t,s(h)};const u=`${NP()}?${mu({onload:M0,render:"explicit",hl:t})}`;pv(u).catch(()=>{clearTimeout(o),i(En(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!xn().grecaptcha?.render&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function tM(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class nM{async load(e){return new kP(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eh="recaptcha",sM={theme:"light",type:"image"};let rM=class{constructor(e,t,s={...sM}){this.parameters=s,this.type=eh,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Qt(e),this.isInvisible=this.parameters.size==="invisible",_e(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const i=typeof t=="string"?document.getElementById(t):t;_e(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new nM:new eM,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),s=t.getResponse(e);return s||new Promise(i=>{const o=u=>{u&&(this.tokenChangeListeners.delete(o),i(u))};this.tokenChangeListeners.add(o),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){_e(!this.parameters.sitekey,this.auth,"argument-error"),_e(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),_e(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(s=>s(t)),typeof e=="function")e(t);else if(typeof e=="string"){const s=xn()[e];typeof s=="function"&&s(t)}}}assertNotDestroyed(){_e(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){_e(fv()&&!Tv(),this.auth,"internal-error"),await iM(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await lP(this.auth);_e(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return _e(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function iM(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=ll._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function aM(n,e,t){if(Lt(n.app))return Promise.reject(Vn(n));const s=Qt(n),i=await Gp(s,e,Oe(t));return new Ev(i,o=>Bp(s,o))}async function oM(n,e,t){const s=Oe(n);await Fp(!1,s,"phone");const i=await Gp(s.auth,e,Oe(t));return new Ev(i,o=>nA(s,o))}async function lM(n,e,t){const s=Oe(n);if(Lt(s.auth.app))return Promise.reject(Vn(s.auth));const i=await Gp(s.auth,e,Oe(t));return new Ev(i,o=>sA(s,o))}async function Gp(n,e,t){if(!n._getRecaptchaConfig())try{await LP(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const i=s.session;if("phoneNumber"in s){_e(i.type==="enroll",n,"internal-error");const o={idToken:i.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await Ga(n,o,"mfaSmsEnrollment",async(p,x)=>{if(x.phoneEnrollmentInfo.captchaResponse===Zd){_e(t?.type===eh,p,"argument-error");const v=await V0(p,x,t);return GE(p,v)}return GE(p,x)},"PHONE_PROVIDER").catch(p=>Promise.reject(p))).phoneSessionInfo.sessionInfo}else{_e(i.type==="signin",n,"internal-error");const o=s.multiFactorHint?.uid||s.multiFactorUid;_e(o,n,"missing-multi-factor-info");const u={mfaPendingCredential:i.credential,mfaEnrollmentId:o,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await Ga(n,u,"mfaSmsSignIn",async(x,v)=>{if(v.phoneSignInInfo.captchaResponse===Zd){_e(t?.type===eh,x,"argument-error");const b=await V0(x,v,t);return QE(x,b)}return QE(x,v)},"PHONE_PROVIDER").catch(x=>Promise.reject(x))).phoneResponseInfo.sessionInfo}}else{const i={phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await Ga(n,i,"sendVerificationCode",async(f,p)=>{if(p.captchaResponse===Zd){_e(t?.type===eh,f,"argument-error");const x=await V0(f,p,t);return qE(f,x)}return qE(f,p)},"PHONE_PROVIDER").catch(f=>Promise.reject(f))).sessionInfo}}finally{t?._reset()}}async function cM(n,e){const t=Oe(n);if(Lt(t.auth.app))return Promise.reject(Vn(t.auth));await gv(t,e)}async function V0(n,e,t){_e(t.type===eh,n,"argument-error");const s=await t.verify();_e(typeof s=="string",n,"argument-error");const i={...e};if("phoneEnrollmentInfo"in i){const o=i.phoneEnrollmentInfo.phoneNumber,u=i.phoneEnrollmentInfo.captchaResponse,h=i.phoneEnrollmentInfo.clientType,f=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:s,captchaResponse:u,clientType:h,recaptchaVersion:f}}),i}else if("phoneSignInInfo"in i){const o=i.phoneSignInInfo.captchaResponse,u=i.phoneSignInInfo.clientType,h=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:s,captchaResponse:o,clientType:u,recaptchaVersion:h}}),i}else return Object.assign(i,{recaptchaToken:s}),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hl=class Hm{constructor(e){this.providerId=Hm.PROVIDER_ID,this.auth=Qt(e)}verifyPhoneNumber(e,t){return Gp(this.auth,e,Oe(t))}static credential(e,t){return ll._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Hm.credentialFromTaggedObject(t)}static credentialFromError(e){return Hm.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:s}=e;return t&&s?ll._fromTokenResponse(t,s):null}};hl.PROVIDER_ID="phone";hl.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nl(n,e){return e?Ls(e):(_e(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv extends gu{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Fi(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Fi(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Fi(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function uM(n){return tA(n.auth,new Iv(n),n.bypassAuthState)}function dM(n){const{auth:e,user:t}=n;return _e(t,e,"internal-error"),eA(t,new Iv(n),n.bypassAuthState)}async function hM(n){const{auth:e,user:t}=n;return _e(t,e,"internal-error"),gv(t,new Iv(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(e,t,s,i,o=!1){this.auth=e,this.resolver=s,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:i,tenantId:o,error:u,type:h}=e;if(u){this.reject(u);return}const f={auth:this.auth,requestUri:t,sessionId:s,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return uM;case"linkViaPopup":case"linkViaRedirect":return hM;case"reauthViaPopup":case"reauthViaRedirect":return dM;default:Gn(this.auth,"internal-error")}}resolve(e){Ar(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ar(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fM=new Fh(2e3,1e4);async function mM(n,e,t){if(Lt(n.app))return Promise.reject(En(n,"operation-not-supported-in-this-environment"));const s=Qt(n);pu(n,e,ea);const i=Nl(s,t);return new Vi(s,"signInViaPopup",e,i).executeNotNull()}async function pM(n,e,t){const s=Oe(n);if(Lt(s.auth.app))return Promise.reject(En(s.auth,"operation-not-supported-in-this-environment"));pu(s.auth,e,ea);const i=Nl(s.auth,t);return new Vi(s.auth,"reauthViaPopup",e,i,s).executeNotNull()}async function gM(n,e,t){const s=Oe(n);pu(s.auth,e,ea);const i=Nl(s.auth,t);return new Vi(s.auth,"linkViaPopup",e,i,s).executeNotNull()}class Vi extends fA{constructor(e,t,s,i,o){super(e,t,i,o),this.provider=s,this.authWindow=null,this.pollId=null,Vi.currentPopupAction&&Vi.currentPopupAction.cancel(),Vi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _e(e,this.auth,"internal-error"),e}async onExecution(){Ar(this.filter.length===1,"Popup operations only handle one event");const e=Gh();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(En(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(En(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Vi.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(En(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,fM.get())};e()}}Vi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yM="pendingRedirect",th=new Map;class xM extends fA{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=th.get(this.auth._key());if(!e){try{const s=await vM(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}th.set(this.auth._key(),e)}return this.bypassAuthState||th.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function vM(n,e){const t=pA(e),s=mA(n);if(!await s._isAvailable())return!1;const i=await s._get(t)==="true";return await s._remove(t),i}async function Sv(n,e){return mA(n)._set(pA(e),"true")}function _M(){th.clear()}function Nv(n,e){th.set(n._key(),e)}function mA(n){return Ls(n._redirectPersistence)}function pA(n){return ol(yM,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bM(n,e,t){return wM(n,e,t)}async function wM(n,e,t){if(Lt(n.app))return Promise.reject(Vn(n));const s=Qt(n);pu(n,e,ea),await s._initializationPromise;const i=Nl(s,t);return await Sv(i,s),i._openRedirect(s,e,"signInViaRedirect")}function TM(n,e,t){return EM(n,e,t)}async function EM(n,e,t){const s=Oe(n);if(pu(s.auth,e,ea),Lt(s.auth.app))return Promise.reject(Vn(s.auth));await s.auth._initializationPromise;const i=Nl(s.auth,t);await Sv(i,s.auth);const o=await gA(s);return i._openRedirect(s.auth,e,"reauthViaRedirect",o)}function IM(n,e,t){return SM(n,e,t)}async function SM(n,e,t){const s=Oe(n);pu(s.auth,e,ea),await s.auth._initializationPromise;const i=Nl(s.auth,t);await Fp(!1,s,e.providerId),await Sv(i,s.auth);const o=await gA(s);return i._openRedirect(s.auth,e,"linkViaRedirect",o)}async function NM(n,e){return await Qt(n)._initializationPromise,$p(n,e,!1)}async function $p(n,e,t=!1){if(Lt(n.app))return Promise.reject(Vn(n));const s=Qt(n),i=Nl(s,e),u=await new xM(s,i,t).execute();return u&&!t&&(delete u.user._redirectEventId,await s._persistUserIfCurrent(u.user),await s._setRedirectUser(null,e)),u}async function gA(n){const e=Gh(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AM=600*1e3;class yA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!RM(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!xA(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";t.onError(En(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=AM&&this.cachedEventUids.clear(),this.cachedEventUids.has(WE(e))}saveEventToCache(e){this.cachedEventUids.add(WE(e)),this.lastProcessedEventTime=Date.now()}}function WE(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function xA({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function RM(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return xA(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vA(n,e={}){return nn(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CM=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,DM=/^https?/;async function kM(n){if(n.config.emulator)return;const{authorizedDomains:e}=await vA(n);for(const t of e)try{if(jM(t))return}catch{}Gn(n,"unauthorized-domain")}function jM(n){const e=yh(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===s}if(!DM.test(t))return!1;if(CM.test(n))return s===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PM=new Fh(3e4,6e4);function YE(){const n=xn().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function OM(n){return new Promise((e,t)=>{function s(){YE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{YE(),t(En(n,"network-request-failed"))},timeout:PM.get()})}if(xn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(xn().gapi?.load)s();else{const i=KN("iframefcb");return xn()[i]=()=>{gapi.load?s():t(En(n,"network-request-failed"))},pv(`${RP()}?onload=${i}`).catch(o=>t(o))}}).catch(e=>{throw Gm=null,e})}let Gm=null;function MM(n){return Gm=Gm||OM(n),Gm}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VM=new Fh(5e3,15e3),LM="__/auth/iframe",UM="emulator/auth/iframe",FM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},BM=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function zM(n){const e=n.config;_e(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?mv(e,UM):`https://${n.config.authDomain}/${LM}`,s={apiKey:e.apiKey,appName:n.name,v:Ji},i=BM.get(n.config.apiHost);i&&(s.eid=i);const o=n._getFrameworks();return o.length&&(s.fw=o.join(",")),`${t}?${mu(s).slice(1)}`}async function qM(n){const e=await MM(n),t=xn().gapi;return _e(t,n,"internal-error"),e.open({where:document.body,url:zM(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:FM,dontclear:!0},s=>new Promise(async(i,o)=>{await s.restyle({setHideOnLeave:!1});const u=En(n,"network-request-failed"),h=xn().setTimeout(()=>{o(u)},VM.get());function f(){xn().clearTimeout(h),i(s)}s.ping(f).then(f,()=>{o(u)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HM={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},GM=500,$M=600,KM="_blank",QM="http://localhost";class XE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function WM(n,e,t,s=GM,i=$M){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),u=Math.max((window.screen.availWidth-s)/2,0).toString();let h="";const f={...HM,width:s.toString(),height:i.toString(),top:o,left:u},p=Kt().toLowerCase();t&&(h=BN(p)?KM:t),UN(p)&&(e=e||QM,f.scrollbars="yes");const x=Object.entries(f).reduce((b,[I,N])=>`${b}${I}=${N},`,"");if(vP(p)&&h!=="_self")return YM(e||"",h),new XE(null);const v=window.open(e||"",h,x);_e(v,n,"popup-blocked");try{v.focus()}catch{}return new XE(v)}function YM(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XM="__/auth/handler",JM="emulator/auth/handler",ZM=encodeURIComponent("fac");async function ox(n,e,t,s,i,o){_e(n.config.authDomain,n,"auth-domain-config-required"),_e(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:Ji,eventId:i};if(e instanceof ea){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",Sj(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,v]of Object.entries(o||{}))u[x]=v}if(e instanceof yu){const x=e.getScopes().filter(v=>v!=="");x.length>0&&(u.scopes=x.join(","))}n.tenantId&&(u.tid=n.tenantId);const h=u;for(const x of Object.keys(h))h[x]===void 0&&delete h[x];const f=await n._getAppCheckToken(),p=f?`#${ZM}=${encodeURIComponent(f)}`:"";return`${eV(n)}?${mu(h).slice(1)}${p}`}function eV({config:n}){return n.emulator?mv(n,JM):`https://${n.authDomain}/${XM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L0="webStorageSupport";class tV{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=dl,this._completeRedirectFn=$p,this._overrideRedirectResult=Nv}async _openPopup(e,t,s,i){Ar(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await ox(e,t,s,yh(),i);return WM(e,o,Gh())}async _openRedirect(e,t,s,i){await this._originValidation(e);const o=await ox(e,t,s,yh(),i);return qO(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(Ar(o,"If manager is not set, promise should be"),o)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await qM(e),s=new yA(e);return t.register("authEvent",i=>(_e(i?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(L0,{type:L0},i=>{const o=i?.[0]?.[L0];o!==void 0&&t(!!o),Gn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=kM(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return GN()||FN()||zh()}}const nV=tV;class sV{constructor(e){this.factorId=e}_process(e,t,s){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,s);case"signin":return this._finalizeSignIn(e,t.credential);default:return si("unexpected MultiFactorSessionType")}}}class Av extends sV{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Av(e)}_finalizeEnroll(e,t,s){return MO(e,{idToken:t,displayName:s,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return JO(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class _A{constructor(){}static assertion(e){return Av._fromCredential(e)}}_A.FACTOR_ID="phone";var JE="@firebase/auth",ZE="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){_e(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iV(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function aV(n){Hi(new ir("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:u,authDomain:h}=s.options;_e(u&&!u.includes(":"),"invalid-api-key",{appName:s.name});const f={apiKey:u,authDomain:h,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$N(n)},p=new IP(s,i,o,f);return UP(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),Hi(new ir("auth-internal",e=>{const t=Qt(e.getProvider("auth").getImmediate());return(s=>new rV(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fs(JE,ZE,iV(n)),Fs(JE,ZE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oV=300;pj("authIdTokenMaxAge");function lV(){return document.getElementsByTagName("head")?.[0]??document}SP({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=i=>{const o=En("internal-error");o.customData=i,t(o)},s.type="text/javascript",s.charset="UTF-8",lV().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});aV("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fl(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cV=2e3;async function uV(n,e,t){const{BuildInfo:s}=fl();Ar(e.sessionId,"AuthEvent did not contain a session ID");const i=await pV(e.sessionId),o={};return zh()?o.ibi=s.packageName:Bh()?o.apn=s.packageName:Gn(n,"operation-not-supported-in-this-environment"),s.displayName&&(o.appDisplayName=s.displayName),o.sessionId=i,ox(n,t,e.type,void 0,e.eventId??void 0,o)}async function dV(n){const{BuildInfo:e}=fl(),t={};zh()?t.iosBundleId=e.packageName:Bh()?t.androidPackageName=e.packageName:Gn(n,"operation-not-supported-in-this-environment"),await vA(n,t)}function hV(n){const{cordova:e}=fl();return new Promise(t=>{e.plugins.browsertab.isAvailable(s=>{let i=null;s?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,xP()?"_blank":"_system","location=yes"),t(i)})})}async function fV(n,e,t){const{cordova:s}=fl();let i=()=>{};try{await new Promise((o,u)=>{let h=null;function f(){o();const v=s.plugins.browsertab?.close;typeof v=="function"&&v(),typeof t?.close=="function"&&t.close()}function p(){h||(h=window.setTimeout(()=>{u(En(n,"redirect-cancelled-by-user"))},cV))}function x(){document?.visibilityState==="visible"&&p()}e.addPassiveListener(f),document.addEventListener("resume",p,!1),Bh()&&document.addEventListener("visibilitychange",x,!1),i=()=>{e.removePassiveListener(f),document.removeEventListener("resume",p,!1),document.removeEventListener("visibilitychange",x,!1),h&&window.clearTimeout(h)}})}finally{i()}}function mV(n){const e=fl();_e(typeof e?.universalLinks?.subscribe=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),_e(typeof e?.BuildInfo?.packageName<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),_e(typeof e?.cordova?.plugins?.browsertab?.openUrl=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),_e(typeof e?.cordova?.plugins?.browsertab?.isAvailable=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),_e(typeof e?.cordova?.InAppBrowser?.open=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function pV(n){const e=gV(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}function gV(n){if(Ar(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let s=0;s<n.length;s++)t[s]=n.charCodeAt(s);return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yV=20;class xV extends yA{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function vV(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:wV(),postBody:null,tenantId:n.tenantId,error:En(n,"no-auth-event")}}function _V(n,e){return lx()._set(cx(n),e)}async function eI(n){const e=await lx()._get(cx(n));return e&&await lx()._remove(cx(n)),e}function bV(n,e){const t=EV(e);if(t.includes("/__/auth/callback")){const s=$m(t),o=(s.firebaseError?TV(decodeURIComponent(s.firebaseError)):null)?.code?.split("auth/")?.[1],u=o?En(o):null;return u?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:u,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:t,postBody:null}}return null}function wV(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<yV;t++){const s=Math.floor(Math.random()*e.length);n.push(e.charAt(s))}return n.join("")}function lx(){return Ls(wv)}function cx(n){return ol("authEvent",n.config.apiKey,n.name)}function TV(n){try{return JSON.parse(n)}catch{return null}}function EV(n){const e=$m(n),t=e.link?decodeURIComponent(e.link):void 0,s=$m(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return $m(i).link||i||s||t||n}function $m(n){if(!n?.includes("?"))return{};const[e,...t]=n.split("?");return jc(t.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IV=500;class SV{constructor(){this._redirectPersistence=dl,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=$p,this._overrideRedirectResult=Nv}async _initialize(e){const t=e._key();let s=this.eventManagers.get(t);return s||(s=new xV(e),this.eventManagers.set(t,s),this.attachCallbackListeners(e,s)),s}_openPopup(e){Gn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,s,i){mV(e);const o=await this._initialize(e);await o.initialized(),o.resetRedirect(),_M(),await this._originValidation(e);const u=vV(e,s,i);await _V(e,u);const h=await uV(e,u,t),f=await hV(h);return fV(e,o,f)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=dV(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:s,handleOpenURL:i,BuildInfo:o}=fl(),u=setTimeout(async()=>{await eI(e),t.onEvent(tI())},IV),h=async x=>{clearTimeout(u);const v=await eI(e);let b=null;v&&x?.url&&(b=bV(v,x.url)),t.onEvent(b||tI())};typeof s<"u"&&typeof s.subscribe=="function"&&s.subscribe(null,h);const f=i,p=`${o.packageName.toLowerCase()}://`;fl().handleOpenURL=async x=>{if(x.toLowerCase().startsWith(p)&&h({url:x}),typeof f=="function")try{f(x)}catch(v){console.error(v)}}}}const NV=SV;function tI(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:En("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AV(n,e){Qt(n)._logFramework(e)}var RV="@firebase/auth-compat",CV="0.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DV=1e3;function nh(){return self?.location?.protocol||null}function kV(){return nh()==="http:"||nh()==="https:"}function bA(n=Kt()){return!!((nh()==="file:"||nh()==="ionic:"||nh()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function jV(){return iv()||Op()}function PV(){return fN()&&document?.documentMode===11}function OV(n=Kt()){return/Edge\/\d+/.test(n)}function MV(n=Kt()){return PV()||OV(n)}function wA(){try{const n=self.localStorage,e=Gh();if(n)return n.setItem(e,"1"),n.removeItem(e),MV()?mh():!0}catch{return Rv()&&mh()}return!1}function Rv(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function U0(){return(kV()||hN()||bA())&&!jV()&&wA()&&!Rv()}function TA(){return bA()&&typeof document<"u"}async function VV(){return TA()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},DV);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function LV(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vs={LOCAL:"local",NONE:"none",SESSION:"session"},jd=_e,EA="persistence";function UV(n,e){if(jd(Object.values(Vs).includes(e),n,"invalid-persistence-type"),iv()){jd(e!==Vs.SESSION,n,"unsupported-persistence-type");return}if(Op()){jd(e===Vs.NONE,n,"unsupported-persistence-type");return}if(Rv()){jd(e===Vs.NONE||e===Vs.LOCAL&&mh(),n,"unsupported-persistence-type");return}jd(e===Vs.NONE||wA(),n,"unsupported-persistence-type")}async function ux(n){await n._initializationPromise;const e=IA(),t=ol(EA,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistenceType())}function FV(n,e){const t=IA();if(!t)return[];const s=ol(EA,n,e);switch(t.getItem(s)){case Vs.NONE:return[Gc];case Vs.LOCAL:return[_h,dl];case Vs.SESSION:return[dl];default:return[]}}function IA(){try{return LV()?.sessionStorage||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BV=_e;class Ba{constructor(){this.browserResolver=Ls(nV),this.cordovaResolver=Ls(NV),this.underlyingResolver=null,this._redirectPersistence=dl,this._completeRedirectFn=$p,this._overrideRedirectResult=Nv}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,s,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,s,i)}async _openRedirect(e,t,s,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,s,i)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return TA()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return BV(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await VV();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SA(n){return n.unwrap()}function zV(n){return n.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qV(n){return NA(n)}function HV(n,e){const t=e.customData?._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){const s=e;s.resolver=new GV(n,OO(n,e))}else if(t){const s=NA(e),i=e;s&&(i.credential=s,i.tenantId=t.tenantId||void 0,i.email=t.email||void 0,i.phoneNumber=t.phoneNumber||void 0)}}function NA(n){const{_tokenResponse:e}=n instanceof ts?n.customData:n;if(!e)return null;if(!(n instanceof ts)&&"temporaryProof"in e&&"phoneNumber"in e)return hl.credentialFromResult(n);const t=e.providerId;if(!t||t===Dd.PASSWORD)return null;let s;switch(t){case Dd.GOOGLE:s=Zr;break;case Dd.FACEBOOK:s=Jr;break;case Dd.GITHUB:s=ei;break;case Dd.TWITTER:s=ti;break;default:const{oauthIdToken:i,oauthAccessToken:o,oauthTokenSecret:u,pendingToken:h,nonce:f}=e;return!o&&!u&&!i&&!h?null:h?t.startsWith("saml.")?$c._create(t,h):ui._fromParams({providerId:t,signInMethod:t,pendingToken:h,idToken:i,accessToken:o}):new Mc(t).credential({idToken:i,accessToken:o,rawNonce:f})}return n instanceof ts?s.credentialFromError(n):s.credentialFromResult(n)}function xs(n,e){return e.catch(t=>{throw t instanceof ts&&HV(n,t),t}).then(t=>{const s=t.operationType,i=t.user;return{operationType:s,credential:qV(t),additionalUserInfo:PO(t),user:Kp.getOrCreate(i)}})}async function dx(n,e){const t=await e;return{verificationId:t.verificationId,confirm:s=>xs(n,t.confirm(s))}}class GV{constructor(e,t){this.resolver=t,this.auth=zV(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return xs(SA(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kp=class Gd{constructor(e){this._delegate=e,this.multiFactor=LO(e)}static getOrCreate(e){return Gd.USER_MAP.has(e)||Gd.USER_MAP.set(e,new Gd(e)),Gd.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return xs(this.auth,nA(this._delegate,e))}async linkWithPhoneNumber(e,t){return dx(this.auth,oM(this._delegate,e,t))}async linkWithPopup(e){return xs(this.auth,gM(this._delegate,e,Ba))}async linkWithRedirect(e){return await ux(Qt(this.auth)),IM(this._delegate,e,Ba)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return xs(this.auth,sA(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return dx(this.auth,lM(this._delegate,e,t))}reauthenticateWithPopup(e){return xs(this.auth,pM(this._delegate,e,Ba))}async reauthenticateWithRedirect(e){return await ux(Qt(this.auth)),TM(this._delegate,e,Ba)}sendEmailVerification(e){return TO(this._delegate,e)}async unlink(e){return await cO(this._delegate,e),this}updateEmail(e){return NO(this._delegate,e)}updatePassword(e){return AO(this._delegate,e)}updatePhoneNumber(e){return cM(this._delegate,e)}updateProfile(e){return SO(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return EO(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Kp.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pd=_e;class hx{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:s}=e.options;Pd(s,"invalid-api-key",{appName:e.name}),Pd(s,"invalid-api-key",{appName:e.name});const i=typeof window<"u"?Ba:void 0;this._delegate=t.initialize({options:{persistence:$V(s,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(J4),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Kp.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){FP(this._delegate,e,t)}applyActionCode(e){return mO(this._delegate,e)}checkActionCode(e){return rA(this._delegate,e)}confirmPasswordReset(e,t){return fO(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return xs(this._delegate,gO(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return wO(this._delegate,e)}isSignInWithEmailLink(e){return vO(this._delegate,e)}async getRedirectResult(){Pd(U0(),this._delegate,"operation-not-supported-in-this-environment");const e=await NM(this._delegate,Ba);return e?xs(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){AV(this._delegate,e)}onAuthStateChanged(e,t,s){const{next:i,error:o,complete:u}=nI(e,t,s);return this._delegate.onAuthStateChanged(i,o,u)}onIdTokenChanged(e,t,s){const{next:i,error:o,complete:u}=nI(e,t,s);return this._delegate.onIdTokenChanged(i,o,u)}sendSignInLinkToEmail(e,t){return xO(this._delegate,e,t)}sendPasswordResetEmail(e,t){return hO(this._delegate,e,t||void 0)}async setPersistence(e){UV(this._delegate,e);let t;switch(e){case Vs.SESSION:t=dl;break;case Vs.LOCAL:t=await Ls(_h)._isAvailable()?_h:wv;break;case Vs.NONE:t=Gc;break;default:return Gn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return xs(this._delegate,lO(this._delegate))}signInWithCredential(e){return xs(this._delegate,Bp(this._delegate,e))}signInWithCustomToken(e){return xs(this._delegate,dO(this._delegate,e))}signInWithEmailAndPassword(e,t){return xs(this._delegate,yO(this._delegate,e,t))}signInWithEmailLink(e,t){return xs(this._delegate,_O(this._delegate,e,t))}signInWithPhoneNumber(e,t){return dx(this._delegate,aM(this._delegate,e,t))}async signInWithPopup(e){return Pd(U0(),this._delegate,"operation-not-supported-in-this-environment"),xs(this._delegate,mM(this._delegate,e,Ba))}async signInWithRedirect(e){return Pd(U0(),this._delegate,"operation-not-supported-in-this-environment"),await ux(this._delegate),bM(this._delegate,e,Ba)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return pO(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}hx.Persistence=Vs;function nI(n,e,t){let s=n;typeof n!="function"&&({next:s,error:e,complete:t}=n);const i=s;return{next:u=>i(u&&Kp.getOrCreate(u)),error:e,complete:t}}function $V(n,e){const t=FV(n,e);if(typeof self<"u"&&!t.includes(_h)&&t.push(_h),typeof window<"u")for(const s of[wv,dl])t.includes(s)||t.push(s);return t.includes(Gc)||t.push(Gc),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{static credential(e,t){return hl.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new hl(SA(Zn.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}Cv.PHONE_SIGN_IN_METHOD=hl.PHONE_SIGN_IN_METHOD;Cv.PROVIDER_ID=hl.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KV=_e;class QV{constructor(e,t,s=Zn.app()){KV(s.options?.apiKey,"invalid-api-key",{appName:s.name}),this._delegate=new rM(s.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WV="auth-compat";function YV(n){n.INTERNAL.registerComponent(new ir(WV,e=>{const t=e.getProvider("app-compat").getImmediate(),s=e.getProvider("auth");return new hx(t,s)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:vc.EMAIL_SIGNIN,PASSWORD_RESET:vc.PASSWORD_RESET,RECOVER_EMAIL:vc.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:vc.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:vc.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:vc.VERIFY_EMAIL}},EmailAuthProvider:co,FacebookAuthProvider:Jr,GithubAuthProvider:ei,GoogleAuthProvider:Zr,OAuthProvider:Mc,SAMLAuthProvider:dp,PhoneAuthProvider:Cv,PhoneMultiFactorGenerator:_A,RecaptchaVerifier:QV,TwitterAuthProvider:ti,Auth:hx,AuthCredential:gu,Error:ts}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(RV,CV)}YV(Zn);var sI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $a,AA;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(L,k){function D(){}D.prototype=k.prototype,L.D=k.prototype,L.prototype=new D,L.prototype.constructor=L,L.C=function(M,B,G){for(var z=Array(arguments.length-2),he=2;he<arguments.length;he++)z[he-2]=arguments[he];return k.prototype[B].apply(M,z)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(L,k,D){D||(D=0);var M=Array(16);if(typeof k=="string")for(var B=0;16>B;++B)M[B]=k.charCodeAt(D++)|k.charCodeAt(D++)<<8|k.charCodeAt(D++)<<16|k.charCodeAt(D++)<<24;else for(B=0;16>B;++B)M[B]=k[D++]|k[D++]<<8|k[D++]<<16|k[D++]<<24;k=L.g[0],D=L.g[1],B=L.g[2];var G=L.g[3],z=k+(G^D&(B^G))+M[0]+3614090360&4294967295;k=D+(z<<7&4294967295|z>>>25),z=G+(B^k&(D^B))+M[1]+3905402710&4294967295,G=k+(z<<12&4294967295|z>>>20),z=B+(D^G&(k^D))+M[2]+606105819&4294967295,B=G+(z<<17&4294967295|z>>>15),z=D+(k^B&(G^k))+M[3]+3250441966&4294967295,D=B+(z<<22&4294967295|z>>>10),z=k+(G^D&(B^G))+M[4]+4118548399&4294967295,k=D+(z<<7&4294967295|z>>>25),z=G+(B^k&(D^B))+M[5]+1200080426&4294967295,G=k+(z<<12&4294967295|z>>>20),z=B+(D^G&(k^D))+M[6]+2821735955&4294967295,B=G+(z<<17&4294967295|z>>>15),z=D+(k^B&(G^k))+M[7]+4249261313&4294967295,D=B+(z<<22&4294967295|z>>>10),z=k+(G^D&(B^G))+M[8]+1770035416&4294967295,k=D+(z<<7&4294967295|z>>>25),z=G+(B^k&(D^B))+M[9]+2336552879&4294967295,G=k+(z<<12&4294967295|z>>>20),z=B+(D^G&(k^D))+M[10]+4294925233&4294967295,B=G+(z<<17&4294967295|z>>>15),z=D+(k^B&(G^k))+M[11]+2304563134&4294967295,D=B+(z<<22&4294967295|z>>>10),z=k+(G^D&(B^G))+M[12]+1804603682&4294967295,k=D+(z<<7&4294967295|z>>>25),z=G+(B^k&(D^B))+M[13]+4254626195&4294967295,G=k+(z<<12&4294967295|z>>>20),z=B+(D^G&(k^D))+M[14]+2792965006&4294967295,B=G+(z<<17&4294967295|z>>>15),z=D+(k^B&(G^k))+M[15]+1236535329&4294967295,D=B+(z<<22&4294967295|z>>>10),z=k+(B^G&(D^B))+M[1]+4129170786&4294967295,k=D+(z<<5&4294967295|z>>>27),z=G+(D^B&(k^D))+M[6]+3225465664&4294967295,G=k+(z<<9&4294967295|z>>>23),z=B+(k^D&(G^k))+M[11]+643717713&4294967295,B=G+(z<<14&4294967295|z>>>18),z=D+(G^k&(B^G))+M[0]+3921069994&4294967295,D=B+(z<<20&4294967295|z>>>12),z=k+(B^G&(D^B))+M[5]+3593408605&4294967295,k=D+(z<<5&4294967295|z>>>27),z=G+(D^B&(k^D))+M[10]+38016083&4294967295,G=k+(z<<9&4294967295|z>>>23),z=B+(k^D&(G^k))+M[15]+3634488961&4294967295,B=G+(z<<14&4294967295|z>>>18),z=D+(G^k&(B^G))+M[4]+3889429448&4294967295,D=B+(z<<20&4294967295|z>>>12),z=k+(B^G&(D^B))+M[9]+568446438&4294967295,k=D+(z<<5&4294967295|z>>>27),z=G+(D^B&(k^D))+M[14]+3275163606&4294967295,G=k+(z<<9&4294967295|z>>>23),z=B+(k^D&(G^k))+M[3]+4107603335&4294967295,B=G+(z<<14&4294967295|z>>>18),z=D+(G^k&(B^G))+M[8]+1163531501&4294967295,D=B+(z<<20&4294967295|z>>>12),z=k+(B^G&(D^B))+M[13]+2850285829&4294967295,k=D+(z<<5&4294967295|z>>>27),z=G+(D^B&(k^D))+M[2]+4243563512&4294967295,G=k+(z<<9&4294967295|z>>>23),z=B+(k^D&(G^k))+M[7]+1735328473&4294967295,B=G+(z<<14&4294967295|z>>>18),z=D+(G^k&(B^G))+M[12]+2368359562&4294967295,D=B+(z<<20&4294967295|z>>>12),z=k+(D^B^G)+M[5]+4294588738&4294967295,k=D+(z<<4&4294967295|z>>>28),z=G+(k^D^B)+M[8]+2272392833&4294967295,G=k+(z<<11&4294967295|z>>>21),z=B+(G^k^D)+M[11]+1839030562&4294967295,B=G+(z<<16&4294967295|z>>>16),z=D+(B^G^k)+M[14]+4259657740&4294967295,D=B+(z<<23&4294967295|z>>>9),z=k+(D^B^G)+M[1]+2763975236&4294967295,k=D+(z<<4&4294967295|z>>>28),z=G+(k^D^B)+M[4]+1272893353&4294967295,G=k+(z<<11&4294967295|z>>>21),z=B+(G^k^D)+M[7]+4139469664&4294967295,B=G+(z<<16&4294967295|z>>>16),z=D+(B^G^k)+M[10]+3200236656&4294967295,D=B+(z<<23&4294967295|z>>>9),z=k+(D^B^G)+M[13]+681279174&4294967295,k=D+(z<<4&4294967295|z>>>28),z=G+(k^D^B)+M[0]+3936430074&4294967295,G=k+(z<<11&4294967295|z>>>21),z=B+(G^k^D)+M[3]+3572445317&4294967295,B=G+(z<<16&4294967295|z>>>16),z=D+(B^G^k)+M[6]+76029189&4294967295,D=B+(z<<23&4294967295|z>>>9),z=k+(D^B^G)+M[9]+3654602809&4294967295,k=D+(z<<4&4294967295|z>>>28),z=G+(k^D^B)+M[12]+3873151461&4294967295,G=k+(z<<11&4294967295|z>>>21),z=B+(G^k^D)+M[15]+530742520&4294967295,B=G+(z<<16&4294967295|z>>>16),z=D+(B^G^k)+M[2]+3299628645&4294967295,D=B+(z<<23&4294967295|z>>>9),z=k+(B^(D|~G))+M[0]+4096336452&4294967295,k=D+(z<<6&4294967295|z>>>26),z=G+(D^(k|~B))+M[7]+1126891415&4294967295,G=k+(z<<10&4294967295|z>>>22),z=B+(k^(G|~D))+M[14]+2878612391&4294967295,B=G+(z<<15&4294967295|z>>>17),z=D+(G^(B|~k))+M[5]+4237533241&4294967295,D=B+(z<<21&4294967295|z>>>11),z=k+(B^(D|~G))+M[12]+1700485571&4294967295,k=D+(z<<6&4294967295|z>>>26),z=G+(D^(k|~B))+M[3]+2399980690&4294967295,G=k+(z<<10&4294967295|z>>>22),z=B+(k^(G|~D))+M[10]+4293915773&4294967295,B=G+(z<<15&4294967295|z>>>17),z=D+(G^(B|~k))+M[1]+2240044497&4294967295,D=B+(z<<21&4294967295|z>>>11),z=k+(B^(D|~G))+M[8]+1873313359&4294967295,k=D+(z<<6&4294967295|z>>>26),z=G+(D^(k|~B))+M[15]+4264355552&4294967295,G=k+(z<<10&4294967295|z>>>22),z=B+(k^(G|~D))+M[6]+2734768916&4294967295,B=G+(z<<15&4294967295|z>>>17),z=D+(G^(B|~k))+M[13]+1309151649&4294967295,D=B+(z<<21&4294967295|z>>>11),z=k+(B^(D|~G))+M[4]+4149444226&4294967295,k=D+(z<<6&4294967295|z>>>26),z=G+(D^(k|~B))+M[11]+3174756917&4294967295,G=k+(z<<10&4294967295|z>>>22),z=B+(k^(G|~D))+M[2]+718787259&4294967295,B=G+(z<<15&4294967295|z>>>17),z=D+(G^(B|~k))+M[9]+3951481745&4294967295,L.g[0]=L.g[0]+k&4294967295,L.g[1]=L.g[1]+(B+(z<<21&4294967295|z>>>11))&4294967295,L.g[2]=L.g[2]+B&4294967295,L.g[3]=L.g[3]+G&4294967295}s.prototype.u=function(L,k){k===void 0&&(k=L.length);for(var D=k-this.blockSize,M=this.B,B=this.h,G=0;G<k;){if(B==0)for(;G<=D;)i(this,L,G),G+=this.blockSize;if(typeof L=="string"){for(;G<k;)if(M[B++]=L.charCodeAt(G++),B==this.blockSize){i(this,M),B=0;break}}else for(;G<k;)if(M[B++]=L[G++],B==this.blockSize){i(this,M),B=0;break}}this.h=B,this.o+=k},s.prototype.v=function(){var L=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);L[0]=128;for(var k=1;k<L.length-8;++k)L[k]=0;var D=8*this.o;for(k=L.length-8;k<L.length;++k)L[k]=D&255,D/=256;for(this.u(L),L=Array(16),k=D=0;4>k;++k)for(var M=0;32>M;M+=8)L[D++]=this.g[k]>>>M&255;return L};function o(L,k){var D=h;return Object.prototype.hasOwnProperty.call(D,L)?D[L]:D[L]=k(L)}function u(L,k){this.h=k;for(var D=[],M=!0,B=L.length-1;0<=B;B--){var G=L[B]|0;M&&G==k||(D[B]=G,M=!1)}this.g=D}var h={};function f(L){return-128<=L&&128>L?o(L,function(k){return new u([k|0],0>k?-1:0)}):new u([L|0],0>L?-1:0)}function p(L){if(isNaN(L)||!isFinite(L))return v;if(0>L)return A(p(-L));for(var k=[],D=1,M=0;L>=D;M++)k[M]=L/D|0,D*=4294967296;return new u(k,0)}function x(L,k){if(L.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(L.charAt(0)=="-")return A(x(L.substring(1),k));if(0<=L.indexOf("-"))throw Error('number format error: interior "-" character');for(var D=p(Math.pow(k,8)),M=v,B=0;B<L.length;B+=8){var G=Math.min(8,L.length-B),z=parseInt(L.substring(B,B+G),k);8>G?(G=p(Math.pow(k,G)),M=M.j(G).add(p(z))):(M=M.j(D),M=M.add(p(z)))}return M}var v=f(0),b=f(1),I=f(16777216);n=u.prototype,n.m=function(){if(E(this))return-A(this).m();for(var L=0,k=1,D=0;D<this.g.length;D++){var M=this.i(D);L+=(0<=M?M:4294967296+M)*k,k*=4294967296}return L},n.toString=function(L){if(L=L||10,2>L||36<L)throw Error("radix out of range: "+L);if(N(this))return"0";if(E(this))return"-"+A(this).toString(L);for(var k=p(Math.pow(L,6)),D=this,M="";;){var B=V(D,k).g;D=C(D,B.j(k));var G=((0<D.g.length?D.g[0]:D.h)>>>0).toString(L);if(D=B,N(D))return G+M;for(;6>G.length;)G="0"+G;M=G+M}},n.i=function(L){return 0>L?0:L<this.g.length?this.g[L]:this.h};function N(L){if(L.h!=0)return!1;for(var k=0;k<L.g.length;k++)if(L.g[k]!=0)return!1;return!0}function E(L){return L.h==-1}n.l=function(L){return L=C(this,L),E(L)?-1:N(L)?0:1};function A(L){for(var k=L.g.length,D=[],M=0;M<k;M++)D[M]=~L.g[M];return new u(D,~L.h).add(b)}n.abs=function(){return E(this)?A(this):this},n.add=function(L){for(var k=Math.max(this.g.length,L.g.length),D=[],M=0,B=0;B<=k;B++){var G=M+(this.i(B)&65535)+(L.i(B)&65535),z=(G>>>16)+(this.i(B)>>>16)+(L.i(B)>>>16);M=z>>>16,G&=65535,z&=65535,D[B]=z<<16|G}return new u(D,D[D.length-1]&-2147483648?-1:0)};function C(L,k){return L.add(A(k))}n.j=function(L){if(N(this)||N(L))return v;if(E(this))return E(L)?A(this).j(A(L)):A(A(this).j(L));if(E(L))return A(this.j(A(L)));if(0>this.l(I)&&0>L.l(I))return p(this.m()*L.m());for(var k=this.g.length+L.g.length,D=[],M=0;M<2*k;M++)D[M]=0;for(M=0;M<this.g.length;M++)for(var B=0;B<L.g.length;B++){var G=this.i(M)>>>16,z=this.i(M)&65535,he=L.i(B)>>>16,Se=L.i(B)&65535;D[2*M+2*B]+=z*Se,q(D,2*M+2*B),D[2*M+2*B+1]+=G*Se,q(D,2*M+2*B+1),D[2*M+2*B+1]+=z*he,q(D,2*M+2*B+1),D[2*M+2*B+2]+=G*he,q(D,2*M+2*B+2)}for(M=0;M<k;M++)D[M]=D[2*M+1]<<16|D[2*M];for(M=k;M<2*k;M++)D[M]=0;return new u(D,0)};function q(L,k){for(;(L[k]&65535)!=L[k];)L[k+1]+=L[k]>>>16,L[k]&=65535,k++}function P(L,k){this.g=L,this.h=k}function V(L,k){if(N(k))throw Error("division by zero");if(N(L))return new P(v,v);if(E(L))return k=V(A(L),k),new P(A(k.g),A(k.h));if(E(k))return k=V(L,A(k)),new P(A(k.g),k.h);if(30<L.g.length){if(E(L)||E(k))throw Error("slowDivide_ only works with positive integers.");for(var D=b,M=k;0>=M.l(L);)D=F(D),M=F(M);var B=K(D,1),G=K(M,1);for(M=K(M,2),D=K(D,2);!N(M);){var z=G.add(M);0>=z.l(L)&&(B=B.add(D),G=z),M=K(M,1),D=K(D,1)}return k=C(L,B.j(k)),new P(B,k)}for(B=v;0<=L.l(k);){for(D=Math.max(1,Math.floor(L.m()/k.m())),M=Math.ceil(Math.log(D)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),G=p(D),z=G.j(k);E(z)||0<z.l(L);)D-=M,G=p(D),z=G.j(k);N(G)&&(G=b),B=B.add(G),L=C(L,z)}return new P(B,L)}n.A=function(L){return V(this,L).h},n.and=function(L){for(var k=Math.max(this.g.length,L.g.length),D=[],M=0;M<k;M++)D[M]=this.i(M)&L.i(M);return new u(D,this.h&L.h)},n.or=function(L){for(var k=Math.max(this.g.length,L.g.length),D=[],M=0;M<k;M++)D[M]=this.i(M)|L.i(M);return new u(D,this.h|L.h)},n.xor=function(L){for(var k=Math.max(this.g.length,L.g.length),D=[],M=0;M<k;M++)D[M]=this.i(M)^L.i(M);return new u(D,this.h^L.h)};function F(L){for(var k=L.g.length+1,D=[],M=0;M<k;M++)D[M]=L.i(M)<<1|L.i(M-1)>>>31;return new u(D,L.h)}function K(L,k){var D=k>>5;k%=32;for(var M=L.g.length-D,B=[],G=0;G<M;G++)B[G]=0<k?L.i(G+D)>>>k|L.i(G+D+1)<<32-k:L.i(G+D);return new u(B,L.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,AA=s,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.A,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=p,u.fromString=x,$a=u}).apply(typeof sI<"u"?sI:typeof self<"u"?self:typeof window<"u"?window:{});var Cm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var RA,$d,CA,Km,fx,DA,kA,jA;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(m,_,w){return m==Array.prototype||m==Object.prototype||(m[_]=w.value),m};function t(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof Cm=="object"&&Cm];for(var _=0;_<m.length;++_){var w=m[_];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var s=t(this);function i(m,_){if(_)e:{var w=s;m=m.split(".");for(var j=0;j<m.length-1;j++){var W=m[j];if(!(W in w))break e;w=w[W]}m=m[m.length-1],j=w[m],_=_(j),_!=j&&_!=null&&e(w,m,{configurable:!0,writable:!0,value:_})}}function o(m,_){m instanceof String&&(m+="");var w=0,j=!1,W={next:function(){if(!j&&w<m.length){var ae=w++;return{value:_(ae,m[ae]),done:!1}}return j=!0,{done:!0,value:void 0}}};return W[Symbol.iterator]=function(){return W},W}i("Array.prototype.values",function(m){return m||function(){return o(this,function(_,w){return w})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},h=this||self;function f(m){var _=typeof m;return _=_!="object"?_:m?Array.isArray(m)?"array":_:"null",_=="array"||_=="object"&&typeof m.length=="number"}function p(m){var _=typeof m;return _=="object"&&m!=null||_=="function"}function x(m,_,w){return m.call.apply(m.bind,arguments)}function v(m,_,w){if(!m)throw Error();if(2<arguments.length){var j=Array.prototype.slice.call(arguments,2);return function(){var W=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(W,j),m.apply(_,W)}}return function(){return m.apply(_,arguments)}}function b(m,_,w){return b=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?x:v,b.apply(null,arguments)}function I(m,_){var w=Array.prototype.slice.call(arguments,1);return function(){var j=w.slice();return j.push.apply(j,arguments),m.apply(this,j)}}function N(m,_){function w(){}w.prototype=_.prototype,m.aa=_.prototype,m.prototype=new w,m.prototype.constructor=m,m.Qb=function(j,W,ae){for(var be=Array(arguments.length-2),it=2;it<arguments.length;it++)be[it-2]=arguments[it];return _.prototype[W].apply(j,be)}}function E(m){const _=m.length;if(0<_){const w=Array(_);for(let j=0;j<_;j++)w[j]=m[j];return w}return[]}function A(m,_){for(let w=1;w<arguments.length;w++){const j=arguments[w];if(f(j)){const W=m.length||0,ae=j.length||0;m.length=W+ae;for(let be=0;be<ae;be++)m[W+be]=j[be]}else m.push(j)}}class C{constructor(_,w){this.i=_,this.j=w,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function q(m){return/^[\s\xa0]*$/.test(m)}function P(){var m=h.navigator;return m&&(m=m.userAgent)?m:""}function V(m){return V[" "](m),m}V[" "]=function(){};var F=P().indexOf("Gecko")!=-1&&!(P().toLowerCase().indexOf("webkit")!=-1&&P().indexOf("Edge")==-1)&&!(P().indexOf("Trident")!=-1||P().indexOf("MSIE")!=-1)&&P().indexOf("Edge")==-1;function K(m,_,w){for(const j in m)_.call(w,m[j],j,m)}function L(m,_){for(const w in m)_.call(void 0,m[w],w,m)}function k(m){const _={};for(const w in m)_[w]=m[w];return _}const D="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(m,_){let w,j;for(let W=1;W<arguments.length;W++){j=arguments[W];for(w in j)m[w]=j[w];for(let ae=0;ae<D.length;ae++)w=D[ae],Object.prototype.hasOwnProperty.call(j,w)&&(m[w]=j[w])}}function B(m){var _=1;m=m.split(":");const w=[];for(;0<_&&m.length;)w.push(m.shift()),_--;return m.length&&w.push(m.join(":")),w}function G(m){h.setTimeout(()=>{throw m},0)}function z(){var m=Ie;let _=null;return m.g&&(_=m.g,m.g=m.g.next,m.g||(m.h=null),_.next=null),_}class he{constructor(){this.h=this.g=null}add(_,w){const j=Se.get();j.set(_,w),this.h?this.h.next=j:this.g=j,this.h=j}}var Se=new C(()=>new J,m=>m.reset());class J{constructor(){this.next=this.g=this.h=null}set(_,w){this.h=_,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let ge,le=!1,Ie=new he,O=()=>{const m=h.Promise.resolve(void 0);ge=()=>{m.then(oe)}};var oe=()=>{for(var m;m=z();){try{m.h.call(m.g)}catch(w){G(w)}var _=Se;_.j(m),100>_.h&&(_.h++,m.next=_.g,_.g=m)}le=!1};function me(){this.s=this.s,this.C=this.C}me.prototype.s=!1,me.prototype.ma=function(){this.s||(this.s=!0,this.N())},me.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function te(m,_){this.type=m,this.g=this.target=_,this.defaultPrevented=!1}te.prototype.h=function(){this.defaultPrevented=!0};var we=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var m=!1,_=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const w=()=>{};h.addEventListener("test",w,_),h.removeEventListener("test",w,_)}catch{}return m}();function Ce(m,_){if(te.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m){var w=this.type=m.type,j=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;if(this.target=m.target||m.srcElement,this.g=_,_=m.relatedTarget){if(F){e:{try{V(_.nodeName);var W=!0;break e}catch{}W=!1}W||(_=null)}}else w=="mouseover"?_=m.fromElement:w=="mouseout"&&(_=m.toElement);this.relatedTarget=_,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=typeof m.pointerType=="string"?m.pointerType:Pe[m.pointerType]||"",this.state=m.state,this.i=m,m.defaultPrevented&&Ce.aa.h.call(this)}}N(Ce,te);var Pe={2:"touch",3:"pen",4:"mouse"};Ce.prototype.h=function(){Ce.aa.h.call(this);var m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var xt="closure_listenable_"+(1e6*Math.random()|0),rt=0;function Ot(m,_,w,j,W){this.listener=m,this.proxy=null,this.src=_,this.type=w,this.capture=!!j,this.ha=W,this.key=++rt,this.da=this.fa=!1}function ws(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function Ts(m){this.src=m,this.g={},this.h=0}Ts.prototype.add=function(m,_,w,j,W){var ae=m.toString();m=this.g[ae],m||(m=this.g[ae]=[],this.h++);var be=lr(m,_,j,W);return-1<be?(_=m[be],w||(_.fa=!1)):(_=new Ot(_,this.src,ae,!!j,W),_.fa=w,m.push(_)),_};function Es(m,_){var w=_.type;if(w in m.g){var j=m.g[w],W=Array.prototype.indexOf.call(j,_,void 0),ae;(ae=0<=W)&&Array.prototype.splice.call(j,W,1),ae&&(ws(_),m.g[w].length==0&&(delete m.g[w],m.h--))}}function lr(m,_,w,j){for(var W=0;W<m.length;++W){var ae=m[W];if(!ae.da&&ae.listener==_&&ae.capture==!!w&&ae.ha==j)return W}return-1}var Ne="closure_lm_"+(1e6*Math.random()|0),Je={};function ct(m,_,w,j,W){if(Array.isArray(_)){for(var ae=0;ae<_.length;ae++)ct(m,_[ae],w,j,W);return null}return w=kl(w),m&&m[xt]?m.K(_,w,p(j)?!!j.capture:!1,W):Yt(m,_,w,!1,j,W)}function Yt(m,_,w,j,W,ae){if(!_)throw Error("Invalid event type");var be=p(W)?!!W.capture:!!W,it=ur(m);if(it||(m[Ne]=it=new Ts(m)),w=it.add(_,w,j,be,ae),w.proxy)return w;if(j=It(),w.proxy=j,j.src=m,j.listener=w,m.addEventListener)we||(W=be),W===void 0&&(W=!1),m.addEventListener(_.toString(),j,W);else if(m.attachEvent)m.attachEvent(cr(_.toString()),j);else if(m.addListener&&m.removeListener)m.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return w}function It(){function m(w){return _.call(m.src,m.listener,w)}const _=yo;return m}function dt(m,_,w,j,W){if(Array.isArray(_))for(var ae=0;ae<_.length;ae++)dt(m,_[ae],w,j,W);else j=p(j)?!!j.capture:!!j,w=kl(w),m&&m[xt]?(m=m.i,_=String(_).toString(),_ in m.g&&(ae=m.g[_],w=lr(ae,w,j,W),-1<w&&(ws(ae[w]),Array.prototype.splice.call(ae,w,1),ae.length==0&&(delete m.g[_],m.h--)))):m&&(m=ur(m))&&(_=m.g[_.toString()],m=-1,_&&(m=lr(_,w,j,W)),(w=-1<m?_[m]:null)&&rn(w))}function rn(m){if(typeof m!="number"&&m&&!m.da){var _=m.src;if(_&&_[xt])Es(_.i,m);else{var w=m.type,j=m.proxy;_.removeEventListener?_.removeEventListener(w,j,m.capture):_.detachEvent?_.detachEvent(cr(w),j):_.addListener&&_.removeListener&&_.removeListener(j),(w=ur(_))?(Es(w,m),w.h==0&&(w.src=null,_[Ne]=null)):ws(m)}}}function cr(m){return m in Je?Je[m]:Je[m]="on"+m}function yo(m,_){if(m.da)m=!0;else{_=new Ce(_,this);var w=m.listener,j=m.ha||m.src;m.fa&&rn(m),m=w.call(j,_)}return m}function ur(m){return m=m[Ne],m instanceof Ts?m:null}var xo="__closure_events_fn_"+(1e9*Math.random()>>>0);function kl(m){return typeof m=="function"?m:(m[xo]||(m[xo]=function(_){return m.handleEvent(_)}),m[xo])}function Ft(){me.call(this),this.i=new Ts(this),this.M=this,this.F=null}N(Ft,me),Ft.prototype[xt]=!0,Ft.prototype.removeEventListener=function(m,_,w,j){dt(this,m,_,w,j)};function ht(m,_){var w,j=m.F;if(j)for(w=[];j;j=j.F)w.push(j);if(m=m.M,j=_.type||_,typeof _=="string")_=new te(_,m);else if(_ instanceof te)_.target=_.target||m;else{var W=_;_=new te(j,m),M(_,W)}if(W=!0,w)for(var ae=w.length-1;0<=ae;ae--){var be=_.g=w[ae];W=rs(be,j,!0,_)&&W}if(be=_.g=m,W=rs(be,j,!0,_)&&W,W=rs(be,j,!1,_)&&W,w)for(ae=0;ae<w.length;ae++)be=_.g=w[ae],W=rs(be,j,!1,_)&&W}Ft.prototype.N=function(){if(Ft.aa.N.call(this),this.i){var m=this.i,_;for(_ in m.g){for(var w=m.g[_],j=0;j<w.length;j++)ws(w[j]);delete m.g[_],m.h--}}this.F=null},Ft.prototype.K=function(m,_,w,j){return this.i.add(String(m),_,!1,w,j)},Ft.prototype.L=function(m,_,w,j){return this.i.add(String(m),_,!0,w,j)};function rs(m,_,w,j){if(_=m.i.g[String(_)],!_)return!0;_=_.concat();for(var W=!0,ae=0;ae<_.length;++ae){var be=_[ae];if(be&&!be.da&&be.capture==w){var it=be.listener,_n=be.ha||be.src;be.fa&&Es(m.i,be),W=it.call(_n,j)!==!1&&W}}return W&&!j.defaultPrevented}function Nn(m,_,w){if(typeof m=="function")w&&(m=b(m,w));else if(m&&typeof m.handleEvent=="function")m=b(m.handleEvent,m);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:h.setTimeout(m,_||0)}function zs(m){m.g=Nn(()=>{m.g=null,m.i&&(m.i=!1,zs(m))},m.l);const _=m.h;m.h=null,m.m.apply(null,_)}class jl extends me{constructor(_,w){super(),this.m=_,this.l=w,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:zs(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Is(m){me.call(this),this.h=m,this.g={}}N(Is,me);var dr=[];function kr(m){K(m.g,function(_,w){this.g.hasOwnProperty(w)&&rn(_)},m),m.g={}}Is.prototype.N=function(){Is.aa.N.call(this),kr(this)},Is.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ss=h.JSON.stringify,aa=h.JSON.parse,fi=class{stringify(m){return h.JSON.stringify(m,void 0)}parse(m){return h.JSON.parse(m,void 0)}};function vo(){}vo.prototype.h=null;function _o(m){return m.h||(m.h=m.i())}function bo(){}var hr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function fr(){te.call(this,"d")}N(fr,te);function wo(){te.call(this,"c")}N(wo,te);var an={},To=null;function jr(){return To=To||new Ft}an.La="serverreachability";function oa(m){te.call(this,an.La,m)}N(oa,te);function mr(m){const _=jr();ht(_,new oa(_))}an.STAT_EVENT="statevent";function Au(m,_){te.call(this,an.STAT_EVENT,m),this.stat=_}N(Au,te);function Mt(m){const _=jr();ht(_,new Au(_,m))}an.Ma="timingevent";function mn(m,_){te.call(this,an.Ma,m),this.size=_}N(mn,te);function on(m,_){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){m()},_)}function Ns(){this.g=!0}Ns.prototype.xa=function(){this.g=!1};function Pl(m,_,w,j,W,ae){m.info(function(){if(m.g)if(ae)for(var be="",it=ae.split("&"),_n=0;_n<it.length;_n++){var at=it[_n].split("=");if(1<at.length){var Dn=at[0];at=at[1];var bn=Dn.split("_");be=2<=bn.length&&bn[1]=="type"?be+(Dn+"="+at+"&"):be+(Dn+"=redacted&")}}else be=null;else be=ae;return"XMLHTTP REQ ("+j+") [attempt "+W+"]: "+_+`
`+w+`
`+be})}function ff(m,_,w,j,W,ae,be){m.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+W+"]: "+_+`
`+w+`
`+ae+" "+be})}function mi(m,_,w,j){m.info(function(){return"XMLHTTP TEXT ("+_+"): "+la(m,w)+(j?" "+j:"")})}function Ru(m,_){m.info(function(){return"TIMEOUT: "+_})}Ns.prototype.info=function(){};function la(m,_){if(!m.g)return _;if(!_)return null;try{var w=JSON.parse(_);if(w){for(m=0;m<w.length;m++)if(Array.isArray(w[m])){var j=w[m];if(!(2>j.length)){var W=j[1];if(Array.isArray(W)&&!(1>W.length)){var ae=W[0];if(ae!="noop"&&ae!="stop"&&ae!="close")for(var be=1;be<W.length;be++)W[be]=""}}}}return Ss(w)}catch{return _}}var pi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Pr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},pr;function gr(){}N(gr,vo),gr.prototype.g=function(){return new XMLHttpRequest},gr.prototype.i=function(){return{}},pr=new gr;function Kn(m,_,w,j){this.j=m,this.i=_,this.l=w,this.R=j||1,this.U=new Is(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Xt}function Xt(){this.i=null,this.g="",this.h=!1}var Ol={},Eo={};function qs(m,_,w){m.L=1,m.v=Hs(Be(_)),m.m=w,m.P=!0,Or(m,null)}function Or(m,_){m.F=Date.now(),ca(m),m.A=Be(m.v);var w=m.A,j=m.R;Array.isArray(j)||(j=[String(j)]),Ou(w.i,"t",j),m.C=0,w=m.j.J,m.h=new Xt,m.g=Ef(m.j,w?_:null,!m.m),0<m.O&&(m.M=new jl(b(m.Y,m,m.g),m.O)),_=m.U,w=m.g,j=m.ca;var W="readystatechange";Array.isArray(W)||(W&&(dr[0]=W.toString()),W=dr);for(var ae=0;ae<W.length;ae++){var be=ct(w,W[ae],j||_.handleEvent,!1,_.h||_);if(!be)break;_.g[be.key]=be}_=m.H?k(m.H):{},m.m?(m.u||(m.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.A,m.u,m.m,_)):(m.u="GET",m.g.ea(m.A,m.u,null,_)),mr(),Pl(m.i,m.u,m.A,m.l,m.R,m.m)}Kn.prototype.ca=function(m){m=m.target;const _=this.M;_&&Ks(m)==3?_.j():this.Y(m)},Kn.prototype.Y=function(m){try{if(m==this.g)e:{const bn=Ks(this.g);var _=this.g.Ba();const wi=this.g.Z();if(!(3>bn)&&(bn!=3||this.g&&(this.h.h||this.g.oa()||gf(this.g)))){this.J||bn!=4||_==7||(_==8||0>=wi?mr(3):mr(2)),gi(this);var w=this.g.Z();this.X=w;t:if(Cu(this)){var j=gf(this.g);m="";var W=j.length,ae=Ks(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){An(this),yr(this);var be="";break t}this.h.i=new h.TextDecoder}for(_=0;_<W;_++)this.h.h=!0,m+=this.h.i.decode(j[_],{stream:!(ae&&_==W-1)});j.length=0,this.h.g+=m,this.C=0,be=this.h.g}else be=this.g.oa();if(this.o=w==200,ff(this.i,this.u,this.A,this.l,this.R,bn,w),this.o){if(this.T&&!this.K){t:{if(this.g){var it,_n=this.g;if((it=_n.g?_n.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(it)){var at=it;break t}}at=null}if(w=at)mi(this.i,this.l,w,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ua(this,w);else{this.o=!1,this.s=3,Mt(12),An(this),yr(this);break e}}if(this.P){w=!0;let Ln;for(;!this.J&&this.C<be.length;)if(Ln=Du(this,be),Ln==Eo){bn==4&&(this.s=4,Mt(14),w=!1),mi(this.i,this.l,null,"[Incomplete Response]");break}else if(Ln==Ol){this.s=4,Mt(15),mi(this.i,this.l,be,"[Invalid Chunk]"),w=!1;break}else mi(this.i,this.l,Ln,null),ua(this,Ln);if(Cu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),bn!=4||be.length!=0||this.h.h||(this.s=1,Mt(16),w=!1),this.o=this.o&&w,!w)mi(this.i,this.l,be,"[Invalid Chunked Response]"),An(this),yr(this);else if(0<be.length&&!this.W){this.W=!0;var Dn=this.j;Dn.g==this&&Dn.ba&&!Dn.M&&(Dn.j.info("Great, no buffering proxy detected. Bytes received: "+be.length),Do(Dn),Dn.M=!0,Mt(11))}}else mi(this.i,this.l,be,null),ua(this,be);bn==4&&An(this),this.o&&!this.J&&(bn==4?bf(this.j,this):(this.o=!1,ca(this)))}else Rg(this.g),w==400&&0<be.indexOf("Unknown SID")?(this.s=3,Mt(12)):(this.s=0,Mt(13)),An(this),yr(this)}}}catch{}finally{}};function Cu(m){return m.g?m.u=="GET"&&m.L!=2&&m.j.Ca:!1}function Du(m,_){var w=m.C,j=_.indexOf(`
`,w);return j==-1?Eo:(w=Number(_.substring(w,j)),isNaN(w)?Ol:(j+=1,j+w>_.length?Eo:(_=_.slice(j,j+w),m.C=j+w,_)))}Kn.prototype.cancel=function(){this.J=!0,An(this)};function ca(m){m.S=Date.now()+m.I,ku(m,m.I)}function ku(m,_){if(m.B!=null)throw Error("WatchDog timer not null");m.B=on(b(m.ba,m),_)}function gi(m){m.B&&(h.clearTimeout(m.B),m.B=null)}Kn.prototype.ba=function(){this.B=null;const m=Date.now();0<=m-this.S?(Ru(this.i,this.A),this.L!=2&&(mr(),Mt(17)),An(this),this.s=2,yr(this)):ku(this,this.S-m)};function yr(m){m.j.G==0||m.J||bf(m.j,m)}function An(m){gi(m);var _=m.M;_&&typeof _.ma=="function"&&_.ma(),m.M=null,kr(m.U),m.g&&(_=m.g,m.g=null,_.abort(),_.ma())}function ua(m,_){try{var w=m.j;if(w.G!=0&&(w.g==m||Z(w.h,m))){if(!m.K&&Z(w.h,m)&&w.G==3){try{var j=w.Da.g.parse(_)}catch{j=null}if(Array.isArray(j)&&j.length==3){var W=j;if(W[0]==0){e:if(!w.u){if(w.g)if(w.g.F+3e3<m.F)ql(w),Bl(w);else break e;Fu(w),Mt(18)}}else w.za=W[1],0<w.za-w.T&&37500>W[2]&&w.F&&w.v==0&&!w.C&&(w.C=on(b(w.Za,w),6e3));if(1>=U(w.h)&&w.ca){try{w.ca()}catch{}w.ca=void 0}}else bi(w,11)}else if((m.K||w.g==m)&&ql(w),!q(_))for(W=w.Da.g.parse(_),_=0;_<W.length;_++){let at=W[_];if(w.T=at[0],at=at[1],w.G==2)if(at[0]=="c"){w.K=at[1],w.ia=at[2];const Dn=at[3];Dn!=null&&(w.la=Dn,w.j.info("VER="+w.la));const bn=at[4];bn!=null&&(w.Aa=bn,w.j.info("SVER="+w.Aa));const wi=at[5];wi!=null&&typeof wi=="number"&&0<wi&&(j=1.5*wi,w.L=j,w.j.info("backChannelRequestTimeoutMs_="+j)),j=w;const Ln=m.g;if(Ln){const Hr=Ln.g?Ln.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Hr){var ae=j.h;ae.g||Hr.indexOf("spdy")==-1&&Hr.indexOf("quic")==-1&&Hr.indexOf("h2")==-1||(ae.j=ae.l,ae.g=new Set,ae.h&&(ne(ae,ae.h),ae.h=null))}if(j.D){const zu=Ln.g?Ln.g.getResponseHeader("X-HTTP-Session-Id"):null;zu&&(j.ya=zu,ze(j.I,j.D,zu))}}w.G=3,w.l&&w.l.ua(),w.ba&&(w.R=Date.now()-m.F,w.j.info("Handshake RTT: "+w.R+"ms")),j=w;var be=m;if(j.qa=Tf(j,j.J?j.ia:null,j.W),be.K){ue(j.h,be);var it=be,_n=j.L;_n&&(it.I=_n),it.B&&(gi(it),ca(it)),j.g=be}else vf(j);0<w.i.length&&zl(w)}else at[0]!="stop"&&at[0]!="close"||bi(w,7);else w.G==3&&(at[0]=="stop"||at[0]=="close"?at[0]=="stop"?bi(w,7):Lu(w):at[0]!="noop"&&w.l&&w.l.ta(at),w.v=0)}}mr(4)}catch{}}var ju=class{constructor(m,_){this.g=m,this.map=_}};function Mr(m){this.l=m||10,h.PerformanceNavigationTiming?(m=h.performance.getEntriesByType("navigation"),m=0<m.length&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function da(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function U(m){return m.h?1:m.g?m.g.size:0}function Z(m,_){return m.h?m.h==_:m.g?m.g.has(_):!1}function ne(m,_){m.g?m.g.add(_):m.h=_}function ue(m,_){m.h&&m.h==_?m.h=null:m.g&&m.g.has(_)&&m.g.delete(_)}Mr.prototype.cancel=function(){if(this.i=ve(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function ve(m){if(m.h!=null)return m.i.concat(m.h.D);if(m.g!=null&&m.g.size!==0){let _=m.i;for(const w of m.g.values())_=_.concat(w.D);return _}return E(m.i)}function xe(m){if(m.V&&typeof m.V=="function")return m.V();if(typeof Map<"u"&&m instanceof Map||typeof Set<"u"&&m instanceof Set)return Array.from(m.values());if(typeof m=="string")return m.split("");if(f(m)){for(var _=[],w=m.length,j=0;j<w;j++)_.push(m[j]);return _}_=[],w=0;for(j in m)_[w++]=m[j];return _}function Le(m){if(m.na&&typeof m.na=="function")return m.na();if(!m.V||typeof m.V!="function"){if(typeof Map<"u"&&m instanceof Map)return Array.from(m.keys());if(!(typeof Set<"u"&&m instanceof Set)){if(f(m)||typeof m=="string"){var _=[];m=m.length;for(var w=0;w<m;w++)_.push(w);return _}_=[],w=0;for(const j in m)_[w++]=j;return _}}}function je(m,_){if(m.forEach&&typeof m.forEach=="function")m.forEach(_,void 0);else if(f(m)||typeof m=="string")Array.prototype.forEach.call(m,_,void 0);else for(var w=Le(m),j=xe(m),W=j.length,ae=0;ae<W;ae++)_.call(void 0,j[ae],w&&w[ae],m)}var Me=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gt(m,_){if(m){m=m.split("&");for(var w=0;w<m.length;w++){var j=m[w].indexOf("="),W=null;if(0<=j){var ae=m[w].substring(0,j);W=m[w].substring(j+1)}else ae=m[w];_(ae,W?decodeURIComponent(W.replace(/\+/g," ")):"")}}}function ft(m){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,m instanceof ft){this.h=m.h,Dt(this,m.j),this.o=m.o,this.g=m.g,ut(this,m.s),this.l=m.l;var _=m.i,w=new yi;w.i=_.i,_.g&&(w.g=new Map(_.g),w.h=_.h),Ye(this,w),this.m=m.m}else m&&(_=String(m).match(Me))?(this.h=!1,Dt(this,_[1]||"",!0),this.o=Rn(_[2]||""),this.g=Rn(_[3]||"",!0),ut(this,_[4]),this.l=Rn(_[5]||"",!0),Ye(this,_[6]||"",!0),this.m=Rn(_[7]||"")):(this.h=!1,this.i=new yi(null,this.h))}ft.prototype.toString=function(){var m=[],_=this.j;_&&m.push(Vr(_,xr,!0),":");var w=this.g;return(w||_=="file")&&(m.push("//"),(_=this.o)&&m.push(Vr(_,xr,!0),"@"),m.push(encodeURIComponent(String(w)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.s,w!=null&&m.push(":",String(w))),(w=this.l)&&(this.g&&w.charAt(0)!="/"&&m.push("/"),m.push(Vr(w,w.charAt(0)=="/"?Ng:Pu,!0))),(w=this.i.toString())&&m.push("?",w),(w=this.m)&&m.push("#",Vr(w,Ml)),m.join("")};function Be(m){return new ft(m)}function Dt(m,_,w){m.j=w?Rn(_,!0):_,m.j&&(m.j=m.j.replace(/:$/,""))}function ut(m,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);m.s=_}else m.s=null}function Ye(m,_,w){_ instanceof yi?(m.i=_,mf(m.i,m.h)):(w||(_=Vr(_,Ag)),m.i=new yi(_,m.h))}function ze(m,_,w){m.i.set(_,w)}function Hs(m){return ze(m,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),m}function Rn(m,_){return m?_?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function Vr(m,_,w){return typeof m=="string"?(m=encodeURI(m).replace(_,ha),w&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function ha(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var xr=/[#\/\?@]/g,Pu=/[#\?:]/g,Ng=/[#\?]/g,Ag=/[#\?@]/g,Ml=/#/g;function yi(m,_){this.h=this.g=null,this.i=m||null,this.j=!!_}function Gs(m){m.g||(m.g=new Map,m.h=0,m.i&&gt(m.i,function(_,w){m.add(decodeURIComponent(_.replace(/\+/g," ")),w)}))}n=yi.prototype,n.add=function(m,_){Gs(this),this.i=null,m=Lr(this,m);var w=this.g.get(m);return w||this.g.set(m,w=[]),w.push(_),this.h+=1,this};function xi(m,_){Gs(m),_=Lr(m,_),m.g.has(_)&&(m.i=null,m.h-=m.g.get(_).length,m.g.delete(_))}function vi(m,_){return Gs(m),_=Lr(m,_),m.g.has(_)}n.forEach=function(m,_){Gs(this),this.g.forEach(function(w,j){w.forEach(function(W){m.call(_,W,j,this)},this)},this)},n.na=function(){Gs(this);const m=Array.from(this.g.values()),_=Array.from(this.g.keys()),w=[];for(let j=0;j<_.length;j++){const W=m[j];for(let ae=0;ae<W.length;ae++)w.push(_[j])}return w},n.V=function(m){Gs(this);let _=[];if(typeof m=="string")vi(this,m)&&(_=_.concat(this.g.get(Lr(this,m))));else{m=Array.from(this.g.values());for(let w=0;w<m.length;w++)_=_.concat(m[w])}return _},n.set=function(m,_){return Gs(this),this.i=null,m=Lr(this,m),vi(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[_]),this.h+=1,this},n.get=function(m,_){return m?(m=this.V(m),0<m.length?String(m[0]):_):_};function Ou(m,_,w){xi(m,_),0<w.length&&(m.i=null,m.g.set(Lr(m,_),E(w)),m.h+=w.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],_=Array.from(this.g.keys());for(var w=0;w<_.length;w++){var j=_[w];const ae=encodeURIComponent(String(j)),be=this.V(j);for(j=0;j<be.length;j++){var W=ae;be[j]!==""&&(W+="="+encodeURIComponent(String(be[j]))),m.push(W)}}return this.i=m.join("&")};function Lr(m,_){return _=String(_),m.j&&(_=_.toLowerCase()),_}function mf(m,_){_&&!m.j&&(Gs(m),m.i=null,m.g.forEach(function(w,j){var W=j.toLowerCase();j!=W&&(xi(this,j),Ou(this,W,w))},m)),m.j=_}function Io(m,_){const w=new Ns;if(h.Image){const j=new Image;j.onload=I($s,w,"TestLoadImage: loaded",!0,_,j),j.onerror=I($s,w,"TestLoadImage: error",!1,_,j),j.onabort=I($s,w,"TestLoadImage: abort",!1,_,j),j.ontimeout=I($s,w,"TestLoadImage: timeout",!1,_,j),h.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=m}else _(!1)}function vr(m,_){const w=new Ns,j=new AbortController,W=setTimeout(()=>{j.abort(),$s(w,"TestPingServer: timeout",!1,_)},1e4);fetch(m,{signal:j.signal}).then(ae=>{clearTimeout(W),ae.ok?$s(w,"TestPingServer: ok",!0,_):$s(w,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(W),$s(w,"TestPingServer: error",!1,_)})}function $s(m,_,w,j,W){try{W&&(W.onload=null,W.onerror=null,W.onabort=null,W.ontimeout=null),j(w)}catch{}}function So(){this.g=new fi}function Ur(m,_,w){const j=w||"";try{je(m,function(W,ae){let be=W;p(W)&&(be=Ss(W)),_.push(j+ae+"="+encodeURIComponent(be))})}catch(W){throw _.push(j+"type="+encodeURIComponent("_badmap")),W}}function fa(m){this.l=m.Ub||null,this.j=m.eb||!1}N(fa,vo),fa.prototype.g=function(){return new _i(this.l,this.j)},fa.prototype.i=function(m){return function(){return m}}({});function _i(m,_){Ft.call(this),this.D=m,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(_i,Ft),n=_i.prototype,n.open=function(m,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=m,this.A=_,this.readyState=1,Br(this)},n.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};m&&(_.body=m),(this.D||h).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Fr(this)),this.readyState=0},n.Sa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,Br(this)),this.g&&(this.readyState=3,Br(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Mu(this)}else m.text().then(this.Ra.bind(this),this.ga.bind(this))};function Mu(m){m.j.read().then(m.Pa.bind(m)).catch(m.ga.bind(m))}n.Pa=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var _=m.value?m.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!m.done}))&&(this.response=this.responseText+=_)}m.done?Fr(this):Br(this),this.readyState==3&&Mu(this)}},n.Ra=function(m){this.g&&(this.response=this.responseText=m,Fr(this))},n.Qa=function(m){this.g&&(this.response=m,Fr(this))},n.ga=function(){this.g&&Fr(this)};function Fr(m){m.readyState=4,m.l=null,m.j=null,m.v=null,Br(m)}n.setRequestHeader=function(m,_){this.u.append(m,_)},n.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],_=this.h.entries();for(var w=_.next();!w.done;)w=w.value,m.push(w[0]+": "+w[1]),w=_.next();return m.join(`\r
`)};function Br(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(_i.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function Vu(m){let _="";return K(m,function(w,j){_+=j,_+=":",_+=w,_+=`\r
`}),_}function Cn(m,_,w){e:{for(j in w){var j=!1;break e}j=!0}j||(w=Vu(w),typeof m=="string"?w!=null&&encodeURIComponent(String(w)):ze(m,_,w))}function vt(m){Ft.call(this),this.headers=new Map,this.o=m||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(vt,Ft);var Vl=/^https?$/i,No=["POST","PUT"];n=vt.prototype,n.Ha=function(m){this.J=m},n.ea=function(m,_,w,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);_=_?_.toUpperCase():"GET",this.D=m,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():pr.g(),this.v=this.o?_o(this.o):_o(pr),this.g.onreadystatechange=b(this.Ea,this);try{this.B=!0,this.g.open(_,String(m),!0),this.B=!1}catch(ae){pf(this,ae);return}if(m=w||"",w=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var W in j)w.set(W,j[W]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const ae of j.keys())w.set(ae,j.get(ae));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(w.keys()).find(ae=>ae.toLowerCase()=="content-type"),W=h.FormData&&m instanceof h.FormData,!(0<=Array.prototype.indexOf.call(No,_,void 0))||j||W||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ae,be]of w)this.g.setRequestHeader(ae,be);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ao(this),this.u=!0,this.g.send(m),this.u=!1}catch(ae){pf(this,ae)}};function pf(m,_){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=_,m.m=5,Ll(m),zr(m)}function Ll(m){m.A||(m.A=!0,ht(m,"complete"),ht(m,"error"))}n.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=m||7,ht(this,"complete"),ht(this,"abort"),zr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zr(this,!0)),vt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Ul(this):this.bb())},n.bb=function(){Ul(this)};function Ul(m){if(m.h&&typeof u<"u"&&(!m.v[1]||Ks(m)!=4||m.Z()!=2)){if(m.u&&Ks(m)==4)Nn(m.Ea,0,m);else if(ht(m,"readystatechange"),Ks(m)==4){m.h=!1;try{const be=m.Z();e:switch(be){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var w;if(!(w=_)){var j;if(j=be===0){var W=String(m.D).match(Me)[1]||null;!W&&h.self&&h.self.location&&(W=h.self.location.protocol.slice(0,-1)),j=!Vl.test(W?W.toLowerCase():"")}w=j}if(w)ht(m,"complete"),ht(m,"success");else{m.m=6;try{var ae=2<Ks(m)?m.g.statusText:""}catch{ae=""}m.l=ae+" ["+m.Z()+"]",Ll(m)}}finally{zr(m)}}}}function zr(m,_){if(m.g){Ao(m);const w=m.g,j=m.v[0]?()=>{}:null;m.g=null,m.v=null,_||ht(m,"ready");try{w.onreadystatechange=j}catch{}}}function Ao(m){m.I&&(h.clearTimeout(m.I),m.I=null)}n.isActive=function(){return!!this.g};function Ks(m){return m.g?m.g.readyState:0}n.Z=function(){try{return 2<Ks(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(m){if(this.g){var _=this.g.responseText;return m&&_.indexOf(m)==0&&(_=_.substring(m.length)),aa(_)}};function gf(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.H){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function Rg(m){const _={};m=(m.g&&2<=Ks(m)&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<m.length;j++){if(q(m[j]))continue;var w=B(m[j]);const W=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const ae=_[W]||[];_[W]=ae,ae.push(w)}L(_,function(j){return j.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ro(m,_,w){return w&&w.internalChannelParams&&w.internalChannelParams[m]||_}function Fl(m){this.Aa=0,this.i=[],this.j=new Ns,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ro("failFast",!1,m),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ro("baseRetryDelayMs",5e3,m),this.cb=Ro("retryDelaySeedMs",1e4,m),this.Wa=Ro("forwardChannelMaxRetries",2,m),this.wa=Ro("forwardChannelRequestTimeoutMs",2e4,m),this.pa=m&&m.xmlHttpFactory||void 0,this.Xa=m&&m.Tb||void 0,this.Ca=m&&m.useFetchStreams||!1,this.L=void 0,this.J=m&&m.supportsCrossDomainXhr||!1,this.K="",this.h=new Mr(m&&m.concurrentRequestLimit),this.Da=new So,this.P=m&&m.fastHandshake||!1,this.O=m&&m.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=m&&m.Rb||!1,m&&m.xa&&this.j.xa(),m&&m.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&m&&m.detectBufferingProxy||!1,this.ja=void 0,m&&m.longPollingTimeout&&0<m.longPollingTimeout&&(this.ja=m.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Fl.prototype,n.la=8,n.G=1,n.connect=function(m,_,w,j){Mt(0),this.W=m,this.H=_||{},w&&j!==void 0&&(this.H.OSID=w,this.H.OAID=j),this.F=this.X,this.I=Tf(this,null,this.W),zl(this)};function Lu(m){if(yf(m),m.G==3){var _=m.U++,w=Be(m.I);if(ze(w,"SID",m.K),ze(w,"RID",_),ze(w,"TYPE","terminate"),Co(m,w),_=new Kn(m,m.j,_),_.L=2,_.v=Hs(Be(w)),w=!1,h.navigator&&h.navigator.sendBeacon)try{w=h.navigator.sendBeacon(_.v.toString(),"")}catch{}!w&&h.Image&&(new Image().src=_.v,w=!0),w||(_.g=Ef(_.j,null),_.g.ea(_.v)),_.F=Date.now(),ca(_)}wf(m)}function Bl(m){m.g&&(Do(m),m.g.cancel(),m.g=null)}function yf(m){Bl(m),m.u&&(h.clearTimeout(m.u),m.u=null),ql(m),m.h.cancel(),m.s&&(typeof m.s=="number"&&h.clearTimeout(m.s),m.s=null)}function zl(m){if(!da(m.h)&&!m.s){m.s=!0;var _=m.Ga;ge||O(),le||(ge(),le=!0),Ie.add(_,m),m.B=0}}function Cg(m,_){return U(m.h)>=m.h.j-(m.s?1:0)?!1:m.s?(m.i=_.D.concat(m.i),!0):m.G==1||m.G==2||m.B>=(m.Va?0:m.Wa)?!1:(m.s=on(b(m.Ga,m,_),Bu(m,m.B)),m.B++,!0)}n.Ga=function(m){if(this.s)if(this.s=null,this.G==1){if(!m){this.U=Math.floor(1e5*Math.random()),m=this.U++;const W=new Kn(this,this.j,m);let ae=this.o;if(this.S&&(ae?(ae=k(ae),M(ae,this.S)):ae=this.S),this.m!==null||this.O||(W.H=ae,ae=null),this.P)e:{for(var _=0,w=0;w<this.i.length;w++){t:{var j=this.i[w];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(_+=j,4096<_){_=w;break e}if(_===4096||w===this.i.length-1){_=w+1;break e}}_=1e3}else _=1e3;_=xf(this,W,_),w=Be(this.I),ze(w,"RID",m),ze(w,"CVER",22),this.D&&ze(w,"X-HTTP-Session-Id",this.D),Co(this,w),ae&&(this.O?_="headers="+encodeURIComponent(String(Vu(ae)))+"&"+_:this.m&&Cn(w,this.m,ae)),ne(this.h,W),this.Ua&&ze(w,"TYPE","init"),this.P?(ze(w,"$req",_),ze(w,"SID","null"),W.T=!0,qs(W,w,null)):qs(W,w,_),this.G=2}}else this.G==3&&(m?Uu(this,m):this.i.length==0||da(this.h)||Uu(this))};function Uu(m,_){var w;_?w=_.l:w=m.U++;const j=Be(m.I);ze(j,"SID",m.K),ze(j,"RID",w),ze(j,"AID",m.T),Co(m,j),m.m&&m.o&&Cn(j,m.m,m.o),w=new Kn(m,m.j,w,m.B+1),m.m===null&&(w.H=m.o),_&&(m.i=_.D.concat(m.i)),_=xf(m,w,1e3),w.I=Math.round(.5*m.wa)+Math.round(.5*m.wa*Math.random()),ne(m.h,w),qs(w,j,_)}function Co(m,_){m.H&&K(m.H,function(w,j){ze(_,j,w)}),m.l&&je({},function(w,j){ze(_,j,w)})}function xf(m,_,w){w=Math.min(m.i.length,w);var j=m.l?b(m.l.Na,m.l,m):null;e:{var W=m.i;let ae=-1;for(;;){const be=["count="+w];ae==-1?0<w?(ae=W[0].g,be.push("ofs="+ae)):ae=0:be.push("ofs="+ae);let it=!0;for(let _n=0;_n<w;_n++){let at=W[_n].g;const Dn=W[_n].map;if(at-=ae,0>at)ae=Math.max(0,W[_n].g-100),it=!1;else try{Ur(Dn,be,"req"+at+"_")}catch{j&&j(Dn)}}if(it){j=be.join("&");break e}}}return m=m.i.splice(0,w),_.D=m,j}function vf(m){if(!m.g&&!m.u){m.Y=1;var _=m.Fa;ge||O(),le||(ge(),le=!0),Ie.add(_,m),m.v=0}}function Fu(m){return m.g||m.u||3<=m.v?!1:(m.Y++,m.u=on(b(m.Fa,m),Bu(m,m.v)),m.v++,!0)}n.Fa=function(){if(this.u=null,_f(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var m=2*this.R;this.j.info("BP detection timer enabled: "+m),this.A=on(b(this.ab,this),m)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Mt(10),Bl(this),_f(this))};function Do(m){m.A!=null&&(h.clearTimeout(m.A),m.A=null)}function _f(m){m.g=new Kn(m,m.j,"rpc",m.Y),m.m===null&&(m.g.H=m.o),m.g.O=0;var _=Be(m.qa);ze(_,"RID","rpc"),ze(_,"SID",m.K),ze(_,"AID",m.T),ze(_,"CI",m.F?"0":"1"),!m.F&&m.ja&&ze(_,"TO",m.ja),ze(_,"TYPE","xmlhttp"),Co(m,_),m.m&&m.o&&Cn(_,m.m,m.o),m.L&&(m.g.I=m.L);var w=m.g;m=m.ia,w.L=1,w.v=Hs(Be(_)),w.m=null,w.P=!0,Or(w,m)}n.Za=function(){this.C!=null&&(this.C=null,Bl(this),Fu(this),Mt(19))};function ql(m){m.C!=null&&(h.clearTimeout(m.C),m.C=null)}function bf(m,_){var w=null;if(m.g==_){ql(m),Do(m),m.g=null;var j=2}else if(Z(m.h,_))w=_.D,ue(m.h,_),j=1;else return;if(m.G!=0){if(_.o)if(j==1){w=_.m?_.m.length:0,_=Date.now()-_.F;var W=m.B;j=jr(),ht(j,new mn(j,w)),zl(m)}else vf(m);else if(W=_.s,W==3||W==0&&0<_.X||!(j==1&&Cg(m,_)||j==2&&Fu(m)))switch(w&&0<w.length&&(_=m.h,_.i=_.i.concat(w)),W){case 1:bi(m,5);break;case 4:bi(m,10);break;case 3:bi(m,6);break;default:bi(m,2)}}}function Bu(m,_){let w=m.Ta+Math.floor(Math.random()*m.cb);return m.isActive()||(w*=2),w*_}function bi(m,_){if(m.j.info("Error code "+_),_==2){var w=b(m.fb,m),j=m.Xa;const W=!j;j=new ft(j||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||Dt(j,"https"),Hs(j),W?Io(j.toString(),w):vr(j.toString(),w)}else Mt(2);m.G=0,m.l&&m.l.sa(_),wf(m),yf(m)}n.fb=function(m){m?(this.j.info("Successfully pinged google.com"),Mt(2)):(this.j.info("Failed to ping google.com"),Mt(1))};function wf(m){if(m.G=0,m.ka=[],m.l){const _=ve(m.h);(_.length!=0||m.i.length!=0)&&(A(m.ka,_),A(m.ka,m.i),m.h.i.length=0,E(m.i),m.i.length=0),m.l.ra()}}function Tf(m,_,w){var j=w instanceof ft?Be(w):new ft(w);if(j.g!="")_&&(j.g=_+"."+j.g),ut(j,j.s);else{var W=h.location;j=W.protocol,_=_?_+"."+W.hostname:W.hostname,W=+W.port;var ae=new ft(null);j&&Dt(ae,j),_&&(ae.g=_),W&&ut(ae,W),w&&(ae.l=w),j=ae}return w=m.D,_=m.ya,w&&_&&ze(j,w,_),ze(j,"VER",m.la),Co(m,j),j}function Ef(m,_,w){if(_&&!m.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=m.Ca&&!m.pa?new vt(new fa({eb:w})):new vt(m.pa),_.Ha(m.J),_}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function If(){}n=If.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Hl(){}Hl.prototype.g=function(m,_){return new is(m,_)};function is(m,_){Ft.call(this),this.g=new Fl(_),this.l=m,this.h=_&&_.messageUrlParams||null,m=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(m?m["X-WebChannel-Content-Type"]=_.messageContentType:m={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(m?m["X-WebChannel-Client-Profile"]=_.va:m={"X-WebChannel-Client-Profile":_.va}),this.g.S=m,(m=_&&_.Sb)&&!q(m)&&(this.g.m=m),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!q(_)&&(this.g.D=_,m=this.h,m!==null&&_ in m&&(m=this.h,_ in m&&delete m[_])),this.j=new qr(this)}N(is,Ft),is.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},is.prototype.close=function(){Lu(this.g)},is.prototype.o=function(m){var _=this.g;if(typeof m=="string"){var w={};w.__data__=m,m=w}else this.u&&(w={},w.__data__=Ss(m),m=w);_.i.push(new ju(_.Ya++,m)),_.G==3&&zl(_)},is.prototype.N=function(){this.g.l=null,delete this.j,Lu(this.g),delete this.g,is.aa.N.call(this)};function Sf(m){fr.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var _=m.__sm__;if(_){e:{for(const w in _){m=w;break e}m=void 0}(this.i=m)&&(m=this.i,_=_!==null&&m in _?_[m]:void 0),this.data=_}else this.data=m}N(Sf,fr);function Nf(){wo.call(this),this.status=1}N(Nf,wo);function qr(m){this.g=m}N(qr,If),qr.prototype.ua=function(){ht(this.g,"a")},qr.prototype.ta=function(m){ht(this.g,new Sf(m))},qr.prototype.sa=function(m){ht(this.g,new Nf)},qr.prototype.ra=function(){ht(this.g,"b")},Hl.prototype.createWebChannel=Hl.prototype.g,is.prototype.send=is.prototype.o,is.prototype.open=is.prototype.m,is.prototype.close=is.prototype.close,jA=function(){return new Hl},kA=function(){return jr()},DA=an,fx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},pi.NO_ERROR=0,pi.TIMEOUT=8,pi.HTTP_ERROR=6,Km=pi,Pr.COMPLETE="complete",CA=Pr,bo.EventType=hr,hr.OPEN="a",hr.CLOSE="b",hr.ERROR="c",hr.MESSAGE="d",Ft.prototype.listen=Ft.prototype.K,$d=bo,vt.prototype.listenOnce=vt.prototype.L,vt.prototype.getLastError=vt.prototype.Ka,vt.prototype.getLastErrorCode=vt.prototype.Ba,vt.prototype.getStatus=vt.prototype.Z,vt.prototype.getResponseJson=vt.prototype.Oa,vt.prototype.getResponseText=vt.prototype.oa,vt.prototype.send=vt.prototype.ea,vt.prototype.setWithCredentials=vt.prototype.Ha,RA=vt}).apply(typeof Cm<"u"?Cm:typeof self<"u"?self:typeof window<"u"?window:{});const rI="@firebase/firestore",iI="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Mn.UNAUTHENTICATED=new Mn(null),Mn.GOOGLE_CREDENTIALS=new Mn("google-credentials-uid"),Mn.FIRST_PARTY=new Mn("first-party-uid"),Mn.MOCK_USER=new Mn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xu="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Za=new Mp("@firebase/firestore");function Ac(){return Za.logLevel}function XV(n){Za.setLogLevel(n)}function ye(n,...e){if(Za.logLevel<=tt.DEBUG){const t=e.map(Dv);Za.debug(`Firestore (${xu}): ${n}`,...t)}}function un(n,...e){if(Za.logLevel<=tt.ERROR){const t=e.map(Dv);Za.error(`Firestore (${xu}): ${n}`,...t)}}function di(n,...e){if(Za.logLevel<=tt.WARN){const t=e.map(Dv);Za.warn(`Firestore (${xu}): ${n}`,...t)}}function Dv(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ae(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,PA(n,s,t)}function PA(n,e,t){let s=`FIRESTORE (${xu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw un(s),new Error(s)}function ke(n,e,t,s){let i="Unexpected state";typeof t=="string"?i=t:s=t,n||PA(e,i,s)}function JV(n,e){n||Ae(57014,e)}function Ee(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pe extends ts{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OA{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ZV{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Mn.UNAUTHENTICATED))}shutdown(){}}class e5{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class t5{constructor(e){this.t=e,this.currentUser=Mn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ke(this.o===void 0,42304);let s=this.i;const i=f=>this.i!==s?(s=this.i,t(f)):Promise.resolve();let o=new Hn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Hn,e.enqueueRetryable(()=>i(this.currentUser))};const u=()=>{const f=o;e.enqueueRetryable(async()=>{await f.promise,await i(this.currentUser)})},h=f=>{ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit(f=>h(f)),setTimeout(()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?h(f):(ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Hn)}},0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(s=>this.i!==e?(ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(ke(typeof s.accessToken=="string",31837,{l:s}),new OA(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ke(e===null||typeof e=="string",2055,{h:e}),new Mn(e)}}class n5{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=Mn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class s5{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new n5(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Mn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class aI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class r5{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Lt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ke(this.o===void 0,3512);const s=o=>{o.error!=null&&ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const u=o.token!==this.m;return this.m=o.token,ye("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>s(o))};const i=o=>{ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new aI(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ke(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new aI(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i5(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const i=i5(40);for(let o=0;o<i.length;++o)s.length<20&&i[o]<t&&(s+=e.charAt(i[o]%62))}return s}}function $e(n,e){return n<e?-1:n>e?1:0}function mx(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const i=n.charAt(s),o=e.charAt(s);if(i!==o)return F0(i)===F0(o)?$e(i,o):F0(i)?1:-1}return $e(n.length,e.length)}const a5=55296,o5=57343;function F0(n){const e=n.charCodeAt(0);return e>=a5&&e<=o5}function Kc(n,e,t){return n.length===e.length&&n.every((s,i)=>t(s,e[i]))}function MA(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oI="__name__";class Yr{constructor(e,t,s){t===void 0?t=0:t>e.length&&Ae(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&Ae(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Yr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Yr?e.forEach(s=>{t.push(s)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let i=0;i<s;i++){const o=Yr.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return $e(e.length,t.length)}static compareSegments(e,t){const s=Yr.isNumericId(e),i=Yr.isNumericId(t);return s&&!i?-1:!s&&i?1:s&&i?Yr.extractNumericId(e).compare(Yr.extractNumericId(t)):mx(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return $a.fromString(e.substring(4,e.length-2))}}class nt extends Yr{construct(e,t,s){return new nt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new pe(ie.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter(i=>i.length>0))}return new nt(t)}static emptyPath(){return new nt([])}}const l5=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qt extends Yr{construct(e,t,s){return new qt(e,t,s)}static isValidIdentifier(e){return l5.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===oI}static keyField(){return new qt([oI])}static fromServerFormat(e){const t=[];let s="",i=0;const o=()=>{if(s.length===0)throw new pe(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let u=!1;for(;i<e.length;){const h=e[i];if(h==="\\"){if(i+1===e.length)throw new pe(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[i+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new pe(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=f,i+=2}else h==="`"?(u=!u,i++):h!=="."||u?(s+=h,i++):(o(),i++)}if(o(),u)throw new pe(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qt(t)}static emptyPath(){return new qt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.path=e}static fromPath(e){return new Te(nt.fromString(e))}static fromName(e){return new Te(nt.fromString(e).popFirst(5))}static empty(){return new Te(nt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&nt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return nt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Te(new nt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jv(n,e,t){if(!t)throw new pe(ie.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function VA(n,e,t,s){if(e===!0&&s===!0)throw new pe(ie.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function lI(n){if(!Te.isDocumentKey(n))throw new pe(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function cI(n){if(Te.isDocumentKey(n))throw new pe(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function LA(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Qp(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ae(12329,{type:typeof n})}function pt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new pe(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Qp(n);throw new pe(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function UA(n,e){if(e<=0)throw new pe(ie.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Kh(n,e){if(!LA(n))throw new pe(ie.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const i=e[s].typeString,o="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const u=n[s];if(i&&typeof u!==i){t=`JSON field '${s}' must be a ${i}.`;break}if(o!==void 0&&u!==o.value){t=`Expected '${s}' field to equal '${o.value}'`;break}}if(t)throw new pe(ie.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI=-62135596800,dI=1e6;class _t{static now(){return _t.fromMillis(Date.now())}static fromDate(e){return _t.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*dI);return new _t(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new pe(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new pe(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<uI)throw new pe(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new pe(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/dI}_compareTo(e){return this.seconds===e.seconds?$e(this.nanoseconds,e.nanoseconds):$e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:_t._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Kh(e,_t._jsonSchema))return new _t(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-uI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}_t._jsonSchemaVersion="firestore/timestamp/1.0",_t._jsonSchema={type:vn("string",_t._jsonSchemaVersion),seconds:vn("number"),nanoseconds:vn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{static fromTimestamp(e){return new Ve(e)}static min(){return new Ve(new _t(0,0))}static max(){return new Ve(new _t(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qc=-1;class pp{constructor(e,t,s,i){this.indexId=e,this.collectionGroup=t,this.fields=s,this.indexState=i}}function px(n){return n.fields.find(e=>e.kind===2)}function Wo(n){return n.fields.filter(e=>e.kind!==2)}pp.UNKNOWN_ID=-1;class Qm{constructor(e,t){this.fieldPath=e,this.kind=t}}class bh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new bh(0,Bs.min())}}function FA(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,i=Ve.fromTimestamp(s===1e9?new _t(t+1,0):new _t(t,s));return new Bs(i,Te.empty(),e)}function BA(n){return new Bs(n.readTime,n.key,Qc)}class Bs{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new Bs(Ve.min(),Te.empty(),Qc)}static max(){return new Bs(Ve.max(),Te.empty(),Qc)}}function Pv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Te.comparator(n.documentKey,e.documentKey),t!==0?t:$e(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zA="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class qA{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uo(n){if(n.code!==ie.FAILED_PRECONDITION||n.message!==zA)throw n;ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ae(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Y((s,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(s,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(s,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Y?t:Y.resolve(t)}catch(t){return Y.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Y.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Y.reject(t)}static resolve(e){return new Y((t,s)=>{t(e)})}static reject(e){return new Y((t,s)=>{s(e)})}static waitFor(e){return new Y((t,s)=>{let i=0,o=0,u=!1;e.forEach(h=>{++i,h.next(()=>{++o,u&&o===i&&t()},f=>s(f))}),u=!0,o===i&&t()})}static or(e){let t=Y.resolve(!1);for(const s of e)t=t.next(i=>i?Y.resolve(i):s());return t}static forEach(e,t){const s=[];return e.forEach((i,o)=>{s.push(t.call(this,i,o))}),this.waitFor(s)}static mapArray(e,t){return new Y((s,i)=>{const o=e.length,u=new Array(o);let h=0;for(let f=0;f<o;f++){const p=f;t(e[p]).next(x=>{u[p]=x,++h,h===o&&s(u)},x=>i(x))}})}static doWhile(e,t){return new Y((s,i)=>{const o=()=>{e()===!0?t().next(()=>{o()},i):s()};o()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ms="SimpleDb";class Wp{static open(e,t,s,i){try{return new Wp(t,e.transaction(i,s))}catch(o){throw new sh(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Hn,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new sh(e,t.error)):this.S.resolve()},this.transaction.onerror=s=>{const i=Ov(s.target.error);this.S.reject(new sh(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ye(Ms,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new u5(t)}}class ai{static delete(e){return ye(Ms,"Removing database:",e),Jo(ev().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!mh())return!1;if(ai.F())return!0;const e=Kt(),t=ai.M(e),s=0<t&&t<10,i=HA(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||o)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(s)}constructor(e,t,s){this.name=e,this.version=t,this.N=s,this.B=null,ai.M(Kt())===12.2&&un("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ye(Ms,"Opening database:",this.name),this.db=await new Promise((t,s)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{const u=o.target.result;t(u)},i.onblocked=()=>{s(new sh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{const u=o.target.error;u.name==="VersionError"?s(new pe(ie.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u.name==="InvalidStateError"?s(new pe(ie.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+u)):s(new sh(e,u))},i.onupgradeneeded=o=>{ye(Ms,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const u=o.target.result;this.N.k(u,i.transaction,o.oldVersion,this.version).next(()=>{ye(Ms,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,s,i){const o=t==="readonly";let u=0;for(;;){++u;try{this.db=await this.L(e);const h=Wp.open(this.db,e,o?"readonly":"readwrite",s),f=i(h).next(p=>(h.C(),p)).catch(p=>(h.abort(p),Y.reject(p))).toPromise();return f.catch(()=>{}),await h.D,f}catch(h){const f=h,p=f.name!=="FirebaseError"&&u<3;if(ye(Ms,"Transaction failed with error:",f.message,"Retrying:",p),this.close(),!p)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function HA(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class c5{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Jo(this.U.delete())}}class sh extends pe{constructor(e,t){super(ie.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ho(n){return n.name==="IndexedDbTransactionError"}class u5{constructor(e){this.store=e}put(e,t){let s;return t!==void 0?(ye(Ms,"PUT",this.store.name,e,t),s=this.store.put(t,e)):(ye(Ms,"PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),Jo(s)}add(e){return ye(Ms,"ADD",this.store.name,e,e),Jo(this.store.add(e))}get(e){return Jo(this.store.get(e)).next(t=>(t===void 0&&(t=null),ye(Ms,"GET",this.store.name,e,t),t))}delete(e){return ye(Ms,"DELETE",this.store.name,e),Jo(this.store.delete(e))}count(){return ye(Ms,"COUNT",this.store.name),Jo(this.store.count())}J(e,t){const s=this.options(e,t),i=s.index?this.store.index(s.index):this.store;if(typeof i.getAll=="function"){const o=i.getAll(s.range);return new Y((u,h)=>{o.onerror=f=>{h(f.target.error)},o.onsuccess=f=>{u(f.target.result)}})}{const o=this.cursor(s),u=[];return this.H(o,(h,f)=>{u.push(f)}).next(()=>u)}}Y(e,t){const s=this.store.getAll(e,t===null?void 0:t);return new Y((i,o)=>{s.onerror=u=>{o(u.target.error)},s.onsuccess=u=>{i(u.target.result)}})}Z(e,t){ye(Ms,"DELETE ALL",this.store.name);const s=this.options(e,t);s.X=!1;const i=this.cursor(s);return this.H(i,(o,u,h)=>h.delete())}ee(e,t){let s;t?s=e:(s={},t=e);const i=this.cursor(s);return this.H(i,t)}te(e){const t=this.cursor({});return new Y((s,i)=>{t.onerror=o=>{const u=Ov(o.target.error);i(u)},t.onsuccess=o=>{const u=o.target.result;u?e(u.primaryKey,u.value).next(h=>{h?u.continue():s()}):s()}})}H(e,t){const s=[];return new Y((i,o)=>{e.onerror=u=>{o(u.target.error)},e.onsuccess=u=>{const h=u.target.result;if(!h)return void i();const f=new c5(h),p=t(h.primaryKey,h.value,f);if(p instanceof Y){const x=p.catch(v=>(f.done(),Y.reject(v)));s.push(x)}f.isDone?i():f.G===null?h.continue():h.continue(f.G)}}).next(()=>Y.waitFor(s))}options(e,t){let s;return e!==void 0&&(typeof e=="string"?s=e:t=e),{index:s,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const s=this.store.index(e.index);return e.X?s.openKeyCursor(e.range,t):s.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Jo(n){return new Y((e,t)=>{n.onsuccess=s=>{const i=s.target.result;e(i)},n.onerror=s=>{const i=Ov(s.target.error);t(i)}})}let hI=!1;function Ov(n){const e=ai.M(Kt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const s=new pe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return hI||(hI=!0,setTimeout(()=>{throw s},0)),s}}return n}const rh="IndexBackfiller";class d5{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ye(rh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.ne.ie();ye(rh,`Documents written: ${t}`)}catch(t){ho(t)?ye(rh,"Ignoring IndexedDB error during index backfill: ",t):await uo(t)}await this.re(6e4)})}}class h5{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.se(t,e))}se(e,t){const s=new Set;let i=t,o=!0;return Y.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(u=>{if(u!==null&&!s.has(u))return ye(rh,`Processing collection: ${u}`),this.oe(e,u,i).next(h=>{i-=h,s.add(u)});o=!1})).next(()=>t-i)}oe(e,t,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,s).next(o=>{const u=o.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next(()=>this._e(i,o)).next(h=>(ye(rh,`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h))).next(()=>u.size)}))}_e(e,t){let s=e;return t.changes.forEach((i,o)=>{const u=BA(o);Pv(u,s)>0&&(s=u)}),new Bs(s.readTime,s.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}vs.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ka=-1;function Qh(n){return n==null}function wh(n){return n===0&&1/n==-1/0}function GA(n){return typeof n=="number"&&Number.isInteger(n)&&!wh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gp="";function ns(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=fI(e)),e=f5(n.get(t),e);return fI(e)}function f5(n,e){let t=e;const s=n.length;for(let i=0;i<s;i++){const o=n.charAt(i);switch(o){case"\0":t+="";break;case gp:t+="";break;default:t+=o}}return t}function fI(n){return n+gp+""}function ri(n){const e=n.length;if(ke(e>=2,64408,{path:n}),e===2)return ke(n.charAt(0)===gp&&n.charAt(1)==="",56145,{path:n}),nt.emptyPath();const t=e-2,s=[];let i="";for(let o=0;o<e;){const u=n.indexOf(gp,o);switch((u<0||u>t)&&Ae(50515,{path:n}),n.charAt(u+1)){case"":const h=n.substring(o,u);let f;i.length===0?f=h:(i+=h,f=i,i=""),s.push(f);break;case"":i+=n.substring(o,u),i+="\0";break;case"":i+=n.substring(o,u+1);break;default:Ae(61167,{path:n})}o=u+2}return new nt(s)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo="remoteDocuments",Wh="owner",_c="owner",Th="mutationQueues",m5="userId",Tr="mutations",mI="batchId",rl="userMutationsIndex",pI=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wm(n,e){return[n,ns(e)]}function $A(n,e,t){return[n,ns(e),t]}const p5={},Wc="documentMutations",yp="remoteDocumentsV14",g5=["prefixPath","collectionGroup","readTime","documentId"],Ym="documentKeyIndex",y5=["prefixPath","collectionGroup","documentId"],KA="collectionGroupIndex",x5=["collectionGroup","readTime","prefixPath","documentId"],Eh="remoteDocumentGlobal",gx="remoteDocumentGlobalKey",Yc="targets",QA="queryTargetsIndex",v5=["canonicalId","targetId"],Xc="targetDocuments",_5=["targetId","path"],Mv="documentTargetsIndex",b5=["path","targetId"],xp="targetGlobalKey",cl="targetGlobal",Ih="collectionParents",w5=["collectionId","parent"],Jc="clientMetadata",T5="clientId",Yp="bundles",E5="bundleId",Xp="namedQueries",I5="name",Vv="indexConfiguration",S5="indexId",yx="collectionGroupIndex",N5="collectionGroup",ih="indexState",A5=["indexId","uid"],WA="sequenceNumberIndex",R5=["uid","sequenceNumber"],ah="indexEntries",C5=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],YA="documentKeyIndex",D5=["indexId","uid","orderedDocumentKey"],Jp="documentOverlays",k5=["userId","collectionPath","documentId"],xx="collectionPathOverlayIndex",j5=["userId","collectionPath","largestBatchId"],XA="collectionGroupOverlayIndex",P5=["userId","collectionGroup","largestBatchId"],Lv="globals",O5="name",JA=[Th,Tr,Wc,Yo,Yc,Wh,cl,Xc,Jc,Eh,Ih,Yp,Xp],M5=[...JA,Jp],ZA=[Th,Tr,Wc,yp,Yc,Wh,cl,Xc,Jc,Eh,Ih,Yp,Xp,Jp],e1=ZA,Uv=[...e1,Vv,ih,ah],V5=Uv,t1=[...Uv,Lv],L5=t1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx extends qA{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Sn(n,e){const t=Ee(n);return ai.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gI(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function fo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function n1(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e,t){this.comparator=e,this.root=t||zn.EMPTY}insert(e,t){return new Pt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,zn.BLACK,null,null))}remove(e){return new Pt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const i=this.comparator(e,s.key);if(i===0)return t+s.left.size;i<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,s)=>(e(t,s),!1))}toString(){const e=[];return this.inorderTraversal((t,s)=>(e.push(`${t}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Dm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Dm(this.root,e,this.comparator,!1)}getReverseIterator(){return new Dm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Dm(this.root,e,this.comparator,!0)}}class Dm{constructor(e,t,s,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?s(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class zn{constructor(e,t,s,i,o){this.key=e,this.value=t,this.color=s??zn.RED,this.left=i??zn.EMPTY,this.right=o??zn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,i,o){return new zn(e??this.key,t??this.value,s??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let i=this;const o=s(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,s),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,s)),i.fixUp()}removeMin(){if(this.left.isEmpty())return zn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return zn.EMPTY;s=i.right.min(),i=i.copy(s.key,s.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,zn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,zn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ae(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ae(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ae(27949);return e+(this.isRed()?0:1)}}zn.EMPTY=null,zn.RED=!0,zn.BLACK=!1;zn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ae(57766)}get value(){throw Ae(16141)}get color(){throw Ae(16727)}get left(){throw Ae(29726)}get right(){throw Ae(36894)}copy(e,t,s,i,o){return this}insert(e,t,s){return new zn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.comparator=e,this.data=new Pt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,s)=>(e(t),!1))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const i=s.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new yI(this.data.getIterator())}getIteratorFrom(e){return new yI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(s=>{t=t.add(s)}),t}isEqual(e){if(!(e instanceof Et)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=s.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Et(this.comparator);return t.data=e,t}}class yI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function bc(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e){this.fields=e,e.sort(qt.comparator)}static empty(){return new _s([])}unionWith(e){let t=new Et(qt.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new _s(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Kc(this.fields,e.fields,(t,s)=>t.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U5(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new s1("Invalid base64 string: "+o):o}}(e);return new en(t)}static fromUint8Array(e){const t=function(i){let o="";for(let u=0;u<i.length;++u)o+=String.fromCharCode(i[u]);return o}(e);return new en(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const s=new Uint8Array(t.length);for(let i=0;i<t.length;i++)s[i]=t.charCodeAt(i);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}en.EMPTY_BYTE_STRING=new en("");const F5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $i(n){if(ke(!!n,39018),typeof n=="string"){let e=0;const t=F5.exec(n);if(ke(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:zt(n.seconds),nanos:zt(n.nanos)}}function zt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ki(n){return typeof n=="string"?en.fromBase64String(n):en.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r1="server_timestamp",i1="__type__",a1="__previous_value__",o1="__local_write_time__";function Zp(n){return(n?.mapValue?.fields||{})[i1]?.stringValue===r1}function eg(n){const e=n.mapValue.fields[a1];return Zp(e)?eg(e):e}function Sh(n){const e=$i(n.mapValue.fields[o1].timestampValue);return new _t(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B5{constructor(e,t,s,i,o,u,h,f,p,x){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=i,this.ssl=o,this.forceLongPolling=u,this.autoDetectLongPolling=h,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=x}}const _x="(default)";class eo{constructor(e,t){this.projectId=e,this.database=t||_x}static empty(){return new eo("","")}get isDefaultDatabase(){return this.database===_x}isEqual(e){return e instanceof eo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fv="__type__",l1="__max__",za={mapValue:{fields:{__type__:{stringValue:l1}}}},Bv="__vector__",Zc="value",Xm={nullValue:"NULL_VALUE"};function to(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Zp(n)?4:c1(n)?9007199254740991:tg(n)?10:11:Ae(28295,{value:n})}function hi(n,e){if(n===e)return!0;const t=to(n);if(t!==to(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Sh(n).isEqual(Sh(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const u=$i(i.timestampValue),h=$i(o.timestampValue);return u.seconds===h.seconds&&u.nanos===h.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return Ki(i.bytesValue).isEqual(Ki(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return zt(i.geoPointValue.latitude)===zt(o.geoPointValue.latitude)&&zt(i.geoPointValue.longitude)===zt(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return zt(i.integerValue)===zt(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const u=zt(i.doubleValue),h=zt(o.doubleValue);return u===h?wh(u)===wh(h):isNaN(u)&&isNaN(h)}return!1}(n,e);case 9:return Kc(n.arrayValue.values||[],e.arrayValue.values||[],hi);case 10:case 11:return function(i,o){const u=i.mapValue.fields||{},h=o.mapValue.fields||{};if(gI(u)!==gI(h))return!1;for(const f in u)if(u.hasOwnProperty(f)&&(h[f]===void 0||!hi(u[f],h[f])))return!1;return!0}(n,e);default:return Ae(52216,{left:n})}}function Nh(n,e){return(n.values||[]).find(t=>hi(t,e))!==void 0}function no(n,e){if(n===e)return 0;const t=to(n),s=to(e);if(t!==s)return $e(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return $e(n.booleanValue,e.booleanValue);case 2:return function(o,u){const h=zt(o.integerValue||o.doubleValue),f=zt(u.integerValue||u.doubleValue);return h<f?-1:h>f?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1}(n,e);case 3:return xI(n.timestampValue,e.timestampValue);case 4:return xI(Sh(n),Sh(e));case 5:return mx(n.stringValue,e.stringValue);case 6:return function(o,u){const h=Ki(o),f=Ki(u);return h.compareTo(f)}(n.bytesValue,e.bytesValue);case 7:return function(o,u){const h=o.split("/"),f=u.split("/");for(let p=0;p<h.length&&p<f.length;p++){const x=$e(h[p],f[p]);if(x!==0)return x}return $e(h.length,f.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,u){const h=$e(zt(o.latitude),zt(u.latitude));return h!==0?h:$e(zt(o.longitude),zt(u.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return vI(n.arrayValue,e.arrayValue);case 10:return function(o,u){const h=o.fields||{},f=u.fields||{},p=h[Zc]?.arrayValue,x=f[Zc]?.arrayValue,v=$e(p?.values?.length||0,x?.values?.length||0);return v!==0?v:vI(p,x)}(n.mapValue,e.mapValue);case 11:return function(o,u){if(o===za.mapValue&&u===za.mapValue)return 0;if(o===za.mapValue)return 1;if(u===za.mapValue)return-1;const h=o.fields||{},f=Object.keys(h),p=u.fields||{},x=Object.keys(p);f.sort(),x.sort();for(let v=0;v<f.length&&v<x.length;++v){const b=mx(f[v],x[v]);if(b!==0)return b;const I=no(h[f[v]],p[x[v]]);if(I!==0)return I}return $e(f.length,x.length)}(n.mapValue,e.mapValue);default:throw Ae(23264,{he:t})}}function xI(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return $e(n,e);const t=$i(n),s=$i(e),i=$e(t.seconds,s.seconds);return i!==0?i:$e(t.nanos,s.nanos)}function vI(n,e){const t=n.values||[],s=e.values||[];for(let i=0;i<t.length&&i<s.length;++i){const o=no(t[i],s[i]);if(o)return o}return $e(t.length,s.length)}function eu(n){return bx(n)}function bx(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const s=$i(t);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ki(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Te.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let s="[",i=!0;for(const o of t.values||[])i?i=!1:s+=",",s+=bx(o);return s+"]"}(n.arrayValue):"mapValue"in n?function(t){const s=Object.keys(t.fields||{}).sort();let i="{",o=!0;for(const u of s)o?o=!1:i+=",",i+=`${u}:${bx(t.fields[u])}`;return i+"}"}(n.mapValue):Ae(61005,{value:n})}function Jm(n){switch(to(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=eg(n);return e?16+Jm(e):16;case 5:return 2*n.stringValue.length;case 6:return Ki(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((i,o)=>i+Jm(o),0)}(n.arrayValue);case 10:case 11:return function(s){let i=0;return fo(s.fields,(o,u)=>{i+=o.length+Jm(u)}),i}(n.mapValue);default:throw Ae(13486,{value:n})}}function ml(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function wx(n){return!!n&&"integerValue"in n}function Ah(n){return!!n&&"arrayValue"in n}function _I(n){return!!n&&"nullValue"in n}function bI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Zm(n){return!!n&&"mapValue"in n}function tg(n){return(n?.mapValue?.fields||{})[Fv]?.stringValue===Bv}function oh(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return fo(n.mapValue.fields,(t,s)=>e.mapValue.fields[t]=oh(s)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=oh(n.arrayValue.values[t]);return e}return{...n}}function c1(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===l1}const u1={mapValue:{fields:{[Fv]:{stringValue:Bv},[Zc]:{arrayValue:{}}}}};function z5(n){return"nullValue"in n?Xm:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ml(eo.empty(),Te.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?tg(n)?u1:{mapValue:{}}:Ae(35942,{value:n})}function q5(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ml(eo.empty(),Te.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?u1:"mapValue"in n?tg(n)?{mapValue:{}}:za:Ae(61959,{value:n})}function wI(n,e){const t=no(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function TI(n,e){const t=no(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this.value=e}static empty(){return new qn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!Zm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=oh(t)}setAll(e){let t=qt.emptyPath(),s={},i=[];e.forEach((u,h)=>{if(!t.isImmediateParentOf(h)){const f=this.getFieldsMap(t);this.applyChanges(f,s,i),s={},i=[],t=h.popLast()}u?s[h.lastSegment()]=oh(u):i.push(h.lastSegment())});const o=this.getFieldsMap(t);this.applyChanges(o,s,i)}delete(e){const t=this.field(e.popLast());Zm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return hi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let i=t.mapValue.fields[e.get(s)];Zm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,s){fo(t,(i,o)=>e[i]=o);for(const i of s)delete e[i]}clone(){return new qn(oh(this.value))}}function d1(n){const e=[];return fo(n.fields,(t,s)=>{const i=new qt([t]);if(Zm(s)){const o=d1(s.mapValue).fields;if(o.length===0)e.push(i);else for(const u of o)e.push(i.child(u))}else e.push(i)}),new _s(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e,t,s,i,o,u,h){this.key=e,this.documentType=t,this.version=s,this.readTime=i,this.createTime=o,this.data=u,this.documentState=h}static newInvalidDocument(e){return new Vt(e,0,Ve.min(),Ve.min(),Ve.min(),qn.empty(),0)}static newFoundDocument(e,t,s,i){return new Vt(e,1,t,Ve.min(),s,i,0)}static newNoDocument(e,t){return new Vt(e,2,t,Ve.min(),Ve.min(),qn.empty(),0)}static newUnknownDocument(e,t){return new Vt(e,3,t,Ve.min(),Ve.min(),qn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(e,t){this.position=e,this.inclusive=t}}function EI(n,e,t){let s=0;for(let i=0;i<n.position.length;i++){const o=e[i],u=n.position[i];if(o.field.isKeyField()?s=Te.comparator(Te.fromName(u.referenceValue),t.key):s=no(u,t.data.field(o.field)),o.dir==="desc"&&(s*=-1),s!==0)break}return s}function II(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!hi(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e,t="asc"){this.field=e,this.dir=t}}function H5(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{}class st extends h1{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new G5(e,t,s):t==="array-contains"?new Q5(e,s):t==="in"?new x1(e,s):t==="not-in"?new W5(e,s):t==="array-contains-any"?new Y5(e,s):new st(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new $5(e,s):new K5(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(no(t,this.value)):t!==null&&to(this.value)===to(t)&&this.matchesComparison(no(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ae(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Tt extends h1{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Tt(e,t)}matches(e){return tu(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function tu(n){return n.op==="and"}function Tx(n){return n.op==="or"}function zv(n){return f1(n)&&tu(n)}function f1(n){for(const e of n.filters)if(e instanceof Tt)return!1;return!0}function Ex(n){if(n instanceof st)return n.field.canonicalString()+n.op.toString()+eu(n.value);if(zv(n))return n.filters.map(e=>Ex(e)).join(",");{const e=n.filters.map(t=>Ex(t)).join(",");return`${n.op}(${e})`}}function m1(n,e){return n instanceof st?function(s,i){return i instanceof st&&s.op===i.op&&s.field.isEqual(i.field)&&hi(s.value,i.value)}(n,e):n instanceof Tt?function(s,i){return i instanceof Tt&&s.op===i.op&&s.filters.length===i.filters.length?s.filters.reduce((o,u,h)=>o&&m1(u,i.filters[h]),!0):!1}(n,e):void Ae(19439)}function p1(n,e){const t=n.filters.concat(e);return Tt.create(t,n.op)}function g1(n){return n instanceof st?function(t){return`${t.field.canonicalString()} ${t.op} ${eu(t.value)}`}(n):n instanceof Tt?function(t){return t.op.toString()+" {"+t.getFilters().map(g1).join(" ,")+"}"}(n):"Filter"}class G5 extends st{constructor(e,t,s){super(e,t,s),this.key=Te.fromName(s.referenceValue)}matches(e){const t=Te.comparator(e.key,this.key);return this.matchesComparison(t)}}class $5 extends st{constructor(e,t){super(e,"in",t),this.keys=y1("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class K5 extends st{constructor(e,t){super(e,"not-in",t),this.keys=y1("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function y1(n,e){return(e.arrayValue?.values||[]).map(t=>Te.fromName(t.referenceValue))}class Q5 extends st{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ah(t)&&Nh(t.arrayValue,this.value)}}class x1 extends st{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Nh(this.value.arrayValue,t)}}class W5 extends st{constructor(e,t){super(e,"not-in",t)}matches(e){if(Nh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Nh(this.value.arrayValue,t)}}class Y5 extends st{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ah(t)||!t.arrayValue.values)&&t.arrayValue.values.some(s=>Nh(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X5{constructor(e,t=null,s=[],i=[],o=null,u=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=i,this.limit=o,this.startAt=u,this.endAt=h,this.Te=null}}function Ix(n,e=null,t=[],s=[],i=null,o=null,u=null){return new X5(n,e,t,s,i,o,u)}function pl(n){const e=Ee(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(s=>Ex(s)).join(","),t+="|ob:",t+=e.orderBy.map(s=>function(o){return o.field.canonicalString()+o.dir}(s)).join(","),Qh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(s=>eu(s)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(s=>eu(s)).join(",")),e.Te=t}return e.Te}function Yh(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!H5(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!m1(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!II(n.startAt,e.startAt)&&II(n.endAt,e.endAt)}function vp(n){return Te.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function _p(n,e){return n.filters.filter(t=>t instanceof st&&t.field.isEqual(e))}function SI(n,e,t){let s=Xm,i=!0;for(const o of _p(n,e)){let u=Xm,h=!0;switch(o.op){case"<":case"<=":u=z5(o.value);break;case"==":case"in":case">=":u=o.value;break;case">":u=o.value,h=!1;break;case"!=":case"not-in":u=Xm}wI({value:s,inclusive:i},{value:u,inclusive:h})<0&&(s=u,i=h)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const u=t.position[o];wI({value:s,inclusive:i},{value:u,inclusive:t.inclusive})<0&&(s=u,i=t.inclusive);break}}return{value:s,inclusive:i}}function NI(n,e,t){let s=za,i=!0;for(const o of _p(n,e)){let u=za,h=!0;switch(o.op){case">=":case">":u=q5(o.value),h=!1;break;case"==":case"in":case"<=":u=o.value;break;case"<":u=o.value,h=!1;break;case"!=":case"not-in":u=za}TI({value:s,inclusive:i},{value:u,inclusive:h})>0&&(s=u,i=h)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const u=t.position[o];TI({value:s,inclusive:i},{value:u,inclusive:t.inclusive})>0&&(s=u,i=t.inclusive);break}}return{value:s,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(e,t=null,s=[],i=[],o=null,u="F",h=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=i,this.limit=o,this.limitType=u,this.startAt=h,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function v1(n,e,t,s,i,o,u,h){return new ta(n,e,t,s,i,o,u,h)}function vu(n){return new ta(n)}function AI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function qv(n){return n.collectionGroup!==null}function Lc(n){const e=Ee(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let h=new Et(qt.comparator);return u.filters.forEach(f=>{f.getFlattenedFilters().forEach(p=>{p.isInequality()&&(h=h.add(p.field))})}),h})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Rh(o,s))}),t.has(qt.keyField().canonicalString())||e.Ie.push(new Rh(qt.keyField(),s))}return e.Ie}function ds(n){const e=Ee(n);return e.Ee||(e.Ee=J5(e,Lc(n))),e.Ee}function J5(n,e){if(n.limitType==="F")return Ix(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new Rh(i.field,o)});const t=n.endAt?new so(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new so(n.startAt.position,n.startAt.inclusive):null;return Ix(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function Sx(n,e){const t=n.filters.concat([e]);return new ta(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function bp(n,e,t){return new ta(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Xh(n,e){return Yh(ds(n),ds(e))&&n.limitType===e.limitType}function _1(n){return`${pl(ds(n))}|lt:${n.limitType}`}function Rc(n){return`Query(target=${function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map(i=>g1(i)).join(", ")}]`),Qh(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map(i=>function(u){return`${u.field.canonicalString()} (${u.dir})`}(i)).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map(i=>eu(i)).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map(i=>eu(i)).join(",")),`Target(${s})`}(ds(n))}; limitType=${n.limitType})`}function Jh(n,e){return e.isFoundDocument()&&function(s,i){const o=i.key.path;return s.collectionGroup!==null?i.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(o):Te.isDocumentKey(s.path)?s.path.isEqual(o):s.path.isImmediateParentOf(o)}(n,e)&&function(s,i){for(const o of Lc(s))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(s,i){for(const o of s.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(s,i){return!(s.startAt&&!function(u,h,f){const p=EI(u,h,f);return u.inclusive?p<=0:p<0}(s.startAt,Lc(s),i)||s.endAt&&!function(u,h,f){const p=EI(u,h,f);return u.inclusive?p>=0:p>0}(s.endAt,Lc(s),i))}(n,e)}function b1(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function w1(n){return(e,t)=>{let s=!1;for(const i of Lc(n)){const o=Z5(i,e,t);if(o!==0)return o;s=s||i.field.isKeyField()}return 0}}function Z5(n,e,t){const s=n.field.isKeyField()?Te.comparator(e.key,t.key):function(o,u,h){const f=u.data.field(o),p=h.data.field(o);return f!==null&&p!==null?no(f,p):Ae(42886)}(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return Ae(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[i,o]of s)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),i=this.inner[s];if(i===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return s.length===1?delete this.inner[t]:s.splice(i,1),this.innerSize--,!0;return!1}forEach(e){fo(this.inner,(t,s)=>{for(const[i,o]of s)e(i,o)})}isEmpty(){return n1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eL=new Pt(Te.comparator);function bs(){return eL}const T1=new Pt(Te.comparator);function Kd(...n){let e=T1;for(const t of n)e=e.insert(t.key,t);return e}function E1(n){let e=T1;return n.forEach((t,s)=>e=e.insert(t,s.overlayedDocument)),e}function ii(){return lh()}function I1(){return lh()}function lh(){return new na(n=>n.toString(),(n,e)=>n.isEqual(e))}const tL=new Pt(Te.comparator),nL=new Et(Te.comparator);function Ke(...n){let e=nL;for(const t of n)e=e.add(t);return e}const sL=new Et($e);function Hv(){return sL}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:wh(e)?"-0":e}}function S1(n){return{integerValue:""+n}}function N1(n,e){return GA(e)?S1(e):Gv(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(){this._=void 0}}function rL(n,e,t){return n instanceof nu?function(i,o){const u={fields:{[i1]:{stringValue:r1},[o1]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Zp(o)&&(o=eg(o)),o&&(u.fields[a1]=o),{mapValue:u}}(t,e):n instanceof gl?R1(n,e):n instanceof yl?C1(n,e):function(i,o){const u=A1(i,o),h=RI(u)+RI(i.Ae);return wx(u)&&wx(i.Ae)?S1(h):Gv(i.serializer,h)}(n,e)}function iL(n,e,t){return n instanceof gl?R1(n,e):n instanceof yl?C1(n,e):t}function A1(n,e){return n instanceof su?function(s){return wx(s)||function(o){return!!o&&"doubleValue"in o}(s)}(e)?e:{integerValue:0}:null}class nu extends ng{}class gl extends ng{constructor(e){super(),this.elements=e}}function R1(n,e){const t=D1(e);for(const s of n.elements)t.some(i=>hi(i,s))||t.push(s);return{arrayValue:{values:t}}}class yl extends ng{constructor(e){super(),this.elements=e}}function C1(n,e){let t=D1(e);for(const s of n.elements)t=t.filter(i=>!hi(i,s));return{arrayValue:{values:t}}}class su extends ng{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function RI(n){return zt(n.integerValue||n.doubleValue)}function D1(n){return Ah(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(e,t){this.field=e,this.transform=t}}function aL(n,e){return n.field.isEqual(e.field)&&function(s,i){return s instanceof gl&&i instanceof gl||s instanceof yl&&i instanceof yl?Kc(s.elements,i.elements,hi):s instanceof su&&i instanceof su?hi(s.Ae,i.Ae):s instanceof nu&&i instanceof nu}(n.transform,e.transform)}class oL{constructor(e,t){this.version=e,this.transformResults=t}}class Ht{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ht}static exists(e){return new Ht(void 0,e)}static updateTime(e){return new Ht(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ep(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class sg{}function k1(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new bu(n.key,Ht.none()):new _u(n.key,n.data,Ht.none());{const t=n.data,s=qn.empty();let i=new Et(qt.comparator);for(let o of e.fields)if(!i.has(o)){let u=t.field(o);u===null&&o.length>1&&(o=o.popLast(),u=t.field(o)),u===null?s.delete(o):s.set(o,u),i=i.add(o)}return new sa(n.key,s,new _s(i.toArray()),Ht.none())}}function lL(n,e,t){n instanceof _u?function(i,o,u){const h=i.value.clone(),f=DI(i.fieldTransforms,o,u.transformResults);h.setAll(f),o.convertToFoundDocument(u.version,h).setHasCommittedMutations()}(n,e,t):n instanceof sa?function(i,o,u){if(!ep(i.precondition,o))return void o.convertToUnknownDocument(u.version);const h=DI(i.fieldTransforms,o,u.transformResults),f=o.data;f.setAll(j1(i)),f.setAll(h),o.convertToFoundDocument(u.version,f).setHasCommittedMutations()}(n,e,t):function(i,o,u){o.convertToNoDocument(u.version).setHasCommittedMutations()}(0,e,t)}function ch(n,e,t,s){return n instanceof _u?function(o,u,h,f){if(!ep(o.precondition,u))return h;const p=o.value.clone(),x=kI(o.fieldTransforms,f,u);return p.setAll(x),u.convertToFoundDocument(u.version,p).setHasLocalMutations(),null}(n,e,t,s):n instanceof sa?function(o,u,h,f){if(!ep(o.precondition,u))return h;const p=kI(o.fieldTransforms,f,u),x=u.data;return x.setAll(j1(o)),x.setAll(p),u.convertToFoundDocument(u.version,x).setHasLocalMutations(),h===null?null:h.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(v=>v.field))}(n,e,t,s):function(o,u,h){return ep(o.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):h}(n,e,t)}function cL(n,e){let t=null;for(const s of n.fieldTransforms){const i=e.data.field(s.field),o=A1(s.transform,i||null);o!=null&&(t===null&&(t=qn.empty()),t.set(s.field,o))}return t||null}function CI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(s,i){return s===void 0&&i===void 0||!(!s||!i)&&Kc(s,i,(o,u)=>aL(o,u))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class _u extends sg{constructor(e,t,s,i=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class sa extends sg{constructor(e,t,s,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function j1(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}}),e}function DI(n,e,t){const s=new Map;ke(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const o=n[i],u=o.transform,h=e.data.field(o.field);s.set(o.field,iL(u,h,t[i]))}return s}function kI(n,e,t){const s=new Map;for(const i of n){const o=i.transform,u=t.data.field(i.field);s.set(i.field,rL(o,u,e))}return s}class bu extends sg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $v extends sg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e,t,s,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=i}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&lL(o,e,s[i])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=ch(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=ch(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=I1();return this.mutations.forEach(i=>{const o=e.get(i.key),u=o.overlayedDocument;let h=this.applyToLocalView(u,o.mutatedFields);h=t.has(i.key)?null:h;const f=k1(u,h);f!==null&&s.set(i.key,f),u.isValidDocument()||u.convertToNoDocument(Ve.min())}),s}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ke())}isEqual(e){return this.batchId===e.batchId&&Kc(this.mutations,e.mutations,(t,s)=>CI(t,s))&&Kc(this.baseMutations,e.baseMutations,(t,s)=>CI(t,s))}}class Qv{constructor(e,t,s,i){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=i}static from(e,t,s){ke(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let i=function(){return tL}();const o=e.mutations;for(let u=0;u<o.length;u++)i=i.insert(o[u].key,s[u].version);return new Qv(e,t,s,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yn,lt;function P1(n){switch(n){case ie.OK:return Ae(64938);case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return Ae(15467,{code:n})}}function O1(n){if(n===void 0)return un("GRPC error has no .code"),ie.UNKNOWN;switch(n){case yn.OK:return ie.OK;case yn.CANCELLED:return ie.CANCELLED;case yn.UNKNOWN:return ie.UNKNOWN;case yn.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case yn.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case yn.INTERNAL:return ie.INTERNAL;case yn.UNAVAILABLE:return ie.UNAVAILABLE;case yn.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case yn.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case yn.NOT_FOUND:return ie.NOT_FOUND;case yn.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case yn.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case yn.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case yn.ABORTED:return ie.ABORTED;case yn.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case yn.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case yn.DATA_LOSS:return ie.DATA_LOSS;default:return Ae(39323,{code:n})}}(lt=yn||(yn={}))[lt.OK=0]="OK",lt[lt.CANCELLED=1]="CANCELLED",lt[lt.UNKNOWN=2]="UNKNOWN",lt[lt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",lt[lt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",lt[lt.NOT_FOUND=5]="NOT_FOUND",lt[lt.ALREADY_EXISTS=6]="ALREADY_EXISTS",lt[lt.PERMISSION_DENIED=7]="PERMISSION_DENIED",lt[lt.UNAUTHENTICATED=16]="UNAUTHENTICATED",lt[lt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",lt[lt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",lt[lt.ABORTED=10]="ABORTED",lt[lt.OUT_OF_RANGE=11]="OUT_OF_RANGE",lt[lt.UNIMPLEMENTED=12]="UNIMPLEMENTED",lt[lt.INTERNAL=13]="INTERNAL",lt[lt.UNAVAILABLE=14]="UNAVAILABLE",lt[lt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M1(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dL=new $a([4294967295,4294967295],0);function jI(n){const e=M1().encode(n),t=new AA;return t.update(e),new Uint8Array(t.digest())}function PI(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new $a([t,s],0),new $a([i,o],0)]}class Yv{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Qd(`Invalid padding: ${t}`);if(s<0)throw new Qd(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Qd(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Qd(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=$a.fromNumber(this.ge)}ye(e,t,s){let i=e.add(t.multiply($a.fromNumber(s)));return i.compare(dL)===1&&(i=new $a([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=jI(e),[s,i]=PI(t);for(let o=0;o<this.hashCount;o++){const u=this.ye(s,i,o);if(!this.we(u))return!1}return!0}static create(e,t,s){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),u=new Yv(o,i,t);return s.forEach(h=>u.insert(h)),u}insert(e){if(this.ge===0)return;const t=jI(e),[s,i]=PI(t);for(let o=0;o<this.hashCount;o++){const u=this.ye(s,i,o);this.Se(u)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Qd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e,t,s,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const i=new Map;return i.set(e,tf.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new ef(Ve.min(),i,new Pt($e),bs(),Ke())}}class tf{constructor(e,t,s,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new tf(s,t,Ke(),Ke(),Ke())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e,t,s,i){this.be=e,this.removedTargetIds=t,this.key=s,this.De=i}}class V1{constructor(e,t){this.targetId=e,this.Ce=t}}class L1{constructor(e,t,s=en.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=i}}class OI{constructor(){this.ve=0,this.Fe=MI(),this.Me=en.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ke(),t=Ke(),s=Ke();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:s=s.add(i);break;default:Ae(38017,{changeType:o})}}),new tf(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=MI()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ke(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class hL{constructor(e){this.Ge=e,this.ze=new Map,this.je=bs(),this.Je=km(),this.He=km(),this.Ye=new Pt($e)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:Ae(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((s,i)=>{this.rt(i)&&t(i)})}st(e){const t=e.targetId,s=e.Ce.count,i=this.ot(t);if(i){const o=i.target;if(vp(o))if(s===0){const u=new Te(o.path);this.et(t,u,Vt.newNoDocument(u,Ve.min()))}else ke(s===1,20013,{expectedCount:s});else{const u=this._t(t);if(u!==s){const h=this.ut(e),f=h?this.ct(h,e,u):1;if(f!==0){this.it(t);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:i=0},hashCount:o=0}=t;let u,h;try{u=Ki(s).toUint8Array()}catch(f){if(f instanceof s1)return di("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{h=new Yv(u,i,o)}catch(f){return di(f instanceof Qd?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return h.ge===0?null:h}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let i=0;return s.forEach(o=>{const u=this.Ge.ht(),h=`projects/${u.projectId}/databases/${u.database}/documents/${o.path.canonicalString()}`;e.mightContain(h)||(this.et(t,o,null),i++)}),i}Tt(e){const t=new Map;this.ze.forEach((o,u)=>{const h=this.ot(u);if(h){if(o.current&&vp(h.target)){const f=new Te(h.target.path);this.It(f).has(u)||this.Et(u,f)||this.et(u,f,Vt.newNoDocument(f,e))}o.Be&&(t.set(u,o.ke()),o.qe())}});let s=Ke();this.He.forEach((o,u)=>{let h=!0;u.forEachWhile(f=>{const p=this.ot(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)}),h&&(s=s.add(o))}),this.je.forEach((o,u)=>u.setReadTime(e));const i=new ef(e,t,this.Ye,this.je,s);return this.je=bs(),this.Je=km(),this.He=km(),this.Ye=new Pt($e),i}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new OI,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Et($e),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Et($e),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ye("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new OI),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function km(){return new Pt(Te.comparator)}function MI(){return new Pt(Te.comparator)}const fL={asc:"ASCENDING",desc:"DESCENDING"},mL={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},pL={and:"AND",or:"OR"};class gL{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Nx(n,e){return n.useProto3Json||Qh(e)?e:{value:e}}function ru(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function U1(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function yL(n,e){return ru(n,e.toTimestamp())}function dn(n){return ke(!!n,49232),Ve.fromTimestamp(function(t){const s=$i(t);return new _t(s.seconds,s.nanos)}(n))}function Xv(n,e){return Ax(n,e).canonicalString()}function Ax(n,e){const t=function(i){return new nt(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function F1(n){const e=nt.fromString(n);return ke(Y1(e),10190,{key:e.toString()}),e}function Ch(n,e){return Xv(n.databaseId,e.path)}function oi(n,e){const t=F1(e);if(t.get(1)!==n.databaseId.projectId)throw new pe(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new pe(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Te(q1(t))}function B1(n,e){return Xv(n.databaseId,e)}function z1(n){const e=F1(n);return e.length===4?nt.emptyPath():q1(e)}function Rx(n){return new nt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function q1(n){return ke(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function VI(n,e,t){return{name:Ch(n,e),fields:t.value.mapValue.fields}}function H1(n,e,t){const s=oi(n,e.name),i=dn(e.updateTime),o=e.createTime?dn(e.createTime):Ve.min(),u=new qn({mapValue:{fields:e.fields}}),h=Vt.newFoundDocument(s,i,o,u);return t&&h.setHasCommittedMutations(),t?h.setHasCommittedMutations():h}function xL(n,e){return"found"in e?function(s,i){ke(!!i.found,43571),i.found.name,i.found.updateTime;const o=oi(s,i.found.name),u=dn(i.found.updateTime),h=i.found.createTime?dn(i.found.createTime):Ve.min(),f=new qn({mapValue:{fields:i.found.fields}});return Vt.newFoundDocument(o,u,h,f)}(n,e):"missing"in e?function(s,i){ke(!!i.missing,3894),ke(!!i.readTime,22933);const o=oi(s,i.missing),u=dn(i.readTime);return Vt.newNoDocument(o,u)}(n,e):Ae(7234,{result:e})}function vL(n,e){let t;if("targetChange"in e){e.targetChange;const s=function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Ae(39313,{state:p})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(p,x){return p.useProto3Json?(ke(x===void 0||typeof x=="string",58123),en.fromBase64String(x||"")):(ke(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),en.fromUint8Array(x||new Uint8Array))}(n,e.targetChange.resumeToken),u=e.targetChange.cause,h=u&&function(p){const x=p.code===void 0?ie.UNKNOWN:O1(p.code);return new pe(x,p.message||"")}(u);t=new L1(s,i,o,h||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const i=oi(n,s.document.name),o=dn(s.document.updateTime),u=s.document.createTime?dn(s.document.createTime):Ve.min(),h=new qn({mapValue:{fields:s.document.fields}}),f=Vt.newFoundDocument(i,o,u,h),p=s.targetIds||[],x=s.removedTargetIds||[];t=new tp(p,x,f.key,f)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const i=oi(n,s.document),o=s.readTime?dn(s.readTime):Ve.min(),u=Vt.newNoDocument(i,o),h=s.removedTargetIds||[];t=new tp([],h,u.key,u)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const i=oi(n,s.document),o=s.removedTargetIds||[];t=new tp([],o,i,null)}else{if(!("filter"in e))return Ae(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:i=0,unchangedNames:o}=s,u=new uL(i,o),h=s.targetId;t=new V1(h,u)}}return t}function Dh(n,e){let t;if(e instanceof _u)t={update:VI(n,e.key,e.value)};else if(e instanceof bu)t={delete:Ch(n,e.key)};else if(e instanceof sa)t={update:VI(n,e.key,e.data),updateMask:IL(e.fieldMask)};else{if(!(e instanceof $v))return Ae(16599,{Vt:e.type});t={verify:Ch(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(s=>function(o,u){const h=u.transform;if(h instanceof nu)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof gl)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof yl)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof su)return{fieldPath:u.field.canonicalString(),increment:h.Ae};throw Ae(20930,{transform:u.transform})}(0,s))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:yL(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Ae(27497)}(n,e.precondition)),t}function Cx(n,e){const t=e.currentDocument?function(o){return o.updateTime!==void 0?Ht.updateTime(dn(o.updateTime)):o.exists!==void 0?Ht.exists(o.exists):Ht.none()}(e.currentDocument):Ht.none(),s=e.updateTransforms?e.updateTransforms.map(i=>function(u,h){let f=null;if("setToServerValue"in h)ke(h.setToServerValue==="REQUEST_TIME",16630,{proto:h}),f=new nu;else if("appendMissingElements"in h){const x=h.appendMissingElements.values||[];f=new gl(x)}else if("removeAllFromArray"in h){const x=h.removeAllFromArray.values||[];f=new yl(x)}else"increment"in h?f=new su(u,h.increment):Ae(16584,{proto:h});const p=qt.fromServerFormat(h.fieldPath);return new Zh(p,f)}(n,i)):[];if(e.update){e.update.name;const i=oi(n,e.update.name),o=new qn({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=function(f){const p=f.fieldPaths||[];return new _s(p.map(x=>qt.fromServerFormat(x)))}(e.updateMask);return new sa(i,o,u,t,s)}return new _u(i,o,t,s)}if(e.delete){const i=oi(n,e.delete);return new bu(i,t)}if(e.verify){const i=oi(n,e.verify);return new $v(i,t)}return Ae(1463,{proto:e})}function _L(n,e){return n&&n.length>0?(ke(e!==void 0,14353),n.map(t=>function(i,o){let u=i.updateTime?dn(i.updateTime):dn(o);return u.isEqual(Ve.min())&&(u=dn(o)),new oL(u,i.transformResults||[])}(t,e))):[]}function G1(n,e){return{documents:[B1(n,e.path)]}}function $1(n,e){const t={structuredQuery:{}},s=e.path;let i;e.collectionGroup!==null?(i=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=B1(n,i);const o=function(p){if(p.length!==0)return W1(Tt.create(p,"and"))}(e.filters);o&&(t.structuredQuery.where=o);const u=function(p){if(p.length!==0)return p.map(x=>function(b){return{field:Cc(b.field),direction:wL(b.dir)}}(x))}(e.orderBy);u&&(t.structuredQuery.orderBy=u);const h=Nx(n,e.limit);return h!==null&&(t.structuredQuery.limit=h),e.startAt&&(t.structuredQuery.startAt=function(p){return{before:p.inclusive,values:p.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(p){return{before:!p.inclusive,values:p.position}}(e.endAt)),{ft:t,parent:i}}function K1(n){let e=z1(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let i=null;if(s>0){ke(s===1,65062);const x=t.from[0];x.allDescendants?i=x.collectionId:e=e.child(x.collectionId)}let o=[];t.where&&(o=function(v){const b=Q1(v);return b instanceof Tt&&zv(b)?b.getFilters():[b]}(t.where));let u=[];t.orderBy&&(u=function(v){return v.map(b=>function(N){return new Rh(Dc(N.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(b))}(t.orderBy));let h=null;t.limit&&(h=function(v){let b;return b=typeof v=="object"?v.value:v,Qh(b)?null:b}(t.limit));let f=null;t.startAt&&(f=function(v){const b=!!v.before,I=v.values||[];return new so(I,b)}(t.startAt));let p=null;return t.endAt&&(p=function(v){const b=!v.before,I=v.values||[];return new so(I,b)}(t.endAt)),v1(e,i,u,o,h,"F",f,p)}function bL(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ae(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Q1(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=Dc(t.unaryFilter.field);return st.create(s,"==",{doubleValue:NaN});case"IS_NULL":const i=Dc(t.unaryFilter.field);return st.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Dc(t.unaryFilter.field);return st.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=Dc(t.unaryFilter.field);return st.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ae(61313);default:return Ae(60726)}}(n):n.fieldFilter!==void 0?function(t){return st.create(Dc(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ae(58110);default:return Ae(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Tt.create(t.compositeFilter.filters.map(s=>Q1(s)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ae(1026)}}(t.compositeFilter.op))}(n):Ae(30097,{filter:n})}function wL(n){return fL[n]}function TL(n){return mL[n]}function EL(n){return pL[n]}function Cc(n){return{fieldPath:n.canonicalString()}}function Dc(n){return qt.fromServerFormat(n.fieldPath)}function W1(n){return n instanceof st?function(t){if(t.op==="=="){if(bI(t.value))return{unaryFilter:{field:Cc(t.field),op:"IS_NAN"}};if(_I(t.value))return{unaryFilter:{field:Cc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(bI(t.value))return{unaryFilter:{field:Cc(t.field),op:"IS_NOT_NAN"}};if(_I(t.value))return{unaryFilter:{field:Cc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Cc(t.field),op:TL(t.op),value:t.value}}}(n):n instanceof Tt?function(t){const s=t.getFilters().map(i=>W1(i));return s.length===1?s[0]:{compositeFilter:{op:EL(t.op),filters:s}}}(n):Ae(54877,{filter:n})}function IL(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Y1(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e,t,s,i,o=Ve.min(),u=Ve.min(),h=en.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=h,this.expectedCount=f}withSequenceNumber(e){return new Li(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Li(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Li(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Li(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1{constructor(e){this.yt=e}}function SL(n,e){let t;if(e.document)t=H1(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=Te.fromSegments(e.noDocument.path),i=vl(e.noDocument.readTime);t=Vt.newNoDocument(s,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ae(56709);{const s=Te.fromSegments(e.unknownDocument.path),i=vl(e.unknownDocument.version);t=Vt.newUnknownDocument(s,i)}}return e.readTime&&t.setReadTime(function(i){const o=new _t(i[0],i[1]);return Ve.fromTimestamp(o)}(e.readTime)),t}function LI(n,e){const t=e.key,s={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:wp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=function(o,u){return{name:Ch(o,u.key),fields:u.data.value.mapValue.fields,updateTime:ru(o,u.version.toTimestamp()),createTime:ru(o,u.createTime.toTimestamp())}}(n.yt,e);else if(e.isNoDocument())s.noDocument={path:t.path.toArray(),readTime:xl(e.version)};else{if(!e.isUnknownDocument())return Ae(57904,{document:e});s.unknownDocument={path:t.path.toArray(),version:xl(e.version)}}return s}function wp(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function xl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function vl(n){const e=new _t(n.seconds,n.nanoseconds);return Ve.fromTimestamp(e)}function Zo(n,e){const t=(e.baseMutations||[]).map(o=>Cx(n.yt,o));for(let o=0;o<e.mutations.length-1;++o){const u=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const h=e.mutations[o+1];u.updateTransforms=h.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const s=e.mutations.map(o=>Cx(n.yt,o)),i=_t.fromMillis(e.localWriteTimeMs);return new Kv(e.batchId,i,t,s)}function Wd(n){const e=vl(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?vl(n.lastLimboFreeSnapshotVersion):Ve.min();let s;return s=function(o){return o.documents!==void 0}(n.query)?function(o){const u=o.documents.length;return ke(u===1,1966,{count:u}),ds(vu(z1(o.documents[0])))}(n.query):function(o){return ds(K1(o))}(n.query),new Li(s,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,en.fromBase64String(n.resumeToken))}function J1(n,e){const t=xl(e.snapshotVersion),s=xl(e.lastLimboFreeSnapshotVersion);let i;i=vp(e.target)?G1(n.yt,e.target):$1(n.yt,e.target).ft;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:pl(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:i}}function Jv(n){const e=K1({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?bp(e,e.limit,"L"):e}function B0(n,e){return new Wv(e.largestBatchId,Cx(n.yt,e.overlayMutation))}function UI(n,e){const t=e.path.lastSegment();return[n,ns(e.path.popLast()),t]}function FI(n,e,t,s){return{indexId:n,uid:e,sequenceNumber:t,readTime:xl(s.readTime),documentKey:ns(s.documentKey.path),largestBatchId:s.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NL{getBundleMetadata(e,t){return BI(e).get(t).next(s=>{if(s)return function(o){return{id:o.bundleId,createTime:vl(o.createTime),version:o.version}}(s)})}saveBundleMetadata(e,t){return BI(e).put(function(i){return{bundleId:i.id,createTime:xl(dn(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return zI(e).get(t).next(s=>{if(s)return function(o){return{name:o.name,query:Jv(o.bundledQuery),readTime:vl(o.readTime)}}(s)})}saveNamedQuery(e,t){return zI(e).put(function(i){return{name:i.name,readTime:xl(dn(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function BI(n){return Sn(n,Yp)}function zI(n){return Sn(n,Xp)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const s=t.uid||"";return new rg(e,s)}getOverlay(e,t){return Od(e).get(UI(this.userId,t)).next(s=>s?B0(this.serializer,s):null)}getOverlays(e,t){const s=ii();return Y.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&s.set(i,o)})).next(()=>s)}saveOverlays(e,t,s){const i=[];return s.forEach((o,u)=>{const h=new Wv(t,u);i.push(this.St(e,h))}),Y.waitFor(i)}removeOverlaysForBatchId(e,t,s){const i=new Set;t.forEach(u=>i.add(ns(u.getCollectionPath())));const o=[];return i.forEach(u=>{const h=IDBKeyRange.bound([this.userId,u,s],[this.userId,u,s+1],!1,!0);o.push(Od(e).Z(xx,h))}),Y.waitFor(o)}getOverlaysForCollection(e,t,s){const i=ii(),o=ns(t),u=IDBKeyRange.bound([this.userId,o,s],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Od(e).J(xx,u).next(h=>{for(const f of h){const p=B0(this.serializer,f);i.set(p.getKey(),p)}return i})}getOverlaysForCollectionGroup(e,t,s,i){const o=ii();let u;const h=IDBKeyRange.bound([this.userId,t,s],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Od(e).ee({index:XA,range:h},(f,p,x)=>{const v=B0(this.serializer,p);o.size()<i||v.largestBatchId===u?(o.set(v.getKey(),v),u=v.largestBatchId):x.done()}).next(()=>o)}St(e,t){return Od(e).put(function(i,o,u){const[h,f,p]=UI(o,u.mutation.key);return{userId:o,collectionPath:f,documentId:p,collectionGroup:u.mutation.key.getCollectionGroup(),largestBatchId:u.largestBatchId,overlayMutation:Dh(i.yt,u.mutation)}}(this.serializer,this.userId,t))}}function Od(n){return Sn(n,Jp)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AL{bt(e){return Sn(e,Lv)}getSessionToken(e){return this.bt(e).get("sessionToken").next(t=>{const s=t?.value;return s?en.fromUint8Array(s):en.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(zt(e.integerValue));else if("doubleValue"in e){const s=zt(e.doubleValue);isNaN(s)?this.Ft(t,13):(this.Ft(t,15),wh(s)?t.Mt(0):t.Mt(s))}else if("timestampValue"in e){let s=e.timestampValue;this.Ft(t,20),typeof s=="string"&&(s=$i(s)),t.xt(`${s.seconds||""}`),t.Mt(s.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Ki(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const s=e.geoPointValue;this.Ft(t,45),t.Mt(s.latitude||0),t.Mt(s.longitude||0)}else"mapValue"in e?c1(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):tg(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Ae(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const s=e.fields||{};this.Ft(t,55);for(const i of Object.keys(s))this.Ot(i,t),this.Ct(s[i],t)}kt(e,t){const s=e.fields||{};this.Ft(t,53);const i=Zc,o=s[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(zt(o)),this.Ot(i,t),this.Ct(s[i],t)}Qt(e,t){const s=e.values||[];this.Ft(t,50);for(const i of s)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),Te.fromName(e).path.forEach(s=>{this.Ft(t,60),this.Ut(s,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}el.Kt=new el;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wc=255;function RL(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function qI(n){const e=64-function(s){let i=0;for(let o=0;o<8;++o){const u=RL(255&s[o]);if(i+=u,u!==8)break}return i}(n);return Math.ceil(e/8)}class CL{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Gt(s.value),s=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Jt(s.value),s=t.next();this.Ht()}Yt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Gt(s);else if(s<2048)this.Gt(960|s>>>6),this.Gt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Jt(s);else if(s<2048)this.Jt(960|s>>>6),this.Jt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),s=qI(t);this.tn(1+s),this.buffer[this.position++]=255&s;for(let i=t.length-s;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),s=qI(t);this.tn(1+s),this.buffer[this.position++]=~(255&s);for(let i=t.length-s;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(wc),this.sn(255)}_n(){this.an(wc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=function(o){const u=new DataView(new ArrayBuffer(8));return u.setFloat64(0,o,!1),new Uint8Array(u.buffer)}(e),s=!!(128&t[0]);t[0]^=s?255:128;for(let i=1;i<t.length;++i)t[i]^=s?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===wc?(this.sn(wc),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===wc?(this.an(wc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let s=2*this.buffer.length;s<t&&(s=t);const i=new Uint8Array(s);i.set(this.buffer),this.buffer=i}}class DL{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class kL{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Md{constructor(){this.cn=new CL,this.ln=new DL(this.cn),this.hn=new kL(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e,t,s,i){this.Tn=e,this.In=t,this.En=s,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,s=new Uint8Array(t);return s.set(this.dn,0),t!==e?s.set([0],this.dn.length):++s[s.length-1],new tl(this.Tn,this.In,this.En,s)}Rn(e,t,s){return{indexId:this.Tn,uid:e,arrayValue:np(this.En),directionalValue:np(this.dn),orderedDocumentKey:np(t),documentKey:s.path.toArray()}}Vn(e,t,s){const i=this.Rn(e,t,s);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Ma(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=HI(n.En,e.En),t!==0?t:(t=HI(n.dn,e.dn),t!==0?t:Te.comparator(n.In,e.In)))}function HI(n,e){for(let t=0;t<n.length&&t<e.length;++t){const s=n[t]-e[t];if(s!==0)return s}return n.length-e.length}function np(n){return pN()?function(t){let s="";for(let i=0;i<t.length;i++)s+=String.fromCharCode(t[i]);return s}(n):n}function GI(n){return typeof n!="string"?n:function(t){const s=new Uint8Array(t.length);for(let i=0;i<t.length;i++)s[i]=t.charCodeAt(i);return s}(n)}class $I{constructor(e){this.mn=new Et((t,s)=>qt.comparator(t.field,s.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const s=t;s.isInequality()?this.mn=this.mn.add(s):this.gn.push(s)}}get pn(){return this.mn.size>1}yn(e){if(ke(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=px(e);if(t!==void 0&&!this.wn(t))return!1;const s=Wo(e);let i=new Set,o=0,u=0;for(;o<s.length&&this.wn(s[o]);++o)i=i.add(s[o].fieldPath.canonicalString());if(o===s.length)return!0;if(this.mn.size>0){const h=this.mn.getIterator().getNext();if(!i.has(h.field.canonicalString())){const f=s[o];if(!this.Sn(h,f)||!this.bn(this.fn[u++],f))return!1}++o}for(;o<s.length;++o){const h=s[o];if(u>=this.fn.length||!this.bn(this.fn[u++],h))return!1}return!0}Dn(){if(this.pn)return null;let e=new Et(qt.comparator);const t=[];for(const s of this.gn)if(!s.field.isKeyField())if(s.op==="array-contains"||s.op==="array-contains-any")t.push(new Qm(s.field,2));else{if(e.has(s.field))continue;e=e.add(s.field),t.push(new Qm(s.field,0))}for(const s of this.fn)s.field.isKeyField()||e.has(s.field)||(e=e.add(s.field),t.push(new Qm(s.field,s.dir==="asc"?0:1)));return new pp(pp.UNKNOWN_ID,this.collectionId,t,bh.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===s}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z1(n){if(ke(n instanceof st||n instanceof Tt,20012),n instanceof st){if(n instanceof x1){const t=n.value.arrayValue?.values?.map(s=>st.create(n.field,"==",s))||[];return Tt.create(t,"or")}return n}const e=n.filters.map(t=>Z1(t));return Tt.create(e,n.op)}function jL(n){if(n.getFilters().length===0)return[];const e=jx(Z1(n));return ke(e2(e),7391),Dx(e)||kx(e)?[e]:e.getFilters()}function Dx(n){return n instanceof st}function kx(n){return n instanceof Tt&&zv(n)}function e2(n){return Dx(n)||kx(n)||function(t){if(t instanceof Tt&&Tx(t)){for(const s of t.getFilters())if(!Dx(s)&&!kx(s))return!1;return!0}return!1}(n)}function jx(n){if(ke(n instanceof st||n instanceof Tt,34018),n instanceof st)return n;if(n.filters.length===1)return jx(n.filters[0]);const e=n.filters.map(s=>jx(s));let t=Tt.create(e,n.op);return t=Tp(t),e2(t)?t:(ke(t instanceof Tt,64498),ke(tu(t),40251),ke(t.filters.length>1,57927),t.filters.reduce((s,i)=>Zv(s,i)))}function Zv(n,e){let t;return ke(n instanceof st||n instanceof Tt,38388),ke(e instanceof st||e instanceof Tt,25473),t=n instanceof st?e instanceof st?function(i,o){return Tt.create([i,o],"and")}(n,e):KI(n,e):e instanceof st?KI(e,n):function(i,o){if(ke(i.filters.length>0&&o.filters.length>0,48005),tu(i)&&tu(o))return p1(i,o.getFilters());const u=Tx(i)?i:o,h=Tx(i)?o:i,f=u.filters.map(p=>Zv(p,h));return Tt.create(f,"or")}(n,e),Tp(t)}function KI(n,e){if(tu(e))return p1(e,n.getFilters());{const t=e.filters.map(s=>Zv(n,s));return Tt.create(t,"or")}}function Tp(n){if(ke(n instanceof st||n instanceof Tt,11850),n instanceof st)return n;const e=n.getFilters();if(e.length===1)return Tp(e[0]);if(f1(n))return n;const t=e.map(i=>Tp(i)),s=[];return t.forEach(i=>{i instanceof st?s.push(i):i instanceof Tt&&(i.op===n.op?s.push(...i.filters):s.push(i))}),s.length===1?s[0]:Tt.create(s,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL{constructor(){this.Cn=new e_}addToCollectionParentIndex(e,t){return this.Cn.add(t),Y.resolve()}getCollectionParents(e,t){return Y.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Y.resolve()}deleteFieldIndex(e,t){return Y.resolve()}deleteAllFieldIndexes(e){return Y.resolve()}createTargetIndexes(e,t){return Y.resolve()}getDocumentsMatchingTarget(e,t){return Y.resolve(null)}getIndexType(e,t){return Y.resolve(0)}getFieldIndexes(e,t){return Y.resolve([])}getNextCollectionGroupToUpdate(e){return Y.resolve(null)}getMinOffset(e,t){return Y.resolve(Bs.min())}getMinOffsetFromCollectionGroup(e,t){return Y.resolve(Bs.min())}updateCollectionGroup(e,t,s){return Y.resolve()}updateIndexEntries(e,t){return Y.resolve()}}class e_{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),i=this.index[t]||new Et(nt.comparator),o=!i.has(s);return this.index[t]=i.add(s),o}has(e){const t=e.lastSegment(),s=e.popLast(),i=this.index[t];return i&&i.has(s)}getEntries(e){return(this.index[e]||new Et(nt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QI="IndexedDbIndexManager",jm=new Uint8Array(0);class OL{constructor(e,t){this.databaseId=t,this.vn=new e_,this.Fn=new na(s=>pl(s),(s,i)=>Yh(s,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const s=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});const o={collectionId:s,parent:ns(i)};return WI(e).put(o)}return Y.resolve()}getCollectionParents(e,t){const s=[],i=IDBKeyRange.bound([t,""],[MA(t),""],!1,!0);return WI(e).J(i).next(o=>{for(const u of o){if(u.collectionId!==t)break;s.push(ri(u.parent))}return s})}addFieldIndex(e,t){const s=Vd(e),i=function(h){return{indexId:h.indexId,collectionGroup:h.collectionGroup,fields:h.fields.map(f=>[f.fieldPath.canonicalString(),f.kind])}}(t);delete i.indexId;const o=s.add(i);if(t.indexState){const u=Ec(e);return o.next(h=>{u.put(FI(h,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){const s=Vd(e),i=Ec(e),o=Tc(e);return s.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Vd(e),s=Tc(e),i=Ec(e);return t.Z().next(()=>s.Z()).next(()=>i.Z())}createTargetIndexes(e,t){return Y.forEach(this.Mn(t),s=>this.getIndexType(e,s).next(i=>{if(i===0||i===1){const o=new $I(s).Dn();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){const s=Tc(e);let i=!0;const o=new Map;return Y.forEach(this.Mn(t),u=>this.xn(e,u).next(h=>{i&&(i=!!h),o.set(u,h)})).next(()=>{if(i){let u=Ke();const h=[];return Y.forEach(o,(f,p)=>{ye(QI,`Using index ${function(P){return`id=${P.indexId}|cg=${P.collectionGroup}|f=${P.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`}(f)} to execute ${pl(t)}`);const x=function(P,V){const F=px(V);if(F===void 0)return null;for(const K of _p(P,F.fieldPath))switch(K.op){case"array-contains-any":return K.value.arrayValue.values||[];case"array-contains":return[K.value]}return null}(p,f),v=function(P,V){const F=new Map;for(const K of Wo(V))for(const L of _p(P,K.fieldPath))switch(L.op){case"==":case"in":F.set(K.fieldPath.canonicalString(),L.value);break;case"not-in":case"!=":return F.set(K.fieldPath.canonicalString(),L.value),Array.from(F.values())}return null}(p,f),b=function(P,V){const F=[];let K=!0;for(const L of Wo(V)){const k=L.kind===0?SI(P,L.fieldPath,P.startAt):NI(P,L.fieldPath,P.startAt);F.push(k.value),K&&(K=k.inclusive)}return new so(F,K)}(p,f),I=function(P,V){const F=[];let K=!0;for(const L of Wo(V)){const k=L.kind===0?NI(P,L.fieldPath,P.endAt):SI(P,L.fieldPath,P.endAt);F.push(k.value),K&&(K=k.inclusive)}return new so(F,K)}(p,f),N=this.On(f,p,b),E=this.On(f,p,I),A=this.Nn(f,p,v),C=this.Bn(f.indexId,x,N,b.inclusive,E,I.inclusive,A);return Y.forEach(C,q=>s.Y(q,t.limit).next(P=>{P.forEach(V=>{const F=Te.fromSegments(V.documentKey);u.has(F)||(u=u.add(F),h.push(F))})}))}).next(()=>h)}return Y.resolve(null)})}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=jL(Tt.create(e.filters,"and")).map(s=>Ix(e.path,e.collectionGroup,e.orderBy,s.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,t),t)}Bn(e,t,s,i,o,u,h){const f=(t!=null?t.length:1)*Math.max(s.length,o.length),p=f/(t!=null?t.length:1),x=[];for(let v=0;v<f;++v){const b=t?this.Ln(t[v/p]):jm,I=this.kn(e,b,s[v%p],i),N=this.qn(e,b,o[v%p],u),E=h.map(A=>this.kn(e,b,A,!0));x.push(...this.createRange(I,N,E))}return x}kn(e,t,s,i){const o=new tl(e,Te.empty(),t,s);return i?o:o.An()}qn(e,t,s,i){const o=new tl(e,Te.empty(),t,s);return i?o.An():o}xn(e,t){const s=new $I(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let u=null;for(const h of o)s.yn(h)&&(!u||h.fields.length>u.fields.length)&&(u=h);return u})}getIndexType(e,t){let s=2;const i=this.Mn(t);return Y.forEach(i,o=>this.xn(e,o).next(u=>{u?s!==0&&u.fields.length<function(f){let p=new Et(qt.comparator),x=!1;for(const v of f.filters)for(const b of v.getFlattenedFilters())b.field.isKeyField()||(b.op==="array-contains"||b.op==="array-contains-any"?x=!0:p=p.add(b.field));for(const v of f.orderBy)v.field.isKeyField()||(p=p.add(v.field));return p.size+(x?1:0)}(o)&&(s=1):s=0})).next(()=>function(u){return u.limit!==null}(t)&&i.length>1&&s===2?1:s)}Qn(e,t){const s=new Md;for(const i of Wo(e)){const o=t.data.field(i.fieldPath);if(o==null)return null;const u=s.Pn(i.kind);el.Kt.Dt(o,u)}return s.un()}Ln(e){const t=new Md;return el.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const s=new Md;return el.Kt.Dt(ml(this.databaseId,t),s.Pn(function(o){const u=Wo(o);return u.length===0?0:u[u.length-1].kind}(e))),s.un()}Nn(e,t,s){if(s===null)return[];let i=[];i.push(new Md);let o=0;for(const u of Wo(e)){const h=s[o++];for(const f of i)if(this.Un(t,u.fieldPath)&&Ah(h))i=this.Kn(i,u,h);else{const p=f.Pn(u.kind);el.Kt.Dt(h,p)}}return this.Wn(i)}On(e,t,s){return this.Nn(e,t,s.position)}Wn(e){const t=[];for(let s=0;s<e.length;++s)t[s]=e[s].un();return t}Kn(e,t,s){const i=[...e],o=[];for(const u of s.arrayValue.values||[])for(const h of i){const f=new Md;f.seed(h.un()),el.Kt.Dt(u,f.Pn(t.kind)),o.push(f)}return o}Un(e,t){return!!e.filters.find(s=>s instanceof st&&s.field.isEqual(t)&&(s.op==="in"||s.op==="not-in"))}getFieldIndexes(e,t){const s=Vd(e),i=Ec(e);return(t?s.J(yx,IDBKeyRange.bound(t,t)):s.J()).next(o=>{const u=[];return Y.forEach(o,h=>i.get([h.indexId,this.uid]).next(f=>{u.push(function(x,v){const b=v?new bh(v.sequenceNumber,new Bs(vl(v.readTime),new Te(ri(v.documentKey)),v.largestBatchId)):bh.empty(),I=x.fields.map(([N,E])=>new Qm(qt.fromServerFormat(N),E));return new pp(x.indexId,x.collectionGroup,I,b)}(h,f))})).next(()=>u)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((s,i)=>{const o=s.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:$e(s.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,s){const i=Vd(e),o=Ec(e);return this.Gn(e).next(u=>i.J(yx,IDBKeyRange.bound(t,t)).next(h=>Y.forEach(h,f=>o.put(FI(f.indexId,this.uid,u,s)))))}updateIndexEntries(e,t){const s=new Map;return Y.forEach(t,(i,o)=>{const u=s.get(i.collectionGroup);return(u?Y.resolve(u):this.getFieldIndexes(e,i.collectionGroup)).next(h=>(s.set(i.collectionGroup,h),Y.forEach(h,f=>this.zn(e,i,f).next(p=>{const x=this.jn(o,f);return p.isEqual(x)?Y.resolve():this.Jn(e,o,f,p,x)}))))})}Hn(e,t,s,i){return Tc(e).put(i.Rn(this.uid,this.$n(s,t.key),t.key))}Yn(e,t,s,i){return Tc(e).delete(i.Vn(this.uid,this.$n(s,t.key),t.key))}zn(e,t,s){const i=Tc(e);let o=new Et(Ma);return i.ee({index:YA,range:IDBKeyRange.only([s.indexId,this.uid,np(this.$n(s,t))])},(u,h)=>{o=o.add(new tl(s.indexId,t,GI(h.arrayValue),GI(h.directionalValue)))}).next(()=>o)}jn(e,t){let s=new Et(Ma);const i=this.Qn(t,e);if(i==null)return s;const o=px(t);if(o!=null){const u=e.data.field(o.fieldPath);if(Ah(u))for(const h of u.arrayValue.values||[])s=s.add(new tl(t.indexId,e.key,this.Ln(h),i))}else s=s.add(new tl(t.indexId,e.key,jm,i));return s}Jn(e,t,s,i,o){ye(QI,"Updating index entries for document '%s'",t.key);const u=[];return function(f,p,x,v,b){const I=f.getIterator(),N=p.getIterator();let E=bc(I),A=bc(N);for(;E||A;){let C=!1,q=!1;if(E&&A){const P=x(E,A);P<0?q=!0:P>0&&(C=!0)}else E!=null?q=!0:C=!0;C?(v(A),A=bc(N)):q?(b(E),E=bc(I)):(E=bc(I),A=bc(N))}}(i,o,Ma,h=>{u.push(this.Hn(e,t,s,h))},h=>{u.push(this.Yn(e,t,s,h))}),Y.waitFor(u)}Gn(e){let t=1;return Ec(e).ee({index:WA,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(s,i,o)=>{o.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,s){s=s.sort((u,h)=>Ma(u,h)).filter((u,h,f)=>!h||Ma(u,f[h-1])!==0);const i=[];i.push(e);for(const u of s){const h=Ma(u,e),f=Ma(u,t);if(h===0)i[0]=e.An();else if(h>0&&f<0)i.push(u),i.push(u.An());else if(f>0)break}i.push(t);const o=[];for(let u=0;u<i.length;u+=2){if(this.Zn(i[u],i[u+1]))return[];const h=i[u].Vn(this.uid,jm,Te.empty()),f=i[u+1].Vn(this.uid,jm,Te.empty());o.push(IDBKeyRange.bound(h,f))}return o}Zn(e,t){return Ma(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(YI)}getMinOffset(e,t){return Y.mapArray(this.Mn(t),s=>this.xn(e,s).next(i=>i||Ae(44426))).next(YI)}}function WI(n){return Sn(n,Ih)}function Tc(n){return Sn(n,ah)}function Vd(n){return Sn(n,Vv)}function Ec(n){return Sn(n,ih)}function YI(n){ke(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let s=1;s<n.length;s++){const i=n[s].indexState.offset;Pv(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Bs(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},t2=41943040;class Xn{static withCacheSize(e){return new Xn(e,Xn.DEFAULT_COLLECTION_PERCENTILE,Xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n2(n,e,t){const s=n.store(Tr),i=n.store(Wc),o=[],u=IDBKeyRange.only(t.batchId);let h=0;const f=s.ee({range:u},(x,v,b)=>(h++,b.delete()));o.push(f.next(()=>{ke(h===1,47070,{batchId:t.batchId})}));const p=[];for(const x of t.mutations){const v=$A(e,x.key.path,t.batchId);o.push(i.delete(v)),p.push(x.key)}return Y.waitFor(o).next(()=>p)}function Ep(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ae(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xn.DEFAULT_COLLECTION_PERCENTILE=10,Xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xn.DEFAULT=new Xn(t2,Xn.DEFAULT_COLLECTION_PERCENTILE,Xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xn.DISABLED=new Xn(-1,0,0);class ig{constructor(e,t,s,i){this.userId=e,this.serializer=t,this.indexManager=s,this.referenceDelegate=i,this.Xn={}}static wt(e,t,s,i){ke(e.uid!=="",64387);const o=e.isAuthenticated()?e.uid:"";return new ig(o,t,s,i)}checkEmpty(e){let t=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Va(e).ee({index:rl,range:s},(i,o,u)=>{t=!1,u.done()}).next(()=>t)}addMutationBatch(e,t,s,i){const o=kc(e),u=Va(e);return u.add({}).next(h=>{ke(typeof h=="number",49019);const f=new Kv(h,t,s,i),p=function(I,N,E){const A=E.baseMutations.map(q=>Dh(I.yt,q)),C=E.mutations.map(q=>Dh(I.yt,q));return{userId:N,batchId:E.batchId,localWriteTimeMs:E.localWriteTime.toMillis(),baseMutations:A,mutations:C}}(this.serializer,this.userId,f),x=[];let v=new Et((b,I)=>$e(b.canonicalString(),I.canonicalString()));for(const b of i){const I=$A(this.userId,b.key.path,h);v=v.add(b.key.path.popLast()),x.push(u.put(p)),x.push(o.put(I,p5))}return v.forEach(b=>{x.push(this.indexManager.addToCollectionParentIndex(e,b))}),e.addOnCommittedListener(()=>{this.Xn[h]=f.keys()}),Y.waitFor(x).next(()=>f)})}lookupMutationBatch(e,t){return Va(e).get(t).next(s=>s?(ke(s.userId===this.userId,48,"Unexpected user for mutation batch",{userId:s.userId,batchId:t}),Zo(this.serializer,s)):null)}er(e,t){return this.Xn[t]?Y.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next(s=>{if(s){const i=s.keys();return this.Xn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const s=t+1,i=IDBKeyRange.lowerBound([this.userId,s]);let o=null;return Va(e).ee({index:rl,range:i},(u,h,f)=>{h.userId===this.userId&&(ke(h.batchId>=s,47524,{tr:s}),o=Zo(this.serializer,h)),f.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=Ka;return Va(e).ee({index:rl,range:t,reverse:!0},(i,o,u)=>{s=o.batchId,u.done()}).next(()=>s)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Ka],[this.userId,Number.POSITIVE_INFINITY]);return Va(e).J(rl,t).next(s=>s.map(i=>Zo(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const s=Wm(this.userId,t.path),i=IDBKeyRange.lowerBound(s),o=[];return kc(e).ee({range:i},(u,h,f)=>{const[p,x,v]=u,b=ri(x);if(p===this.userId&&t.path.isEqual(b))return Va(e).get(v).next(I=>{if(!I)throw Ae(61480,{nr:u,batchId:v});ke(I.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:I.userId,batchId:v}),o.push(Zo(this.serializer,I))});f.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Et($e);const i=[];return t.forEach(o=>{const u=Wm(this.userId,o.path),h=IDBKeyRange.lowerBound(u),f=kc(e).ee({range:h},(p,x,v)=>{const[b,I,N]=p,E=ri(I);b===this.userId&&o.path.isEqual(E)?s=s.add(N):v.done()});i.push(f)}),Y.waitFor(i).next(()=>this.rr(e,s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,i=s.length+1,o=Wm(this.userId,s),u=IDBKeyRange.lowerBound(o);let h=new Et($e);return kc(e).ee({range:u},(f,p,x)=>{const[v,b,I]=f,N=ri(b);v===this.userId&&s.isPrefixOf(N)?N.length===i&&(h=h.add(I)):x.done()}).next(()=>this.rr(e,h))}rr(e,t){const s=[],i=[];return t.forEach(o=>{i.push(Va(e).get(o).next(u=>{if(u===null)throw Ae(35274,{batchId:o});ke(u.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:u.userId,batchId:o}),s.push(Zo(this.serializer,u))}))}),Y.waitFor(i).next(()=>s)}removeMutationBatch(e,t){return n2(e.le,this.userId,t).next(s=>(e.addOnCommittedListener(()=>{this.ir(t.batchId)}),Y.forEach(s,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return Y.resolve();const s=IDBKeyRange.lowerBound(function(u){return[u]}(this.userId)),i=[];return kc(e).ee({range:s},(o,u,h)=>{if(o[0]===this.userId){const f=ri(o[1]);i.push(f)}else h.done()}).next(()=>{ke(i.length===0,56720,{sr:i.map(o=>o.canonicalString())})})})}containsKey(e,t){return s2(e,this.userId,t)}_r(e){return r2(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:Ka,lastStreamToken:""})}}function s2(n,e,t){const s=Wm(e,t.path),i=s[1],o=IDBKeyRange.lowerBound(s);let u=!1;return kc(n).ee({range:o,X:!0},(h,f,p)=>{const[x,v,b]=h;x===e&&v===i&&(u=!0),p.done()}).next(()=>u)}function Va(n){return Sn(n,Tr)}function kc(n){return Sn(n,Wc)}function r2(n){return Sn(n,Th)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new _l(0)}static cr(){return new _l(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ML{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next(t=>{const s=new _l(t.highestTargetId);return t.highestTargetId=s.next(),this.hr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(t=>Ve.fromTimestamp(new _t(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,s){return this.lr(e).next(i=>(i.highestListenSequenceNumber=t,s&&(i.lastRemoteSnapshotVersion=s.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i)))}addTargetData(e,t){return this.Pr(e,t).next(()=>this.lr(e).next(s=>(s.targetCount+=1,this.Tr(t,s),this.hr(e,s))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Ic(e).delete(t.targetId)).next(()=>this.lr(e)).next(s=>(ke(s.targetCount>0,8065),s.targetCount-=1,this.hr(e,s)))}removeTargets(e,t,s){let i=0;const o=[];return Ic(e).ee((u,h)=>{const f=Wd(h);f.sequenceNumber<=t&&s.get(f.targetId)===null&&(i++,o.push(this.removeTargetData(e,f)))}).next(()=>Y.waitFor(o)).next(()=>i)}forEachTarget(e,t){return Ic(e).ee((s,i)=>{const o=Wd(i);t(o)})}lr(e){return JI(e).get(xp).next(t=>(ke(t!==null,2888),t))}hr(e,t){return JI(e).put(xp,t)}Pr(e,t){return Ic(e).put(J1(this.serializer,t))}Tr(e,t){let s=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,s=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.lr(e).next(t=>t.targetCount)}getTargetData(e,t){const s=pl(t),i=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let o=null;return Ic(e).ee({range:i,index:QA},(u,h,f)=>{const p=Wd(h);Yh(t,p.target)&&(o=p,f.done())}).next(()=>o)}addMatchingKeys(e,t,s){const i=[],o=Fa(e);return t.forEach(u=>{const h=ns(u.path);i.push(o.put({targetId:s,path:h})),i.push(this.referenceDelegate.addReference(e,s,u))}),Y.waitFor(i)}removeMatchingKeys(e,t,s){const i=Fa(e);return Y.forEach(t,o=>{const u=ns(o.path);return Y.waitFor([i.delete([s,u]),this.referenceDelegate.removeReference(e,s,o)])})}removeMatchingKeysForTargetId(e,t){const s=Fa(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return s.delete(i)}getMatchingKeysForTargetId(e,t){const s=IDBKeyRange.bound([t],[t+1],!1,!0),i=Fa(e);let o=Ke();return i.ee({range:s,X:!0},(u,h,f)=>{const p=ri(u[1]),x=new Te(p);o=o.add(x)}).next(()=>o)}containsKey(e,t){const s=ns(t.path),i=IDBKeyRange.bound([s],[MA(s)],!1,!0);let o=0;return Fa(e).ee({index:Mv,X:!0,range:i},([u,h],f,p)=>{u!==0&&(o++,p.done())}).next(()=>o>0)}At(e,t){return Ic(e).get(t).next(s=>s?Wd(s):null)}}function Ic(n){return Sn(n,Yc)}function JI(n){return Sn(n,cl)}function Fa(n){return Sn(n,Xc)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZI="LruGarbageCollector",VL=1048576;function eS([n,e],[t,s]){const i=$e(n,t);return i===0?$e(e,s):i}class LL{constructor(e){this.Ir=e,this.buffer=new Et(eS),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();eS(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class i2{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ye(ZI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ho(t)?ye(ZI,"Ignoring IndexedDB error during garbage collection: ",t):await uo(t)}await this.Vr(3e5)})}}class UL{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(s=>Math.floor(t/100*s))}nthSequenceNumber(e,t){if(t===0)return Y.resolve(vs.ce);const s=new LL(t);return this.mr.forEachTarget(e,i=>s.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>s.Ar(i))).next(()=>s.maxValue)}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ye("LruGarbageCollector","Garbage collection skipped; disabled"),Y.resolve(XI)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),XI):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,i,o,u,h,f,p;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),i=this.params.maximumSequenceNumbersToCollect):i=v,u=Date.now(),this.nthSequenceNumber(e,i))).next(v=>(s=v,h=Date.now(),this.removeTargets(e,s,t))).next(v=>(o=v,f=Date.now(),this.removeOrphanedDocuments(e,s))).next(v=>(p=Date.now(),Ac()<=tt.DEBUG&&ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-x}ms
	Determined least recently used ${i} in `+(h-u)+`ms
	Removed ${o} targets in `+(f-h)+`ms
	Removed ${v} documents in `+(p-f)+`ms
Total Duration: ${p-x}ms`),Y.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:v})))}}function a2(n,e){return new UL(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FL{constructor(e,t){this.db=e,this.garbageCollector=a2(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(s=>t.next(i=>s+i))}wr(e){let t=0;return this.pr(e,s=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,(s,i)=>t(i))}addReference(e,t,s){return Pm(e,s)}removeReference(e,t,s){return Pm(e,s)}removeTargets(e,t,s){return this.db.getTargetCache().removeTargets(e,t,s)}markPotentiallyOrphaned(e,t){return Pm(e,t)}br(e,t){return function(i,o){let u=!1;return r2(i).te(h=>s2(i,h,o).next(f=>(f&&(u=!0),Y.resolve(!f)))).next(()=>u)}(e,t)}removeOrphanedDocuments(e,t){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let o=0;return this.Sr(e,(u,h)=>{if(h<=t){const f=this.br(e,u).next(p=>{if(!p)return o++,s.getEntry(e,u).next(()=>(s.removeEntry(u,Ve.min()),Fa(e).delete(function(v){return[0,ns(v.path)]}(u))))});i.push(f)}}).next(()=>Y.waitFor(i)).next(()=>s.apply(e)).next(()=>o)}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,t){return Pm(e,t)}Sr(e,t){const s=Fa(e);let i,o=vs.ce;return s.ee({index:Mv},([u,h],{path:f,sequenceNumber:p})=>{u===0?(o!==vs.ce&&t(new Te(ri(i)),o),o=p,i=f):o=vs.ce}).next(()=>{o!==vs.ce&&t(new Te(ri(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Pm(n,e){return Fa(n).put(function(s,i){return{targetId:0,path:ns(s.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o2{constructor(){this.changes=new na(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Vt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?Y.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BL{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,s){return Ko(e).put(s)}removeEntry(e,t,s){return Ko(e).delete(function(o,u){const h=o.path.toArray();return[h.slice(0,h.length-2),h[h.length-2],wp(u),h[h.length-1]]}(t,s))}updateMetadata(e,t){return this.getMetadata(e).next(s=>(s.byteSize+=t,this.Dr(e,s)))}getEntry(e,t){let s=Vt.newInvalidDocument(t);return Ko(e).ee({index:Ym,range:IDBKeyRange.only(Ld(t))},(i,o)=>{s=this.Cr(t,o)}).next(()=>s)}vr(e,t){let s={size:0,document:Vt.newInvalidDocument(t)};return Ko(e).ee({index:Ym,range:IDBKeyRange.only(Ld(t))},(i,o)=>{s={document:this.Cr(t,o),size:Ep(o)}}).next(()=>s)}getEntries(e,t){let s=bs();return this.Fr(e,t,(i,o)=>{const u=this.Cr(i,o);s=s.insert(i,u)}).next(()=>s)}Mr(e,t){let s=bs(),i=new Pt(Te.comparator);return this.Fr(e,t,(o,u)=>{const h=this.Cr(o,u);s=s.insert(o,h),i=i.insert(o,Ep(u))}).next(()=>({documents:s,Or:i}))}Fr(e,t,s){if(t.isEmpty())return Y.resolve();let i=new Et(sS);t.forEach(f=>i=i.add(f));const o=IDBKeyRange.bound(Ld(i.first()),Ld(i.last())),u=i.getIterator();let h=u.getNext();return Ko(e).ee({index:Ym,range:o},(f,p,x)=>{const v=Te.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;h&&sS(h,v)<0;)s(h,null),h=u.getNext();h&&h.isEqual(v)&&(s(h,p),h=u.hasNext()?u.getNext():null),h?x.j(Ld(h)):x.done()}).next(()=>{for(;h;)s(h,null),h=u.hasNext()?u.getNext():null})}getDocumentsMatchingQuery(e,t,s,i,o){const u=t.path,h=[u.popLast().toArray(),u.lastSegment(),wp(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],f=[u.popLast().toArray(),u.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ko(e).J(IDBKeyRange.bound(h,f,!0)).next(p=>{o?.incrementDocumentReadCount(p.length);let x=bs();for(const v of p){const b=this.Cr(Te.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);b.isFoundDocument()&&(Jh(t,b)||i.has(b.key))&&(x=x.insert(b.key,b))}return x})}getAllFromCollectionGroup(e,t,s,i){let o=bs();const u=nS(t,s),h=nS(t,Bs.max());return Ko(e).ee({index:KA,range:IDBKeyRange.bound(u,h,!0)},(f,p,x)=>{const v=this.Cr(Te.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);o=o.insert(v.key,v),o.size===i&&x.done()}).next(()=>o)}newChangeBuffer(e){return new zL(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return tS(e).get(gx).next(t=>(ke(!!t,20021),t))}Dr(e,t){return tS(e).put(gx,t)}Cr(e,t){if(t){const s=SL(this.serializer,t);if(!(s.isNoDocument()&&s.version.isEqual(Ve.min())))return s}return Vt.newInvalidDocument(e)}}function l2(n){return new BL(n)}class zL extends o2{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new na(s=>s.toString(),(s,i)=>s.isEqual(i))}applyChanges(e){const t=[];let s=0,i=new Et((o,u)=>$e(o.canonicalString(),u.canonicalString()));return this.changes.forEach((o,u)=>{const h=this.Br.get(o);if(t.push(this.Nr.removeEntry(e,o,h.readTime)),u.isValidDocument()){const f=LI(this.Nr.serializer,u);i=i.add(o.path.popLast());const p=Ep(f);s+=p-h.size,t.push(this.Nr.addEntry(e,o,f))}else if(s-=h.size,this.trackRemovals){const f=LI(this.Nr.serializer,u.convertToNoDocument(Ve.min()));t.push(this.Nr.addEntry(e,o,f))}}),i.forEach(o=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.Nr.updateMetadata(e,s)),Y.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next(s=>(this.Br.set(t,{size:s.size,readTime:s.document.readTime}),s.document))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next(({documents:s,Or:i})=>(i.forEach((o,u)=>{this.Br.set(o,{size:u,readTime:s.get(o).readTime})}),s))}}function tS(n){return Sn(n,Eh)}function Ko(n){return Sn(n,yp)}function Ld(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function nS(n,e){const t=e.documentKey.path.toArray();return[n,wp(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function sS(n,e){const t=n.path.toArray(),s=e.path.toArray();let i=0;for(let o=0;o<t.length-2&&o<s.length-2;++o)if(i=$e(t[o],s[o]),i)return i;return i=$e(t.length,s.length),i||(i=$e(t[t.length-2],s[s.length-2]),i||$e(t[t.length-1],s[s.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qL{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2{constructor(e,t,s,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=i}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(s=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(s!==null&&ch(s.mutation,i,_s.empty(),_t.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.getLocalViewOfDocuments(e,s,Ke()).next(()=>s))}getLocalViewOfDocuments(e,t,s=Ke()){const i=ii();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,s).next(o=>{let u=Kd();return o.forEach((h,f)=>{u=u.insert(h,f.overlayedDocument)}),u}))}getOverlayedDocuments(e,t){const s=ii();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,Ke()))}populateOverlays(e,t,s){const i=[];return s.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((u,h)=>{t.set(u,h)})})}computeViews(e,t,s,i){let o=bs();const u=lh(),h=function(){return lh()}();return t.forEach((f,p)=>{const x=s.get(p.key);i.has(p.key)&&(x===void 0||x.mutation instanceof sa)?o=o.insert(p.key,p):x!==void 0?(u.set(p.key,x.mutation.getFieldMask()),ch(x.mutation,p,x.mutation.getFieldMask(),_t.now())):u.set(p.key,_s.empty())}),this.recalculateAndSaveOverlays(e,o).next(f=>(f.forEach((p,x)=>u.set(p,x)),t.forEach((p,x)=>h.set(p,new qL(x,u.get(p)??null))),h))}recalculateAndSaveOverlays(e,t){const s=lh();let i=new Pt((u,h)=>u-h),o=Ke();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(u=>{for(const h of u)h.keys().forEach(f=>{const p=t.get(f);if(p===null)return;let x=s.get(f)||_s.empty();x=h.applyToLocalView(p,x),s.set(f,x);const v=(i.get(h.batchId)||Ke()).add(f);i=i.insert(h.batchId,v)})}).next(()=>{const u=[],h=i.getReverseIterator();for(;h.hasNext();){const f=h.getNext(),p=f.key,x=f.value,v=I1();x.forEach(b=>{if(!o.has(b)){const I=k1(t.get(b),s.get(b));I!==null&&v.set(b,I),o=o.add(b)}}),u.push(this.documentOverlayCache.saveOverlays(e,p,v))}return Y.waitFor(u)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,t,s,i){return function(u){return Te.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):qv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,i):this.getDocumentsMatchingCollectionQuery(e,t,s,i)}getNextDocuments(e,t,s,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,i).next(o=>{const u=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,i-o.size):Y.resolve(ii());let h=Qc,f=o;return u.next(p=>Y.forEach(p,(x,v)=>(h<v.largestBatchId&&(h=v.largestBatchId),o.get(x)?Y.resolve():this.remoteDocumentCache.getEntry(e,x).next(b=>{f=f.insert(x,b)}))).next(()=>this.populateOverlays(e,p,o)).next(()=>this.computeViews(e,f,p,Ke())).next(x=>({batchId:h,changes:E1(x)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Te(t)).next(s=>{let i=Kd();return s.isFoundDocument()&&(i=i.insert(s.key,s)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,s,i){const o=t.collectionGroup;let u=Kd();return this.indexManager.getCollectionParents(e,o).next(h=>Y.forEach(h,f=>{const p=function(v,b){return new ta(b,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(t,f.child(o));return this.getDocumentsMatchingCollectionQuery(e,p,s,i).next(x=>{x.forEach((v,b)=>{u=u.insert(v,b)})})}).next(()=>u))}getDocumentsMatchingCollectionQuery(e,t,s,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next(u=>(o=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,o,i))).next(u=>{o.forEach((f,p)=>{const x=p.getKey();u.get(x)===null&&(u=u.insert(x,Vt.newInvalidDocument(x)))});let h=Kd();return u.forEach((f,p)=>{const x=o.get(f);x!==void 0&&ch(x.mutation,p,_s.empty(),_t.now()),Jh(t,p)&&(h=h.insert(f,p))}),h})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HL{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Y.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:dn(i.createTime)}}(t)),Y.resolve()}getNamedQuery(e,t){return Y.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(i){return{name:i.name,query:Jv(i.bundledQuery),readTime:dn(i.readTime)}}(t)),Y.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GL{constructor(){this.overlays=new Pt(Te.comparator),this.qr=new Map}getOverlay(e,t){return Y.resolve(this.overlays.get(t))}getOverlays(e,t){const s=ii();return Y.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&s.set(i,o)})).next(()=>s)}saveOverlays(e,t,s){return s.forEach((i,o)=>{this.St(e,t,o)}),Y.resolve()}removeOverlaysForBatchId(e,t,s){const i=this.qr.get(s);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(s)),Y.resolve()}getOverlaysForCollection(e,t,s){const i=ii(),o=t.length+1,u=new Te(t.child("")),h=this.overlays.getIteratorFrom(u);for(;h.hasNext();){const f=h.getNext().value,p=f.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===o&&f.largestBatchId>s&&i.set(f.getKey(),f)}return Y.resolve(i)}getOverlaysForCollectionGroup(e,t,s,i){let o=new Pt((p,x)=>p-x);const u=this.overlays.getIterator();for(;u.hasNext();){const p=u.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>s){let x=o.get(p.largestBatchId);x===null&&(x=ii(),o=o.insert(p.largestBatchId,x)),x.set(p.getKey(),p)}}const h=ii(),f=o.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach((p,x)=>h.set(p,x)),!(h.size()>=i)););return Y.resolve(h)}St(e,t,s){const i=this.overlays.get(s.key);if(i!==null){const u=this.qr.get(i.largestBatchId).delete(s.key);this.qr.set(i.largestBatchId,u)}this.overlays=this.overlays.insert(s.key,new Wv(t,s));let o=this.qr.get(t);o===void 0&&(o=Ke(),this.qr.set(t,o)),this.qr.set(t,o.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $L{constructor(){this.sessionToken=en.EMPTY_BYTE_STRING}getSessionToken(e){return Y.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Y.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(){this.Qr=new Et(On.$r),this.Ur=new Et(On.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new On(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach(s=>this.addReference(s,t))}removeReference(e,t){this.Gr(new On(e,t))}zr(e,t){e.forEach(s=>this.removeReference(s,t))}jr(e){const t=new Te(new nt([])),s=new On(t,e),i=new On(t,e+1),o=[];return this.Ur.forEachInRange([s,i],u=>{this.Gr(u),o.push(u.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Te(new nt([])),s=new On(t,e),i=new On(t,e+1);let o=Ke();return this.Ur.forEachInRange([s,i],u=>{o=o.add(u.key)}),o}containsKey(e){const t=new On(e,0),s=this.Qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class On{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Te.comparator(e.key,t.key)||$e(e.Yr,t.Yr)}static Kr(e,t){return $e(e.Yr,t.Yr)||Te.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KL{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Et(On.$r)}checkEmpty(e){return Y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new Kv(o,t,s,i);this.mutationQueue.push(u);for(const h of i)this.Zr=this.Zr.add(new On(h.key,o)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return Y.resolve(u)}lookupMutationBatch(e,t){return Y.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,i=this.ei(s),o=i<0?0:i;return Y.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return Y.resolve(this.mutationQueue.length===0?Ka:this.tr-1)}getAllMutationBatches(e){return Y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new On(t,0),i=new On(t,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([s,i],u=>{const h=this.Xr(u.Yr);o.push(h)}),Y.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Et($e);return t.forEach(i=>{const o=new On(i,0),u=new On(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,u],h=>{s=s.add(h.Yr)})}),Y.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,i=s.length+1;let o=s;Te.isDocumentKey(o)||(o=o.child(""));const u=new On(new Te(o),0);let h=new Et($e);return this.Zr.forEachWhile(f=>{const p=f.key.path;return!!s.isPrefixOf(p)&&(p.length===i&&(h=h.add(f.Yr)),!0)},u),Y.resolve(this.ti(h))}ti(e){const t=[];return e.forEach(s=>{const i=this.Xr(s);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ke(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return Y.forEach(t.mutations,i=>{const o=new On(i.key,t.batchId);return s=s.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=s})}ir(e){}containsKey(e,t){const s=new On(t,0),i=this.Zr.firstAfterOrEqual(s);return Y.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Y.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QL{constructor(e){this.ri=e,this.docs=function(){return new Pt(Te.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,i=this.docs.get(s),o=i?i.size:0,u=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:u}),this.size+=u-o,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return Y.resolve(s?s.document.mutableCopy():Vt.newInvalidDocument(t))}getEntries(e,t){let s=bs();return t.forEach(i=>{const o=this.docs.get(i);s=s.insert(i,o?o.document.mutableCopy():Vt.newInvalidDocument(i))}),Y.resolve(s)}getDocumentsMatchingQuery(e,t,s,i){let o=bs();const u=t.path,h=new Te(u.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(h);for(;f.hasNext();){const{key:p,value:{document:x}}=f.getNext();if(!u.isPrefixOf(p.path))break;p.path.length>u.length+1||Pv(BA(x),s)<=0||(i.has(x.key)||Jh(t,x))&&(o=o.insert(x.key,x.mutableCopy()))}return Y.resolve(o)}getAllFromCollectionGroup(e,t,s,i){Ae(9500)}ii(e,t){return Y.forEach(this.docs,s=>t(s))}newChangeBuffer(e){return new WL(this)}getSize(e){return Y.resolve(this.size)}}class WL extends o2{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((s,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(s)}),Y.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YL{constructor(e){this.persistence=e,this.si=new na(t=>pl(t),Yh),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.oi=0,this._i=new t_,this.targetCount=0,this.ai=_l.ur()}forEachTarget(e,t){return this.si.forEach((s,i)=>t(i)),Y.resolve()}getLastRemoteSnapshotVersion(e){return Y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Y.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Y.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),Y.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new _l(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Y.resolve()}updateTargetData(e,t){return this.Pr(t),Y.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Y.resolve()}removeTargets(e,t,s){let i=0;const o=[];return this.si.forEach((u,h)=>{h.sequenceNumber<=t&&s.get(h.targetId)===null&&(this.si.delete(u),o.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)}),Y.waitFor(o).next(()=>i)}getTargetCount(e){return Y.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return Y.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),Y.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(u=>{o.push(i.markPotentiallyOrphaned(e,u))}),Y.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Y.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return Y.resolve(s)}containsKey(e,t){return Y.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_{constructor(e,t){this.ui={},this.overlays={},this.ci=new vs(0),this.li=!1,this.li=!0,this.hi=new $L,this.referenceDelegate=e(this),this.Pi=new YL(this),this.indexManager=new PL,this.remoteDocumentCache=function(i){return new QL(i)}(s=>this.referenceDelegate.Ti(s)),this.serializer=new X1(t),this.Ii=new HL(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new GL,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new KL(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){ye("MemoryPersistence","Starting transaction:",e);const i=new XL(this.ci.next());return this.referenceDelegate.Ei(),s(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ai(e,t){return Y.or(Object.values(this.ui).map(s=>()=>s.containsKey(e,t)))}}class XL extends qA{constructor(e){super(),this.currentSequenceNumber=e}}class ag{constructor(e){this.persistence=e,this.Ri=new t_,this.Vi=null}static mi(e){return new ag(e)}get fi(){if(this.Vi)return this.Vi;throw Ae(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),Y.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),Y.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Y.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(i=>this.fi.add(i.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.fi.add(o.toString()))}).next(()=>s.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Y.forEach(this.fi,s=>{const i=Te.fromPath(s);return this.gi(e,i).next(o=>{o||t.removeEntry(i,Ve.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(s=>{s?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return Y.or([()=>Y.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Ip{constructor(e,t){this.persistence=e,this.pi=new na(s=>ns(s.path),(s,i)=>s.isEqual(i)),this.garbageCollector=a2(this,t)}static mi(e,t){return new Ip(e,t)}Ei(){}di(e){return Y.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>t.next(i=>s+i))}wr(e){let t=0;return this.pr(e,s=>{t++}).next(()=>t)}pr(e,t){return Y.forEach(this.pi,(s,i)=>this.br(e,s,i).next(o=>o?Y.resolve():t(i)))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,u=>this.br(e,u,t).next(h=>{h||(s++,o.removeEntry(u,Ve.min()))})).next(()=>o.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Y.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),Y.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),Y.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Y.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Jm(e.data.value)),t}br(e,t,s){return Y.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return Y.resolve(i!==void 0&&i>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JL{constructor(e){this.serializer=e}k(e,t,s,i){const o=new Wp("createOrUpgrade",t);s<1&&i>=1&&(function(f){f.createObjectStore(Wh)}(e),function(f){f.createObjectStore(Th,{keyPath:m5}),f.createObjectStore(Tr,{keyPath:mI,autoIncrement:!0}).createIndex(rl,pI,{unique:!0}),f.createObjectStore(Wc)}(e),rS(e),function(f){f.createObjectStore(Yo)}(e));let u=Y.resolve();return s<3&&i>=3&&(s!==0&&(function(f){f.deleteObjectStore(Xc),f.deleteObjectStore(Yc),f.deleteObjectStore(cl)}(e),rS(e)),u=u.next(()=>function(f){const p=f.store(cl),x={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ve.min().toTimestamp(),targetCount:0};return p.put(xp,x)}(o))),s<4&&i>=4&&(s!==0&&(u=u.next(()=>function(f,p){return p.store(Tr).J().next(v=>{f.deleteObjectStore(Tr),f.createObjectStore(Tr,{keyPath:mI,autoIncrement:!0}).createIndex(rl,pI,{unique:!0});const b=p.store(Tr),I=v.map(N=>b.put(N));return Y.waitFor(I)})}(e,o))),u=u.next(()=>{(function(f){f.createObjectStore(Jc,{keyPath:T5})})(e)})),s<5&&i>=5&&(u=u.next(()=>this.yi(o))),s<6&&i>=6&&(u=u.next(()=>(function(f){f.createObjectStore(Eh)}(e),this.wi(o)))),s<7&&i>=7&&(u=u.next(()=>this.Si(o))),s<8&&i>=8&&(u=u.next(()=>this.bi(e,o))),s<9&&i>=9&&(u=u.next(()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)})),s<10&&i>=10&&(u=u.next(()=>this.Di(o))),s<11&&i>=11&&(u=u.next(()=>{(function(f){f.createObjectStore(Yp,{keyPath:E5})})(e),function(f){f.createObjectStore(Xp,{keyPath:I5})}(e)})),s<12&&i>=12&&(u=u.next(()=>{(function(f){const p=f.createObjectStore(Jp,{keyPath:k5});p.createIndex(xx,j5,{unique:!1}),p.createIndex(XA,P5,{unique:!1})})(e)})),s<13&&i>=13&&(u=u.next(()=>function(f){const p=f.createObjectStore(yp,{keyPath:g5});p.createIndex(Ym,y5),p.createIndex(KA,x5)}(e)).next(()=>this.Ci(e,o)).next(()=>e.deleteObjectStore(Yo))),s<14&&i>=14&&(u=u.next(()=>this.Fi(e,o))),s<15&&i>=15&&(u=u.next(()=>function(f){f.createObjectStore(Vv,{keyPath:S5,autoIncrement:!0}).createIndex(yx,N5,{unique:!1}),f.createObjectStore(ih,{keyPath:A5}).createIndex(WA,R5,{unique:!1}),f.createObjectStore(ah,{keyPath:C5}).createIndex(YA,D5,{unique:!1})}(e))),s<16&&i>=16&&(u=u.next(()=>{t.objectStore(ih).clear()}).next(()=>{t.objectStore(ah).clear()})),s<17&&i>=17&&(u=u.next(()=>{(function(f){f.createObjectStore(Lv,{keyPath:O5})})(e)})),s<18&&i>=18&&pN()&&(u=u.next(()=>{t.objectStore(ih).clear()}).next(()=>{t.objectStore(ah).clear()})),u}wi(e){let t=0;return e.store(Yo).ee((s,i)=>{t+=Ep(i)}).next(()=>{const s={byteSize:t};return e.store(Eh).put(gx,s)})}yi(e){const t=e.store(Th),s=e.store(Tr);return t.J().next(i=>Y.forEach(i,o=>{const u=IDBKeyRange.bound([o.userId,Ka],[o.userId,o.lastAcknowledgedBatchId]);return s.J(rl,u).next(h=>Y.forEach(h,f=>{ke(f.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const p=Zo(this.serializer,f);return n2(e,o.userId,p).next(()=>{})}))}))}Si(e){const t=e.store(Xc),s=e.store(Yo);return e.store(cl).get(xp).next(i=>{const o=[];return s.ee((u,h)=>{const f=new nt(u),p=function(v){return[0,ns(v)]}(f);o.push(t.get(p).next(x=>x?Y.resolve():(v=>t.put({targetId:0,path:ns(v),sequenceNumber:i.highestListenSequenceNumber}))(f)))}).next(()=>Y.waitFor(o))})}bi(e,t){e.createObjectStore(Ih,{keyPath:w5});const s=t.store(Ih),i=new e_,o=u=>{if(i.add(u)){const h=u.lastSegment(),f=u.popLast();return s.put({collectionId:h,parent:ns(f)})}};return t.store(Yo).ee({X:!0},(u,h)=>{const f=new nt(u);return o(f.popLast())}).next(()=>t.store(Wc).ee({X:!0},([u,h,f],p)=>{const x=ri(h);return o(x.popLast())}))}Di(e){const t=e.store(Yc);return t.ee((s,i)=>{const o=Wd(i),u=J1(this.serializer,o);return t.put(u)})}Ci(e,t){const s=t.store(Yo),i=[];return s.ee((o,u)=>{const h=t.store(yp),f=function(v){return v.document?new Te(nt.fromString(v.document.name).popFirst(5)):v.noDocument?Te.fromSegments(v.noDocument.path):v.unknownDocument?Te.fromSegments(v.unknownDocument.path):Ae(36783)}(u).path.toArray(),p={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};i.push(h.put(p))}).next(()=>Y.waitFor(i))}Fi(e,t){const s=t.store(Tr),i=l2(this.serializer),o=new n_(ag.mi,this.serializer.yt);return s.J().next(u=>{const h=new Map;return u.forEach(f=>{let p=h.get(f.userId)??Ke();Zo(this.serializer,f).keys().forEach(x=>p=p.add(x)),h.set(f.userId,p)}),Y.forEach(h,(f,p)=>{const x=new Mn(p),v=rg.wt(this.serializer,x),b=o.getIndexManager(x),I=ig.wt(x,this.serializer,b,o.referenceDelegate);return new c2(i,I,v,b).recalculateAndSaveOverlaysForDocumentKeys(new vx(t,vs.ce),f).next()})})}}function rS(n){n.createObjectStore(Xc,{keyPath:_5}).createIndex(Mv,b5,{unique:!0}),n.createObjectStore(Yc,{keyPath:"targetId"}).createIndex(QA,v5,{unique:!0}),n.createObjectStore(cl)}const La="IndexedDbPersistence",z0=18e5,q0=5e3,H0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",u2="main";class s_{constructor(e,t,s,i,o,u,h,f,p,x,v=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=s,this.Mi=o,this.window=u,this.document=h,this.xi=p,this.Oi=x,this.Ni=v,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=b=>Promise.resolve(),!s_.v())throw new pe(ie.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new FL(this,i),this.$i=t+u2,this.serializer=new X1(f),this.Ui=new ai(this.$i,this.Ni,new JL(this.serializer)),this.hi=new AL,this.Pi=new ML(this.referenceDelegate,this.serializer),this.remoteDocumentCache=l2(this.serializer),this.Ii=new NL,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,x===!1&&un(La,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new pe(ie.FAILED_PRECONDITION,H0);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new vs(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Om(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(t=>this.isPrimary&&!t?this.Zi(e).next(()=>!1):!!t&&this.Xi(e).next(()=>!0))).catch(e=>{if(ho(e))return ye(La,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ye(La,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return Ud(e).get(_c).next(t=>Y.resolve(this.es(t)))}ts(e){return Om(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,z0)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const s=Sn(t,Jc);return s.J().next(i=>{const o=this.ss(i,z0),u=i.filter(h=>o.indexOf(h)===-1);return Y.forEach(u,h=>s.delete(h.clientId)).next(()=>u)})}).catch(()=>[]);if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Y.resolve(!0):Ud(e).get(_c).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,q0)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new pe(ie.FAILED_PRECONDITION,H0);return!1}}return!(!this.networkEnabled||!this.inForeground)||Om(e).J().next(s=>this.ss(s,q0).find(i=>{if(this.clientId!==i.clientId){const o=!this.networkEnabled&&i.networkEnabled,u=!this.inForeground&&i.inForeground,h=this.networkEnabled===i.networkEnabled;if(o||u&&h)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&ye(La,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Wh,Jc],e=>{const t=new vx(e,vs.ce);return this.Zi(t).next(()=>this.ts(t))}),this.Ui.close(),this.Ps()}ss(e,t){return e.filter(s=>this.rs(s.updateTimeMs,t)&&!this.us(s.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>Om(e).J().next(t=>this.ss(t,z0).map(s=>s.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return ig.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new OL(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return rg.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,s){ye(La,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",o=function(f){return f===18?L5:f===17?t1:f===16?V5:f===15?Uv:f===14?e1:f===13?ZA:f===12?M5:f===11?JA:void Ae(60245)}(this.Ni);let u;return this.Ui.runTransaction(e,i,o,h=>(u=new vx(h,this.ci?this.ci.next():vs.ce),t==="readwrite-primary"?this.Hi(u).next(f=>!!f||this.Yi(u)).next(f=>{if(!f)throw un(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new pe(ie.FAILED_PRECONDITION,zA);return s(u)}).next(f=>this.Xi(u).next(()=>f)):this.Is(u).next(()=>s(u)))).then(h=>(u.raiseOnCommittedEvent(),h))}Is(e){return Ud(e).get(_c).next(t=>{if(t!==null&&this.rs(t.leaseTimestampMs,q0)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new pe(ie.FAILED_PRECONDITION,H0)})}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ud(e).put(_c,t)}static v(){return ai.v()}Zi(e){const t=Ud(e);return t.get(_c).next(s=>this.es(s)?(ye(La,"Releasing primary lease."),t.delete(_c)):Y.resolve())}rs(e,t){const s=Date.now();return!(e<s-t)&&(!(e>s)||(un(`Detected an update time that is in the future: ${e} > ${s}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;mN()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return ye(La,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return un(La,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){un("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ud(n){return Sn(n,Wh)}function Om(n){return Sn(n,Jc)}function r_(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(e,t,s,i){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=i}static As(e,t){let s=Ke(),i=Ke();for(const o of t.docChanges)switch(o.type){case 0:s=s.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new i_(e,t.fromCache,s,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return mN()?8:HA(Kt())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,i){const o={result:null};return this.ys(e,t).next(u=>{o.result=u}).next(()=>{if(!o.result)return this.ws(e,t,i,s).next(u=>{o.result=u})}).next(()=>{if(o.result)return;const u=new ZL;return this.Ss(e,t,u).next(h=>{if(o.result=h,this.Vs)return this.bs(e,t,u,h.size)})}).next(()=>o.result)}bs(e,t,s,i){return s.documentReadCount<this.fs?(Ac()<=tt.DEBUG&&ye("QueryEngine","SDK will not create cache indexes for query:",Rc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Y.resolve()):(Ac()<=tt.DEBUG&&ye("QueryEngine","Query:",Rc(t),"scans",s.documentReadCount,"local documents and returns",i,"documents as results."),s.documentReadCount>this.gs*i?(Ac()<=tt.DEBUG&&ye("QueryEngine","The SDK decides to create cache indexes for query:",Rc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ds(t))):Y.resolve())}ys(e,t){if(AI(t))return Y.resolve(null);let s=ds(t);return this.indexManager.getIndexType(e,s).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=bp(t,null,"F"),s=ds(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next(o=>{const u=Ke(...o);return this.ps.getDocuments(e,u).next(h=>this.indexManager.getMinOffset(e,s).next(f=>{const p=this.Ds(t,h);return this.Cs(t,p,u,f.readTime)?this.ys(e,bp(t,null,"F")):this.vs(e,p,t,f)}))})))}ws(e,t,s,i){return AI(t)||i.isEqual(Ve.min())?Y.resolve(null):this.ps.getDocuments(e,s).next(o=>{const u=this.Ds(t,o);return this.Cs(t,u,s,i)?Y.resolve(null):(Ac()<=tt.DEBUG&&ye("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Rc(t)),this.vs(e,u,t,FA(i,Qc)).next(h=>h))})}Ds(e,t){let s=new Et(w1(e));return t.forEach((i,o)=>{Jh(e,o)&&(s=s.add(o))}),s}Cs(e,t,s,i){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,t,s){return Ac()<=tt.DEBUG&&ye("QueryEngine","Using full collection scan to execute query:",Rc(t)),this.ps.getDocumentsMatchingQuery(e,t,Bs.min(),s)}vs(e,t,s,i){return this.ps.getDocumentsMatchingQuery(e,s,i).next(o=>(t.forEach(u=>{o=o.insert(u.key,u)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a_="LocalStore",e3=3e8;class t3{constructor(e,t,s,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new Pt($e),this.xs=new na(o=>pl(o),Yh),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new c2(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function h2(n,e,t,s){return new t3(n,e,t,s)}async function f2(n,e){const t=Ee(n);return await t.persistence.runTransaction("Handle user change","readonly",s=>{let i;return t.mutationQueue.getAllMutationBatches(s).next(o=>(i=o,t.Bs(e),t.mutationQueue.getAllMutationBatches(s))).next(o=>{const u=[],h=[];let f=Ke();for(const p of i){u.push(p.batchId);for(const x of p.mutations)f=f.add(x.key)}for(const p of o){h.push(p.batchId);for(const x of p.mutations)f=f.add(x.key)}return t.localDocuments.getDocuments(s,f).next(p=>({Ls:p,removedBatchIds:u,addedBatchIds:h}))})})}function n3(n,e){const t=Ee(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const i=e.batch.keys(),o=t.Ns.newChangeBuffer({trackRemovals:!0});return function(h,f,p,x){const v=p.batch,b=v.keys();let I=Y.resolve();return b.forEach(N=>{I=I.next(()=>x.getEntry(f,N)).next(E=>{const A=p.docVersions.get(N);ke(A!==null,48541),E.version.compareTo(A)<0&&(v.applyToRemoteDocument(E,p),E.isValidDocument()&&(E.setReadTime(p.commitVersion),x.addEntry(E)))})}),I.next(()=>h.mutationQueue.removeMutationBatch(f,v))}(t,s,e,o).next(()=>o.apply(s)).next(()=>t.mutationQueue.performConsistencyCheck(s)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(s,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(h){let f=Ke();for(let p=0;p<h.mutationResults.length;++p)h.mutationResults[p].transformResults.length>0&&(f=f.add(h.batch.mutations[p].key));return f}(e))).next(()=>t.localDocuments.getDocuments(s,i))})}function m2(n){const e=Ee(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function s3(n,e){const t=Ee(n),s=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const u=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const h=[];e.targetChanges.forEach((x,v)=>{const b=i.get(v);if(!b)return;h.push(t.Pi.removeMatchingKeys(o,x.removedDocuments,v).next(()=>t.Pi.addMatchingKeys(o,x.addedDocuments,v)));let I=b.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(v)!==null?I=I.withResumeToken(en.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):x.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(x.resumeToken,s)),i=i.insert(v,I),function(E,A,C){return E.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=e3?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(b,I,x)&&h.push(t.Pi.updateTargetData(o,I))});let f=bs(),p=Ke();if(e.documentUpdates.forEach(x=>{e.resolvedLimboDocuments.has(x)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(o,x))}),h.push(p2(o,u,e.documentUpdates).next(x=>{f=x.ks,p=x.qs})),!s.isEqual(Ve.min())){const x=t.Pi.getLastRemoteSnapshotVersion(o).next(v=>t.Pi.setTargetsMetadata(o,o.currentSequenceNumber,s));h.push(x)}return Y.waitFor(h).next(()=>u.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,f,p)).next(()=>f)}).then(o=>(t.Ms=i,o))}function p2(n,e,t){let s=Ke(),i=Ke();return t.forEach(o=>s=s.add(o)),e.getEntries(n,s).next(o=>{let u=bs();return t.forEach((h,f)=>{const p=o.get(h);f.isFoundDocument()!==p.isFoundDocument()&&(i=i.add(h)),f.isNoDocument()&&f.version.isEqual(Ve.min())?(e.removeEntry(h,f.readTime),u=u.insert(h,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),u=u.insert(h,f)):ye(a_,"Ignoring outdated watch update for ",h,". Current version:",p.version," Watch version:",f.version)}),{ks:u,qs:i}})}function r3(n,e){const t=Ee(n);return t.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=Ka),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function iu(n,e){const t=Ee(n);return t.persistence.runTransaction("Allocate target","readwrite",s=>{let i;return t.Pi.getTargetData(s,e).next(o=>o?(i=o,Y.resolve(i)):t.Pi.allocateTargetId(s).next(u=>(i=new Li(e,u,"TargetPurposeListen",s.currentSequenceNumber),t.Pi.addTargetData(s,i).next(()=>i))))}).then(s=>{const i=t.Ms.get(s.targetId);return(i===null||s.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(s.targetId,s),t.xs.set(e,s.targetId)),s})}async function au(n,e,t){const s=Ee(n),i=s.Ms.get(e),o=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",o,u=>s.persistence.referenceDelegate.removeTarget(u,i))}catch(u){if(!ho(u))throw u;ye(a_,`Failed to update sequence numbers for target ${e}: ${u}`)}s.Ms=s.Ms.remove(e),s.xs.delete(i.target)}function Sp(n,e,t){const s=Ee(n);let i=Ve.min(),o=Ke();return s.persistence.runTransaction("Execute query","readwrite",u=>function(f,p,x){const v=Ee(f),b=v.xs.get(x);return b!==void 0?Y.resolve(v.Ms.get(b)):v.Pi.getTargetData(p,x)}(s,u,ds(e)).next(h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(u,h.targetId).next(f=>{o=f})}).next(()=>s.Fs.getDocumentsMatchingQuery(u,e,t?i:Ve.min(),t?o:Ke())).next(h=>(x2(s,b1(e),h),{documents:h,Qs:o})))}function g2(n,e){const t=Ee(n),s=Ee(t.Pi),i=t.Ms.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",o=>s.At(o,e).next(u=>u?u.target:null))}function y2(n,e){const t=Ee(n),s=t.Os.get(e)||Ve.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Ns.getAllFromCollectionGroup(i,e,FA(s,Qc),Number.MAX_SAFE_INTEGER)).then(i=>(x2(t,e,i),i))}function x2(n,e,t){let s=n.Os.get(e)||Ve.min();t.forEach((i,o)=>{o.readTime.compareTo(s)>0&&(s=o.readTime)}),n.Os.set(e,s)}async function i3(n,e,t,s){const i=Ee(n);let o=Ke(),u=bs();for(const p of t){const x=e.$s(p.metadata.name);p.document&&(o=o.add(x));const v=e.Us(p);v.setReadTime(e.Ks(p.metadata.readTime)),u=u.insert(x,v)}const h=i.Ns.newChangeBuffer({trackRemovals:!0}),f=await iu(i,function(x){return ds(vu(nt.fromString(`__bundle__/docs/${x}`)))}(s));return i.persistence.runTransaction("Apply bundle documents","readwrite",p=>p2(p,h,u).next(x=>(h.apply(p),x)).next(x=>i.Pi.removeMatchingKeysForTargetId(p,f.targetId).next(()=>i.Pi.addMatchingKeys(p,o,f.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(p,x.ks,x.qs)).next(()=>x.ks)))}async function a3(n,e,t=Ke()){const s=await iu(n,ds(Jv(e.bundledQuery))),i=Ee(n);return i.persistence.runTransaction("Save named query","readwrite",o=>{const u=dn(e.readTime);if(s.snapshotVersion.compareTo(u)>=0)return i.Ii.saveNamedQuery(o,e);const h=s.withResumeToken(en.EMPTY_BYTE_STRING,u);return i.Ms=i.Ms.insert(h.targetId,h),i.Pi.updateTargetData(o,h).next(()=>i.Pi.removeMatchingKeysForTargetId(o,s.targetId)).next(()=>i.Pi.addMatchingKeys(o,t,s.targetId)).next(()=>i.Ii.saveNamedQuery(o,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v2="firestore_clients";function iS(n,e){return`${v2}_${n}_${e}`}const _2="firestore_mutations";function aS(n,e,t){let s=`${_2}_${n}_${t}`;return e.isAuthenticated()&&(s+=`_${e.uid}`),s}const b2="firestore_targets";function G0(n,e){return`${b2}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xr="SharedClientState";class Np{constructor(e,t,s,i){this.user=e,this.batchId=t,this.state=s,this.error=i}static Ws(e,t,s){const i=JSON.parse(s);let o,u=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return u&&i.error&&(u=typeof i.error.message=="string"&&typeof i.error.code=="string",u&&(o=new pe(i.error.code,i.error.message))),u?new Np(e,t,i.state,o):(un(Xr,`Failed to parse mutation state for ID '${t}': ${s}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class uh{constructor(e,t,s){this.targetId=e,this.state=t,this.error=s}static Ws(e,t){const s=JSON.parse(t);let i,o=typeof s=="object"&&["not-current","current","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new pe(s.error.code,s.error.message))),o?new uh(e,s.state,i):(un(Xr,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ap{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const s=JSON.parse(t);let i=typeof s=="object"&&s.activeTargetIds instanceof Array,o=Hv();for(let u=0;i&&u<s.activeTargetIds.length;++u)i=GA(s.activeTargetIds[u]),o=o.add(s.activeTargetIds[u]);return i?new Ap(e,o):(un(Xr,`Failed to parse client data for instance '${e}': ${t}`),null)}}class o_{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new o_(t.clientId,t.onlineState):(un(Xr,`Failed to parse online state: ${e}`),null)}}class Px{constructor(){this.activeTargetIds=Hv()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class $0{constructor(e,t,s,i,o){this.window=e,this.Mi=t,this.persistenceKey=s,this.Js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new Pt($e),this.started=!1,this.Xs=[];const u=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.eo=iS(this.persistenceKey,this.Js),this.no=function(f){return`firestore_sequence_number_${f}`}(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new Px),this.ro=new RegExp(`^${v2}_${u}_([^_]*)$`),this.io=new RegExp(`^${_2}_${u}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${b2}_${u}_(\\d+)$`),this.oo=function(f){return`firestore_online_state_${f}`}(this.persistenceKey),this._o=function(f){return`firestore_bundle_loaded_v2_${f}`}(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const s of e){if(s===this.Js)continue;const i=this.getItem(iS(this.persistenceKey,s));if(i){const o=Ap.Ws(s,i);o&&(this.Zs=this.Zs.insert(o.clientId,o))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const s=this.uo(t);s&&this.co(s)}for(const s of this.Xs)this.Ys(s);this.Xs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach((s,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,s){this.ho(e,t,s),this.Po(e)}addLocalQueryTarget(e,t=!0){let s="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(G0(this.persistenceKey,e));if(i){const o=uh.Ws(e,i);o&&(s=o.state)}}return t&&this.To.zs(e),this.ao(),s}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(G0(this.persistenceKey,e))}updateQueryState(e,t,s){this.Io(e,t,s)}handleUserChange(e,t,s){t.forEach(i=>{this.Po(i)}),this.currentUser=e,s.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ye(Xr,"READ",e,t),t}setItem(e,t){ye(Xr,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){ye(Xr,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(ye(Xr,"EVENT",t.key,t.newValue),t.key===this.eo)return void un("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const s=this.Ro(t.key);return this.Vo(s,null)}{const s=this.mo(t.key,t.newValue);if(s)return this.Vo(s.clientId,s)}}else if(this.io.test(t.key)){if(t.newValue!==null){const s=this.fo(t.key,t.newValue);if(s)return this.po(s)}}else if(this.so.test(t.key)){if(t.newValue!==null){const s=this.yo(t.key,t.newValue);if(s)return this.wo(s)}}else if(t.key===this.oo){if(t.newValue!==null){const s=this.uo(t.newValue);if(s)return this.co(s)}}else if(t.key===this.no){const s=function(o){let u=vs.ce;if(o!=null)try{const h=JSON.parse(o);ke(typeof h=="number",30636,{So:o}),u=h}catch(h){un(Xr,"Failed to read sequence number from WebStorage",h)}return u}(t.newValue);s!==vs.ce&&this.sequenceNumberHandler(s)}else if(t.key===this._o){const s=this.bo(t.newValue);await Promise.all(s.map(i=>this.syncEngine.Do(i)))}}}else this.Xs.push(t)})}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,s){const i=new Np(this.currentUser,e,t,s),o=aS(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Gs())}Po(e){const t=aS(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,s){const i=G0(this.persistenceKey,e),o=new uh(e,t,s);this.setItem(i,o.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const s=this.Ro(e);return Ap.Ws(s,t)}fo(e,t){const s=this.io.exec(e),i=Number(s[1]),o=s[2]!==void 0?s[2]:null;return Np.Ws(new Mn(o),i,t)}yo(e,t){const s=this.so.exec(e),i=Number(s[1]);return uh.Ws(i,t)}uo(e){return o_.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);ye(Xr,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const s=t?this.Zs.insert(e,t):this.Zs.remove(e),i=this.lo(this.Zs),o=this.lo(s),u=[],h=[];return o.forEach(f=>{i.has(f)||u.push(f)}),i.forEach(f=>{o.has(f)||h.push(f)}),this.syncEngine.Fo(u,h).then(()=>{this.Zs=s})}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=Hv();return e.forEach((s,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class w2{constructor(){this.Mo=new Px,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Px,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o3{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oS="ConnectivityMonitor";class lS{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ye(oS,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ye(oS,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mm=null;function Ox(){return Mm===null?Mm=function(){return 268435456+Math.round(2147483648*Math.random())}():Mm++,"0x"+Mm.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K0="RestConnection",l3={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class c3{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${i}`,this.Wo=this.databaseId.database===_x?`project_id=${s}`:`project_id=${s}&database_id=${i}`}Go(e,t,s,i,o){const u=Ox(),h=this.zo(e,t.toUriEncodedString());ye(K0,`Sending RPC '${e}' ${u}:`,h,s);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,i,o);const{host:p}=new URL(h),x=lo(p);return this.Jo(e,h,f,s,x).then(v=>(ye(K0,`Received RPC '${e}' ${u}: `,v),v),v=>{throw di(K0,`RPC '${e}' ${u} failed with error: `,v,"url: ",h,"request:",s),v})}Ho(e,t,s,i,o,u){return this.Go(e,t,s,i,o)}jo(e,t,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+xu}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),s&&s.headers.forEach((i,o)=>e[o]=i)}zo(e,t){const s=l3[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u3{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yn="WebChannelConnection";class d3 extends c3{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,i,o){const u=Ox();return new Promise((h,f)=>{const p=new RA;p.setWithCredentials(!0),p.listenOnce(CA.COMPLETE,()=>{try{switch(p.getLastErrorCode()){case Km.NO_ERROR:const v=p.getResponseJson();ye(Yn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(v)),h(v);break;case Km.TIMEOUT:ye(Yn,`RPC '${e}' ${u} timed out`),f(new pe(ie.DEADLINE_EXCEEDED,"Request time out"));break;case Km.HTTP_ERROR:const b=p.getStatus();if(ye(Yn,`RPC '${e}' ${u} failed with status:`,b,"response text:",p.getResponseText()),b>0){let I=p.getResponseJson();Array.isArray(I)&&(I=I[0]);const N=I?.error;if(N&&N.status&&N.message){const E=function(C){const q=C.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(q)>=0?q:ie.UNKNOWN}(N.status);f(new pe(E,N.message))}else f(new pe(ie.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new pe(ie.UNAVAILABLE,"Connection failed."));break;default:Ae(9055,{l_:e,streamId:u,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{ye(Yn,`RPC '${e}' ${u} completed.`)}});const x=JSON.stringify(i);ye(Yn,`RPC '${e}' ${u} sending request:`,i),p.send(t,"POST",x,s,15)})}T_(e,t,s){const i=Ox(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=jA(),h=kA(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,t,s),f.encodeInitMessageHeaders=!0;const x=o.join("");ye(Yn,`Creating RPC '${e}' stream ${i}: ${x}`,f);const v=u.createWebChannel(x,f);this.I_(v);let b=!1,I=!1;const N=new u3({Yo:A=>{I?ye(Yn,`Not sending because RPC '${e}' stream ${i} is closed:`,A):(b||(ye(Yn,`Opening RPC '${e}' stream ${i} transport.`),v.open(),b=!0),ye(Yn,`RPC '${e}' stream ${i} sending:`,A),v.send(A))},Zo:()=>v.close()}),E=(A,C,q)=>{A.listen(C,P=>{try{q(P)}catch(V){setTimeout(()=>{throw V},0)}})};return E(v,$d.EventType.OPEN,()=>{I||(ye(Yn,`RPC '${e}' stream ${i} transport opened.`),N.o_())}),E(v,$d.EventType.CLOSE,()=>{I||(I=!0,ye(Yn,`RPC '${e}' stream ${i} transport closed`),N.a_(),this.E_(v))}),E(v,$d.EventType.ERROR,A=>{I||(I=!0,di(Yn,`RPC '${e}' stream ${i} transport errored. Name:`,A.name,"Message:",A.message),N.a_(new pe(ie.UNAVAILABLE,"The operation could not be completed")))}),E(v,$d.EventType.MESSAGE,A=>{if(!I){const C=A.data[0];ke(!!C,16349);const q=C,P=q?.error||q[0]?.error;if(P){ye(Yn,`RPC '${e}' stream ${i} received error:`,P);const V=P.status;let F=function(k){const D=yn[k];if(D!==void 0)return O1(D)}(V),K=P.message;F===void 0&&(F=ie.INTERNAL,K="Unknown error status: "+V+" with message "+P.message),I=!0,N.a_(new pe(F,K)),v.close()}else ye(Yn,`RPC '${e}' stream ${i} received:`,C),N.u_(C)}}),E(h,DA.STAT_EVENT,A=>{A.stat===fx.PROXY?ye(Yn,`RPC '${e}' stream ${i} detected buffering proxy`):A.stat===fx.NOPROXY&&ye(Yn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{N.__()},0),N}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T2(){return typeof window<"u"?window:null}function sp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nf(n){return new gL(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(e,t,s=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-s);i>0&&ye("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cS="PersistentStream";class E2{constructor(e,t,s,i,o,u,h,f){this.Mi=e,this.S_=s,this.b_=i,this.connection=o,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=h,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new l_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(un(t.toString()),un("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,i])=>{this.D_===t&&this.G_(s,i)},s=>{e(()=>{const i=new pe(ie.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(i)})})}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{s(()=>this.listener.Xo())}),this.stream.t_(()=>{s(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{s(()=>this.z_(i))}),this.stream.onMessage(i=>{s(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ye(cS,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(ye(cS,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class h3 extends E2{constructor(e,t,s,i,o,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,i,u),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=vL(this.serializer,e),s=function(o){if(!("targetChange"in o))return Ve.min();const u=o.targetChange;return u.targetIds&&u.targetIds.length?Ve.min():u.readTime?dn(u.readTime):Ve.min()}(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=Rx(this.serializer),t.addTarget=function(o,u){let h;const f=u.target;if(h=vp(f)?{documents:G1(o,f)}:{query:$1(o,f).ft},h.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){h.resumeToken=U1(o,u.resumeToken);const p=Nx(o,u.expectedCount);p!==null&&(h.expectedCount=p)}else if(u.snapshotVersion.compareTo(Ve.min())>0){h.readTime=ru(o,u.snapshotVersion.toTimestamp());const p=Nx(o,u.expectedCount);p!==null&&(h.expectedCount=p)}return h}(this.serializer,e);const s=bL(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=Rx(this.serializer),t.removeTarget=e,this.q_(t)}}class f3 extends E2{constructor(e,t,s,i,o,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,i,u),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return ke(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ke(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ke(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=_L(e.writeResults,e.commitTime),s=dn(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=Rx(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(s=>Dh(this.serializer,s))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m3{}class p3 extends m3{constructor(e,t,s,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new pe(ie.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Go(e,Ax(t,s),i,o,u)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new pe(ie.UNKNOWN,o.toString())})}Ho(e,t,s,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([u,h])=>this.connection.Ho(e,Ax(t,s),i,u,h,o)).catch(u=>{throw u.name==="FirebaseError"?(u.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new pe(ie.UNKNOWN,u.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class g3{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(un(t),this.aa=!1):ye("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bl="RemoteStore";class y3{constructor(e,t,s,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(u=>{s.enqueueAndForget(async()=>{mo(this)&&(ye(bl,"Restarting streams for network reachability change."),await async function(f){const p=Ee(f);p.Ea.add(4),await wu(p),p.Ra.set("Unknown"),p.Ea.delete(4),await sf(p)}(this))})}),this.Ra=new g3(s,i)}}async function sf(n){if(mo(n))for(const e of n.da)await e(!0)}async function wu(n){for(const e of n.da)await e(!1)}function og(n,e){const t=Ee(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),d_(t)?u_(t):Eu(t).O_()&&c_(t,e))}function ou(n,e){const t=Ee(n),s=Eu(t);t.Ia.delete(e),s.O_()&&I2(t,e),t.Ia.size===0&&(s.O_()?s.L_():mo(t)&&t.Ra.set("Unknown"))}function c_(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ve.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Eu(n).Y_(e)}function I2(n,e){n.Va.Ue(e),Eu(n).Z_(e)}function u_(n){n.Va=new hL({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Eu(n).start(),n.Ra.ua()}function d_(n){return mo(n)&&!Eu(n).x_()&&n.Ia.size>0}function mo(n){return Ee(n).Ea.size===0}function S2(n){n.Va=void 0}async function x3(n){n.Ra.set("Online")}async function v3(n){n.Ia.forEach((e,t)=>{c_(n,e)})}async function _3(n,e){S2(n),d_(n)?(n.Ra.ha(e),u_(n)):n.Ra.set("Unknown")}async function b3(n,e,t){if(n.Ra.set("Online"),e instanceof L1&&e.state===2&&e.cause)try{await async function(i,o){const u=o.cause;for(const h of o.targetIds)i.Ia.has(h)&&(await i.remoteSyncer.rejectListen(h,u),i.Ia.delete(h),i.Va.removeTarget(h))}(n,e)}catch(s){ye(bl,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Rp(n,s)}else if(e instanceof tp?n.Va.Ze(e):e instanceof V1?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ve.min()))try{const s=await m2(n.localStore);t.compareTo(s)>=0&&await function(o,u){const h=o.Va.Tt(u);return h.targetChanges.forEach((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const x=o.Ia.get(p);x&&o.Ia.set(p,x.withResumeToken(f.resumeToken,u))}}),h.targetMismatches.forEach((f,p)=>{const x=o.Ia.get(f);if(!x)return;o.Ia.set(f,x.withResumeToken(en.EMPTY_BYTE_STRING,x.snapshotVersion)),I2(o,f);const v=new Li(x.target,f,p,x.sequenceNumber);c_(o,v)}),o.remoteSyncer.applyRemoteEvent(h)}(n,t)}catch(s){ye(bl,"Failed to raise snapshot:",s),await Rp(n,s)}}async function Rp(n,e,t){if(!ho(e))throw e;n.Ea.add(1),await wu(n),n.Ra.set("Offline"),t||(t=()=>m2(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ye(bl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await sf(n)})}function N2(n,e){return e().catch(t=>Rp(n,t,e))}async function Tu(n){const e=Ee(n),t=ro(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ka;for(;w3(e);)try{const i=await r3(e.localStore,s);if(i===null){e.Ta.length===0&&t.L_();break}s=i.batchId,T3(e,i)}catch(i){await Rp(e,i)}A2(e)&&R2(e)}function w3(n){return mo(n)&&n.Ta.length<10}function T3(n,e){n.Ta.push(e);const t=ro(n);t.O_()&&t.X_&&t.ea(e.mutations)}function A2(n){return mo(n)&&!ro(n).x_()&&n.Ta.length>0}function R2(n){ro(n).start()}async function E3(n){ro(n).ra()}async function I3(n){const e=ro(n);for(const t of n.Ta)e.ea(t.mutations)}async function S3(n,e,t){const s=n.Ta.shift(),i=Qv.from(s,e,t);await N2(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await Tu(n)}async function N3(n,e){e&&ro(n).X_&&await async function(s,i){if(function(u){return P1(u)&&u!==ie.ABORTED}(i.code)){const o=s.Ta.shift();ro(s).B_(),await N2(s,()=>s.remoteSyncer.rejectFailedWrite(o.batchId,i)),await Tu(s)}}(n,e),A2(n)&&R2(n)}async function uS(n,e){const t=Ee(n);t.asyncQueue.verifyOperationInProgress(),ye(bl,"RemoteStore received new credentials");const s=mo(t);t.Ea.add(3),await wu(t),s&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await sf(t)}async function Mx(n,e){const t=Ee(n);e?(t.Ea.delete(2),await sf(t)):e||(t.Ea.add(2),await wu(t),t.Ra.set("Unknown"))}function Eu(n){return n.ma||(n.ma=function(t,s,i){const o=Ee(t);return o.sa(),new h3(s,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Xo:x3.bind(null,n),t_:v3.bind(null,n),r_:_3.bind(null,n),H_:b3.bind(null,n)}),n.da.push(async e=>{e?(n.ma.B_(),d_(n)?u_(n):n.Ra.set("Unknown")):(await n.ma.stop(),S2(n))})),n.ma}function ro(n){return n.fa||(n.fa=function(t,s,i){const o=Ee(t);return o.sa(),new f3(s,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:E3.bind(null,n),r_:N3.bind(null,n),ta:I3.bind(null,n),na:S3.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await Tu(n)):(await n.fa.stop(),n.Ta.length>0&&(ye(bl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(e,t,s,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=i,this.removalCallback=o,this.deferred=new Hn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(u=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,i,o){const u=Date.now()+s,h=new h_(e,t,u,i,o);return h.start(s),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new pe(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Iu(n,e){if(un("AsyncQueue",`${e}: ${n}`),ho(n))return new pe(ie.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{static emptySet(e){return new Uc(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Te.comparator(t.key,s.key):(t,s)=>Te.comparator(t.key,s.key),this.keyedMap=Kd(),this.sortedSet=new Pt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,s)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Uc)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=s.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Uc;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(){this.ga=new Pt(Te.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ae(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,s)=>{e.push(s)}),e}}class lu{constructor(e,t,s,i,o,u,h,f,p){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=i,this.mutatedKeys=o,this.fromCache=u,this.syncStateChanged=h,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,t,s,i,o){const u=[];return t.forEach(h=>{u.push({type:0,doc:h})}),new lu(e,t,Uc.emptySet(t),u,s,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==s[i].type||!t[i].doc.isEqual(s[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A3{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class R3{constructor(){this.queries=hS(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const i=Ee(t),o=i.queries;i.queries=hS(),o.forEach((u,h)=>{for(const f of h.Sa)f.onError(s)})})(this,new pe(ie.ABORTED,"Firestore shutting down"))}}function hS(){return new na(n=>_1(n),Xh)}async function f_(n,e){const t=Ee(n);let s=3;const i=e.query;let o=t.queries.get(i);o?!o.ba()&&e.Da()&&(s=2):(o=new A3,s=e.Da()?0:1);try{switch(s){case 0:o.wa=await t.onListen(i,!0);break;case 1:o.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(u){const h=Iu(u,`Initialization of query '${Rc(e.query)}' failed`);return void e.onError(h)}t.queries.set(i,o),o.Sa.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&p_(t)}async function m_(n,e){const t=Ee(n),s=e.query;let i=3;const o=t.queries.get(s);if(o){const u=o.Sa.indexOf(e);u>=0&&(o.Sa.splice(u,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function C3(n,e){const t=Ee(n);let s=!1;for(const i of e){const o=i.query,u=t.queries.get(o);if(u){for(const h of u.Sa)h.Fa(i)&&(s=!0);u.wa=i}}s&&p_(t)}function D3(n,e,t){const s=Ee(n),i=s.queries.get(e);if(i)for(const o of i.Sa)o.onError(t);s.queries.delete(e)}function p_(n){n.Ca.forEach(e=>{e.next()})}var Vx,fS;(fS=Vx||(Vx={})).Ma="default",fS.Cache="cache";class g_{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const i of e.docChanges)i.type!==3&&s.push(i);e=new lu(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=lu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Vx.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k3{constructor(e,t){this.Qa=e,this.byteLength=t}$a(){return"metadata"in this.Qa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(e){this.serializer=e}$s(e){return oi(this.serializer,e)}Us(e){return e.metadata.exists?H1(this.serializer,e.document,!1):Vt.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return dn(e)}}class j3{constructor(e,t){this.Ua=e,this.serializer=t,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=C2(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++t;const s=nt.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(s.get(s.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,s=new mS(this.serializer);for(const i of e)if(i.metadata.queries){const o=s.$s(i.metadata.name);for(const u of i.metadata.queries){const h=(t.get(u)||Ke()).add(o);t.set(u,h)}}return t}async ja(e){const t=await i3(e,new mS(this.serializer),this.Wa,this.Ua.id),s=this.za(this.documents);for(const i of this.Ka)await a3(e,i,s.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:t}}}function C2(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(e){this.key=e}}class k2{constructor(e){this.key=e}}class j2{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ke(),this.mutatedKeys=Ke(),this.eu=w1(e),this.tu=new Uc(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new dS,i=t?t.tu:this.tu;let o=t?t.mutatedKeys:this.mutatedKeys,u=i,h=!1;const f=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,p=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((x,v)=>{const b=i.get(x),I=Jh(this.query,v)?v:null,N=!!b&&this.mutatedKeys.has(b.key),E=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let A=!1;b&&I?b.data.isEqual(I.data)?N!==E&&(s.track({type:3,doc:I}),A=!0):this.su(b,I)||(s.track({type:2,doc:I}),A=!0,(f&&this.eu(I,f)>0||p&&this.eu(I,p)<0)&&(h=!0)):!b&&I?(s.track({type:0,doc:I}),A=!0):b&&!I&&(s.track({type:1,doc:b}),A=!0,(f||p)&&(h=!0)),A&&(I?(u=u.add(I),o=E?o.add(x):o.delete(x)):(u=u.delete(x),o=o.delete(x)))}),this.query.limit!==null)for(;u.size>this.query.limit;){const x=this.query.limitType==="F"?u.last():u.first();u=u.delete(x.key),o=o.delete(x.key),s.track({type:1,doc:x})}return{tu:u,iu:s,Cs:h,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort((x,v)=>function(I,N){const E=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ae(20277,{Rt:A})}};return E(I)-E(N)}(x.type,v.type)||this.eu(x.doc,v.doc)),this.ou(s),i=i??!1;const h=t&&!i?this._u():[],f=this.Xa.size===0&&this.current&&!i?1:0,p=f!==this.Za;return this.Za=f,u.length!==0||p?{snapshot:new lu(this.query,e.tu,o,u,e.mutatedKeys,f===0,p,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:h}:{au:h}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new dS,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ke(),this.tu.forEach(s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))});const t=[];return e.forEach(s=>{this.Xa.has(s)||t.push(new k2(s))}),this.Xa.forEach(s=>{e.has(s)||t.push(new D2(s))}),t}cu(e){this.Ya=e.Qs,this.Xa=Ke();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return lu.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const po="SyncEngine";class P3{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class O3{constructor(e){this.key=e,this.hu=!1}}class M3{constructor(e,t,s,i,o,u){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new na(h=>_1(h),Xh),this.Iu=new Map,this.Eu=new Set,this.du=new Pt(Te.comparator),this.Au=new Map,this.Ru=new t_,this.Vu={},this.mu=new Map,this.fu=_l.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function V3(n,e,t=!0){const s=lg(n);let i;const o=s.Tu.get(e);return o?(s.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await P2(s,e,t,!0),i}async function L3(n,e){const t=lg(n);await P2(t,e,!0,!1)}async function P2(n,e,t,s){const i=await iu(n.localStore,ds(e)),o=i.targetId,u=n.sharedClientState.addLocalQueryTarget(o,t);let h;return s&&(h=await y_(n,e,o,u==="current",i.resumeToken)),n.isPrimaryClient&&t&&og(n.remoteStore,i),h}async function y_(n,e,t,s,i){n.pu=(v,b,I)=>async function(E,A,C,q){let P=A.view.ru(C);P.Cs&&(P=await Sp(E.localStore,A.query,!1).then(({documents:L})=>A.view.ru(L,P)));const V=q&&q.targetChanges.get(A.targetId),F=q&&q.targetMismatches.get(A.targetId)!=null,K=A.view.applyChanges(P,E.isPrimaryClient,V,F);return Lx(E,A.targetId,K.au),K.snapshot}(n,v,b,I);const o=await Sp(n.localStore,e,!0),u=new j2(e,o.Qs),h=u.ru(o.documents),f=tf.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",i),p=u.applyChanges(h,n.isPrimaryClient,f);Lx(n,t,p.au);const x=new P3(e,t,u);return n.Tu.set(e,x),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function U3(n,e,t){const s=Ee(n),i=s.Tu.get(e),o=s.Iu.get(i.targetId);if(o.length>1)return s.Iu.set(i.targetId,o.filter(u=>!Xh(u,e))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(i.targetId),s.sharedClientState.isActiveQueryTarget(i.targetId)||await au(s.localStore,i.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(i.targetId),t&&ou(s.remoteStore,i.targetId),cu(s,i.targetId)}).catch(uo)):(cu(s,i.targetId),await au(s.localStore,i.targetId,!0))}async function F3(n,e){const t=Ee(n),s=t.Tu.get(e),i=t.Iu.get(s.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),ou(t.remoteStore,s.targetId))}async function B3(n,e,t){const s=b_(n);try{const i=await function(u,h){const f=Ee(u),p=_t.now(),x=h.reduce((I,N)=>I.add(N.key),Ke());let v,b;return f.persistence.runTransaction("Locally write mutations","readwrite",I=>{let N=bs(),E=Ke();return f.Ns.getEntries(I,x).next(A=>{N=A,N.forEach((C,q)=>{q.isValidDocument()||(E=E.add(C))})}).next(()=>f.localDocuments.getOverlayedDocuments(I,N)).next(A=>{v=A;const C=[];for(const q of h){const P=cL(q,v.get(q.key).overlayedDocument);P!=null&&C.push(new sa(q.key,P,d1(P.value.mapValue),Ht.exists(!0)))}return f.mutationQueue.addMutationBatch(I,p,C,h)}).next(A=>{b=A;const C=A.applyToLocalDocumentSet(v,E);return f.documentOverlayCache.saveOverlays(I,A.batchId,C)})}).then(()=>({batchId:b.batchId,changes:E1(v)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(i.batchId),function(u,h,f){let p=u.Vu[u.currentUser.toKey()];p||(p=new Pt($e)),p=p.insert(h,f),u.Vu[u.currentUser.toKey()]=p}(s,i.batchId,t),await ra(s,i.changes),await Tu(s.remoteStore)}catch(i){const o=Iu(i,"Failed to persist write");t.reject(o)}}async function O2(n,e){const t=Ee(n);try{const s=await s3(t.localStore,e);e.targetChanges.forEach((i,o)=>{const u=t.Au.get(o);u&&(ke(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?u.hu=!0:i.modifiedDocuments.size>0?ke(u.hu,14607):i.removedDocuments.size>0&&(ke(u.hu,42227),u.hu=!1))}),await ra(t,s,e)}catch(s){await uo(s)}}function pS(n,e,t){const s=Ee(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const i=[];s.Tu.forEach((o,u)=>{const h=u.view.va(e);h.snapshot&&i.push(h.snapshot)}),function(u,h){const f=Ee(u);f.onlineState=h;let p=!1;f.queries.forEach((x,v)=>{for(const b of v.Sa)b.va(h)&&(p=!0)}),p&&p_(f)}(s.eventManager,e),i.length&&s.Pu.H_(i),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function z3(n,e,t){const s=Ee(n);s.sharedClientState.updateQueryState(e,"rejected",t);const i=s.Au.get(e),o=i&&i.key;if(o){let u=new Pt(Te.comparator);u=u.insert(o,Vt.newNoDocument(o,Ve.min()));const h=Ke().add(o),f=new ef(Ve.min(),new Map,new Pt($e),u,h);await O2(s,f),s.du=s.du.remove(o),s.Au.delete(e),__(s)}else await au(s.localStore,e,!1).then(()=>cu(s,e,t)).catch(uo)}async function q3(n,e){const t=Ee(n),s=e.batch.batchId;try{const i=await n3(t.localStore,e);v_(t,s,null),x_(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await ra(t,i)}catch(i){await uo(i)}}async function H3(n,e,t){const s=Ee(n);try{const i=await function(u,h){const f=Ee(u);return f.persistence.runTransaction("Reject batch","readwrite-primary",p=>{let x;return f.mutationQueue.lookupMutationBatch(p,h).next(v=>(ke(v!==null,37113),x=v.keys(),f.mutationQueue.removeMutationBatch(p,v))).next(()=>f.mutationQueue.performConsistencyCheck(p)).next(()=>f.documentOverlayCache.removeOverlaysForBatchId(p,x,h)).next(()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,x)).next(()=>f.localDocuments.getDocuments(p,x))})}(s.localStore,e);v_(s,e,t),x_(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await ra(s,i)}catch(i){await uo(i)}}async function G3(n,e){const t=Ee(n);mo(t.remoteStore)||ye(po,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const s=await function(u){const h=Ee(u);return h.persistence.runTransaction("Get highest unacknowledged batch id","readonly",f=>h.mutationQueue.getHighestUnacknowledgedBatchId(f))}(t.localStore);if(s===Ka)return void e.resolve();const i=t.mu.get(s)||[];i.push(e),t.mu.set(s,i)}catch(s){const i=Iu(s,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function x_(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function v_(n,e,t){const s=Ee(n);let i=s.Vu[s.currentUser.toKey()];if(i){const o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),s.Vu[s.currentUser.toKey()]=i}}function cu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(s=>{n.Ru.containsKey(s)||M2(n,s)})}function M2(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(ou(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),__(n))}function Lx(n,e,t){for(const s of t)s instanceof D2?(n.Ru.addReference(s.key,e),$3(n,s)):s instanceof k2?(ye(po,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,e),n.Ru.containsKey(s.key)||M2(n,s.key)):Ae(19791,{wu:s})}function $3(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Eu.has(s)||(ye(po,"New document in limbo: "+t),n.Eu.add(s),__(n))}function __(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Te(nt.fromString(e)),s=n.fu.next();n.Au.set(s,new O3(t)),n.du=n.du.insert(t,s),og(n.remoteStore,new Li(ds(vu(t.path)),s,"TargetPurposeLimboResolution",vs.ce))}}async function ra(n,e,t){const s=Ee(n),i=[],o=[],u=[];s.Tu.isEmpty()||(s.Tu.forEach((h,f)=>{u.push(s.pu(f,e,t).then(p=>{if((p||t)&&s.isPrimaryClient){const x=p?!p.fromCache:t?.targetChanges.get(f.targetId)?.current;s.sharedClientState.updateQueryState(f.targetId,x?"current":"not-current")}if(p){i.push(p);const x=i_.As(f.targetId,p);o.push(x)}}))}),await Promise.all(u),s.Pu.H_(i),await async function(f,p){const x=Ee(f);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>Y.forEach(p,b=>Y.forEach(b.Es,I=>x.persistence.referenceDelegate.addReference(v,b.targetId,I)).next(()=>Y.forEach(b.ds,I=>x.persistence.referenceDelegate.removeReference(v,b.targetId,I)))))}catch(v){if(!ho(v))throw v;ye(a_,"Failed to update sequence numbers: "+v)}for(const v of p){const b=v.targetId;if(!v.fromCache){const I=x.Ms.get(b),N=I.snapshotVersion,E=I.withLastLimboFreeSnapshotVersion(N);x.Ms=x.Ms.insert(b,E)}}}(s.localStore,o))}async function K3(n,e){const t=Ee(n);if(!t.currentUser.isEqual(e)){ye(po,"User change. New user:",e.toKey());const s=await f2(t.localStore,e);t.currentUser=e,function(o,u){o.mu.forEach(h=>{h.forEach(f=>{f.reject(new pe(ie.CANCELLED,u))})}),o.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await ra(t,s.Ls)}}function Q3(n,e){const t=Ee(n),s=t.Au.get(e);if(s&&s.hu)return Ke().add(s.key);{let i=Ke();const o=t.Iu.get(e);if(!o)return i;for(const u of o){const h=t.Tu.get(u);i=i.unionWith(h.view.nu)}return i}}async function W3(n,e){const t=Ee(n),s=await Sp(t.localStore,e.query,!0),i=e.view.cu(s);return t.isPrimaryClient&&Lx(t,e.targetId,i.au),i}async function Y3(n,e){const t=Ee(n);return y2(t.localStore,e).then(s=>ra(t,s))}async function X3(n,e,t,s){const i=Ee(n),o=await function(h,f){const p=Ee(h),x=Ee(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",v=>x.er(v,f).next(b=>b?p.localDocuments.getDocuments(v,b):Y.resolve(null)))}(i.localStore,e);o!==null?(t==="pending"?await Tu(i.remoteStore):t==="acknowledged"||t==="rejected"?(v_(i,e,s||null),x_(i,e),function(h,f){Ee(Ee(h).mutationQueue).ir(f)}(i.localStore,e)):Ae(6720,"Unknown batchState",{Su:t}),await ra(i,o)):ye(po,"Cannot apply mutation batch with id: "+e)}async function J3(n,e){const t=Ee(n);if(lg(t),b_(t),e===!0&&t.gu!==!0){const s=t.sharedClientState.getAllActiveQueryTargets(),i=await gS(t,s.toArray());t.gu=!0,await Mx(t.remoteStore,!0);for(const o of i)og(t.remoteStore,o)}else if(e===!1&&t.gu!==!1){const s=[];let i=Promise.resolve();t.Iu.forEach((o,u)=>{t.sharedClientState.isLocalQueryTarget(u)?s.push(u):i=i.then(()=>(cu(t,u),au(t.localStore,u,!0))),ou(t.remoteStore,u)}),await i,await gS(t,s),function(u){const h=Ee(u);h.Au.forEach((f,p)=>{ou(h.remoteStore,p)}),h.Ru.Jr(),h.Au=new Map,h.du=new Pt(Te.comparator)}(t),t.gu=!1,await Mx(t.remoteStore,!1)}}async function gS(n,e,t){const s=Ee(n),i=[],o=[];for(const u of e){let h;const f=s.Iu.get(u);if(f&&f.length!==0){h=await iu(s.localStore,ds(f[0]));for(const p of f){const x=s.Tu.get(p),v=await W3(s,x);v.snapshot&&o.push(v.snapshot)}}else{const p=await g2(s.localStore,u);h=await iu(s.localStore,p),await y_(s,V2(p),u,!1,h.resumeToken)}i.push(h)}return s.Pu.H_(o),i}function V2(n){return v1(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Z3(n){return function(t){return Ee(Ee(t).persistence).Ts()}(Ee(n).localStore)}async function e6(n,e,t,s){const i=Ee(n);if(i.gu)return void ye(po,"Ignoring unexpected query state notification.");const o=i.Iu.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{const u=await y2(i.localStore,b1(o[0])),h=ef.createSynthesizedRemoteEventForCurrentChange(e,t==="current",en.EMPTY_BYTE_STRING);await ra(i,u,h);break}case"rejected":await au(i.localStore,e,!0),cu(i,e,s);break;default:Ae(64155,t)}}async function t6(n,e,t){const s=lg(n);if(s.gu){for(const i of e){if(s.Iu.has(i)&&s.sharedClientState.isActiveQueryTarget(i)){ye(po,"Adding an already active target "+i);continue}const o=await g2(s.localStore,i),u=await iu(s.localStore,o);await y_(s,V2(o),u.targetId,!1,u.resumeToken),og(s.remoteStore,u)}for(const i of t)s.Iu.has(i)&&await au(s.localStore,i,!1).then(()=>{ou(s.remoteStore,i),cu(s,i)}).catch(uo)}}function lg(n){const e=Ee(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=O2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Q3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=z3.bind(null,e),e.Pu.H_=C3.bind(null,e.eventManager),e.Pu.yu=D3.bind(null,e.eventManager),e}function b_(n){const e=Ee(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=q3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=H3.bind(null,e),e}function n6(n,e,t){const s=Ee(n);(async function(o,u,h){try{const f=await u.getMetadata();if(await function(I,N){const E=Ee(I),A=dn(N.createTime);return E.persistence.runTransaction("hasNewerBundle","readonly",C=>E.Ii.getBundleMetadata(C,N.id)).then(C=>!!C&&C.createTime.compareTo(A)>=0)}(o.localStore,f))return await u.close(),h._completeWith(function(I){return{taskState:"Success",documentsLoaded:I.totalDocuments,bytesLoaded:I.totalBytes,totalDocuments:I.totalDocuments,totalBytes:I.totalBytes}}(f)),Promise.resolve(new Set);h._updateProgress(C2(f));const p=new j3(f,u.serializer);let x=await u.bu();for(;x;){const b=await p.Ga(x);b&&h._updateProgress(b),x=await u.bu()}const v=await p.ja(o.localStore);return await ra(o,v.Ha,void 0),await function(I,N){const E=Ee(I);return E.persistence.runTransaction("Save bundle","readwrite",A=>E.Ii.saveBundleMetadata(A,N))}(o.localStore,f),h._completeWith(v.progress),Promise.resolve(v.Ja)}catch(f){return di(po,`Loading bundle failed with ${f}`),h._failWith(f),Promise.resolve(new Set)}})(s,e,t).then(i=>{s.sharedClientState.notifyBundleLoaded(i)})}class kh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=nf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return h2(this.persistence,new d2,e.initialUser,this.serializer)}Cu(e){return new n_(ag.mi,this.serializer)}Du(e){return new w2}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}kh.provider={build:()=>new kh};class s6 extends kh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ke(this.persistence.referenceDelegate instanceof Ip,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new i2(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Xn.withCacheSize(this.cacheSizeBytes):Xn.DEFAULT;return new n_(s=>Ip.mi(s,t),this.serializer)}}class L2 extends kh{constructor(e,t,s){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=s,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await b_(this.xu.syncEngine),await Tu(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return h2(this.persistence,new d2,e.initialUser,this.serializer)}Fu(e,t){const s=this.persistence.referenceDelegate.garbageCollector;return new i2(s,e.asyncQueue,t)}Mu(e,t){const s=new h5(t,this.persistence);return new d5(e.asyncQueue,s)}Cu(e){const t=r_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?Xn.withCacheSize(this.cacheSizeBytes):Xn.DEFAULT;return new s_(this.synchronizeTabs,t,e.clientId,s,e.asyncQueue,T2(),sp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new w2}}class r6 extends L2{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof $0&&(this.sharedClientState.syncEngine={Co:X3.bind(null,t),vo:e6.bind(null,t),Fo:t6.bind(null,t),Ts:Z3.bind(null,t),Do:Y3.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji(async s=>{await J3(this.xu.syncEngine,s),this.gcScheduler&&(s&&!this.gcScheduler.started?this.gcScheduler.start():s||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(s&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():s||this.indexBackfillerScheduler.stop())})}Du(e){const t=T2();if(!$0.v(t))throw new pe(ie.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const s=r_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new $0(t,e.asyncQueue,s,e.clientId,e.initialUser)}}class jh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>pS(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=K3.bind(null,this.syncEngine),await Mx(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new R3}()}createDatastore(e){const t=nf(e.databaseInfo.databaseId),s=function(o){return new d3(o)}(e.databaseInfo);return function(o,u,h,f){return new p3(o,u,h,f)}(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return function(s,i,o,u,h){return new y3(s,i,o,u,h)}(this.localStore,this.datastore,e.asyncQueue,t=>pS(this.syncEngine,t,0),function(){return lS.v()?new lS:new o3}())}createSyncEngine(e,t){return function(i,o,u,h,f,p,x){const v=new M3(i,o,u,h,f,p);return x&&(v.gu=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(t){const s=Ee(t);ye(bl,"RemoteStore shutting down."),s.Ea.add(5),await wu(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}jh.provider={build:()=>new jh};function yS(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const s={value:n.slice(t,t+e),done:!1};return t+=e,s}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):un("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i6{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new Hn,this.buffer=new Uint8Array,this.Lu=function(){return new TextDecoder("utf-8")}(),this.ku().then(s=>{s&&s.$a()?this.metadata.resolve(s.Qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(s?.Qa)}`))},s=>this.metadata.reject(s))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(e===null)return null;const t=this.Lu.decode(e),s=Number(t);isNaN(s)&&this.Qu(`length string (${t}) is not valid number`);const i=await this.$u(s);return new k3(JSON.parse(i),e.length+s)}Uu(){return this.buffer.findIndex(e=>e===123)}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(this.buffer.length===0)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ku(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a6{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new pe(ie.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(i,o){const u=Ee(i),h={documents:o.map(v=>Ch(u.serializer,v))},f=await u.Ho("BatchGetDocuments",u.serializer.databaseId,nt.emptyPath(),h,o.length),p=new Map;f.forEach(v=>{const b=xL(u.serializer,v);p.set(b.key.toString(),b)});const x=[];return o.forEach(v=>{const b=p.get(v.toString());ke(!!b,55234,{key:v}),x.push(b)}),x}(this.datastore,e);return t.forEach(s=>this.recordVersion(s)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(s){this.lastTransactionError=s}this.writtenDocs.add(e.toString())}delete(e){this.write(new bu(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,s)=>{const i=Te.fromPath(s);this.mutations.push(new $v(i,this.precondition(i)))}),await async function(s,i){const o=Ee(s),u={writes:i.map(h=>Dh(o.serializer,h))};await o.Go("Commit",o.serializer.databaseId,nt.emptyPath(),u)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ae(50498,{Gu:e.constructor.name});t=Ve.min()}const s=this.readVersions.get(e.key.toString());if(s){if(!t.isEqual(s))throw new pe(ie.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ve.min())?Ht.exists(!1):Ht.updateTime(t):Ht.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ve.min()))throw new pe(ie.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ht.updateTime(t)}return Ht.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(e,t,s,i,o){this.asyncQueue=e,this.datastore=t,this.options=s,this.updateFunction=i,this.deferred=o,this.zu=s.maxAttempts,this.M_=new l_(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_(async()=>{const e=new a6(this.datastore),t=this.Hu(e);t&&t.then(s=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(s)}).catch(i=>{this.Yu(i)}))}).catch(s=>{this.Yu(s)})})}Hu(e){try{const t=this.updateFunction(e);return!Qh(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ju(),Promise.resolve()))):this.deferred.reject(e)}Zu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!P1(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const io="FirestoreClient";class l6{constructor(e,t,s,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=i,this.user=Mn.UNAUTHENTICATED,this.clientId=kv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(s,async u=>{ye(io,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u}),this.appCheckCredentials.start(s,u=>(ye(io,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Hn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Iu(t,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function Q0(n,e){n.asyncQueue.verifyOperationInProgress(),ye(io,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener(async i=>{s.isEqual(i)||(await f2(e.localStore,i),s=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function xS(n,e){n.asyncQueue.verifyOperationInProgress();const t=await w_(n);ye(io,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(s=>uS(e.remoteStore,s)),n.setAppCheckTokenChangeListener((s,i)=>uS(e.remoteStore,i)),n._onlineComponents=e}async function w_(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ye(io,"Using user provided OfflineComponentProvider");try{await Q0(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===ie.FAILED_PRECONDITION||i.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;di("Error using user provided cache. Falling back to memory cache: "+t),await Q0(n,new kh)}}else ye(io,"Using default OfflineComponentProvider"),await Q0(n,new s6(void 0));return n._offlineComponents}async function ug(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ye(io,"Using user provided OnlineComponentProvider"),await xS(n,n._uninitializedComponentsProvider._online)):(ye(io,"Using default OnlineComponentProvider"),await xS(n,new jh))),n._onlineComponents}function U2(n){return w_(n).then(e=>e.persistence)}function T_(n){return w_(n).then(e=>e.localStore)}function F2(n){return ug(n).then(e=>e.remoteStore)}function E_(n){return ug(n).then(e=>e.syncEngine)}function c6(n){return ug(n).then(e=>e.datastore)}async function uu(n){const e=await ug(n),t=e.eventManager;return t.onListen=V3.bind(null,e.syncEngine),t.onUnlisten=U3.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=L3.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=F3.bind(null,e.syncEngine),t}function u6(n){return n.asyncQueue.enqueue(async()=>{const e=await U2(n),t=await F2(n);return e.setNetworkEnabled(!0),function(i){const o=Ee(i);return o.Ea.delete(0),sf(o)}(t)})}function d6(n){return n.asyncQueue.enqueue(async()=>{const e=await U2(n),t=await F2(n);return e.setNetworkEnabled(!1),async function(i){const o=Ee(i);o.Ea.add(0),await wu(o),o.Ra.set("Offline")}(t)})}function h6(n,e){const t=new Hn;return n.asyncQueue.enqueueAndForget(async()=>async function(i,o,u){try{const h=await function(p,x){const v=Ee(p);return v.persistence.runTransaction("read document","readonly",b=>v.localDocuments.getDocument(b,x))}(i,o);h.isFoundDocument()?u.resolve(h):h.isNoDocument()?u.resolve(null):u.reject(new pe(ie.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const f=Iu(h,`Failed to get document '${o} from cache`);u.reject(f)}}(await T_(n),e,t)),t.promise}function B2(n,e,t={}){const s=new Hn;return n.asyncQueue.enqueueAndForget(async()=>function(o,u,h,f,p){const x=new cg({next:b=>{x.Nu(),u.enqueueAndForget(()=>m_(o,v));const I=b.docs.has(h);!I&&b.fromCache?p.reject(new pe(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&b.fromCache&&f&&f.source==="server"?p.reject(new pe(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(b)},error:b=>p.reject(b)}),v=new g_(vu(h.path),x,{includeMetadataChanges:!0,qa:!0});return f_(o,v)}(await uu(n),n.asyncQueue,e,t,s)),s.promise}function f6(n,e){const t=new Hn;return n.asyncQueue.enqueueAndForget(async()=>async function(i,o,u){try{const h=await Sp(i,o,!0),f=new j2(o,h.Qs),p=f.ru(h.documents),x=f.applyChanges(p,!1);u.resolve(x.snapshot)}catch(h){const f=Iu(h,`Failed to execute query '${o} against cache`);u.reject(f)}}(await T_(n),e,t)),t.promise}function z2(n,e,t={}){const s=new Hn;return n.asyncQueue.enqueueAndForget(async()=>function(o,u,h,f,p){const x=new cg({next:b=>{x.Nu(),u.enqueueAndForget(()=>m_(o,v)),b.fromCache&&f.source==="server"?p.reject(new pe(ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(b)},error:b=>p.reject(b)}),v=new g_(h,x,{includeMetadataChanges:!0,qa:!0});return f_(o,v)}(await uu(n),n.asyncQueue,e,t,s)),s.promise}function m6(n,e){const t=new cg(e);return n.asyncQueue.enqueueAndForget(async()=>function(i,o){Ee(i).Ca.add(o),o.next()}(await uu(n),t)),()=>{t.Nu(),n.asyncQueue.enqueueAndForget(async()=>function(i,o){Ee(i).Ca.delete(o)}(await uu(n),t))}}function p6(n,e,t,s){const i=function(u,h){let f;return f=typeof u=="string"?M1().encode(u):u,function(x,v){return new i6(x,v)}(function(x,v){if(x instanceof Uint8Array)return yS(x,v);if(x instanceof ArrayBuffer)return yS(new Uint8Array(x),v);if(x instanceof ReadableStream)return x.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(f),h)}(t,nf(e));n.asyncQueue.enqueueAndForget(async()=>{n6(await E_(n),i,s)})}function g6(n,e){return n.asyncQueue.enqueue(async()=>function(s,i){const o=Ee(s);return o.persistence.runTransaction("Get named query","readonly",u=>o.Ii.getNamedQuery(u,i))}(await T_(n),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q2(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vS=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H2="firestore.googleapis.com",_S=!0;class bS{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new pe(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=H2,this.ssl=_S}else this.host=e.host,this.ssl=e.ssl??_S;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=t2;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<VL)throw new pe(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}VA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=q2(e.experimentalLongPollingOptions??{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new pe(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new pe(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new pe(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,i){return s.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class rf{constructor(e,t,s,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bS({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new pe(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new pe(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bS(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new ZV;switch(s.type){case"firstParty":return new s5(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new pe(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const s=vS.get(t);s&&(ye("ComponentProvider","Removing Datastore"),vS.delete(t),s.terminate())}(this),Promise.resolve()}}function y6(n,e,t,s={}){n=pt(n,rf);const i=lo(e),o=n._getSettings(),u={...o,emulatorOptions:n._getEmulatorOptions()},h=`${e}:${t}`;i&&(sv(`https://${h}`),rv("Firestore",!0)),o.host!==H2&&o.host!==h&&di("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...o,host:h,ssl:i,emulatorOptions:s};if(!Ya(f,u)&&(n._setSettings(f),s.mockUserToken)){let p,x;if(typeof s.mockUserToken=="string")p=s.mockUserToken,x=Mn.MOCK_USER;else{p=uN(s.mockUserToken,n._app?.options.projectId);const v=s.mockUserToken.sub||s.mockUserToken.user_id;if(!v)throw new pe(ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new Mn(v)}n._authCredentials=new e5(new OA(p,x))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hs=class G2{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new G2(this.firestore,e,this._query)}},jt=class Yd{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Yd(this.firestore,e,this._key)}toJSON(){return{type:Yd._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(Kh(t,Yd._jsonSchema))return new Yd(e,s||null,new Te(nt.fromString(t.referencePath)))}};jt._jsonSchemaVersion="firestore/documentReference/1.0",jt._jsonSchema={type:vn("string",jt._jsonSchemaVersion),referencePath:vn("string")};let Qa=class $2 extends hs{constructor(e,t,s){super(e,t,vu(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new jt(this.firestore,null,new Te(e))}withConverter(e){return new $2(this.firestore,e,this._path)}};function K2(n,e,...t){if(n=Oe(n),jv("collection","path",e),n instanceof rf){const s=nt.fromString(e,...t);return cI(s),new Qa(n,null,s)}{if(!(n instanceof jt||n instanceof Qa))throw new pe(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(nt.fromString(e,...t));return cI(s),new Qa(n.firestore,null,s)}}function x6(n,e){if(n=pt(n,rf),jv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new pe(ie.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new hs(n,null,function(s){return new ta(nt.emptyPath(),s)}(e))}function Cp(n,e,...t){if(n=Oe(n),arguments.length===1&&(e=kv.newId()),jv("doc","path",e),n instanceof rf){const s=nt.fromString(e,...t);return lI(s),new jt(n,null,new Te(s))}{if(!(n instanceof jt||n instanceof Qa))throw new pe(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(nt.fromString(e,...t));return lI(s),new jt(n.firestore,n instanceof Qa?n.converter:null,new Te(s))}}function Q2(n,e){return n=Oe(n),e=Oe(e),(n instanceof jt||n instanceof Qa)&&(e instanceof jt||e instanceof Qa)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function W2(n,e){return n=Oe(n),e=Oe(e),n instanceof hs&&e instanceof hs&&n.firestore===e.firestore&&Xh(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wS="AsyncQueue";class TS{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new l_(this,"async_queue_retry"),this._c=()=>{const s=sp();s&&ye(wS,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=sp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=sp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new Hn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ho(e))throw e;ye(wS,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(s=>{throw this.nc=s,this.rc=!1,un("INTERNAL UNHANDLED ERROR: ",ES(s)),s}).then(s=>(this.rc=!1,s))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=h_.createAndSchedule(this,e,t,s,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&Ae(47125,{Pc:ES(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,s)=>t.targetTimeMs-s.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function ES(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ux(n){return function(t,s){if(typeof t!="object"||t===null)return!1;const i=t;for(const o of s)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}class v6{constructor(){this._progressObserver={},this._taskCompletionResolver=new Hn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,s){this._progressObserver={next:e,error:t,complete:s}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _6=-1;let hn=class extends rf{constructor(e,t,s,i){super(e,t,s,i),this.type="firestore",this._queue=new TS,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new TS(e),this._firestoreClient=void 0,await e}}};function ss(n){if(n._terminated)throw new pe(ie.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Y2(n),n._firestoreClient}function Y2(n){const e=n._freezeSettings(),t=function(i,o,u,h){return new B5(i,o,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,q2(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new l6(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}}(n._componentsProvider))}function b6(n,e){di("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return X2(n,jh.provider,{build:s=>new L2(s,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}async function w6(n){di("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();X2(n,jh.provider,{build:t=>new r6(t,e.cacheSizeBytes)})}function X2(n,e,t){if((n=pt(n,hn))._firestoreClient||n._terminated)throw new pe(ie.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new pe(ie.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},Y2(n)}function T6(n){if(n._initialized&&!n._terminated)throw new pe(ie.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Hn;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(s){if(!ai.v())return Promise.resolve();const i=s+u2;await ai.delete(i)}(r_(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function E6(n){return function(t){const s=new Hn;return t.asyncQueue.enqueueAndForget(async()=>G3(await E_(t),s)),s.promise}(ss(n=pt(n,hn)))}function I6(n){return u6(ss(n=pt(n,hn)))}function S6(n){return d6(ss(n=pt(n,hn)))}function N6(n,e){const t=ss(n=pt(n,hn)),s=new v6;return p6(t,n._databaseId,e,s),s}function A6(n,e){return g6(ss(n=pt(n,hn)),e).then(t=>t?new hs(n,null,t.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Jn(en.fromBase64String(e))}catch(t){throw new pe(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Jn(en.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Jn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Kh(e,Jn._jsonSchema))return Jn.fromBase64String(e.bytes)}}Jn._jsonSchemaVersion="firestore/bytes/1.0",Jn._jsonSchema={type:vn("string",Jn._jsonSchemaVersion),bytes:vn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ao=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new pe(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Al=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new pe(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new pe(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return $e(this._lat,e._lat)||$e(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ir._jsonSchemaVersion}}static fromJSON(e){if(Kh(e,Ir._jsonSchema))return new Ir(e.latitude,e.longitude)}}Ir._jsonSchemaVersion="firestore/geoPoint/1.0",Ir._jsonSchema={type:vn("string",Ir._jsonSchemaVersion),latitude:vn("number"),longitude:vn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,i){if(s.length!==i.length)return!1;for(let o=0;o<s.length;++o)if(s[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:li._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Kh(e,li._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new li(e.vectorValues);throw new pe(ie.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}li._jsonSchemaVersion="firestore/vectorValue/1.0",li._jsonSchema={type:vn("string",li._jsonSchemaVersion),vectorValues:vn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R6=/^__.*__$/;class C6{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new sa(e,this.data,this.fieldMask,t,this.fieldTransforms):new _u(e,this.data,t,this.fieldTransforms)}}class J2{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new sa(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Z2(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ae(40011,{Ac:n})}}class dg{constructor(e,t,s,i,o,u){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new dg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),s=this.Vc({path:t,fc:!1});return s.gc(e),s}yc(e){const t=this.path?.child(e),s=this.Vc({path:t,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Dp(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Z2(this.Ac)&&R6.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class D6{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||nf(e)}Cc(e,t,s,i=!1){return new dg({Ac:e,methodName:t,Dc:s,path:qt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Rl(n){const e=n._freezeSettings(),t=nf(n._databaseId);return new D6(n._databaseId,!!e.ignoreUndefinedProperties,t)}function hg(n,e,t,s,i,o={}){const u=n.Cc(o.merge||o.mergeFields?2:0,e,t,i);D_("Data must be an object, but it was:",u,s);const h=nR(s,u);let f,p;if(o.merge)f=new _s(u.fieldMask),p=u.fieldTransforms;else if(o.mergeFields){const x=[];for(const v of o.mergeFields){const b=Fx(e,v,t);if(!u.contains(b))throw new pe(ie.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);rR(x,b)||x.push(b)}f=new _s(x),p=u.fieldTransforms.filter(v=>f.covers(v.field))}else f=null,p=u.fieldTransforms;return new C6(new qn(h),f,p)}class af extends Al{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof af}}function eR(n,e,t){return new dg({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class I_ extends Al{_toFieldTransform(e){return new Zh(e.path,new nu)}isEqual(e){return e instanceof I_}}class S_ extends Al{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=eR(this,e,!0),s=this.vc.map(o=>Cl(o,t)),i=new gl(s);return new Zh(e.path,i)}isEqual(e){return e instanceof S_&&Ya(this.vc,e.vc)}}class N_ extends Al{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=eR(this,e,!0),s=this.vc.map(o=>Cl(o,t)),i=new yl(s);return new Zh(e.path,i)}isEqual(e){return e instanceof N_&&Ya(this.vc,e.vc)}}class A_ extends Al{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new su(e.serializer,N1(e.serializer,this.Fc));return new Zh(e.path,t)}isEqual(e){return e instanceof A_&&this.Fc===e.Fc}}function R_(n,e,t,s){const i=n.Cc(1,e,t);D_("Data must be an object, but it was:",i,s);const o=[],u=qn.empty();fo(s,(f,p)=>{const x=k_(e,f,t);p=Oe(p);const v=i.yc(x);if(p instanceof af)o.push(x);else{const b=Cl(p,v);b!=null&&(o.push(x),u.set(x,b))}});const h=new _s(o);return new J2(u,h,i.fieldTransforms)}function C_(n,e,t,s,i,o){const u=n.Cc(1,e,t),h=[Fx(e,s,t)],f=[i];if(o.length%2!=0)throw new pe(ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<o.length;b+=2)h.push(Fx(e,o[b])),f.push(o[b+1]);const p=[],x=qn.empty();for(let b=h.length-1;b>=0;--b)if(!rR(p,h[b])){const I=h[b];let N=f[b];N=Oe(N);const E=u.yc(I);if(N instanceof af)p.push(I);else{const A=Cl(N,E);A!=null&&(p.push(I),x.set(I,A))}}const v=new _s(p);return new J2(x,v,u.fieldTransforms)}function tR(n,e,t,s=!1){return Cl(t,n.Cc(s?4:3,e))}function Cl(n,e){if(sR(n=Oe(n)))return D_("Unsupported field value:",e,n),nR(n,e);if(n instanceof Al)return function(s,i){if(!Z2(i.Ac))throw i.Sc(`${s._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${s._methodName}() is not currently supported inside arrays`);const o=s._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(s,i){const o=[];let u=0;for(const h of s){let f=Cl(h,i.wc(u));f==null&&(f={nullValue:"NULL_VALUE"}),o.push(f),u++}return{arrayValue:{values:o}}}(n,e)}return function(s,i){if((s=Oe(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return N1(i.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const o=_t.fromDate(s);return{timestampValue:ru(i.serializer,o)}}if(s instanceof _t){const o=new _t(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:ru(i.serializer,o)}}if(s instanceof Ir)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Jn)return{bytesValue:U1(i.serializer,s._byteString)};if(s instanceof jt){const o=i.databaseId,u=s.firestore._databaseId;if(!u.isEqual(o))throw i.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Xv(s.firestore._databaseId||i.databaseId,s._key.path)}}if(s instanceof li)return function(u,h){return{mapValue:{fields:{[Fv]:{stringValue:Bv},[Zc]:{arrayValue:{values:u.toArray().map(p=>{if(typeof p!="number")throw h.Sc("VectorValues must only contain numeric values.");return Gv(h.serializer,p)})}}}}}}(s,i);throw i.Sc(`Unsupported field value: ${Qp(s)}`)}(n,e)}function nR(n,e){const t={};return n1(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):fo(n,(s,i)=>{const o=Cl(i,e.mc(s));o!=null&&(t[s]=o)}),{mapValue:{fields:t}}}function sR(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof _t||n instanceof Ir||n instanceof Jn||n instanceof jt||n instanceof Al||n instanceof li)}function D_(n,e,t){if(!sR(t)||!LA(t)){const s=Qp(t);throw s==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+s)}}function Fx(n,e,t){if((e=Oe(e))instanceof ao)return e._internalPath;if(typeof e=="string")return k_(n,e);throw Dp("Field path arguments must be of type string or ",n,!1,void 0,t)}const k6=new RegExp("[~\\*/\\[\\]]");function k_(n,e,t){if(e.search(k6)>=0)throw Dp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ao(...e.split("."))._internalPath}catch{throw Dp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Dp(n,e,t,s,i){const o=s&&!s.isEmpty(),u=i!==void 0;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let f="";return(o||u)&&(f+=" (found",o&&(f+=` in field ${s}`),u&&(f+=` in document ${i}`),f+=")"),new pe(ie.INVALID_ARGUMENT,h+n+f)}function rR(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(e,t,s,i,o){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new jt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new j6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(fg("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class j6 extends Ph{data(){return super.data()}}function fg(n,e){return typeof e=="string"?k_(n,e):e instanceof ao?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iR(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new pe(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class j_{}class of extends j_{}function Ua(n,e,...t){let s=[];e instanceof j_&&s.push(e),s=s.concat(t),function(o){const u=o.filter(f=>f instanceof P_).length,h=o.filter(f=>f instanceof mg).length;if(u>1||u>0&&h>0)throw new pe(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const i of s)n=i._apply(n);return n}class mg extends of{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new mg(e,t,s)}_apply(e){const t=this._parse(e);return oR(e._query,t),new hs(e.firestore,e.converter,Sx(e._query,t))}_parse(e){const t=Rl(e.firestore);return function(o,u,h,f,p,x,v){let b;if(p.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new pe(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){SS(v,x);const N=[];for(const E of v)N.push(IS(f,o,E));b={arrayValue:{values:N}}}else b=IS(f,o,v)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||SS(v,x),b=tR(h,u,v,x==="in"||x==="not-in");return st.create(p,x,b)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function P6(n,e,t){const s=e,i=fg("where",n);return mg._create(i,s,t)}class P_ extends j_{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new P_(e,t)}_parse(e){const t=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return t.length===1?t[0]:Tt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let u=i;const h=o.getFlattenedFilters();for(const f of h)oR(u,f),u=Sx(u,f)}(e._query,t),new hs(e.firestore,e.converter,Sx(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class O_ extends of{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new O_(e,t)}_apply(e){const t=function(i,o,u){if(i.startAt!==null)throw new pe(ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new pe(ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Rh(o,u)}(e._query,this._field,this._direction);return new hs(e.firestore,e.converter,function(i,o){const u=i.explicitOrderBy.concat([o]);return new ta(i.path,i.collectionGroup,u,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function O6(n,e="asc"){const t=e,s=fg("orderBy",n);return O_._create(s,t)}class pg extends of{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new pg(e,t,s)}_apply(e){return new hs(e.firestore,e.converter,bp(e._query,this._limit,this._limitType))}}function M6(n){return UA("limit",n),pg._create("limit",n,"F")}function V6(n){return UA("limitToLast",n),pg._create("limitToLast",n,"L")}class gg extends of{constructor(e,t,s){super(),this.type=e,this._docOrFields=t,this._inclusive=s}static _create(e,t,s){return new gg(e,t,s)}_apply(e){const t=aR(e,this.type,this._docOrFields,this._inclusive);return new hs(e.firestore,e.converter,function(i,o){return new ta(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)}(e._query,t))}}function L6(...n){return gg._create("startAt",n,!0)}function U6(...n){return gg._create("startAfter",n,!1)}class yg extends of{constructor(e,t,s){super(),this.type=e,this._docOrFields=t,this._inclusive=s}static _create(e,t,s){return new yg(e,t,s)}_apply(e){const t=aR(e,this.type,this._docOrFields,this._inclusive);return new hs(e.firestore,e.converter,function(i,o){return new ta(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,o)}(e._query,t))}}function F6(...n){return yg._create("endBefore",n,!1)}function B6(...n){return yg._create("endAt",n,!0)}function aR(n,e,t,s){if(t[0]=Oe(t[0]),t[0]instanceof Ph)return function(o,u,h,f,p){if(!f)throw new pe(ie.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${h}().`);const x=[];for(const v of Lc(o))if(v.field.isKeyField())x.push(ml(u,f.key));else{const b=f.data.field(v.field);if(Zp(b))throw new pe(ie.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+v.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(b===null){const I=v.field.canonicalString();throw new pe(ie.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${I}' (used as the orderBy) does not exist.`)}x.push(b)}return new so(x,p)}(n._query,n.firestore._databaseId,e,t[0]._document,s);{const i=Rl(n.firestore);return function(u,h,f,p,x,v){const b=u.explicitOrderBy;if(x.length>b.length)throw new pe(ie.INVALID_ARGUMENT,`Too many arguments provided to ${p}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const I=[];for(let N=0;N<x.length;N++){const E=x[N];if(b[N].field.isKeyField()){if(typeof E!="string")throw new pe(ie.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${p}(), but got a ${typeof E}`);if(!qv(u)&&E.indexOf("/")!==-1)throw new pe(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${p}() must be a plain document ID, but '${E}' contains a slash.`);const A=u.path.child(nt.fromString(E));if(!Te.isDocumentKey(A))throw new pe(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${p}() must result in a valid document path, but '${A}' is not because it contains an odd number of segments.`);const C=new Te(A);I.push(ml(h,C))}else{const A=tR(f,p,E);I.push(A)}}return new so(I,v)}(n._query,n.firestore._databaseId,i,e,t,s)}}function IS(n,e,t){if(typeof(t=Oe(t))=="string"){if(t==="")throw new pe(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!qv(e)&&t.indexOf("/")!==-1)throw new pe(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(nt.fromString(t));if(!Te.isDocumentKey(s))throw new pe(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return ml(n,new Te(s))}if(t instanceof jt)return ml(n,t._key);throw new pe(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Qp(t)}.`)}function SS(n,e){if(!Array.isArray(n)||n.length===0)throw new pe(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function oR(n,e){const t=function(i,o){for(const u of i)for(const h of u.getFlattenedFilters())if(o.indexOf(h.op)>=0)return h.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new pe(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new pe(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class M_{convertValue(e,t="none"){switch(to(e)){case 0:return null;case 1:return e.booleanValue;case 2:return zt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ki(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ae(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return fo(e,(i,o)=>{s[i]=this.convertValue(o,t)}),s}convertVectorValue(e){const t=e.fields?.[Zc].arrayValue?.values?.map(s=>zt(s.doubleValue));return new li(t)}convertGeoPoint(e){return new Ir(zt(e.latitude),zt(e.longitude))}convertArray(e,t){return(e.values||[]).map(s=>this.convertValue(s,t))}convertServerTimestamp(e,t){switch(t){case"previous":const s=eg(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Sh(e));default:return null}}convertTimestamp(e){const t=$i(e);return new _t(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=nt.fromString(e);ke(Y1(s),9688,{name:e});const i=new eo(s.get(1),s.get(3)),o=new Te(s.popFirst(5));return i.isEqual(t)||un(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xg(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class z6 extends M_{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new jt(this.firestore,null,t)}}class il{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let sr=class lR extends Ph{constructor(e,t,s,i,o,u){super(e,t,s,i,u),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new dh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(fg("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new pe(ie.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=lR._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};sr._jsonSchemaVersion="firestore/documentSnapshot/1.0",sr._jsonSchema={type:vn("string",sr._jsonSchemaVersion),bundleSource:vn("string","DocumentSnapshot"),bundleName:vn("string"),bundle:vn("string")};let dh=class extends sr{data(e={}){return super.data(e)}},Sr=class cR{constructor(e,t,s,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new il(i.hasPendingWrites,i.fromCache),this.query=s}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(s=>{e.call(t,new dh(this._firestore,this._userDataWriter,s.key,s,new il(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new pe(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let u=0;return i._snapshot.docChanges.map(h=>{const f=new dh(i._firestore,i._userDataWriter,h.doc.key,h.doc,new il(i._snapshot.mutatedKeys.has(h.doc.key),i._snapshot.fromCache),i.query.converter);return h.doc,{type:"added",doc:f,oldIndex:-1,newIndex:u++}})}{let u=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(h=>o||h.type!==3).map(h=>{const f=new dh(i._firestore,i._userDataWriter,h.doc.key,h.doc,new il(i._snapshot.mutatedKeys.has(h.doc.key),i._snapshot.fromCache),i.query.converter);let p=-1,x=-1;return h.type!==0&&(p=u.indexOf(h.doc.key),u=u.delete(h.doc.key)),h.type!==1&&(u=u.add(h.doc),x=u.indexOf(h.doc.key)),{type:q6(h.type),doc:f,oldIndex:p,newIndex:x}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new pe(ie.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=cR._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=kv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),s.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function q6(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ae(61501,{type:n})}}function uR(n,e){return n instanceof sr&&e instanceof sr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Sr&&e instanceof Sr&&n._firestore===e._firestore&&W2(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H6(n){n=pt(n,jt);const e=pt(n.firestore,hn);return B2(ss(e),n._key).then(t=>V_(e,n,t))}Sr._jsonSchemaVersion="firestore/querySnapshot/1.0",Sr._jsonSchema={type:vn("string",Sr._jsonSchemaVersion),bundleSource:vn("string","QuerySnapshot"),bundleName:vn("string"),bundle:vn("string")};class Dl extends M_{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new jt(this.firestore,null,t)}}function G6(n){n=pt(n,jt);const e=pt(n.firestore,hn),t=ss(e),s=new Dl(e);return h6(t,n._key).then(i=>new sr(e,s,n._key,i,new il(i!==null&&i.hasLocalMutations,!0),n.converter))}function $6(n){n=pt(n,jt);const e=pt(n.firestore,hn);return B2(ss(e),n._key,{source:"server"}).then(t=>V_(e,n,t))}function K6(n){n=pt(n,hs);const e=pt(n.firestore,hn),t=ss(e),s=new Dl(e);return iR(n._query),z2(t,n._query).then(i=>new Sr(e,s,n,i))}function Q6(n){n=pt(n,hs);const e=pt(n.firestore,hn),t=ss(e),s=new Dl(e);return f6(t,n._query).then(i=>new Sr(e,s,n,i))}function W6(n){n=pt(n,hs);const e=pt(n.firestore,hn),t=ss(e),s=new Dl(e);return z2(t,n._query,{source:"server"}).then(i=>new Sr(e,s,n,i))}function NS(n,e,t){n=pt(n,jt);const s=pt(n.firestore,hn),i=xg(n.converter,e,t);return lf(s,[hg(Rl(s),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Ht.none())])}function AS(n,e,t,...s){n=pt(n,jt);const i=pt(n.firestore,hn),o=Rl(i);let u;return u=typeof(e=Oe(e))=="string"||e instanceof ao?C_(o,"updateDoc",n._key,e,t,s):R_(o,"updateDoc",n._key,e),lf(i,[u.toMutation(n._key,Ht.exists(!0))])}function Y6(n){return lf(pt(n.firestore,hn),[new bu(n._key,Ht.none())])}function X6(n,e){const t=pt(n.firestore,hn),s=Cp(n),i=xg(n.converter,e);return lf(t,[hg(Rl(n.firestore),"addDoc",s._key,i,n.converter!==null,{}).toMutation(s._key,Ht.exists(!1))]).then(()=>s)}function dR(n,...e){n=Oe(n);let t={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||Ux(e[s])||(t=e[s++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Ux(e[s])){const f=e[s];e[s]=f.next?.bind(f),e[s+1]=f.error?.bind(f),e[s+2]=f.complete?.bind(f)}let o,u,h;if(n instanceof jt)u=pt(n.firestore,hn),h=vu(n._key.path),o={next:f=>{e[s]&&e[s](V_(u,n,f))},error:e[s+1],complete:e[s+2]};else{const f=pt(n,hs);u=pt(f.firestore,hn),h=f._query;const p=new Dl(u);o={next:x=>{e[s]&&e[s](new Sr(u,p,f,x))},error:e[s+1],complete:e[s+2]},iR(n._query)}return function(p,x,v,b){const I=new cg(b),N=new g_(x,I,v);return p.asyncQueue.enqueueAndForget(async()=>f_(await uu(p),N)),()=>{I.Nu(),p.asyncQueue.enqueueAndForget(async()=>m_(await uu(p),N))}}(ss(u),h,i,o)}function J6(n,e){return m6(ss(n=pt(n,hn)),Ux(e)?e:{next:e})}function lf(n,e){return function(s,i){const o=new Hn;return s.asyncQueue.enqueueAndForget(async()=>B3(await E_(s),i,o)),o.promise}(ss(n),e)}function V_(n,e,t){const s=t.docs.get(e._key),i=new Dl(n);return new sr(n,i,e._key,s,new il(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z6={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eU=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Rl(e)}set(e,t,s){this._verifyNotCommitted();const i=qa(e,this._firestore),o=xg(i.converter,t,s),u=hg(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,s);return this._mutations.push(u.toMutation(i._key,Ht.none())),this}update(e,t,s,...i){this._verifyNotCommitted();const o=qa(e,this._firestore);let u;return u=typeof(t=Oe(t))=="string"||t instanceof ao?C_(this._dataReader,"WriteBatch.update",o._key,t,s,i):R_(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(u.toMutation(o._key,Ht.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=qa(e,this._firestore);return this._mutations=this._mutations.concat(new bu(t._key,Ht.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new pe(ie.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function qa(n,e){if((n=Oe(n)).firestore!==e)throw new pe(ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Rl(e)}get(e){const t=qa(e,this._firestore),s=new z6(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||i.length!==1)return Ae(24041);const o=i[0];if(o.isFoundDocument())return new Ph(this._firestore,s,o.key,o,t.converter);if(o.isNoDocument())return new Ph(this._firestore,s,t._key,null,t.converter);throw Ae(18433,{doc:o})})}set(e,t,s){const i=qa(e,this._firestore),o=xg(i.converter,t,s),u=hg(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,s);return this._transaction.set(i._key,u),this}update(e,t,s,...i){const o=qa(e,this._firestore);let u;return u=typeof(t=Oe(t))=="string"||t instanceof ao?C_(this._dataReader,"Transaction.update",o._key,t,s,i):R_(this._dataReader,"Transaction.update",o._key,t),this._transaction.update(o._key,u),this}delete(e){const t=qa(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nU=class extends tU{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=qa(e,this._firestore),s=new Dl(this._firestore);return super.get(e).then(i=>new sr(this._firestore,s,t._key,i._document,new il(!1,!1),t.converter))}};function sU(n,e,t){n=pt(n,hn);const s={...Z6,...t};return function(o){if(o.maxAttempts<1)throw new pe(ie.INVALID_ARGUMENT,"Max attempts must be at least 1")}(s),function(o,u,h){const f=new Hn;return o.asyncQueue.enqueueAndForget(async()=>{const p=await c6(o);new o6(o.asyncQueue,p,h,u,f).ju()}),f.promise}(ss(n),i=>e(new nU(n,i)),s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rU(){return new af("deleteField")}function iU(){return new I_("serverTimestamp")}function aU(...n){return new S_("arrayUnion",n)}function oU(...n){return new N_("arrayRemove",n)}function lU(n){return new A_("increment",n)}(function(e,t=!0){(function(i){xu=i})(Ji),Hi(new ir("firestore",(s,{instanceIdentifier:i,options:o})=>{const u=s.getProvider("app").getImmediate(),h=new hn(new t5(s.getProvider("auth-internal")),new r5(u,s.getProvider("app-check-internal")),function(p,x){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new pe(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new eo(p.options.projectId,x)}(u,i),u);return o={useFetchStreams:t,...o},h._setSettings(o),h},"PUBLIC").setMultipleInstances(!0)),Fs(rI,iI,e),Fs(rI,iI,"esm2020")})();const cU="@firebase/firestore-compat",uU="0.4.0";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new pe("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RS(){if(typeof Uint8Array>"u")throw new pe("unimplemented","Uint8Arrays are not available in this environment.")}function CS(){if(!U5())throw new pe("unimplemented","Blobs are unavailable in Firestore in this environment.")}let hR=class Bx{constructor(e){this._delegate=e}static fromBase64String(e){return CS(),new Bx(Jn.fromBase64String(e))}static fromUint8Array(e){return RS(),new Bx(Jn.fromUint8Array(e))}toBase64(){return CS(),this._delegate.toBase64()}toUint8Array(){return RS(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zx(n){return dU(n,["next","error","complete"])}function dU(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const s of e)if(s in t&&typeof t[s]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hU{enableIndexedDbPersistence(e,t){return b6(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return w6(e._delegate)}clearIndexedDbPersistence(e){return T6(e._delegate)}}class fR{constructor(e,t,s){this._delegate=t,this._persistenceProvider=s,this.INTERNAL={delete:()=>this.terminate()},e instanceof eo||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&di("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,s={}){y6(this._delegate,e,t,s)}enableNetwork(){return I6(this._delegate)}disableNetwork(){return S6(this._delegate)}enablePersistence(e){let t=!1,s=!1;return e&&(t=!!e.synchronizeTabs,s=!!e.experimentalForceOwningTab,VA("synchronizeTabs",t,"experimentalForceOwningTab",s)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,s)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return E6(this._delegate)}onSnapshotsInSync(e){return J6(this._delegate,e)}get app(){if(!this._appCompat)throw new pe("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new du(this,K2(this._delegate,e))}catch(t){throw cs(t,"collection()","Firestore.collection()")}}doc(e){try{return new tr(this,Cp(this._delegate,e))}catch(t){throw cs(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new ls(this,x6(this._delegate,e))}catch(t){throw cs(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return sU(this._delegate,t=>e(new mR(this,t)))}batch(){return ss(this._delegate),new pR(new eU(this._delegate,e=>lf(this._delegate,e)))}loadBundle(e){return N6(this._delegate,e)}namedQuery(e){return A6(this._delegate,e).then(t=>t?new ls(this,t):null)}}class vg extends M_{constructor(e){super(),this.firestore=e}convertBytes(e){return new hR(new Jn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return tr.forKey(t,this.firestore,null)}}function fU(n){XV(n)}class mR{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new vg(e)}get(e){const t=al(e);return this._delegate.get(t).then(s=>new Oh(this._firestore,new sr(this._firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,t.converter)))}set(e,t,s){const i=al(e);return s?(L_("Transaction.set",s),this._delegate.set(i,t,s)):this._delegate.set(i,t),this}update(e,t,s,...i){const o=al(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,s,...i),this}delete(e){const t=al(e);return this._delegate.delete(t),this}}class pR{constructor(e){this._delegate=e}set(e,t,s){const i=al(e);return s?(L_("WriteBatch.set",s),this._delegate.set(i,t,s)):this._delegate.set(i,t),this}update(e,t,s,...i){const o=al(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,s,...i),this}delete(e){const t=al(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class wl{constructor(e,t,s){this._firestore=e,this._userDataWriter=t,this._delegate=s}fromFirestore(e,t){const s=new dh(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Mh(this._firestore,s),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const s=wl.INSTANCES;let i=s.get(e);i||(i=new WeakMap,s.set(e,i));let o=i.get(t);return o||(o=new wl(e,new vg(e),t),i.set(t,o)),o}}wl.INSTANCES=new WeakMap;class tr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new vg(e)}static forPath(e,t,s){if(e.length%2!==0)throw new pe("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new tr(t,new jt(t._delegate,s,new Te(e)))}static forKey(e,t,s){return new tr(t,new jt(t._delegate,s,e))}get id(){return this._delegate.id}get parent(){return new du(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new du(this.firestore,K2(this._delegate,e))}catch(t){throw cs(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Oe(e),e instanceof jt?Q2(this._delegate,e):!1}set(e,t){t=L_("DocumentReference.set",t);try{return t?NS(this._delegate,e,t):NS(this._delegate,e)}catch(s){throw cs(s,"setDoc()","DocumentReference.set()")}}update(e,t,...s){try{return arguments.length===1?AS(this._delegate,e):AS(this._delegate,e,t,...s)}catch(i){throw cs(i,"updateDoc()","DocumentReference.update()")}}delete(){return Y6(this._delegate)}onSnapshot(...e){const t=gR(e),s=yR(e,i=>new Oh(this.firestore,new sr(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return dR(this._delegate,t,s)}get(e){let t;return e?.source==="cache"?t=G6(this._delegate):e?.source==="server"?t=$6(this._delegate):t=H6(this._delegate),t.then(s=>new Oh(this.firestore,new sr(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)))}withConverter(e){return new tr(this.firestore,e?this._delegate.withConverter(wl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function cs(n,e,t){return n.message=n.message.replace(e,t),n}function gR(n){for(const e of n)if(typeof e=="object"&&!zx(e))return e;return{}}function yR(n,e){let t;return zx(n[0])?t=n[0]:zx(n[1])?t=n[1]:typeof n[0]=="function"?t={next:n[0],error:n[1],complete:n[2]}:t={next:n[1],error:n[2],complete:n[3]},{next:s=>{t.next&&t.next(e(s))},error:t.error?.bind(t),complete:t.complete?.bind(t)}}class Oh{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new tr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return uR(this._delegate,e._delegate)}}class Mh extends Oh{data(e){const t=this._delegate.data(e);return this._delegate._converter||JV(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class ls{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new vg(e)}where(e,t,s){try{return new ls(this.firestore,Ua(this._delegate,P6(e,t,s)))}catch(i){throw cs(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new ls(this.firestore,Ua(this._delegate,O6(e,t)))}catch(s){throw cs(s,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new ls(this.firestore,Ua(this._delegate,M6(e)))}catch(t){throw cs(t,"limit()","Query.limit()")}}limitToLast(e){try{return new ls(this.firestore,Ua(this._delegate,V6(e)))}catch(t){throw cs(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new ls(this.firestore,Ua(this._delegate,L6(...e)))}catch(t){throw cs(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new ls(this.firestore,Ua(this._delegate,U6(...e)))}catch(t){throw cs(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new ls(this.firestore,Ua(this._delegate,F6(...e)))}catch(t){throw cs(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new ls(this.firestore,Ua(this._delegate,B6(...e)))}catch(t){throw cs(t,"endAt()","Query.endAt()")}}isEqual(e){return W2(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=Q6(this._delegate):e?.source==="server"?t=W6(this._delegate):t=K6(this._delegate),t.then(s=>new qx(this.firestore,new Sr(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)))}onSnapshot(...e){const t=gR(e),s=yR(e,i=>new qx(this.firestore,new Sr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return dR(this._delegate,t,s)}withConverter(e){return new ls(this.firestore,e?this._delegate.withConverter(wl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class mU{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Mh(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class qx{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new ls(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Mh(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new mU(this._firestore,t))}forEach(e,t){this._delegate.forEach(s=>{e.call(t,new Mh(this._firestore,s))})}isEqual(e){return uR(this._delegate,e._delegate)}}class du extends ls{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new tr(this.firestore,e):null}doc(e){try{return e===void 0?new tr(this.firestore,Cp(this._delegate)):new tr(this.firestore,Cp(this._delegate,e))}catch(t){throw cs(t,"doc()","CollectionReference.doc()")}}add(e){return X6(this._delegate,e).then(t=>new tr(this.firestore,t))}isEqual(e){return Q2(this._delegate,e._delegate)}withConverter(e){return new du(this.firestore,e?this._delegate.withConverter(wl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function al(n){return pt(n,jt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_{constructor(...e){this._delegate=new ao(...e)}static documentId(){return new U_(qt.keyField().canonicalString())}isEqual(e){return e=Oe(e),e instanceof ao?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{static serverTimestamp(){const e=iU();return e._methodName="FieldValue.serverTimestamp",new nl(e)}static delete(){const e=rU();return e._methodName="FieldValue.delete",new nl(e)}static arrayUnion(...e){const t=aU(...e);return t._methodName="FieldValue.arrayUnion",new nl(t)}static arrayRemove(...e){const t=oU(...e);return t._methodName="FieldValue.arrayRemove",new nl(t)}static increment(e){const t=lU(e);return t._methodName="FieldValue.increment",new nl(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pU={Firestore:fR,GeoPoint:Ir,Timestamp:_t,Blob:hR,Transaction:mR,WriteBatch:pR,DocumentReference:tr,DocumentSnapshot:Oh,Query:ls,QueryDocumentSnapshot:Mh,QuerySnapshot:qx,CollectionReference:du,FieldPath:U_,FieldValue:nl,setLogLevel:fU,CACHE_SIZE_UNLIMITED:_6};function gU(n,e){n.INTERNAL.registerComponent(new ir("firestore-compat",t=>{const s=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(s,i)},"PUBLIC").setServiceProps({...pU}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yU(n){gU(n,(e,t)=>new fR(e,t,new hU)),n.registerVersion(cU,uU)}yU(Zn);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xR="firebasestorage.googleapis.com",vR="storageBucket",xU=120*1e3,vU=600*1e3,_U=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt extends ts{constructor(e,t,s=0){super(W0(e),`Firebase Storage: ${t} (${W0(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Wt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return W0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ut;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ut||(Ut={}));function W0(n){return"storage/"+n}function F_(){const n="An unknown error occurred, please check the error payload for server response.";return new Wt(Ut.UNKNOWN,n)}function bU(n){return new Wt(Ut.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function wU(n){return new Wt(Ut.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function TU(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Wt(Ut.UNAUTHENTICATED,n)}function EU(){return new Wt(Ut.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function IU(n){return new Wt(Ut.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function _R(){return new Wt(Ut.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function bR(){return new Wt(Ut.CANCELED,"User canceled the upload/download.")}function SU(n){return new Wt(Ut.INVALID_URL,"Invalid URL '"+n+"'.")}function NU(n){return new Wt(Ut.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function AU(){return new Wt(Ut.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+vR+"' property when initializing the app?")}function wR(){return new Wt(Ut.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function RU(){return new Wt(Ut.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function CU(){return new Wt(Ut.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function DU(n){return new Wt(Ut.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Fc(n){return new Wt(Ut.INVALID_ARGUMENT,n)}function TR(){return new Wt(Ut.APP_DELETED,"The Firebase app was deleted.")}function ER(n){return new Wt(Ut.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function hh(n,e){return new Wt(Ut.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Fd(n){throw new Wt(Ut.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=es.makeFromUrl(e,t)}catch{return new es(e,"")}if(s.path==="")return s;throw NU(e)}static makeFromUrl(e,t){let s=null;const i="([A-Za-z0-9.\\-_]+)";function o(V){V.path.charAt(V.path.length-1)==="/"&&(V.path_=V.path_.slice(0,-1))}const u="(/(.*))?$",h=new RegExp("^gs://"+i+u,"i"),f={bucket:1,path:3};function p(V){V.path_=decodeURIComponent(V.path)}const x="v[A-Za-z0-9_]+",v=t.replace(/[.]/g,"\\."),b="(/([^?#]*).*)?$",I=new RegExp(`^https?://${v}/${x}/b/${i}/o${b}`,"i"),N={bucket:1,path:3},E=t===xR?"(?:storage.googleapis.com|storage.cloud.google.com)":t,A="([^?#]*)",C=new RegExp(`^https?://${E}/${i}/${A}`,"i"),P=[{regex:h,indices:f,postModify:o},{regex:I,indices:N,postModify:p},{regex:C,indices:{bucket:1,path:2},postModify:p}];for(let V=0;V<P.length;V++){const F=P[V],K=F.regex.exec(e);if(K){const L=K[F.indices.bucket];let k=K[F.indices.path];k||(k=""),s=new es(L,k),F.postModify(s);break}}if(s==null)throw SU(e);return s}}class kU{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jU(n,e,t){let s=1,i=null,o=null,u=!1,h=0;function f(){return h===2}let p=!1;function x(...A){p||(p=!0,e.apply(null,A))}function v(A){i=setTimeout(()=>{i=null,n(I,f())},A)}function b(){o&&clearTimeout(o)}function I(A,...C){if(p){b();return}if(A){b(),x.call(null,A,...C);return}if(f()||u){b(),x.call(null,A,...C);return}s<64&&(s*=2);let P;h===1?(h=2,P=0):P=(s+Math.random())*1e3,v(P)}let N=!1;function E(A){N||(N=!0,b(),!p&&(i!==null?(A||(h=2),clearTimeout(i),v(0)):A||(h=1)))}return v(0),o=setTimeout(()=>{u=!0,E(!0)},t),E}function PU(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OU(n){return n!==void 0}function MU(n){return typeof n=="function"}function VU(n){return typeof n=="object"&&!Array.isArray(n)}function _g(n){return typeof n=="string"||n instanceof String}function DS(n){return B_()&&n instanceof Blob}function B_(){return typeof Blob<"u"}function Hx(n,e,t,s){if(s<e)throw Fc(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw Fc(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function go(n,e,t){let s=e;return t==null&&(s=`https://${e}`),`${t}://${s}/v0${n}`}function IR(n){const e=encodeURIComponent;let t="?";for(const s in n)if(n.hasOwnProperty(s)){const i=e(s)+"="+e(n[s]);t=t+i+"&"}return t=t.slice(0,-1),t}var ul;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(ul||(ul={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SR(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,o=e.indexOf(n)!==-1;return t||i||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LU{constructor(e,t,s,i,o,u,h,f,p,x,v,b=!0,I=!1){this.url_=e,this.method_=t,this.headers_=s,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=u,this.callback_=h,this.errorCallback_=f,this.timeout_=p,this.progressCallback_=x,this.connectionFactory_=v,this.retry=b,this.isUsingEmulator=I,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((N,E)=>{this.resolve_=N,this.reject_=E,this.start_()})}start_(){const e=(s,i)=>{if(i){s(!1,new Vm(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const u=h=>{const f=h.loaded,p=h.lengthComputable?h.total:-1;this.progressCallback_!==null&&this.progressCallback_(f,p)};this.progressCallback_!==null&&o.addUploadProgressListener(u),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(u),this.pendingConnection_=null;const h=o.getErrorCode()===ul.NO_ERROR,f=o.getStatus();if(!h||SR(f,this.additionalRetryCodes_)&&this.retry){const x=o.getErrorCode()===ul.ABORT;s(!1,new Vm(!1,null,x));return}const p=this.successCodes_.indexOf(f)!==-1;s(!0,new Vm(p,o))})},t=(s,i)=>{const o=this.resolve_,u=this.reject_,h=i.connection;if(i.wasSuccessCode)try{const f=this.callback_(h,h.getResponse());OU(f)?o(f):o()}catch(f){u(f)}else if(h!==null){const f=F_();f.serverResponse=h.getErrorText(),this.errorCallback_?u(this.errorCallback_(h,f)):u(f)}else if(i.canceled){const f=this.appDelete_?TR():bR();u(f)}else{const f=_R();u(f)}};this.canceled_?t(!1,new Vm(!1,null,!0)):this.backoffId_=jU(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&PU(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Vm{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function UU(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function FU(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function BU(n,e){e&&(n["X-Firebase-GMPID"]=e)}function zU(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function qU(n,e,t,s,i,o,u=!0,h=!1){const f=IR(n.urlParams),p=n.url+f,x=Object.assign({},n.headers);return BU(x,e),UU(x,t),FU(x,o),zU(x,s),new LU(p,n.method,x,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,u,h)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HU(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function GU(...n){const e=HU();if(e!==void 0){const t=new e;for(let s=0;s<n.length;s++)t.append(n[s]);return t.getBlob()}else{if(B_())return new Blob(n);throw new Wt(Ut.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function $U(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KU(n){if(typeof atob>"u")throw DU("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Y0{constructor(e,t){this.data=e,this.contentType=t||null}}function NR(n,e){switch(n){case nr.RAW:return new Y0(AR(e));case nr.BASE64:case nr.BASE64URL:return new Y0(RR(n,e));case nr.DATA_URL:return new Y0(WU(e),YU(e))}throw F_()}function AR(n){const e=[];for(let t=0;t<n.length;t++){let s=n.charCodeAt(t);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const o=s,u=n.charCodeAt(++t);s=65536|(o&1023)<<10|u&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function QU(n){let e;try{e=decodeURIComponent(n)}catch{throw hh(nr.DATA_URL,"Malformed data URL.")}return AR(e)}function RR(n,e){switch(n){case nr.BASE64:{const i=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(i||o)throw hh(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case nr.BASE64URL:{const i=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(i||o)throw hh(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=KU(e)}catch(i){throw i.message.includes("polyfill")?i:hh(n,"Invalid character found")}const s=new Uint8Array(t.length);for(let i=0;i<t.length;i++)s[i]=t.charCodeAt(i);return s}class CR{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw hh(nr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=t[1]||null;s!=null&&(this.base64=XU(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function WU(n){const e=new CR(n);return e.base64?RR(nr.BASE64,e.rest):QU(e.rest)}function YU(n){return new CR(n).contentType}function XU(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e,t){let s=0,i="";DS(e)?(this.data_=e,s=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(DS(this.data_)){const s=this.data_,i=$U(s,e,t);return i===null?null:new Mi(i)}else{const s=new Uint8Array(this.data_.buffer,e,t-e);return new Mi(s,!0)}}static getBlob(...e){if(B_()){const t=e.map(s=>s instanceof Mi?s.data_:s);return new Mi(GU.apply(null,t))}else{const t=e.map(u=>_g(u)?NR(nr.RAW,u).data:u.data_);let s=0;t.forEach(u=>{s+=u.byteLength});const i=new Uint8Array(s);let o=0;return t.forEach(u=>{for(let h=0;h<u.length;h++)i[o++]=u[h]}),new Mi(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z_(n){let e;try{e=JSON.parse(n)}catch{return null}return VU(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JU(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function ZU(n,e){const t=e.split("/").filter(s=>s.length>0).join("/");return n.length===0?t:n+"/"+t}function DR(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eF(n,e){return e}class os{constructor(e,t,s,i){this.server=e,this.local=t||e,this.writable=!!s,this.xform=i||eF}}let Lm=null;function tF(n){return!_g(n)||n.length<2?n:DR(n)}function bg(){if(Lm)return Lm;const n=[];n.push(new os("bucket")),n.push(new os("generation")),n.push(new os("metageneration")),n.push(new os("name","fullPath",!0));function e(o,u){return tF(u)}const t=new os("name");t.xform=e,n.push(t);function s(o,u){return u!==void 0?Number(u):u}const i=new os("size");return i.xform=s,n.push(i),n.push(new os("timeCreated")),n.push(new os("updated")),n.push(new os("md5Hash",null,!0)),n.push(new os("cacheControl",null,!0)),n.push(new os("contentDisposition",null,!0)),n.push(new os("contentEncoding",null,!0)),n.push(new os("contentLanguage",null,!0)),n.push(new os("contentType",null,!0)),n.push(new os("metadata","customMetadata",!0)),Lm=n,Lm}function nF(n,e){function t(){const s=n.bucket,i=n.fullPath,o=new es(s,i);return e._makeStorageReference(o)}Object.defineProperty(n,"ref",{get:t})}function sF(n,e,t){const s={};s.type="file";const i=t.length;for(let o=0;o<i;o++){const u=t[o];s[u.local]=u.xform(s,e[u.server])}return nF(s,n),s}function kR(n,e,t){const s=z_(e);return s===null?null:sF(n,s,t)}function rF(n,e,t,s){const i=z_(e);if(i===null||!_g(i.downloadTokens))return null;const o=i.downloadTokens;if(o.length===0)return null;const u=encodeURIComponent;return o.split(",").map(p=>{const x=n.bucket,v=n.fullPath,b="/b/"+u(x)+"/o/"+u(v),I=go(b,t,s),N=IR({alt:"media",token:p});return I+N})[0]}function q_(n,e){const t={},s=e.length;for(let i=0;i<s;i++){const o=e[i];o.writable&&(t[o.server]=n[o.local])}return JSON.stringify(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kS="prefixes",jS="items";function iF(n,e,t){const s={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[kS])for(const i of t[kS]){const o=i.replace(/\/$/,""),u=n._makeStorageReference(new es(e,o));s.prefixes.push(u)}if(t[jS])for(const i of t[jS]){const o=n._makeStorageReference(new es(e,i.name));s.items.push(o)}return s}function aF(n,e,t){const s=z_(t);return s===null?null:iF(n,e,s)}class ia{constructor(e,t,s,i){this.url=e,this.method=t,this.handler=s,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ci(n){if(!n)throw F_()}function wg(n,e){function t(s,i){const o=kR(n,i,e);return ci(o!==null),o}return t}function oF(n,e){function t(s,i){const o=aF(n,e,i);return ci(o!==null),o}return t}function lF(n,e){function t(s,i){const o=kR(n,i,e);return ci(o!==null),rF(o,i,n.host,n._protocol)}return t}function Su(n){function e(t,s){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=EU():i=TU():t.getStatus()===402?i=wU(n.bucket):t.getStatus()===403?i=IU(n.path):i=s,i.status=t.getStatus(),i.serverResponse=s.serverResponse,i}return e}function Tg(n){const e=Su(n);function t(s,i){let o=e(s,i);return s.getStatus()===404&&(o=bU(n.path)),o.serverResponse=i.serverResponse,o}return t}function jR(n,e,t){const s=e.fullServerUrl(),i=go(s,n.host,n._protocol),o="GET",u=n.maxOperationRetryTime,h=new ia(i,o,wg(n,t),u);return h.errorHandler=Tg(e),h}function cF(n,e,t,s,i){const o={};e.isRoot?o.prefix="":o.prefix=e.path+"/",t.length>0&&(o.delimiter=t),s&&(o.pageToken=s),i&&(o.maxResults=i);const u=e.bucketOnlyServerUrl(),h=go(u,n.host,n._protocol),f="GET",p=n.maxOperationRetryTime,x=new ia(h,f,oF(n,e.bucket),p);return x.urlParams=o,x.errorHandler=Su(e),x}function uF(n,e,t){const s=e.fullServerUrl(),i=go(s,n.host,n._protocol),o="GET",u=n.maxOperationRetryTime,h=new ia(i,o,lF(n,t),u);return h.errorHandler=Tg(e),h}function dF(n,e,t,s){const i=e.fullServerUrl(),o=go(i,n.host,n._protocol),u="PATCH",h=q_(t,s),f={"Content-Type":"application/json; charset=utf-8"},p=n.maxOperationRetryTime,x=new ia(o,u,wg(n,s),p);return x.headers=f,x.body=h,x.errorHandler=Tg(e),x}function hF(n,e){const t=e.fullServerUrl(),s=go(t,n.host,n._protocol),i="DELETE",o=n.maxOperationRetryTime;function u(f,p){}const h=new ia(s,i,u,o);return h.successCodes=[200,204],h.errorHandler=Tg(e),h}function fF(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function PR(n,e,t){const s=Object.assign({},t);return s.fullPath=n.path,s.size=e.size(),s.contentType||(s.contentType=fF(null,e)),s}function mF(n,e,t,s,i){const o=e.bucketOnlyServerUrl(),u={"X-Goog-Upload-Protocol":"multipart"};function h(){let P="";for(let V=0;V<2;V++)P=P+Math.random().toString().slice(2);return P}const f=h();u["Content-Type"]="multipart/related; boundary="+f;const p=PR(e,s,i),x=q_(p,t),v="--"+f+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+x+`\r
--`+f+`\r
Content-Type: `+p.contentType+`\r
\r
`,b=`\r
--`+f+"--",I=Mi.getBlob(v,s,b);if(I===null)throw wR();const N={name:p.fullPath},E=go(o,n.host,n._protocol),A="POST",C=n.maxUploadRetryTime,q=new ia(E,A,wg(n,t),C);return q.urlParams=N,q.headers=u,q.body=I.uploadData(),q.errorHandler=Su(e),q}class kp{constructor(e,t,s,i){this.current=e,this.total=t,this.finalized=!!s,this.metadata=i||null}}function H_(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{ci(!1)}return ci(!!t&&(e||["active"]).indexOf(t)!==-1),t}function pF(n,e,t,s,i){const o=e.bucketOnlyServerUrl(),u=PR(e,s,i),h={name:u.fullPath},f=go(o,n.host,n._protocol),p="POST",x={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${s.size()}`,"X-Goog-Upload-Header-Content-Type":u.contentType,"Content-Type":"application/json; charset=utf-8"},v=q_(u,t),b=n.maxUploadRetryTime;function I(E){H_(E);let A;try{A=E.getResponseHeader("X-Goog-Upload-URL")}catch{ci(!1)}return ci(_g(A)),A}const N=new ia(f,p,I,b);return N.urlParams=h,N.headers=x,N.body=v,N.errorHandler=Su(e),N}function gF(n,e,t,s){const i={"X-Goog-Upload-Command":"query"};function o(p){const x=H_(p,["active","final"]);let v=null;try{v=p.getResponseHeader("X-Goog-Upload-Size-Received")}catch{ci(!1)}v||ci(!1);const b=Number(v);return ci(!isNaN(b)),new kp(b,s.size(),x==="final")}const u="POST",h=n.maxUploadRetryTime,f=new ia(t,u,o,h);return f.headers=i,f.errorHandler=Su(e),f}const PS=256*1024;function yF(n,e,t,s,i,o,u,h){const f=new kp(0,0);if(u?(f.current=u.current,f.total=u.total):(f.current=0,f.total=s.size()),s.size()!==f.total)throw RU();const p=f.total-f.current;let x=p;i>0&&(x=Math.min(x,i));const v=f.current,b=v+x;let I="";x===0?I="finalize":p===x?I="upload, finalize":I="upload";const N={"X-Goog-Upload-Command":I,"X-Goog-Upload-Offset":`${f.current}`},E=s.slice(v,b);if(E===null)throw wR();function A(V,F){const K=H_(V,["active","final"]),L=f.current+x,k=s.size();let D;return K==="final"?D=wg(e,o)(V,F):D=null,new kp(L,k,K==="final",D)}const C="POST",q=e.maxUploadRetryTime,P=new ia(t,C,A,q);return P.headers=N,P.body=E.uploadData(),P.progressCallback=h||null,P.errorHandler=Su(n),P}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xF={STATE_CHANGED:"state_changed"},us={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function X0(n){switch(n){case"running":case"pausing":case"canceling":return us.RUNNING;case"paused":return us.PAUSED;case"success":return us.SUCCESS;case"canceled":return us.CANCELED;case"error":return us.ERROR;default:return us.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vF{constructor(e,t,s){if(MU(e)||t!=null||s!=null)this.next=e,this.error=t??void 0,this.complete=s??void 0;else{const o=e;this.next=o.next,this.error=o.error,this.complete=o.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sc(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}class _F{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ul.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ul.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ul.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,s,i,o){if(this.sent_)throw Fd("cannot .send() more than once");if(lo(e)&&s&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),o!==void 0)for(const u in o)o.hasOwnProperty(u)&&this.xhr_.setRequestHeader(u,o[u].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Fd("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Fd("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Fd("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Fd("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class bF extends _F{initXhr(){this.xhr_.responseType="text"}}function ni(){return new bF}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,t,s=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=s,this._mappings=bg(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(Ut.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const o=this.isExponentialBackoffExpired();if(SR(i.status,[]))if(o)i=_R();else{this.sleepTime=Math.max(this.sleepTime*2,_U),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(Ut.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,o)=>{this._resolve=i,this._reject=o,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,s])=>{switch(this._state){case"running":e(t,s);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{const s=pF(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(s,ni,e,t);this._request=i,i.getPromise().then(o=>{this._request=void 0,this._uploadUrl=o,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,s)=>{const i=gF(this._ref.storage,this._ref._location,e,this._blob),o=this._ref.storage._makeRequest(i,ni,t,s);this._request=o,o.getPromise().then(u=>{u=u,this._request=void 0,this._updateProgress(u.current),this._needToFetchStatus=!1,u.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=PS*this._chunkMultiplier,t=new kp(this._transferred,this._blob.size()),s=this._uploadUrl;this._resolveToken((i,o)=>{let u;try{u=yF(this._ref._location,this._ref.storage,s,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(f){this._error=f,this._transition("error");return}const h=this._ref.storage._makeRequest(u,ni,i,o,!1);this._request=h,h.getPromise().then(f=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(f.current),f.finalized?(this._metadata=f.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){PS*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const s=jR(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(s,ni,e,t);this._request=i,i.getPromise().then(o=>{this._request=void 0,this._metadata=o,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const s=mF(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(s,ni,e,t);this._request=i,i.getPromise().then(o=>{this._request=void 0,this._metadata=o,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=bR(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=X0(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,s,i){const o=new vF(t||void 0,s||void 0,i||void 0);return this._addObserver(o),()=>{this._removeObserver(o)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(X0(this._state)){case us.SUCCESS:Sc(this._resolve.bind(null,this.snapshot))();break;case us.CANCELED:case us.ERROR:const t=this._reject;Sc(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(X0(this._state)){case us.RUNNING:case us.PAUSED:e.next&&Sc(e.next.bind(e,this.snapshot))();break;case us.SUCCESS:e.complete&&Sc(e.complete.bind(e))();break;case us.CANCELED:case us.ERROR:e.error&&Sc(e.error.bind(e,this._error))();break;default:e.error&&Sc(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e,t){this._service=e,t instanceof es?this._location=t:this._location=es.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Tl(e,t)}get root(){const e=new es(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return DR(this._location.path)}get storage(){return this._service}get parent(){const e=JU(this._location.path);if(e===null)return null;const t=new es(this._location.bucket,e);return new Tl(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw ER(e)}}function wF(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new OR(n,new Mi(e),t)}function TF(n){const e={prefixes:[],items:[]};return MR(n,e).then(()=>e)}async function MR(n,e,t){const i=await VR(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&await MR(n,e,i.nextPageToken)}function VR(n,e){e!=null&&typeof e.maxResults=="number"&&Hx("options.maxResults",1,1e3,e.maxResults);const t=e||{},s=cF(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(s,ni)}function EF(n){n._throwIfRoot("getMetadata");const e=jR(n.storage,n._location,bg());return n.storage.makeRequestWithTokens(e,ni)}function IF(n,e){n._throwIfRoot("updateMetadata");const t=dF(n.storage,n._location,e,bg());return n.storage.makeRequestWithTokens(t,ni)}function SF(n){n._throwIfRoot("getDownloadURL");const e=uF(n.storage,n._location,bg());return n.storage.makeRequestWithTokens(e,ni).then(t=>{if(t===null)throw CU();return t})}function NF(n){n._throwIfRoot("deleteObject");const e=hF(n.storage,n._location);return n.storage.makeRequestWithTokens(e,ni)}function LR(n,e){const t=ZU(n._location.path,e),s=new es(n._location.bucket,t);return new Tl(n.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AF(n){return/^[A-Za-z]+:\/\//.test(n)}function RF(n,e){return new Tl(n,e)}function UR(n,e){if(n instanceof G_){const t=n;if(t._bucket==null)throw AU();const s=new Tl(t,t._bucket);return e!=null?UR(s,e):s}else return e!==void 0?LR(n,e):n}function CF(n,e){if(e&&AF(e)){if(n instanceof G_)return RF(n,e);throw Fc("To use ref(service, url), the first argument must be a Storage instance.")}else return UR(n,e)}function OS(n,e){const t=e?.[vR];return t==null?null:es.makeFromBucketSpec(t,n)}function DF(n,e,t,s={}){n.host=`${e}:${t}`;const i=lo(e);i&&(sv(`https://${n.host}/b`),rv("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:o}=s;o&&(n._overrideAuthToken=typeof o=="string"?o:uN(o,n.app.options.projectId))}class G_{constructor(e,t,s,i,o,u=!1){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=i,this._firebaseVersion=o,this._isUsingEmulator=u,this._bucket=null,this._host=xR,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=xU,this._maxUploadRetryTime=vU,this._requests=new Set,i!=null?this._bucket=es.makeFromBucketSpec(i,this._host):this._bucket=OS(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=es.makeFromBucketSpec(this._url,e):this._bucket=OS(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Hx("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Hx("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Lt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Tl(this,e)}_makeRequest(e,t,s,i,o=!0){if(this._deleted)return new kU(TR());{const u=qU(e,this._appId,s,i,t,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(u),u.getPromise().then(()=>this._requests.delete(u),()=>this._requests.delete(u)),u}}async makeRequestWithTokens(e,t){const[s,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,i).getPromise()}}const MS="@firebase/storage",VS="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kF="storage";function jF(n,e,t){return n=Oe(n),wF(n,e,t)}function PF(n){return n=Oe(n),EF(n)}function OF(n,e){return n=Oe(n),IF(n,e)}function MF(n,e){return n=Oe(n),VR(n,e)}function VF(n){return n=Oe(n),TF(n)}function LF(n){return n=Oe(n),SF(n)}function UF(n){return n=Oe(n),NF(n)}function LS(n,e){return n=Oe(n),CF(n,e)}function FF(n,e){return LR(n,e)}function BF(n,e,t,s={}){DF(n,e,t,s)}function zF(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new G_(t,s,i,e,Ji)}function qF(){Hi(new ir(kF,zF,"PUBLIC").setMultipleInstances(!0)),Fs(MS,VS,""),Fs(MS,VS,"esm2020")}qF();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Um{constructor(e,t,s){this._delegate=e,this.task=t,this.ref=s}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Um(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(s=>{if(e)return e(new Um(s,this,this._ref))},t)}on(e,t,s,i){let o;return t&&(typeof t=="function"?o=u=>t(new Um(u,this,this._ref)):o={next:t.next?u=>t.next(new Um(u,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,o,s||void 0,i||void 0)}}class FS{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Bi(e,this._service))}get items(){return this._delegate.items.map(e=>new Bi(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=FF(this._delegate,e);return new Bi(t,this.storage)}get root(){return new Bi(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return e==null?null:new Bi(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new US(jF(this._delegate,e,t),this)}putString(e,t=nr.RAW,s){this._throwIfRoot("putString");const i=NR(t,e),o={...s};return o.contentType==null&&i.contentType!=null&&(o.contentType=i.contentType),new US(new OR(this._delegate,new Mi(i.data,!0),o),this)}listAll(){return VF(this._delegate).then(e=>new FS(e,this.storage))}list(e){return MF(this._delegate,e||void 0).then(t=>new FS(t,this.storage))}getMetadata(){return PF(this._delegate)}updateMetadata(e){return OF(this._delegate,e)}getDownloadURL(){return LF(this._delegate)}delete(){return this._throwIfRoot("delete"),UF(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw ER(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(BS(e))throw Fc("ref() expected a child path but got a URL, use refFromURL instead.");return new Bi(LS(this._delegate,e),this)}refFromURL(e){if(!BS(e))throw Fc("refFromURL() expected a full URL but got a child path, use ref() instead.");try{es.makeFromUrl(e,this._delegate.host)}catch{throw Fc("refFromUrl() expected a valid full URL but got an invalid one.")}return new Bi(LS(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,s={}){BF(this._delegate,e,t,s)}}function BS(n){return/^[A-Za-z]+:\/\//.test(n)}const HF="@firebase/storage-compat",GF="0.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $F="storage-compat";function KF(n,{instanceIdentifier:e}){const t=n.getProvider("app-compat").getImmediate(),s=n.getProvider("storage").getImmediate({identifier:e});return new FR(t,s)}function QF(n){const e={TaskState:us,TaskEvent:xF,StringFormat:nr,Storage:FR,Reference:Bi};n.INTERNAL.registerComponent(new ir($F,KF,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion(HF,GF)}QF(Zn);const WF={apiKey:"AIzaSyA6xDfTTIV9cTj3r2TYDyB7I_7KiWmrQys",authDomain:"oficina-promotienda.firebaseapp.com",projectId:"oficina-promotienda",storageBucket:"oficina-promotienda.firebasestorage.app",messagingSenderId:"261291434764",appId:"1:261291434764:web:aa9bc15b10717875021f29",measurementId:"G-PSB6H7NJWY"};Zn.apps.length||Zn.initializeApp(WF);const Re=Zn.firestore(),Bd=Zn.auth(),BR=Zn.storage(),zR=new Zn.auth.GoogleAuthProvider;zR.addScope("https://www.googleapis.com/auth/drive");const Nc={id:"user_raul_colosio",name:"Ral Colosio",email:"hola@promotienda.mx",role:"Administrador",sortIndex:0},YF=["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],$n=n=>{if(!n)return"";const e=new Date(n.includes("T")?n:`${n}T00:00:00`);if(isNaN(e.getTime()))return"";const t=String(e.getDate()).padStart(2,"0"),s=YF[e.getMonth()],i=e.getFullYear();return`${t}-${s}-${i}`},Qi=(n,e)=>{let t=new Date(n),s=0;for(;s<e;)t.setDate(t.getDate()+1),t.getDay()!==0&&s++;return t},zd=async(n,e,t,s)=>{const i=[...t].sort((p,x)=>p.sortIndex-x.sortIndex),o=i.findIndex(p=>p.id===n),u=i.findIndex(p=>p.id===e);if(o===-1||u===-1||n===e)return;const h=i[u];let f;if(o<u){const p=i[u+1];f=(h.sortIndex+(p?p.sortIndex:h.sortIndex+2e3))/2}else{const p=i[u-1];f=(h.sortIndex+(p?p.sortIndex:0))/2}await Re.collection(s).doc(n).update({sortIndex:f})},qR=S.createContext(void 0),Ct=n=>({...n.data(),id:n.id}),Fm=async(n,e)=>{const t=`attachments/${e}/${Date.now()}_${n.name}`,i=await BR.ref(t).put(n),o=await i.ref.getDownloadURL();return{id:i.ref.name,name:n.name,type:n.type,size:n.size,url:o,storagePath:t}},XF=async n=>{try{await BR.ref(n.storagePath).delete()}catch(e){e.code!=="storage/object-not-found"&&console.error("Failed to delete attachment from storage:",e)}},J0=async n=>{!n||n.length===0||await Promise.all(n.map(e=>XF(e)))},JF=({children:n,showConfirmation:e,showContactDetail:t,showAddEditContact:s,showAddDeal:i,showAlert:o})=>{const[u,h]=S.useState(null),[f,p]=S.useState(!0),[x,v]=S.useState([]),[b,I]=S.useState([]),[N,E]=S.useState([]),[A,C]=S.useState([]),[q,P]=S.useState([]),[V,F]=S.useState([Nc]),[K,L]=S.useState([]),[k,D]=S.useState([]),[M,B]=S.useState([]),[G,z]=S.useState([]),[he,Se]=S.useState([]),[J,ge]=S.useState([]),[le,Ie]=S.useState([]),[O,oe]=S.useState([]),[me,te]=S.useState([]),[we,Ce]=S.useState([]),[Pe,xt]=S.useState([]),[rt,Ot]=S.useState(!1),[ws,Ts]=S.useState(!1),Es=async()=>{const U=Re.collection("pipelineStages");if((await U.get()).empty){console.log("No pipeline stages found. Initializing default pipeline...");const ne=["Nuevos","Contactados","En revisin","Aprobado","Compra de material","En camino","Produccin","Taller externo","Listo en local","Espera de pago","Listo para entrega","Ganado","Perdido"],ue=Re.batch();ne.forEach((ve,xe)=>{const Le=U.doc();ue.set(Le,{name:ve,sortIndex:(xe+1)*1e3})}),await ue.commit(),console.log("Default pipeline initialized.")}};S.useEffect(()=>{window.gapi&&window.gapi.load("picker",()=>Ts(!0)),Es()},[]),S.useEffect(()=>{localStorage.getItem("googleDriveConnected")==="true"&&Ot(!0)},[]);const lr=async()=>{try{const Z=(await Bd.signInWithPopup(zR)).credential;if(Z?.accessToken)sessionStorage.setItem("googleOauthToken",Z.accessToken),Ot(!0),localStorage.setItem("googleDriveConnected","true");else throw new Error("No access token received from Google.")}catch(U){console.error("Google Drive connection error:",U),alert("Could not connect to Google Drive. Please check popup blockers and try again."),Ot(!1),localStorage.removeItem("googleDriveConnected"),sessionStorage.removeItem("googleOauthToken")}},Ne=async()=>{Ot(!1),localStorage.removeItem("googleDriveConnected"),sessionStorage.removeItem("googleOauthToken")},Je=async()=>new Promise((U,Z)=>{const ne=sessionStorage.getItem("googleOauthToken");if(window.process?.env?.GOOGLE_API_KEY,window.process?.env?.GOOGLE_CLIENT_ID,!ne||!ws)return Z(new Error("Google Drive integration is not ready or user is not authenticated."));const ue=new window.google.picker.DocsView(window.google.picker.ViewId.FOLDERS).setIncludeFolders(!0).setSelectFolderEnabled(!0);new window.google.picker.PickerBuilder().setOAuthToken(ne).addView(ue).setCallback(xe=>{if(xe.action===window.google.picker.Action.PICKED){const Le=xe.docs[0];U({id:Le.id,url:Le.url,name:Le.name})}else xe.action===window.google.picker.Action.CANCEL&&U(null)}).build().setVisible(!0)});S.useEffect(()=>{p(!0);const U=Bd.onAuthStateChanged(async Z=>{if(Z&&Z.email){let ne=null;const ue=await Re.collection("users").where("email","==",Z.email).limit(1).get();ue.empty?Z.email===Nc.email&&(ne=Nc):ne=Ct(ue.docs[0]),ne?(ne.id!==Nc.id&&!ne.authUid&&(await Re.collection("users").doc(ne.id).update({authUid:Z.uid}),ne.authUid=Z.uid),h(ne)):(console.warn(`Authenticated user with email ${Z.email} has no profile in Firestore. Logging out.`),await Bd.signOut(),h(null))}else h(null);p(!1)});return()=>U()},[]),S.useEffect(()=>{if(!u){p(!1),v([]),I([]),E([]),C([]),P([]),L([]),D([]),B([]),z([]),Se([]),ge([]),Ie([]),oe([]),te([]),Ce([]),xt([]);return}let U=[];return(async()=>{p(!0);const ne=await Re.collection("pipelineStages").get();if(!ne.empty){const ve=new Map(ne.docs.map(je=>[je.data().name,je.id])),Le=(await Re.collection("deals").get()).docs.filter(je=>je.data().stage&&!je.data().stageId);if(Le.length>0){console.log(`Migrating ${Le.length} deals to use stage IDs.`);const je=Re.batch();Le.forEach(Me=>{const gt=Me.data(),ft=ve.get(gt.stage);ft&&je.update(Me.ref,{stageId:ft,stage:Zn.firestore.FieldValue.delete()})}),await je.commit(),console.log("Deal migration finished.")}}(async()=>{})(),U=[Re.collection("contacts").where("deletedAt","==",null).onSnapshot(ve=>v(ve.docs.map(xe=>Ct(xe)))),Re.collection("deals").where("deletedAt","==",null).onSnapshot(ve=>I(ve.docs.map(xe=>Ct(xe)))),Re.collection("tasks").where("deletedAt","==",null).onSnapshot(ve=>E(ve.docs.map(xe=>Ct(xe)))),Re.collection("notes").onSnapshot(ve=>C(ve.docs.map(xe=>Ct(xe)))),Re.collection("contactNotes").onSnapshot(ve=>P(ve.docs.map(xe=>Ct(xe)))),Re.collection("users").orderBy("sortIndex").onSnapshot(ve=>{const xe=ve.docs.map(je=>Ct(je)),Le=[Nc,...xe.filter(je=>je.id!==Nc.id)];F(Le)}),Re.collection("tags").orderBy("sortIndex").onSnapshot(ve=>L(ve.docs.map(xe=>Ct(xe)))),Re.collection("contactTags").orderBy("sortIndex").onSnapshot(ve=>D(ve.docs.map(xe=>Ct(xe)))),Re.collection("messageTemplates").orderBy("sortIndex").onSnapshot(ve=>B(ve.docs.map(xe=>Ct(xe)))),Re.collection("quotes").onSnapshot(ve=>z(ve.docs.map(xe=>Ct(xe)))),Re.collection("notifications").where("userId","==",u.id).orderBy("createdAt","desc").onSnapshot(ve=>Se(ve.docs.map(xe=>Ct(xe)))),Re.collection("notifications").where("createdBy.id","==",u.id).orderBy("createdAt","desc").onSnapshot(ve=>ge(ve.docs.map(xe=>Ct(xe)))),Re.collection("contacts").where("deletedAt","!=",null).onSnapshot(ve=>te(ve.docs.map(xe=>Ct(xe)))),Re.collection("deals").where("deletedAt","!=",null).onSnapshot(ve=>Ce(ve.docs.map(xe=>Ct(xe)))),Re.collection("tasks").where("deletedAt","!=",null).onSnapshot(ve=>xt(ve.docs.map(xe=>Ct(xe)))),Re.collection("dynamicLists").orderBy("name").onSnapshot(ve=>Ie(ve.docs.map(xe=>Ct(xe)))),Re.collection("pipelineStages").orderBy("sortIndex").onSnapshot(ve=>oe(ve.docs.map(xe=>Ct(xe))))],p(!1)})(),()=>U.forEach(ne=>ne())},[u]);const ct=async(U,Z)=>{await Bd.signInWithEmailAndPassword(U,Z)},Yt=async()=>{await Bd.signOut()},It=async(U,Z)=>{const ne=Object.fromEntries(Object.entries(Z).filter(([ue,ve])=>ve!==void 0));return await Re.collection(U).add(ne)},dt=async(U,Z,ne)=>{const ue={...ne};for(const ve in ue)ue[ve]===void 0&&(ue[ve]=Zn.firestore.FieldValue.delete());await Re.collection(U).doc(Z).update(ue)},rn=async(U,Z)=>await Re.collection(U).doc(Z).delete(),cr=async(U,Z)=>await dt(U,Z,{deletedAt:new Date().toISOString()}),yo=async(U,Z)=>await dt(U,Z,{deletedAt:null}),ur=async(U,Z,ne,ue)=>{const ve=/<span[^>]*data-user-id="([^"]+)"[^>]*>/g;let xe;const Le=new Set;for(;(xe=ve.exec(U))!==null;)Le.add(xe[1]);const je=await Re.collection("notifications").where("sourceNoteId","==",ne).get(),Me=new Map;je.docs.forEach(ut=>{const Ye=ut.data();Ye.userId&&Me.set(Ye.userId,ut.id)});const gt=new Set(Me.keys()),ft=new Set([...Le].filter(ut=>!gt.has(ut))),Be=new Set([...gt].filter(ut=>!Le.has(ut)));if(ft.size===0&&Be.size===0)return;const Dt=Re.batch();Be.forEach(ut=>{const Ye=Me.get(ut);if(Ye){const ze=Re.collection("notifications").doc(Ye);Dt.delete(ze)}}),ft.forEach(ut=>{if(ut===ue.id)return;const Ye=Re.collection("notifications").doc(),ze=`${ue.name} mentioned you in a note.`;Dt.set(Ye,{userId:ut,message:ze,link:Z,isRead:!1,createdAt:new Date().toISOString(),createdBy:{id:ue.id,name:ue.name},sourceNoteId:ne})}),await Dt.commit()},xo=async U=>{if(U.length===0)return;const Z=Re.batch();U.forEach(ne=>{const ue=Re.collection("notifications").doc(ne);Z.update(ue,{isRead:!0})}),await Z.commit()},kl=async U=>{if(U.length===0)return;const Z=Re.batch();U.forEach(ne=>{const ue=Re.collection("notifications").doc(ne);Z.update(ue,{isRead:!1})}),await Z.commit()},Ft=async U=>{if(U.length===0)return;const Z=Re.batch();U.forEach(ne=>{const ue=Re.collection("notifications").doc(ne);Z.delete(ue)}),await Z.commit()},ht=async(U,Z)=>{if(!u)return;const ne=Re.collection(U).doc(Z),ue=await ne.get();if(!ue.exists)return;(ue.data()?.likes||[]).includes(u.id)?await ne.update({likes:Zn.firestore.FieldValue.arrayRemove(u.id)}):await ne.update({likes:Zn.firestore.FieldValue.arrayUnion(u.id)})},rs=U=>ht("notes",U),Nn=U=>ht("contactNotes",U),zs=U=>{const Z=k.find(xe=>xe.name.toLowerCase()==="lead"),ne=k.find(xe=>xe.name.toLowerCase()==="cliente");if(!Z||!ne)return U;const ue=U.includes(Z.id),ve=U.includes(ne.id);return ue&&ve?U.filter(xe=>xe!==Z.id):U},jl=(U,Z)=>Z.rules.every(ne=>{const ue=U[ne.field],ve=ne.value;if(ne.field==="contactTagIds"){const xe=U.contactTagIds||[];if(ne.operator==="has_tag")return xe.includes(ve);if(ne.operator==="not_has_tag")return!xe.includes(ve)}else if(typeof ue=="string"){const xe=ue.toLowerCase(),Le=ve.toLowerCase();if(ne.operator==="contains")return xe.includes(Le);if(ne.operator==="not_contains")return!xe.includes(Le);if(ne.operator==="is")return xe===Le;if(ne.operator==="is_not")return xe!==Le}return!1}),Is=async U=>{if(le.length===0&&!U.contactTagIds)return;const Z=new Set;le.forEach(Me=>{jl(U,Me)&&Me.assignedTagIds.forEach(gt=>Z.add(gt))});const ne=new Set(le.flatMap(Me=>Me.assignedTagIds)),ue=new Set(U.contactTagIds||[]),ve=new Set([...ue].filter(Me=>!ne.has(Me))),xe=new Set([...ve,...Z]),Le=zs(Array.from(xe));ue.size===Le.length&&[...ue].every(Me=>Le.includes(Me))||await dt("contacts",U.id,{contactTagIds:Le})},dr=async U=>{let Z=Re.batch(),ne=0;for(const ue of x){const ve=new Set;U.forEach(Be=>{jl(ue,Be)&&Be.assignedTagIds.forEach(Dt=>ve.add(Dt))});const xe=new Set(U.flatMap(Be=>Be.assignedTagIds)),Le=new Set(ue.contactTagIds||[]),je=new Set([...Le].filter(Be=>!xe.has(Be))),Me=new Set([...je,...ve]),gt=zs(Array.from(Me));if(!(Le.size===gt.length&&[...Le].every(Be=>gt.includes(Be)))){const Be=Re.collection("contacts").doc(ue.id);Z.update(Be,{contactTagIds:gt}),ne++,ne>=499&&(await Z.commit(),Z=Re.batch(),ne=0)}}ne>0&&await Z.commit()},kr=async(U,Z)=>{const ne=Re.batch();U.forEach(ue=>{const ve=Re.collection(Z).doc(ue);ne.update(ve,{deletedAt:new Date().toISOString()})}),await ne.commit()},Ss=async U=>{const Z=k.find(Le=>Le.name.toLowerCase()==="lead");let ne=U.contactTagIds||[];Z&&!ne.includes(Z.id)&&ne.push(Z.id),ne=zs(ne);const ve=await(await It("contacts",{...U,contactTagIds:ne,createdAt:new Date().toISOString(),deletedAt:null})).get(),xe=Ct(ve);return await Is(xe),xe},aa=async U=>{const Z=Re.batch(),ne=[],ue=k.find(xe=>xe.name.toLowerCase()==="lead");U.forEach(xe=>{const Le=Re.collection("contacts").doc();let je=xe.contactTagIds||[];ue&&!je.includes(ue.id)&&je.push(ue.id),je=zs(je);const Me={...xe,contactTagIds:je,createdAt:new Date().toISOString(),deletedAt:null};Z.set(Le,Me),ne.push(Le.get().then(gt=>Ct(gt)))}),await Z.commit();const ve=await Promise.all(ne);await Promise.all(ve.map(xe=>Is(xe)))},fi=async U=>{const Z=zs(U.contactTagIds||[]),ne={...U,contactTagIds:Z};await dt("contacts",ne.id,ne),await Is(ne)},vo=U=>kr(U,"contacts"),_o=async(U,Z)=>{if(U.length===0)return;const ne=x.filter(xe=>U.includes(xe.id));if(ne.length===0)return;const ue=Re.batch(),ve=[];ne.forEach(xe=>{const Le=Re.collection("contacts").doc(xe.id),je=new Set(xe.contactTagIds||[]);Z.addTagIds.forEach(gt=>je.add(gt)),Z.removeTagIds.forEach(gt=>je.delete(gt));const Me=zs(Array.from(je));ue.update(Le,{contactTagIds:Me}),ve.push({...xe,contactTagIds:Me})}),await ue.commit(),await Promise.all(ve.map(xe=>Is(xe)))},bo=async(U,Z,ne)=>{const ue=Re.batch(),ve=[U,...ne],xe=await Promise.all(ve.map(Ye=>Re.collection("contacts").doc(Ye).get())),Le=new Set;xe.forEach(Ye=>{Ye.exists&&Ct(Ye).contactTagIds?.forEach(Hs=>Le.add(Hs))});let je=zs(Array.from(Le));const Me=Re.collection("contacts").doc(U),{id:gt,...ft}=Z;ue.update(Me,{...ft,contactTagIds:je}),b.filter(Ye=>Ye.contactIds.some(ze=>ne.includes(ze))).forEach(Ye=>{const ze=Array.from(new Set(Ye.contactIds.filter(Hs=>!ne.includes(Hs)).concat(U)));ue.update(Re.collection("deals").doc(Ye.id),{contactIds:ze})}),q.filter(Ye=>ne.includes(Ye.contactId)).forEach(Ye=>{ue.update(Re.collection("contactNotes").doc(Ye.id),{contactId:U})}),ne.forEach(Ye=>{ue.delete(Re.collection("contacts").doc(Ye))}),await ue.commit();const ut=await Re.collection("contacts").doc(U).get();ut.exists&&await Is(Ct(ut))},hr=async U=>{if(!U.assignedUserId)throw o("Asignacin obligatoria","Por favor, asigna el trato a un usuario antes de guardarlo."),new Error("Deal must be assigned to a user.");const Z={...U,createdAt:new Date().toISOString(),tagIds:U.tagIds||[],sortIndex:Date.now(),deletedAt:null},ne=await It("deals",Z),ue=new Date().toISOString().split("T")[0];await an({title:"Enviar cotizacin",dealId:ne.id,responsibleUserId:U.assignedUserId,dueDate:ue});const ve=await ne.get();return Ct(ve)},fr=async(U,Z)=>{const ne=b.find(Be=>Be.id===U)||we.find(Be=>Be.id===U);if(!ne)return;const ue=Z(ne);if(ue.hasOwnProperty("assignedUserId")&&!ue.assignedUserId){o("Asignacin obligatoria","Los tratos no pueden quedar sin asignar. Por favor, selecciona otro usuario.");return}const ve=ne.stageId,xe=ue.stageId||ne.stageId,Le=O.find(Be=>Be.id===ve),je=O.find(Be=>Be.id===xe),Me=new Set("tagIds"in ue?ue.tagIds||[]:ne.tagIds||[]),gt=new Date().toISOString().split("T")[0];if(je&&Le?.name!==je.name){if(je.name==="Compra de material"&&ne.assignedUserId&&await an({title:"Comprar material",dealId:ne.id,responsibleUserId:ne.assignedUserId,dueDate:gt}),je.name==="Produccin"){const Be=K.find(Dt=>Dt.name.toLowerCase()==="recibido");Be&&Me.add(Be.id)}if(je.name==="Ganado"){const Be=V.find(ut=>ut.name==="Ral Colosio");if(Be){const ut=Qi(new Date,2);await an({title:"Enviar el Google review",dealId:ne.id,responsibleUserId:Be.id,dueDate:ut.toISOString().split("T")[0]})}const Dt=ne.contactIds[0];if(Dt){const ut=Re.collection("contacts").doc(Dt);await Re.runTransaction(async Ye=>{const ze=await Ye.get(ut);if(!ze.exists)return;let Rn=Ct(ze).contactTagIds||[];const Vr=k.find(xr=>xr.name.toLowerCase()==="lead"),ha=k.find(xr=>xr.name.toLowerCase()==="cliente");Vr&&(Rn=Rn.filter(xr=>xr!==Vr.id)),ha&&!Rn.includes(ha.id)&&Rn.push(ha.id),Ye.update(ut,{contactTagIds:Rn})})}}}const ft=[...Me].filter(Be=>!(ne.tagIds||[]).includes(Be));if(ft.length>0){const Be=V.find(ze=>ze.name==="Ral Colosio"),Dt=V.find(ze=>ze.email==="produccion.promotienda@gmail.com"),ut=V.find(ze=>ze.email==="impresion@promotienda.mx"),Ye=K.filter(ze=>ft.includes(ze.id));for(const ze of Ye)ze.name.toLowerCase()==="serigrafa"&&(Be&&await an({title:"Preparar positivo",dealId:ne.id,responsibleUserId:Be.id,dueDate:gt}),ut&&await an({title:"Impresin de serigrafa",dealId:ne.id,responsibleUserId:ut.id,dueDate:gt})),ze.name.toLowerCase()==="dtf textil"&&(Be&&await an({title:"Enviar diseo a impresin",dealId:ne.id,responsibleUserId:Be.id,dueDate:gt}),Dt&&await an({title:"Estampado DTF textil",dealId:ne.id,responsibleUserId:Dt.id,dueDate:gt})),ze.name.toLowerCase()==="uv"&&(Be&&await an({title:"Enviar diseo a impresin",dealId:ne.id,responsibleUserId:Be.id,dueDate:gt}),Dt&&await an({title:"Estampado UV",dealId:ne.id,responsibleUserId:Dt.id,dueDate:gt}))}if(je?.name==="Produccin"){const Be=K.find(Dt=>Dt.name.toLowerCase()==="recibido");Be&&Me.has(Be.id)&&Me.size>1&&Me.delete(Be.id)}if(je?.name!=="Produccin"&&Le?.name==="Produccin"?ue.tagIds=[]:ue.tagIds=Array.from(Me),je?.name==="Produccin"&&ue.tagIds.length===0){o("Action Required","To keep this deal in Production, it must have at least one tag. Add another tag before removing this one.");return}await dt("deals",U,ue)},wo=async(U,Z)=>{const ne=b.find(Me=>Me.id===U),ue=b.find(Me=>Me.id===Z);if(!ne||!ue||U===Z)return;const ve=b.filter(Me=>Me.stageId===ue.stageId).sort((Me,gt)=>Me.sortIndex-gt.sortIndex),xe=ve.findIndex(Me=>Me.id===U),Le=ve.findIndex(Me=>Me.id===Z);if(xe===-1||Le===-1)return;let je;if(xe<Le){const Me=ve[Le+1]?.sortIndex;je=(ue.sortIndex+(Me||ue.sortIndex+2))/2}else{const Me=ve[Le-1]?.sortIndex;je=(ue.sortIndex+(Me||0))/2}await dt("deals",U,{sortIndex:je,stageId:ue.stageId})},an=async U=>{if(!U.responsibleUserId)throw o("Asignacin obligatoria","Por favor, asigna la tarea a un usuario antes de guardarla."),new Error("Task must be assigned to a user.");await It("tasks",{...U,completed:!1,deletedAt:null})},To=async U=>{if(!U.responsibleUserId)throw o("Asignacin obligatoria","Por favor, asigna la tarea a un usuario antes de guardarla."),new Error("Task must be assigned to a user.");await dt("tasks",U.id,U)},jr=U=>kr(U,"tasks"),oa=async U=>{const Z=Re.batch();U.forEach(ne=>{const ue=Re.collection("tasks").doc(ne);Z.update(ue,{completed:!0})}),await Z.commit()},mr=async(U,Z)=>{const ne=Re.collection(Z).doc(U),ue=await ne.get();if(!ue.exists)return;const ve=Ct(ue),xe=Re.batch();ve.attachments&&await J0(ve.attachments),xe.delete(ne),(await Re.collection("notifications").where("sourceNoteId","==",U).get()).docs.forEach(je=>{xe.delete(je.ref)}),await xe.commit()},da={currentUser:u,loading:f,login:ct,logout:Yt,contacts:x,deals:b,tasks:N,notes:A,contactNotes:q,users:V,tags:K,contactTags:k,messageTemplates:M,quotes:G,notifications:he,sentNotifications:J,dynamicLists:le,pipelineStages:O,getContactById:U=>x.find(Z=>Z.id===U)||me.find(Z=>Z.id===U),getDealById:U=>b.find(Z=>Z.id===U)||we.find(Z=>Z.id===U),getStageById:U=>O.find(Z=>Z.id===U),getTasksForDeal:U=>N.filter(Z=>Z.dealId===U).sort((Z,ne)=>(Z.completed?1:-1)-(ne.completed?1:-1)||Z.id.localeCompare(ne.id)),getAllPendingTasks:()=>N.filter(U=>!U.completed).sort((U,Z)=>(U.dueDate||"").localeCompare(Z.dueDate||"")||U.id.localeCompare(Z.id)),getNotesForDeal:U=>A.filter(Z=>Z.dealId===U).sort((Z,ne)=>new Date(ne.createdAt).getTime()-new Date(Z.createdAt).getTime()),getNotesForContact:U=>q.filter(Z=>Z.contactId===U).sort((Z,ne)=>new Date(ne.createdAt).getTime()-new Date(Z.createdAt).getTime()),getUsers:()=>V,getUserById:U=>V.find(Z=>Z.id===U),getTags:()=>K,getTagById:U=>K.find(Z=>Z.id===U),getQuotesForDeal:U=>G.filter(Z=>Z.dealId===U).sort((Z,ne)=>ne.createdAt&&Z.createdAt?new Date(ne.createdAt).getTime()-new Date(Z.createdAt).getTime():ne.id.localeCompare(Z.id)),addContact:Ss,bulkAddContacts:aa,updateContact:fi,bulkDeleteContacts:vo,bulkUpdateContacts:_o,mergeContacts:bo,addDeal:hr,updateDeal:fr,reorderDeal:wo,addTask:an,updateTask:To,completeTasks:oa,addNote:async(U,Z)=>{const ne=await Promise.all(Z.map(ve=>Fm(ve,U.dealId))),ue=await It("notes",{...U,attachments:ne,createdAt:new Date().toISOString()});u&&await ur(U.content,`/deals/${U.dealId}`,ue.id,u)},updateNote:async(U,Z,ne)=>{await J0(ne);const ue=await Promise.all(Z.map(je=>Fm(je,U.dealId))),Le=[...(A.find(je=>je.id===U.id)?.attachments||[]).filter(je=>!ne.some(Me=>Me.id===je.id)),...ue];await dt("notes",U.id,{...U,attachments:Le}),u&&await ur(U.content,`/deals/${U.dealId}`,U.id,u)},deleteNote:U=>mr(U,"notes"),addContactNote:async(U,Z)=>{const ne=await Promise.all(Z.map(ve=>Fm(ve,U.contactId))),ue=await It("contactNotes",{...U,attachments:ne,createdAt:new Date().toISOString()});u&&await ur(U.content,`/contacts?contactId=${U.contactId}`,ue.id,u)},updateContactNote:async(U,Z,ne)=>{await J0(ne);const ue=await Promise.all(Z.map(je=>Fm(je,U.contactId))),Le=[...(q.find(je=>je.id===U.id)?.attachments||[]).filter(je=>!ne.some(Me=>Me.id===je.id)),...ue];await dt("contactNotes",U.id,{...U,attachments:Le}),u&&await ur(U.content,`/contacts?contactId=${U.contactId}`,U.id,u)},deleteContactNote:U=>mr(U,"contactNotes"),addUser:async U=>{const Z=V.reduce((ne,ue)=>Math.max(ne,ue.sortIndex||0),0);await It("users",{...U,sortIndex:Z+1e3})},updateUser:async U=>await dt("users",U.id,U),deleteUser:async U=>await rn("users",U),reorderUser:(U,Z)=>zd(U,Z,V,"users"),addTag:async U=>{const Z=K.reduce((ve,xe)=>Math.max(ve,xe.sortIndex||0),0),ue=await(await It("tags",{...U,sortIndex:Z+1e3})).get();return Ct(ue)},updateTag:async U=>await dt("tags",U.id,U),deleteTag:async U=>{await rn("tags",U);const Z=Re.batch();b.forEach(ne=>{if(ne.tagIds.includes(U)){const ue=ne.tagIds.filter(ve=>ve!==U);Z.update(Re.collection("deals").doc(ne.id),{tagIds:ue})}}),await Z.commit()},reorderTag:(U,Z)=>zd(U,Z,K,"tags"),addContactTag:async U=>{const Z=k.reduce((ve,xe)=>Math.max(ve,xe.sortIndex||0),0),ue=await(await It("contactTags",{...U,sortIndex:Z+1e3})).get();return Ct(ue)},updateContactTag:async U=>await dt("contactTags",U.id,U),deleteContactTag:async U=>{await rn("contactTags",U);const Z=Re.batch();x.forEach(ne=>{if(ne.contactTagIds?.includes(U)){const ue=ne.contactTagIds.filter(ve=>ve!==U);Z.update(Re.collection("contacts").doc(ne.id),{contactTagIds:ue})}}),await Z.commit()},reorderContactTag:(U,Z)=>zd(U,Z,k,"contactTags"),addMessageTemplate:async U=>{const Z=M.reduce((ne,ue)=>Math.max(ne,ue.sortIndex||0),0);await It("messageTemplates",{...U,sortIndex:Z+1e3})},updateMessageTemplate:async U=>await dt("messageTemplates",U.id,U),deleteMessageTemplate:async U=>await rn("messageTemplates",U),reorderMessageTemplate:(U,Z)=>zd(U,Z,M,"messageTemplates"),updatePipelineStage:async U=>await dt("pipelineStages",U.id,U),reorderPipelineStage:(U,Z)=>zd(U,Z,O,"pipelineStages"),addQuote:async U=>{await It("quotes",{...U,createdAt:new Date().toISOString()})},updateQuote:async(U,Z)=>await dt("quotes",U,Z),deleteQuote:async U=>await rn("quotes",U),markNotificationsAsRead:xo,markNotificationsAsUnread:kl,deleteNotifications:Ft,addDynamicList:async U=>{await It("dynamicLists",U),await dr([...le,{...U,id:"temp"}])},updateDynamicList:async U=>{await dt("dynamicLists",U.id,U);const Z=le.map(ne=>ne.id===U.id?U:ne);await dr(Z)},deleteDynamicList:async U=>{await rn("dynamicLists",U);const Z=le.filter(ne=>ne.id!==U);await dr(Z)},toggleNoteLike:rs,toggleContactNoteLike:Nn,deleteContact:U=>cr("contacts",U),deleteDeal:U=>cr("deals",U),deleteTask:U=>cr("tasks",U),deleteTasks:jr,deletedContacts:me,deletedDeals:we,deletedTasks:Pe,restoreContact:U=>yo("contacts",U),restoreDeal:U=>yo("deals",U),restoreTask:U=>yo("tasks",U),permanentlyDeleteContact:U=>rn("contacts",U),permanentlyDeleteDeal:U=>rn("deals",U),permanentlyDeleteTask:U=>rn("tasks",U),showConfirmation:e,showContactDetail:t,showAddEditContact:s,showAddDeal:i,showAlert:o,isGoogleDriveConnected:rt,googleApiReady:ws,connectToGoogleDrive:lr,disconnectFromGoogleDrive:Ne,pickGoogleDriveFolder:Je};return c.jsx(qR.Provider,{value:da,children:n})},Ue=()=>{const n=S.useContext(qR);if(!n)throw new Error("useCrm must be used within a CrmProvider");return n},Rr=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),c.jsx("circle",{cx:"9",cy:"7",r:"4"}),c.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),c.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),fs=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),c.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),Eg=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),c.jsx("polyline",{points:"2 17 12 22 22 17"}),c.jsx("polyline",{points:"2 12 12 17 22 12"})]}),$_=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),c.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),c.jsx("path",{d:"M12 11h4"}),c.jsx("path",{d:"M12 16h4"}),c.jsx("path",{d:"M8 11h.01"}),c.jsx("path",{d:"M8 16h.01"})]}),ZF=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("circle",{cx:"12",cy:"12",r:"3"}),c.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06-.06a1.65 1.65 0 0 0-.33 1.82 1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),ms=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),c.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),In=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("polyline",{points:"3 6 5 6 21 6"}),c.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),c.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),c.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),cf=({className:n})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",className:n,children:c.jsx("path",{d:"M12.04 2c-5.46 0-9.91 4.45-9.91 9.91 0 1.75.46 3.45 1.32 4.95L2.05 22l5.25-1.38c1.45.79 3.08 1.21 4.74 1.21 5.46 0 9.91-4.45 9.91-9.91S17.5 2 12.04 2zM12.04 20.22c-1.48 0-2.91-.4-4.19-1.15l-.3-.18-3.12.82.83-3.04-.2-.32a8.13 8.13 0 0 1-1.26-4.38c0-4.54 3.7-8.24 8.24-8.24s8.24 3.7 8.24 8.24-3.7 8.24-8.24 8.24zm4.24-6.11c-.23-.12-1.35-.67-1.56-.74-.21-.07-.36-.12-.51.12-.15.23-.59.74-.72.89-.13.15-.26.17-.48.05-.22-.12-1.02-.38-1.94-1.2-1.13-1.01-1.36-1.48-1.36-1.48s-.15-.17-.03-.3.12-.15.27-.32c.13-.15.17-.25.25-.42.08-.17.04-.32-.02-.44-.06-.12-.51-1.23-.7-1.68-.18-.45-.37-.39-.51-.39h-.3c-.15 0-.39.04-.59.27-.2.23-.78.76-.78 1.85s.8 2.15.91 2.3c.12.15 1.57 2.4 3.79 3.3.54.22.97.35 1.3.45.57.16 1.09.14 1.5-.08.46-.22 1.35-1.1 1.54-1.48.19-.38.19-.7.13-.82z"})}),Vh=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2"}),c.jsx("path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"})]}),uf=({className:n})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:c.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),Dr=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),c.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),c.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),c.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),El=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),c.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),HR=({className:n})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:c.jsx("circle",{cx:"12",cy:"12",r:"10"})}),fn=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),c.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),eB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("circle",{cx:"12",cy:"12",r:"10"}),c.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),c.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),K_=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),c.jsx("polyline",{points:"7 10 12 15 17 10"}),c.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),Q_=({className:n})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:c.jsx("polyline",{points:"15 18 9 12 15 6"})}),tB=({className:n})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:c.jsx("polyline",{points:"9 18 15 12 9 6"})}),GR=({className:n})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:c.jsx("polyline",{points:"6 9 12 15 18 9"})}),$R=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),c.jsx("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})]}),nB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("rect",{x:"2",y:"4",width:"20",height:"5",rx:"1"}),c.jsx("path",{d:"M4 9v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9"}),c.jsx("path",{d:"M10 13h4"})]}),Wa=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M3 2v6h6"}),c.jsx("path",{d:"M21 12A9 9 0 0 0 6 5.3L3 8"}),c.jsx("path",{d:"M21 22v-6h-6"}),c.jsx("path",{d:"M3 12a9 9 0 0 0 15 6.7l3-2.7"})]}),KR=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"}),c.jsx("path",{d:"M12 12v9"}),c.jsx("path",{d:"m16 16-4-4-4 4"})]}),sB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),c.jsx("polyline",{points:"17 8 12 3 7 8"}),c.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),rB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("circle",{cx:"11",cy:"11",r:"8"}),c.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),QR=({className:n})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:c.jsx("path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z"})}),oo=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.72"}),c.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.72-1.72"})]}),Nr=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),c.jsx("polyline",{points:"14 2 14 8 20 8"}),c.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),c.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),c.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]}),iB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),c.jsx("polyline",{points:"15 3 21 3 21 9"}),c.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]}),aB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),c.jsx("polyline",{points:"16 17 21 12 16 7"}),c.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),oB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"}),c.jsx("path",{d:"M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"})]}),lB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("line",{x1:"19",y1:"4",x2:"10",y2:"4"}),c.jsx("line",{x1:"14",y1:"20",x2:"5",y2:"20"}),c.jsx("line",{x1:"15",y1:"4",x2:"9",y2:"20"})]}),cB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),c.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),c.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),c.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),c.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),c.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]}),uB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("line",{x1:"10",y1:"6",x2:"21",y2:"6"}),c.jsx("line",{x1:"10",y1:"12",x2:"21",y2:"12"}),c.jsx("line",{x1:"10",y1:"18",x2:"21",y2:"18"}),c.jsx("path",{d:"M4 6h1v4"}),c.jsx("path",{d:"M4 10h2"}),c.jsx("path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1"})]}),dB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21H7Z"}),c.jsx("path",{d:"m5 12 5 5"}),c.jsx("path",{d:"m22 11-5-5"})]}),hB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("rect",{x:"1",y:"3",width:"15",height:"13"}),c.jsx("polygon",{points:"16 8 20 8 23 11 23 16 16 16 16 8"}),c.jsx("circle",{cx:"5.5",cy:"18.5",r:"2.5"}),c.jsx("circle",{cx:"18.5",cy:"18.5",r:"2.5"})]}),Ig=({className:n})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:c.jsx("polyline",{points:"20 6 9 17 4 12"})}),fB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("polyline",{points:"9 11 12 14 22 4"}),c.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})]}),df=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("circle",{cx:"9",cy:"12",r:"1"}),c.jsx("circle",{cx:"9",cy:"5",r:"1"}),c.jsx("circle",{cx:"9",cy:"19",r:"1"}),c.jsx("circle",{cx:"15",cy:"12",r:"1"}),c.jsx("circle",{cx:"15",cy:"5",r:"1"}),c.jsx("circle",{cx:"15",cy:"19",r:"1"})]}),W_=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"m20 18-3-3-3 3"}),c.jsx("path",{d:"m17 15-3-3 3-3"}),c.jsx("path",{d:"M2 18v-4a4 4 0 0 1 4-4h4"}),c.jsx("path",{d:"M2 6v4a4 4 0 0 0 4 4h4"})]}),WR=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),c.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),mB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"}),c.jsx("path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0"}),c.jsx("path",{d:"M20 17a3 3 0 0 0-3-3"}),c.jsx("path",{d:"M4 17a3 3 0 0 1 3-3"})]}),YR=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("polyline",{points:"4 17 10 11 4 5"}),c.jsx("line",{x1:"12",y1:"19",x2:"20",y2:"19"})]}),Y_=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M7 10v12"}),c.jsx("path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a2 2 0 0 1 1.79 1.11L15 5.88Z"})]}),pB=({className:n})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:c.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),gB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),c.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),yB=({className:n})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:c.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),xB=({className:n})=>c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:c.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),vB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"}),c.jsx("path",{d:"M9 18h6"}),c.jsx("path",{d:"M10 22h4"})]}),_B=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),c.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]}),bB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("path",{d:"M18.37 2.63 14 7l-1.59-1.59a2 2 0 0 0-2.82 0L8 7l9 9 1.59-1.59a2 2 0 0 0 0-2.82L17 10l4.37-4.37a2.12 2.12 0 1 0-3-3Z"}),c.jsx("path",{d:"M9 8c-2 3-4 3.5-7 4l8 10c2-1 6-5 6-7"}),c.jsx("path",{d:"M14.5 17.5 4.5 7.5"})]}),wB=({className:n})=>c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[c.jsx("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),c.jsx("polyline",{points:"17 6 23 6 23 12"})]}),sn=({isOpen:n,onClose:e,title:t,children:s})=>n?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center",onClick:e,children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl m-4 flex flex-col max-h-[90vh]",onClick:i=>i.stopPropagation(),children:[c.jsxs("div",{className:"p-4 border-b border-slate-200 flex justify-between items-center flex-shrink-0",children:[c.jsx("h2",{className:"text-xl font-semibold text-slate-700",children:t}),c.jsx("button",{onClick:e,className:"text-slate-400 hover:text-slate-600",children:c.jsx(fn,{className:"w-6 h-6"})})]}),c.jsx("div",{className:"p-6 overflow-y-auto",children:s})]})}):null,XR=({isOpen:n,onClose:e,onConfirm:t,deal:s})=>{const{tags:i,addTag:o}=Ue(),[u,h]=S.useState([]),[f,p]=S.useState(""),[x,v]=S.useState("bg-gray-500");S.useEffect(()=>{n&&s&&h(s.tagIds||[])},[n,s]);const b=S.useMemo(()=>u.map(P=>i.find(V=>V.id===P)).filter(Boolean),[u,i]),I=S.useMemo(()=>i.filter(P=>!u.includes(P.id)),[i,u]),N=P=>{P&&h(V=>[...V,P])},E=P=>{h(V=>V.filter(F=>F!==P))},A=async()=>{if(!f.trim())return;const P=await o({name:f.trim(),color:x});N(P.id),p(""),v("bg-gray-500")},C=()=>{t(u)},q=["bg-red-500","bg-yellow-500","bg-green-500","bg-blue-500","bg-indigo-500","bg-purple-500","bg-pink-500","bg-gray-500"];return c.jsx(sn,{isOpen:n,onClose:e,title:"Assign Production Tags",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("p",{className:"text-sm text-slate-600",children:["To move deal ",c.jsx("span",{className:"font-semibold",children:s.title})," to Production, you must assign at least one tag."]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-md font-semibold text-slate-700 mb-2",children:"Assigned Tags"}),c.jsxs("div",{className:"flex flex-wrap gap-2 min-h-[30px] p-2 bg-slate-50 rounded-md",children:[b.map(P=>c.jsxs("span",{className:`text-xs font-semibold text-white px-2 py-1 rounded-full flex items-center ${P.color}`,children:[P.name,c.jsx("button",{onClick:()=>E(P.id),className:"ml-1.5 -mr-0.5 text-white/70 hover:text-white",children:c.jsx(fn,{className:"w-3 h-3"})})]},P.id)),b.length===0&&c.jsx("p",{className:"text-xs text-slate-400",children:"No tags selected."})]})]}),c.jsxs("div",{className:"mt-4 pt-4 border-t",children:[c.jsxs("div",{className:"mb-2",children:[c.jsx("label",{className:"text-sm font-medium text-slate-600 block mb-1",children:"Add existing tag"}),c.jsxs("select",{onChange:P=>N(P.target.value),className:"block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-sm",value:"",children:[c.jsx("option",{value:"",children:"Select a tag..."}),I.map(P=>c.jsx("option",{value:P.id,children:P.name},P.id))]})]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"text-sm font-medium text-slate-600 block mb-1",children:"Or create a new one"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"text",placeholder:"New tag name",value:f,onChange:P=>p(P.target.value),className:"flex-grow px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-sm"}),c.jsx("button",{onClick:A,className:"bg-blue-600 text-white px-3 py-2 rounded-lg text-sm font-semibold",children:"+"})]}),c.jsx("div",{className:"flex gap-2 mt-2",children:q.map(P=>c.jsx("button",{type:"button",onClick:()=>v(P),className:`w-6 h-6 rounded-full ${P} ${x===P?"ring-2 ring-offset-1 ring-blue-500":""}`},P))})]})]}),c.jsxs("div",{className:"flex justify-between items-center pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsx("button",{onClick:C,disabled:u.length===0,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed",children:"Confirm"})]})]})})},hf=()=>{const{deals:n,contacts:e,showContactDetail:t}=Ue(),[s,i]=S.useState(""),[o,u]=S.useState(!1),h=Xi(),f=S.useRef(null),p=S.useMemo(()=>{if(s.length<2)return{deals:[],contacts:[]};const N=s.toLowerCase(),E=e.filter(P=>`${P.firstName} ${P.lastName}`.toLowerCase().includes(N)||P.email&&P.email.toLowerCase().includes(N)||P.phone&&P.phone.includes(N)),A=new Set(E.map(P=>P.id)),C=n.filter(P=>P.title.toLowerCase().includes(N)||P.contactIds.some(V=>A.has(V)));return{deals:Array.from(new Map(C.map(P=>[P.id,P])).values()).slice(0,5),contacts:E.slice(0,5)}},[s,n,e]);S.useEffect(()=>{const N=E=>{f.current&&!f.current.contains(E.target)&&u(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]);const x=N=>{h(`/deals/${N}`),i(""),u(!1)},v=N=>{t(N),i(""),u(!1)},b=o&&s.length>=2,I=p.deals.length>0||p.contacts.length>0;return c.jsxs("div",{className:"relative w-full max-w-lg",ref:f,children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:c.jsx(rB,{className:"h-5 w-5 text-slate-400"})}),c.jsx("input",{type:"text",placeholder:"Search deals or contacts...",value:s,onChange:N=>i(N.target.value),onFocus:()=>u(!0),className:"block w-full rounded-md border-slate-300 bg-white py-2 pl-10 pr-3 text-sm placeholder:text-slate-400 focus:border-blue-500 focus:ring-blue-500"})]}),b&&c.jsx("div",{className:"absolute z-10 mt-2 w-full origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:c.jsx("div",{className:"py-1",children:I?c.jsxs(c.Fragment,{children:[p.deals.length>0&&c.jsxs("div",{children:[c.jsx("h3",{className:"px-4 py-2 text-xs font-semibold text-slate-500 uppercase",children:"Deals"}),p.deals.map(N=>c.jsxs("button",{onClick:()=>x(N.id),className:"w-full text-left flex items-center px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:[c.jsx(Eg,{className:"w-4 h-4 mr-3 text-slate-400"}),N.title]},N.id))]}),p.contacts.length>0&&c.jsxs("div",{children:[c.jsx("h3",{className:"px-4 py-2 text-xs font-semibold text-slate-500 uppercase",children:"Contacts"}),p.contacts.map(N=>c.jsxs("button",{onClick:()=>v(N.id),className:"w-full text-left flex items-center px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:[c.jsx(Rr,{className:"w-4 h-4 mr-3 text-slate-400"}),N.firstName," ",N.lastName]},N.id))]})]}):c.jsxs("div",{className:"px-4 py-3 text-sm text-center text-slate-500",children:['No results found for "',s,'".']})})})]})},Nu=({value:n,onChange:e,children:t,className:s})=>{const i=S.useRef(null),o=()=>{if(i.current)try{i.current.showPicker()}catch(u){console.error("showPicker() is not supported by this browser.",u)}};return c.jsxs("div",{onClick:o,className:`cursor-pointer ${s||""}`,role:"button",tabIndex:0,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&o()},children:[t,c.jsx("input",{ref:i,type:"date",value:n,onChange:u=>e(u.target.value),className:"sr-only","aria-label":"Select date",tabIndex:-1})]})},JR=({isOpen:n,onClose:e,deal:t})=>{const{updateDeal:s}=Ue(),[i,o]=S.useState(""),u=S.useMemo(()=>Qi(new Date,5).toISOString().split("T")[0],[]),h=S.useMemo(()=>Qi(new Date,10).toISOString().split("T")[0],[]);if(S.useEffect(()=>{if(n){const I=t?.deliveryDate?t.deliveryDate.split("T")[0]:u;o(I)}},[t,n,u]),!t)return null;const f=()=>{if(!i){alert("Please select a delivery date.");return}s(t.id,()=>({deliveryDate:i})),e()},p=I=>`px-3 py-2 rounded-md text-sm font-semibold transition-colors border ${I?"bg-blue-600 text-white border-blue-700":"bg-white text-slate-700 border-slate-300 hover:bg-slate-100"}`,x=i===u,v=i===h,b=!!i&&!x&&!v;return c.jsx(sn,{isOpen:n,onClose:e,title:"Establecer fecha de entrega",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("p",{className:"text-sm text-slate-600",children:["Establece la fecha de entrega para el deal ",c.jsx("span",{className:"font-semibold",children:t.title}),"."]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Fecha de entrega"}),c.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[c.jsx("button",{type:"button",onClick:()=>o(u),className:p(x),children:"1 Semana"}),c.jsx("button",{type:"button",onClick:()=>o(h),className:p(v),children:"10 das"}),c.jsx(Nu,{value:i,onChange:o,children:c.jsx("div",{className:p(b),children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Dr,{className:`w-4 h-4 ${b?"":"text-slate-500"}`}),c.jsx("span",{children:"Elegir fecha"})]})})}),i&&c.jsxs("p",{className:"text-sm text-slate-500 ml-2",children:["Seleccionada: ",$n(i)]})]})]}),c.jsxs("div",{className:"flex justify-end pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"mr-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancelar"}),c.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700",children:"Guardar"})]})]})})},TB={Nuevos:"border-t-slate-400",Contactados:"border-t-blue-400","En revisin":"border-t-yellow-400",Aprobado:"border-t-cyan-400","Compra de material":"border-t-orange-400","En camino":"border-t-lime-400",Produccin:"border-t-indigo-400","Taller externo":"border-t-violet-400","Listo en local":"border-t-purple-400","Espera de pago":"border-t-pink-400","Listo para entrega":"border-t-teal-400",Ganado:"border-t-green-400",Perdido:"border-t-red-400 bg-slate-900"},EB=({deal:n,stageName:e,isReorderEnabled:t,onReorder:s})=>{const{getContactById:i,getUserById:o}=Ue(),u=Xi(),[h,f]=S.useState(!1),p=n.contactIds.length>0?i(n.contactIds[0]):void 0,x=n.assignedUserId?o(n.assignedUserId):void 0,v=new Date;v.setHours(0,0,0,0);const b=n.deliveryDate?new Date(n.deliveryDate+"T00:00:00"):null,I=b&&b<v&&e!=="Ganado"&&e!=="Perdido",N=P=>{P.dataTransfer.setData("dealId",n.id)},E=()=>{u(`/deals/${n.id}`)},A=P=>{t&&(P.preventDefault(),f(!0))},C=()=>{f(!1)},q=P=>{if(!t)return;P.preventDefault(),P.stopPropagation();const V=P.dataTransfer.getData("dealId");V&&V!==n.id&&s(V,n.id),f(!1)};return c.jsxs("div",{onClick:E,draggable:!0,onDragStart:N,onDragOver:A,onDragLeave:C,onDrop:q,className:`bg-white p-4 rounded-lg shadow-sm mb-3 cursor-pointer active:cursor-grabbing border-t-4 ${TB[e]||"border-t-gray-400"} ${h?"ring-2 ring-blue-500 ring-inset":""}`,children:[c.jsx("h4",{className:`font-bold ${e==="Perdido"?"text-slate-400":"text-slate-800"}`,children:n.title}),c.jsxs("div",{className:"mt-2 space-y-2",children:[p&&c.jsxs("p",{className:`text-sm flex items-center ${e==="Perdido"?"text-slate-500":"text-slate-600"}`,children:[c.jsx(Rr,{className:"w-4 h-4 mr-2 text-slate-400"}),p.firstName," ",p.lastName,n.contactIds.length>1&&` +${n.contactIds.length-1}`]}),x&&c.jsxs("div",{className:"flex items-center text-sm text-slate-600",children:[c.jsx("span",{className:"bg-slate-200 text-slate-600 rounded-full h-5 w-5 flex items-center justify-center text-xs font-bold mr-2",children:x.name.charAt(0)}),c.jsx("span",{children:x.name})]}),n.deliveryDate&&c.jsxs("div",{className:`text-sm flex items-center ${I?"text-red-600 font-semibold":"text-slate-500"}`,children:[c.jsx(Dr,{className:"w-4 h-4 mr-2"}),$n(n.deliveryDate)]})]})]})},IB=({stage:n,deals:e,onDropDeal:t,isCollapsed:s,onToggleCollapse:i,isReorderEnabled:o,onReorder:u})=>{const[h,f]=S.useState(!1),p=I=>{I.preventDefault(),f(!0)},x=()=>f(!1),v=I=>{I.preventDefault();const N=I.dataTransfer.getData("dealId");N&&t(N,n.id),f(!1)},b=()=>s?c.jsx("div",{onClick:i,className:"flex flex-col items-center justify-start h-full py-4 cursor-pointer",children:c.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[c.jsx("h3",{style:{writingMode:"vertical-rl"},className:"transform rotate-180 font-semibold text-slate-700 whitespace-nowrap select-none",children:n.name}),c.jsx("span",{className:"text-sm bg-slate-200 text-slate-600 font-medium px-2 py-1 rounded-full",children:e.length})]})}):c.jsxs("div",{className:"flex justify-between items-center mb-4 flex-shrink-0",children:[c.jsxs("button",{onClick:i,className:"flex items-center gap-2 text-slate-700 font-semibold hover:text-blue-600 w-full text-left truncate",children:[n.name,c.jsx(GR,{className:"w-4 h-4 transition-transform duration-200"})]}),c.jsx("span",{className:"text-sm bg-slate-200 text-slate-600 font-medium px-2 py-1 rounded-full",children:e.length})]});return c.jsx("div",{className:`flex-shrink-0 transition-all duration-300 ${s?"w-16":"w-80"}`,children:c.jsxs("div",{onDragOver:p,onDrop:v,onDragLeave:x,className:`rounded-lg p-2 h-full flex flex-col transition-colors ${h?"bg-slate-200":"bg-transparent"} ${n.name==="Perdido"?"bg-black/5":""}`,children:[c.jsx(b,{}),!s&&c.jsx("div",{className:"overflow-y-auto h-full min-h-[50vh] px-1",children:e.map(I=>c.jsx(EB,{deal:I,stageName:n.name,isReorderEnabled:o,onReorder:u},I.id))})]})})},SB=()=>{const{deals:n,updateDeal:e,getDealById:t,reorderDeal:s,showAddDeal:i,pipelineStages:o,getStageById:u}=Ue(),[h,f]=S.useState(null),[p,x]=S.useState(!1),[v,b]=S.useState(null),[I,N]=S.useState("createdAt-desc"),[E,A]=S.useState(new Set),C=v?t(v):null;S.useEffect(()=>{if(o.length>0){const F=o.filter(K=>K.name==="Ganado"||K.name==="Perdido").map(K=>K.id);A(new Set(F))}},[o]);const q=S.useMemo(()=>{const F=[...n];if(I==="manual")return F.sort((k,D)=>k.sortIndex-D.sortIndex);const[K,L]=I.split("-");return F.sort((k,D)=>{const M=k[K]?new Date(k[K]).getTime():L==="asc"?1/0:-1/0,B=D[K]?new Date(D[K]).getTime():L==="asc"?1/0:-1/0;return M<B?L==="asc"?-1:1:M>B?L==="asc"?1:-1:0})},[n,I]),P=(F,K)=>{const L=t(F);if(!L||L.stageId===K)return;const k=u(K);k&&(k.name==="Produccin"?f(L):e(F,()=>({stageId:K})),k.name==="Compra de material"&&(b(F),x(!0)))},V=F=>{A(K=>{const L=new Set(K);return L.has(F)?L.delete(F):L.add(F),L})};return c.jsxs("div",{className:"flex flex-col h-full bg-slate-100",children:[h&&c.jsx(XR,{isOpen:!!h,onClose:()=>f(null),onConfirm:F=>{const K=o.find(L=>L.name==="Produccin");K&&e(h.id,()=>({stageId:K.id,tagIds:F})),f(null)},deal:h}),C&&c.jsx(JR,{isOpen:p,onClose:()=>{x(!1),b(null)},deal:C}),c.jsxs("header",{className:"flex-shrink-0 p-8 pb-4 space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h2",{className:"text-3xl font-bold text-slate-800",children:"Deal Pipeline"}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{htmlFor:"sort-deals",className:"text-sm font-medium text-slate-600",children:"Sort by:"}),c.jsxs("select",{id:"sort-deals",value:I,onChange:F=>N(F.target.value),className:"block px-3 py-1.5 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm",children:[c.jsx("option",{value:"createdAt-desc",children:"Creation Date (Newest first)"}),c.jsx("option",{value:"createdAt-asc",children:"Creation Date (Oldest first)"}),c.jsx("option",{value:"deliveryDate-asc",children:"Delivery Date (Soonest first)"}),c.jsx("option",{value:"deliveryDate-desc",children:"Delivery Date (Latest first)"}),c.jsx("option",{value:"manual",children:"Manual"})]})]}),c.jsxs("button",{onClick:()=>i(),className:"flex items-center bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors",children:[c.jsx(fs,{className:"w-5 h-5 mr-2"}),"Add Deal"]})]})]}),c.jsx(hf,{})]}),c.jsx("div",{className:"flex-1 overflow-x-auto px-8 pb-4",children:c.jsx("div",{className:"inline-flex space-x-4 h-full",children:o.map(F=>c.jsx(IB,{stage:F,deals:q.filter(K=>K.stageId===F.id),onDropDeal:P,isCollapsed:E.has(F.id),onToggleCollapse:()=>V(F.id),isReorderEnabled:I==="manual",onReorder:s},F.id))})})]})},NB=({isOpen:n,onClose:e,contactsToMerge:t})=>{const{mergeContacts:s,deals:i}=Ue(),[o,u]=S.useState(""),[h,f]=S.useState({}),[p,x]=S.useState(!1);S.useEffect(()=>{if(t&&t.length>0){const C=[...t].sort((q,P)=>new Date(P.createdAt).getTime()-new Date(q.createdAt).getTime())[0];u(C.id),f(C)}else u(""),f({})},[t,n]);const v=S.useMemo(()=>{if(!t)return[];const A=new Set(t.map(C=>C.id));return i.filter(C=>C.contactIds.some(q=>A.has(q)))},[t,i]),b=(A,C)=>{f(q=>({...q,[A]:C}))},I=async()=>{if(!(!o||!t)){x(!0);try{const A=t.map(P=>P.id).filter(P=>P!==o),{id:C,...q}=h;await s(o,q,A),e()}catch(A){console.error("Failed to merge contacts:",A),alert("An error occurred while merging contacts. Please check the console and try again.")}finally{x(!1)}}};if(!t||t.length<2)return null;const N=["firstName","lastName","email","email2","phone","company","googleDriveFolderUrl"],E={firstName:"First Name",lastName:"Last Name",email:"Email",email2:"Secondary Email",phone:"Phone",company:"Company",googleDriveFolderUrl:"Google Drive URL"};return c.jsx(sn,{isOpen:n,onClose:e,title:"Merge Duplicate Contacts",children:c.jsxs("div",{className:"space-y-6",children:[c.jsx("p",{className:"text-sm text-slate-600",children:"Review the duplicate contacts below. Select the master record that will be kept, and choose which information to retain for each field. All associated deals and notes will be moved to the master contact."}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[c.jsx("thead",{className:"bg-slate-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Field"}),t.map(A=>c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"radio",name:"master-contact",value:A.id,checked:o===A.id,onChange:()=>u(A.id),className:"h-4 w-4 text-blue-600 border-slate-300 focus:ring-blue-500"}),c.jsx("span",{className:"ml-2",children:"Master"})]})},A.id))]})}),c.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:N.map(A=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-semibold text-slate-700",children:E[A]}),t.map(C=>c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-slate-600",children:c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"radio",name:A,checked:h[A]===C[A],onChange:()=>b(A,C[A]),className:"h-4 w-4 text-blue-600 border-slate-300 focus:ring-blue-500"}),c.jsx("span",{className:"ml-2 truncate",title:C[A]||"",children:C[A]||c.jsx("i",{className:"text-slate-400",children:"empty"})})]})},C.id))]},A))})]})}),v.length>0&&c.jsxs("div",{children:[c.jsxs("h4",{className:"text-md font-semibold text-slate-700 mb-2 flex items-center",children:[c.jsx(Eg,{className:"w-5 h-5 mr-2 text-slate-500"}),"Associated Deals to be Merged (",v.length,")"]}),c.jsx("div",{className:"border rounded-lg max-h-32 overflow-y-auto p-2 bg-slate-50 space-y-1",children:v.map(A=>c.jsx("div",{className:"text-sm text-slate-600",children:A.title},A.id))})]}),c.jsxs("div",{className:"flex justify-end pt-4 gap-2",children:[c.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsxs("button",{type:"button",onClick:I,disabled:p,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 disabled:bg-blue-400",children:[c.jsx(W_,{className:"w-5 h-5 mr-2"}),p?"Merging...":"Merge Contacts"]})]})]})})},AB=[{value:"firstName",label:"First Name"},{value:"lastName",label:"Last Name"},{value:"email",label:"Email"},{value:"company",label:"Company"},{value:"contactTagIds",label:"Contact Tags"}],zS={firstName:[{value:"contains",label:"contains"},{value:"not_contains",label:"does not contain"},{value:"is",label:"is"},{value:"is_not",label:"is not"}],lastName:[{value:"contains",label:"contains"},{value:"not_contains",label:"does not contain"},{value:"is",label:"is"},{value:"is_not",label:"is not"}],email:[{value:"contains",label:"contains"},{value:"not_contains",label:"does not contain"}],company:[{value:"contains",label:"contains"},{value:"not_contains",label:"does not contain"},{value:"is",label:"is"},{value:"is_not",label:"is not"}],contactTagIds:[{value:"has_tag",label:"has tag"},{value:"not_has_tag",label:"does not have tag"}]},RB=({isOpen:n,onClose:e,listToEdit:t})=>{const{addDynamicList:s,updateDynamicList:i,contactTags:o}=Ue(),[u,h]=S.useState(""),[f,p]=S.useState([]),[x,v]=S.useState([]);S.useEffect(()=>{t?(h(t.name),p(t.assignedTagIds),v(t.rules)):(h(""),p([]),v([{field:"email",operator:"contains",value:""}]))},[t,n]);const b=()=>{v(V=>[...V,{field:"email",operator:"contains",value:""}])},I=V=>{v(F=>F.filter((K,L)=>L!==V))},N=(V,F,K)=>{const L=[...x],k=L[V];if(L[V]={...k,[F]:K},F==="field"){const M=zS[K];M.find(B=>B.value===k.operator)||(L[V].operator=M[0].value,L[V].value="")}v(L)},E=S.useMemo(()=>f.map(V=>o.find(F=>F.id===V)).filter(Boolean),[f,o]),A=S.useMemo(()=>o.filter(V=>!f.includes(V.id)),[f,o]),C=V=>{V&&!f.includes(V)&&p(F=>[...F,V])},q=V=>{p(F=>F.filter(K=>K!==V))},P=async V=>{if(V.preventDefault(),!u.trim()||x.some(K=>!K.value.trim())){alert("Please provide a name for the list and ensure all rule values are filled in.");return}const F={name:u,assignedTagIds:f,rules:x};t?await i({...F,id:t.id}):await s(F),e()};return c.jsx(sn,{isOpen:n,onClose:e,title:t?"Edit Dynamic List":"Create Dynamic List",children:c.jsxs("form",{onSubmit:P,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"list-name",className:"block text-sm font-medium text-slate-700",children:"List Name"}),c.jsx("input",{type:"text",id:"list-name",value:u,onChange:V=>h(V.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Automatically apply these tags"}),c.jsx("div",{className:"mt-2 p-2 min-h-[40px] bg-slate-50 border rounded-md flex flex-wrap gap-2",children:E.map(V=>c.jsxs("span",{className:`text-xs font-semibold text-white px-2 py-1 rounded-full flex items-center ${V.color}`,children:[V.name,c.jsx("button",{type:"button",onClick:()=>q(V.id),className:"ml-1.5 -mr-0.5 text-white/70 hover:text-white",children:c.jsx(fn,{className:"w-3 h-3"})})]},V.id))}),c.jsxs("select",{onChange:V=>{C(V.target.value),V.target.value=""},value:"",className:"mt-2 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-sm",children:[c.jsx("option",{value:"",children:"Add a tag..."}),A.map(V=>c.jsx("option",{value:V.id,children:V.name},V.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Rules"}),c.jsx("p",{className:"text-xs text-slate-500",children:"Contacts must match ALL of these rules to be in the list."}),c.jsx("div",{className:"mt-2 space-y-3",children:x.map((V,F)=>c.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 p-2 rounded-md",children:[c.jsx("select",{value:V.field,onChange:K=>N(F,"field",K.target.value),className:"block w-1/4 px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-sm",children:AB.map(K=>c.jsx("option",{value:K.value,children:K.label},K.value))}),c.jsx("select",{value:V.operator,onChange:K=>N(F,"operator",K.target.value),className:"block w-1/4 px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-sm",children:zS[V.field].map(K=>c.jsx("option",{value:K.value,children:K.label},K.value))}),V.field==="contactTagIds"?c.jsxs("select",{value:V.value,onChange:K=>N(F,"value",K.target.value),className:"block w-2/4 px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-sm",children:[c.jsx("option",{value:"",children:"Select a tag..."}),o.map(K=>c.jsx("option",{value:K.id,children:K.name},K.id))]}):c.jsx("input",{type:"text",value:V.value,onChange:K=>N(F,"value",K.target.value),className:"block w-2/4 px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-sm"}),c.jsx("button",{type:"button",onClick:()=>I(F),className:"text-red-500 hover:text-red-700 disabled:opacity-50",disabled:x.length<=1,children:c.jsx(In,{className:"w-5 h-5"})})]},F))}),c.jsxs("button",{type:"button",onClick:b,className:"mt-3 flex items-center text-sm font-semibold text-blue-600 hover:text-blue-800",children:[c.jsx(fs,{className:"w-4 h-4 mr-1"})," Add another rule"]})]}),c.jsxs("div",{className:"flex justify-end pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"mr-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700",children:t?"Save Changes":"Create List"})]})]})})},CB=({isOpen:n,onClose:e,selectedContactIds:t})=>{const{contactTags:s,bulkUpdateContacts:i}=Ue(),[o,u]=S.useState([]),[h,f]=S.useState([]),p=S.useMemo(()=>s.filter(E=>!o.includes(E.id)),[s,o]),x=S.useMemo(()=>s.filter(E=>!h.includes(E.id)),[s,h]),v=(E,A)=>{E&&(A==="add"?o.includes(E)||u(C=>[...C,E]):h.includes(E)||f(C=>[...C,E]))},b=(E,A)=>{A==="add"?u(C=>C.filter(q=>q!==E)):f(C=>C.filter(q=>q!==E))},I=async()=>{await i(t,{addTagIds:o,removeTagIds:h}),e(),u([]),f([])},N=({label:E,selectedTagIds:A,availableTags:C,onAdd:q,onRemove:P})=>{const V=A.map(F=>s.find(K=>K.id===F)).filter(Boolean);return c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700",children:E}),c.jsx("div",{className:"mt-2 p-2 min-h-[40px] bg-slate-50 border rounded-md flex flex-wrap gap-2",children:V.map(F=>c.jsxs("span",{className:`text-xs font-semibold text-white px-2 py-1 rounded-full flex items-center ${F.color}`,children:[F.name,c.jsx("button",{type:"button",onClick:()=>P(F.id),className:"ml-1.5 -mr-0.5 text-white/70 hover:text-white",children:c.jsx(fn,{className:"w-3 h-3"})})]},F.id))}),c.jsxs("select",{onChange:F=>{q(F.target.value),F.target.value=""},value:"",className:"mt-2 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-sm",children:[c.jsx("option",{value:"",children:"Select a tag..."}),C.map(F=>c.jsx("option",{value:F.id,children:F.name},F.id))]})]})};return c.jsx(sn,{isOpen:n,onClose:e,title:`Bulk Edit ${t.length} Contacts`,children:c.jsxs("div",{className:"space-y-6",children:[c.jsx("p",{className:"text-sm text-slate-600",children:"The changes you make here will be applied to all selected contacts. This will not affect any tags that were applied manually or by other lists."}),c.jsx(N,{label:"Add these tags",selectedTagIds:o,availableTags:p,onAdd:E=>v(E,"add"),onRemove:E=>b(E,"add")}),c.jsx(N,{label:"Remove these tags",selectedTagIds:h,availableTags:x,onAdd:E=>v(E,"remove"),onRemove:E=>b(E,"remove")}),c.jsxs("div",{className:"flex justify-end pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"mr-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700",children:"Apply Changes"})]})]})})},DB=({onMerge:n})=>{const{contacts:e}=Ue(),t=S.useMemo(()=>{const s=new Map;return e.forEach(i=>{if(i.email){const o=i.email.toLowerCase().trim();o&&(s.has(o)||s.set(o,[]),s.get(o).push(i))}if(i.phone){const o=i.phone.replace(/\D/g,"");o&&(s.has(o)||s.set(o,[]),s.get(o).push(i))}}),Array.from(s.values()).filter(i=>i.length>1).filter((i,o,u)=>o===u.findIndex(h=>{const f=new Set(h.map(x=>x.id)),p=new Set(i.map(x=>x.id));return f.size===p.size&&[...f].every(x=>p.has(x))}))},[e]);return t.length===0?c.jsx("div",{className:"text-center p-8 bg-green-50 text-green-700 rounded-lg",children:c.jsx("p",{children:"No potential duplicates found. Great job!"})}):c.jsx("div",{className:"space-y-6",children:t.map((s,i)=>c.jsxs("div",{className:"bg-white shadow-md rounded-lg p-4",children:[c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsxs("h3",{className:"font-semibold text-slate-800",children:["Potential Duplicate Group ",i+1]}),c.jsxs("button",{onClick:()=>n(s),className:"flex items-center bg-blue-600 text-white px-3 py-1.5 rounded-md text-sm font-semibold hover:bg-blue-700",children:[c.jsx(W_,{className:"w-4 h-4 mr-2"}),"Merge"]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(o=>c.jsxs("div",{className:"bg-slate-50 p-3 rounded-md border",children:[c.jsxs("p",{className:"font-bold",children:[o.firstName," ",o.lastName]}),c.jsx("p",{className:"text-sm text-slate-600",children:o.company}),c.jsx("p",{className:"text-sm text-slate-600",children:o.email}),c.jsx("p",{className:"text-sm text-slate-600",children:o.phone})]},o.id))})]},i))})},kB=({onEditList:n,onViewList:e})=>{const{contacts:t,dynamicLists:s,deleteDynamicList:i,showConfirmation:o,contactTags:u}=Ue(),h=(x,v)=>v.rules.every(b=>{const I=x[b.field],N=b.value;if(b.field==="contactTagIds"){const E=x.contactTagIds||[];if(b.operator==="has_tag")return E.includes(N);if(b.operator==="not_has_tag")return!E.includes(N)}else if(typeof I=="string"){const E=I.toLowerCase(),A=N.toLowerCase();if(b.operator==="contains")return E.includes(A);if(b.operator==="not_contains")return!E.includes(A);if(b.operator==="is")return E===A;if(b.operator==="is_not")return E!==A}return!1}),f=S.useMemo(()=>s.map(x=>({...x,memberCount:t.filter(v=>h(v,x)).length})),[s,t]),p=x=>{o("Are you sure you want to delete this list? This will not delete the contacts, but it will un-assign any tags automatically applied by this list.",()=>i(x))};return s.length===0?c.jsx("div",{className:"text-center p-8 bg-slate-50 text-slate-600 rounded-lg",children:c.jsx("p",{children:"No dynamic lists created yet. Create one to get started!"})}):c.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[c.jsx("thead",{className:"bg-slate-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"List Name"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Members"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Tags Applied"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:f.map(x=>{const v=x.assignedTagIds.map(b=>u.find(I=>I.id===b)).filter(Boolean);return c.jsxs("tr",{className:"hover:bg-slate-50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:c.jsx("button",{onClick:()=>e(x),className:"text-blue-600 hover:underline",children:x.name})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:x.memberCount}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:"flex flex-wrap gap-1",children:v.map(b=>c.jsx("span",{className:`text-xs font-semibold text-white px-2 py-0.5 rounded-full ${b.color}`,children:b.name},b.id))})}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium flex items-center gap-4",children:[c.jsx("button",{onClick:()=>n(x),className:"text-blue-600 hover:text-blue-900","aria-label":"Edit List",children:c.jsx(ms,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>p(x.id),className:"text-red-600 hover:text-red-900","aria-label":"Delete List",children:c.jsx(In,{className:"w-5 h-5"})})]})]},x.id)})})]})})},jB=()=>{const{contacts:n,deleteContact:e,bulkDeleteContacts:t,showConfirmation:s,showAddEditContact:i,showContactDetail:o,contactTags:u,dynamicLists:h}=Ue(),[f,p]=S.useState("list"),[x,v]=S.useState(null),[b,I]=S.useState(new Set),[N,E]=S.useState(null),[A,C]=S.useState(!1),[q,P]=S.useState(null),[V,F]=S.useState(!1),[K,L]=S.useState({key:"createdAt",direction:"desc"}),k=[{key:"select",label:"",sortable:!1},{key:"firstName",label:"First Name",sortable:!0},{key:"lastName",label:"Last Name",sortable:!0},{key:"company",label:"Company",sortable:!0},{key:"email",label:"Email",sortable:!1},{key:"email2",label:"Secondary Email",sortable:!1},{key:"phone",label:"Phone",sortable:!1},{key:"contactTags",label:"Contact Tags",sortable:!1},{key:"actions",label:"Actions",sortable:!1}],[D,M]=S.useState(k),B=S.useRef(null),G=S.useRef(null),z=(Ne,Je)=>Je.rules.every(ct=>{const Yt=Ne[ct.field],It=ct.value;if(ct.field==="contactTagIds"){const dt=Ne.contactTagIds||[];if(ct.operator==="has_tag")return dt.includes(It);if(ct.operator==="not_has_tag")return!dt.includes(It)}else if(typeof Yt=="string"){const dt=Yt.toLowerCase(),rn=It.toLowerCase();if(ct.operator==="contains")return dt.includes(rn);if(ct.operator==="not_contains")return!dt.includes(rn);if(ct.operator==="is")return dt===rn;if(ct.operator==="is_not")return dt!==rn}return!1}),he=S.useMemo(()=>{if(!x)return[];const Ne=h.find(Je=>Je.id===x.id);return Ne?n.filter(Je=>z(Je,Ne)):[]},[x,n,h]),Se=x?he:n,J=S.useMemo(()=>{let Ne=[...Se];return K&&Ne.sort((Je,ct)=>{const Yt=Je[K.key]||"",It=ct[K.key]||"";return Yt<It?K.direction==="asc"?-1:1:Yt>It?K.direction==="asc"?1:-1:0}),Ne},[Se,K]),ge=Ne=>{I(Je=>{const ct=new Set(Je);return ct.has(Ne)?ct.delete(Ne):ct.add(Ne),ct})},le=Ne=>{Ne.target.checked?I(new Set(J.map(Je=>Je.id))):I(new Set)},Ie=()=>{s(`Are you sure you want to delete ${b.size} contacts? They will be moved to the archive.`,async()=>{await t(Array.from(b)),I(new Set)})},O=Ne=>{s("Are you sure you want to delete this contact? It will be moved to the archive.",()=>e(Ne))},oe=Ne=>E(Ne),me=()=>{P(null),C(!0)},te=Ne=>{P(Ne),C(!0)},we=Ne=>{v(Ne),p("list"),I(new Set)},Ce=()=>{v(null),I(new Set)},Pe=Ne=>`https://web.whatsapp.com/send?phone=${Ne.replace(/\D/g,"")}`,xt=Ne=>{let Je="asc";K&&K.key===Ne&&K.direction==="asc"&&(Je="desc"),L({key:Ne,direction:Je})},rt=Ne=>!K||K.key!==Ne?"":K.direction==="asc"?" ":" ",Ot=(Ne,Je)=>{B.current=Je},ws=(Ne,Je)=>{G.current=Je},Ts=()=>{if(B.current===null||G.current===null)return;const Ne=["actions","select"];if(Ne.includes(D[B.current].key)||Ne.includes(D[G.current].key))return;const Je=[...D],ct=Je.splice(B.current,1)[0];Je.splice(G.current,0,ct),B.current=null,G.current=null,M(Je)},Es=Ne=>`px-3 py-1.5 text-sm font-semibold rounded-md transition-colors flex items-center gap-2 ${Ne?"bg-blue-600 text-white shadow":"text-slate-600 hover:bg-slate-300"}`,lr=J.length>0&&b.size===J.length;return c.jsxs(c.Fragment,{children:[N&&c.jsx(NB,{isOpen:!!N,onClose:()=>E(null),contactsToMerge:N}),c.jsx(RB,{isOpen:A,onClose:()=>C(!1),listToEdit:q}),c.jsx(CB,{isOpen:V,onClose:()=>F(!1),selectedContactIds:Array.from(b)}),c.jsxs("div",{className:"flex flex-col h-[calc(100vh)] p-8",children:[c.jsxs("div",{className:"flex-shrink-0 pb-6 space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h2",{className:"text-3xl font-bold text-slate-800",children:"Contacts"}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"bg-slate-200 p-1 rounded-lg flex items-center",children:[c.jsx("button",{onClick:()=>{p("list"),Ce()},className:Es(f==="list"),children:"List"}),c.jsxs("button",{onClick:()=>p("lists"),className:Es(f==="lists"),children:[c.jsx(xB,{className:"w-4 h-4"})," Lists"]}),c.jsxs("button",{onClick:()=>p("duplicates"),className:Es(f==="duplicates"),children:[c.jsx(W_,{className:"w-4 h-4"})," Find Duplicates"]})]}),c.jsxs("button",{onClick:f==="lists"?me:()=>i(),className:"flex items-center bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors",children:[c.jsx(fs,{className:"w-5 h-5 mr-2"}),f==="lists"?"Add List":"Add Contact"]})]})]}),c.jsx(hf,{})]}),c.jsxs("div",{className:"flex-grow overflow-auto",children:[f==="list"&&c.jsxs(c.Fragment,{children:[x&&c.jsxs("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm text-slate-600",children:"Viewing list:"}),c.jsx("h3",{className:"font-semibold text-blue-800",children:x.name})]}),c.jsxs("button",{onClick:Ce,className:"flex items-center text-sm font-semibold text-blue-600 hover:underline",children:[c.jsx(Q_,{className:"w-4 h-4 mr-1"})," Back to All Contacts"]})]}),b.size>0&&c.jsxs("div",{className:"bg-blue-100 border border-blue-200 rounded-lg p-3 flex justify-between items-center mb-4 sticky top-0 z-10",children:[c.jsxs("span",{className:"text-sm font-semibold text-blue-800",children:[b.size," contact(s) selected"]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("button",{onClick:()=>F(!0),className:"flex items-center gap-2 text-sm font-semibold text-slate-700 hover:text-blue-600",children:[c.jsx(ms,{className:"w-5 h-5"})," Bulk Edit"]}),c.jsxs("button",{onClick:Ie,className:"flex items-center gap-2 text-sm font-semibold text-red-600 hover:text-red-800",children:[c.jsx(In,{className:"w-5 h-5"})," Delete"]}),c.jsx("button",{onClick:()=>I(new Set),className:"text-slate-500 hover:text-slate-700",children:c.jsx(fn,{className:"w-5 h-5"})})]})]}),c.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[c.jsx("thead",{className:"bg-slate-50",children:c.jsx("tr",{children:D.map((Ne,Je)=>c.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider ${Ne.sortable?"cursor-pointer hover:bg-slate-100":""}`,onClick:()=>Ne.sortable&&xt(Ne.key),draggable:Ne.key!=="actions"&&Ne.key!=="select",onDragStart:ct=>Ot(ct,Je),onDragEnter:ct=>ws(ct,Je),onDragEnd:Ts,onDragOver:ct=>ct.preventDefault(),children:Ne.key==="select"?c.jsx("input",{type:"checkbox",onChange:le,checked:lr,className:"h-4 w-4 rounded border-slate-300 accent-blue-600"}):c.jsxs(c.Fragment,{children:[Ne.label,Ne.sortable&&rt(Ne.key)]})},Ne.key))})}),c.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:J.map(Ne=>c.jsx("tr",{className:`hover:bg-slate-50 ${b.has(Ne.id)?"bg-blue-50":""}`,children:D.map(Je=>{const ct=()=>{switch(Je.key){case"select":return c.jsx("input",{type:"checkbox",checked:b.has(Ne.id),onChange:()=>ge(Ne.id),className:"h-4 w-4 rounded border-slate-300 accent-blue-600"});case"firstName":return c.jsx("button",{onClick:()=>o(Ne.id),className:"text-sm font-medium text-slate-900 hover:text-blue-600 text-left",children:Ne.firstName});case"lastName":return c.jsx("div",{className:"text-sm text-slate-800",children:Ne.lastName});case"company":return c.jsx("div",{className:"text-sm text-slate-700",children:Ne.company});case"email":return c.jsx("div",{className:"text-sm text-slate-700",children:Ne.email});case"email2":return c.jsx("div",{className:"text-sm text-slate-700",children:Ne.email2});case"phone":return c.jsxs("div",{className:"text-sm text-slate-500 flex items-center",children:[Ne.phone,c.jsx("a",{href:Pe(Ne.phone),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-green-500 hover:text-green-600",title:"Send WhatsApp message",children:c.jsx(cf,{className:"w-5 h-5"})})]});case"contactTags":const Yt=(Ne.contactTagIds||[]).map(It=>u.find(dt=>dt.id===It)).filter(Boolean);return c.jsx("div",{className:"flex flex-wrap gap-1",children:Yt.map(It=>c.jsx("span",{className:`text-xs font-semibold text-white px-2 py-0.5 rounded-full ${It.color}`,children:It.name},It.id))});case"actions":return c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>i(Ne),className:"text-blue-600 hover:text-blue-900","aria-label":"Edit",children:c.jsx(ms,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>O(Ne.id),className:"text-red-600 hover:text-red-900","aria-label":"Delete",children:c.jsx(In,{className:"w-5 h-5"})})]});default:return null}};return c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ct()},Je.key)})},Ne.id))})]})})]}),f==="duplicates"&&c.jsx(DB,{onMerge:oe}),f==="lists"&&c.jsx(kB,{onEditList:te,onViewList:we})]})]})]})},PB=[{name:"Mexico",code:"+52"},{name:"USA",code:"+1"},{name:"Spain",code:"+34"},{name:"UK",code:"+44"},{name:"Colombia",code:"+57"},{name:"Argentina",code:"+54"},{name:"Peru",code:"+51"},{name:"Chile",code:"+56"}],OB=({onCancel:n,onSave:e})=>{const{addContact:t}=Ue(),[s,i]=S.useState(""),[o,u]=S.useState(""),[h,f]=S.useState(""),[p,x]=S.useState("+52"),[v,b]=S.useState(""),[I,N]=S.useState(""),[E,A]=S.useState(""),C=()=>{i(""),u(""),f(""),x("+52"),b(""),N(""),A("")},q=async P=>{P.preventDefault();const V=s.trim(),F=o.trim(),K=h.replace(/\s/g,""),L=v.replace(/\s/g,""),k=I.trim(),D=E.trim();if(!V&&!F&&!K&&!L&&!k){alert("Please fill out at least one field (First Name, Last Name, Email, Phone, or Company) to create a contact.");return}const M={firstName:V,lastName:F,email:K,phone:`${p}${L}`,company:k,googleDriveFolderUrl:D},B=await t(M);e(B),C()};return c.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg mt-4",children:[c.jsx("h4",{className:"text-md font-semibold text-slate-700 mb-3",children:"Create New Contact"}),c.jsxs("form",{onSubmit:q,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"firstName-new",className:"block text-sm font-medium text-slate-700",children:"First Name"}),c.jsx("input",{type:"text",id:"firstName-new",value:s,onChange:P=>i(P.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"lastName-new",className:"block text-sm font-medium text-slate-700",children:"Last Name"}),c.jsx("input",{type:"text",id:"lastName-new",value:o,onChange:P=>u(P.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-sm"})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email-new",className:"block text-sm font-medium text-slate-700",children:"Email"}),c.jsx("input",{type:"email",id:"email-new",value:h,onChange:P=>f(P.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"phone-new",className:"block text-sm font-medium text-slate-700",children:"Phone"}),c.jsxs("div",{className:"mt-1 flex rounded-md shadow-sm",children:[c.jsx("select",{value:p,onChange:P=>x(P.target.value),className:"inline-flex items-center px-3 rounded-l-md border border-r-0 border-slate-300 bg-slate-50 text-slate-500 text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500","aria-label":"Country code",children:PB.map(P=>c.jsxs("option",{value:P.code,children:[P.name," (",P.code,")"]},P.code))}),c.jsx("input",{type:"tel",id:"phone-new",placeholder:"Phone number",value:v,onChange:P=>b(P.target.value),className:"flex-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-r-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm"})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"company-new",className:"block text-sm font-medium text-slate-700",children:"Company"}),c.jsx("input",{type:"text",id:"company-new",value:I,onChange:P=>N(P.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-sm"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"googleDriveUrl-new",className:"block text-sm font-medium text-slate-700",children:"Google Drive Folder URL"}),c.jsx("input",{type:"url",id:"googleDriveUrl-new",value:E,onChange:P=>A(P.target.value),placeholder:"https://drive.google.com/...",className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-sm"})]}),c.jsxs("div",{className:"flex justify-end pt-2 gap-2",children:[c.jsx("button",{type:"button",onClick:n,className:"px-3 py-1.5 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsx("button",{type:"submit",className:"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700",children:"Create & Add"})]})]})]})},MB=({isOpen:n,onClose:e,deal:t})=>{const{contacts:s,getContactById:i,updateDeal:o}=Ue(),[u,h]=S.useState(""),[f,p]=S.useState(!1),x=S.useMemo(()=>t.contactIds.map(E=>i(E)).filter(Boolean),[t.contactIds,i]),v=S.useMemo(()=>s.filter(E=>!t.contactIds.includes(E.id)&&`${E.firstName} ${E.lastName} ${E.company}`.toLowerCase().includes(u.toLowerCase())),[s,t.contactIds,u]),b=E=>{o(t.id,A=>({...A,contactIds:A.contactIds.filter(C=>C!==E)}))},I=E=>{o(t.id,A=>({...A,contactIds:[...A.contactIds,E]})),h("")},N=E=>{I(E.id),p(!1)};return c.jsx(sn,{isOpen:n,onClose:e,title:`Manage Contacts for "${t.title}"`,children:c.jsxs("div",{className:"flex flex-col",style:{minHeight:"450px"},children:[c.jsxs("div",{className:"flex-grow space-y-6",children:[c.jsxs("div",{children:[c.jsxs("h4",{className:"text-md font-semibold text-slate-700 mb-2",children:["Assigned Contacts (",x.length,")"]}),c.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto pr-2",children:[x.map(E=>c.jsxs("div",{className:"flex justify-between items-center bg-slate-100 p-2 rounded-md",children:[c.jsxs("div",{children:[c.jsxs("p",{className:"font-medium text-slate-800",children:[E.firstName," ",E.lastName]}),c.jsx("p",{className:"text-sm text-slate-500",children:E.company})]}),c.jsx("button",{onClick:()=>b(E.id),className:"text-red-500 hover:text-red-700 p-1",children:c.jsx(In,{className:"w-5 h-5"})})]},E.id)),x.length===0&&c.jsx("p",{className:"text-sm text-slate-500 text-center py-4",children:"No contacts assigned."})]})]}),c.jsx("div",{className:"border-t pt-4",children:f?c.jsx(OB,{onCancel:()=>p(!1),onSave:N}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h4",{className:"text-md font-semibold text-slate-700",children:"Add Contact"}),c.jsxs("button",{onClick:()=>p(!0),className:"flex items-center text-sm font-semibold text-blue-600 hover:text-blue-800",children:[c.jsx(fs,{className:"w-4 h-4 mr-1"})," Create New"]})]}),c.jsxs("div",{className:"mt-2",children:[c.jsx("input",{type:"text",placeholder:"Search existing contacts...",value:u,onChange:E=>h(E.target.value),className:"w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-sm"}),u&&c.jsxs("div",{className:"mt-1 border rounded-md max-h-48 overflow-y-auto",children:[v.map(E=>c.jsxs("div",{onClick:()=>I(E.id),className:"p-2 cursor-pointer hover:bg-slate-100",children:[c.jsxs("p",{className:"font-semibold",children:[E.firstName," ",E.lastName]}),c.jsx("p",{className:"text-sm text-slate-500",children:E.company})]},E.id)),v.length===0&&c.jsx("p",{className:"text-sm text-slate-500 p-3 text-center",children:"No matching contacts found."})]})]})]})})]}),c.jsx("div",{className:"flex-shrink-0 flex justify-end pt-5 mt-5 border-t border-slate-200",children:c.jsx("button",{onClick:e,className:"px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Done"})})]})})},ZR=({dealId:n,className:e,showUserAssignment:t=!1,defaultAssignedUserId:s,onTaskAdded:i,onCancel:o})=>{const{users:u,addTask:h}=Ue(),[f,p]=S.useState("Seguimiento"),[x,v]=S.useState(""),[b,I]=S.useState(s||"");S.useEffect(()=>{I(s||"")},[s]);const N=F=>F.toISOString().split("T")[0],E=N(new Date),A=new Date;A.setDate(A.getDate()+1);const C=N(A),q=N(Qi(new Date,2)),P=async F=>{if(F.preventDefault(),f.trim()!=="")try{await h({title:f,dueDate:x||void 0,dealId:n,responsibleUserId:b||void 0}),p("Seguimiento"),v(""),i&&i()}catch(K){console.error(K)}},V=F=>`px-3 py-2 rounded-md text-sm font-semibold transition-colors border ${F?"bg-blue-600 text-white border-blue-700":"bg-white text-slate-700 border-slate-300 hover:bg-slate-100"}`;return c.jsxs("form",{onSubmit:P,className:`bg-slate-50 border border-slate-200 p-3 rounded-lg ${e}`,children:[c.jsx("div",{children:c.jsx("input",{type:"text",value:f,onChange:F=>p(F.target.value),placeholder:"Add a new task...",className:"w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})}),c.jsxs("div",{className:"flex justify-between items-center mt-3 gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2 flex-wrap flex-grow",children:[c.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase",children:"Due:"}),c.jsx("button",{type:"button",onClick:()=>v(E),className:V(x===E),children:"Hoy"}),c.jsx("button",{type:"button",onClick:()=>v(C),className:V(x===C),children:"Maana"}),c.jsx("button",{type:"button",onClick:()=>v(q),className:V(x===q),children:"En 2 das"}),c.jsx(Nu,{value:x,onChange:v,children:c.jsx("div",{className:V(!!x&&x!==E&&x!==C&&x!==q),children:c.jsx(Dr,{className:"w-4 h-4"})})}),x&&c.jsxs("div",{className:"flex items-center gap-2 text-sm bg-blue-100 text-blue-800 font-medium px-3 py-2 rounded-md",children:[c.jsx("span",{children:$n(x)}),c.jsx("button",{type:"button",onClick:()=>v(""),className:"text-blue-600 hover:text-blue-800",children:c.jsx(fn,{className:"w-4 h-4"})})]})]}),c.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[t&&c.jsxs("div",{className:"relative",style:{minWidth:"150px"},children:[c.jsxs("select",{id:"responsible-user",value:b,onChange:F=>I(F.target.value),className:"appearance-none block w-full pl-3 pr-10 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm",children:[c.jsx("option",{value:"",children:"Assign to..."}),u.map(F=>c.jsx("option",{value:F.id,children:F.name},F.id))]}),c.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-700",children:c.jsx(Rr,{className:"w-5 h-5 text-slate-400"})})]}),o&&c.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 rounded-lg text-sm font-semibold bg-white border border-slate-300 text-slate-700 hover:bg-slate-50 transition-colors",children:"Cancel"}),c.jsxs("button",{type:"submit",className:"flex items-center justify-center bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors font-semibold disabled:bg-blue-400 whitespace-nowrap",disabled:!f.trim(),children:[c.jsx(fs,{className:"w-5 h-5 mr-2"}),"Add Task"]})]})]})]})},eC=({isOpen:n,onClose:e,taskToEdit:t,dealId:s})=>{const{users:i,addTask:o,updateTask:u}=Ue(),[h,f]=S.useState(""),[p,x]=S.useState(""),[v,b]=S.useState(""),I=V=>V.toISOString().split("T")[0],N=I(new Date),E=new Date;E.setDate(E.getDate()+1);const A=I(E),C=I(Qi(new Date,2));S.useEffect(()=>{n&&(t?(f(t.title),x(t.dueDate||""),b(t.responsibleUserId||"")):(f("Seguimiento"),x(""),b("")))},[n,t]);const q=V=>`px-3 py-1.5 rounded-md text-sm font-semibold transition-colors border ${V?"bg-blue-600 text-white border-blue-700":"bg-white text-slate-700 border-slate-300 hover:bg-slate-100"}`,P=async V=>{if(V.preventDefault(),!!h.trim())try{t?await u({...t,title:h,dueDate:p||void 0,responsibleUserId:v||void 0}):await o({title:h,dueDate:p||void 0,responsibleUserId:v||void 0,dealId:s}),e()}catch(F){console.error("Failed to save task:",F)}};return c.jsx(sn,{isOpen:n,onClose:e,title:t?"Edit Task":"Add Task",children:c.jsxs("form",{onSubmit:P,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"task-title",className:"block text-sm font-medium text-slate-700",children:"Title"}),c.jsx("textarea",{id:"task-title",value:h,onChange:V=>f(V.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,rows:3})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Due Date"}),c.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[c.jsx("button",{type:"button",onClick:()=>x(N),className:q(p===N),children:"Hoy"}),c.jsx("button",{type:"button",onClick:()=>x(A),className:q(p===A),children:"Maana"}),c.jsx("button",{type:"button",onClick:()=>x(C),className:q(p===C),children:"En 2 das"}),c.jsx(Nu,{value:p,onChange:x,children:c.jsx("div",{className:q(!!p&&p!==N&&p!==A&&p!==C),children:c.jsx(Dr,{className:"w-4 h-4"})})}),p&&c.jsxs("div",{className:"flex items-center gap-2 text-sm bg-blue-100 text-blue-800 font-medium px-3 py-1.5 rounded-md",children:[c.jsx("span",{children:$n(p)}),c.jsx("button",{type:"button",onClick:()=>x(""),className:"text-blue-600 hover:text-blue-800",children:c.jsx(fn,{className:"w-4 h-4"})})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"responsible-user",className:"block text-sm font-medium text-slate-700",children:"Assign to"}),c.jsxs("div",{className:"relative mt-1",children:[c.jsxs("select",{id:"responsible-user",value:v,onChange:V=>b(V.target.value),className:"appearance-none block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[c.jsx("option",{value:"",children:"Unassigned"}),i.map(V=>c.jsx("option",{value:V.id,children:V.name},V.id))]}),c.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-700",children:c.jsx(Rr,{className:"w-5 h-5 text-slate-400"})})]})]}),c.jsxs("div",{className:"flex justify-end pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"mr-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700",children:t?"Save Changes":"Add Task"})]})]})})},VB=({isOpen:n,onClose:e,deal:t})=>{const{updateDeal:s,pickGoogleDriveFolder:i,isGoogleDriveConnected:o,googleApiReady:u}=Ue(),[h,f]=S.useState("");S.useEffect(()=>{n&&t&&f(t.googleDriveFolderUrl||"")},[n,t]);const p=()=>{const b=h.trim();s(t.id,()=>({googleDriveFolderUrl:b||void 0})),e()},x=()=>{s(t.id,()=>({googleDriveFolderUrl:void 0})),e()},v=async()=>{try{const b=await i();b&&f(b.url)}catch(b){console.error(b),alert("Could not open Google Drive picker. Please ensure you are connected in Settings.")}};return c.jsx(sn,{isOpen:n,onClose:e,title:"Manage Cloud Link",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("p",{className:"text-sm text-slate-600",children:"Set a specific Google Drive folder URL for this deal, or clear it to use the primary contact's default folder."}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"cloud-link-url",className:"block text-sm font-medium text-slate-700",children:"Google Drive Folder URL"}),c.jsxs("div",{className:"mt-1 flex gap-2",children:[c.jsx("input",{type:"url",id:"cloud-link-url",value:h,onChange:b=>f(b.target.value),placeholder:"https://drive.google.com/drive/folders/...",className:"flex-grow block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"}),c.jsx("button",{type:"button",onClick:v,disabled:!o||!u,title:o?"Select Folder from Google Drive":"Connect to Google Drive in Settings first",className:"flex-shrink-0 px-3 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200 disabled:bg-slate-50 disabled:cursor-not-allowed disabled:text-slate-400",children:c.jsx(oo,{className:"w-5 h-5"})})]}),!o&&c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Connect to Google Drive in Settings to enable folder selection."})]}),c.jsxs("div",{className:"flex justify-between items-center pt-4",children:[c.jsx("button",{type:"button",onClick:x,className:"px-4 py-2 text-sm font-medium text-red-600 rounded-md hover:bg-red-50",children:"Clear Deal-Specific Link"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsx("button",{type:"button",onClick:p,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700",children:"Save"})]})]})]})})},LB=n=>{try{const t=decodeURIComponent(n).split("/Mi unidad/");return t.length>1?t[1].replace(/\//g," / "):n}catch{return n}},UB=({deal:n})=>{const{getContactById:e}=Ue(),[t,s]=S.useState(!1),i=S.useMemo(()=>n.contactIds.length>0?e(n.contactIds[0]):void 0,[n.contactIds,e]),o=S.useMemo(()=>n.googleDriveFolderUrl||i?.googleDriveFolderUrl,[n,i]),u=S.useMemo(()=>n.googleDriveFolderUrl?"Deal":i?.googleDriveFolderUrl?`Contact (${i.firstName})`:null,[n,i]),h=S.useMemo(()=>o?LB(o):"",[o]);return c.jsxs(c.Fragment,{children:[t&&c.jsx(VB,{isOpen:t,onClose:()=>s(!1),deal:n}),c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-800 flex items-center",children:[c.jsx(QR,{className:"w-5 h-5 mr-2 text-slate-500"}),"Nube de contacto"]}),c.jsx("button",{onClick:()=>s(!0),className:"text-blue-600 hover:text-blue-800 text-sm font-semibold",children:"Manage Link"})]}),o?c.jsxs("div",{className:"space-y-2",children:[c.jsxs("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-600 font-medium break-all hover:underline",children:[c.jsx(oo,{className:"w-4 h-4 flex-shrink-0"}),c.jsx("span",{children:h})]}),u&&c.jsxs("p",{className:"text-xs text-slate-400",children:["Source: ",u]})]}):c.jsxs("div",{className:"text-center py-4",children:[c.jsx("p",{className:"text-sm text-slate-500",children:"No Google Drive folder linked."}),c.jsx("button",{onClick:()=>s(!0),className:"mt-2 text-sm font-semibold text-blue-600 hover:underline",children:"Add a link for this deal"})]})]})]})},FB=({deal:n})=>{const{updateDeal:e}=Ue(),[t,s]=S.useState(!1),[i,o]=S.useState("");S.useEffect(()=>{n.trackingUrl?(s(!1),o(n.trackingUrl)):(s(!0),o(""))},[n.trackingUrl]);const u=v=>{const b={deliveryMethod:v};v!=="shipping"&&(b.trackingUrl=void 0,s(!0),o("")),e(n.id,()=>b)},h=()=>{const v=i.trim();e(n.id,()=>({trackingUrl:v||void 0})),v&&s(!1)},f=()=>{s(!0)},p=v=>`flex-1 text-center px-3 py-2 rounded-md text-sm font-semibold transition-colors border ${n.deliveryMethod===v?"bg-blue-600 text-white border-blue-700 shadow":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200"}`,x=()=>t?c.jsxs("div",{children:[c.jsx("label",{htmlFor:"trackingUrl",className:"block text-sm font-medium text-slate-700",children:"Tracking Link"}),c.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[c.jsxs("div",{className:"relative flex-grow",children:[c.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:c.jsx(oo,{className:"h-5 w-5 text-slate-400"})}),c.jsx("input",{type:"url",id:"trackingUrl",value:i,onChange:v=>o(v.target.value),placeholder:"https://...",className:"block w-full rounded-md border-slate-300 bg-slate-100 py-2 pl-10 pr-3 text-slate-700 placeholder:text-slate-500 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}),c.jsx("button",{onClick:h,className:"px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:"Save"})]})]}):n.trackingUrl?c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Tracking Link"}),c.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2 p-2 bg-slate-50 rounded-md",children:[c.jsxs("a",{href:n.trackingUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-600 font-medium hover:underline",children:[c.jsx(oo,{className:"w-4 h-4 flex-shrink-0"}),c.jsx("span",{children:"Seguimiento"})]}),c.jsx("button",{onClick:f,className:"px-4 py-1.5 text-sm font-semibold text-slate-600 bg-white border border-slate-300 rounded-md hover:bg-slate-100",children:"Edit"})]})]}):c.jsx("button",{onClick:()=>s(!0),className:"w-full text-center px-3 py-2 text-sm font-semibold text-slate-700 bg-slate-100 border border-slate-200 rounded-md hover:bg-slate-200",children:"+ Add Tracking Link"});return c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-800 flex items-center mb-4",children:[c.jsx(hB,{className:"w-5 h-5 mr-2 text-slate-500"}),"Entrega"]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>u("pickup"),className:p("pickup"),children:"Recoleccin"}),c.jsx("button",{onClick:()=>u("shipping"),className:p("shipping"),children:"Envo"})]})}),n.deliveryMethod==="shipping"&&x()]})]})},Sg=({value:n,onChange:e,placeholder:t,onFilesDrop:s,users:i})=>{const o=S.useRef(null),[u,h]=S.useState(!1),[f,p]=S.useState(null);S.useEffect(()=>{const C=o.current;C&&n!==C.innerHTML&&(C.innerHTML=n)},[n]);const x=C=>{const q=o.current;if(!q)return;const P=C.currentTarget.innerHTML;e(P);const V=window.getSelection();if(V&&V.rangeCount>0){const F=V.getRangeAt(0),K=F.startContainer;if(K.nodeType===Node.TEXT_NODE&&F.startOffset>0){const L=K.textContent||"",k=L.lastIndexOf("@",F.startOffset-1);if(k!==-1&&(k===0||/\s|&nbsp;/.test(L.substring(k-1,k)))){const D=L.substring(k+1,F.startOffset),M=document.createRange();M.setStart(K,k),M.setEnd(K,k+1);const B=M.getBoundingClientRect(),G=q.getBoundingClientRect();p({top:B.bottom-G.top,left:B.left-G.left,query:D});return}}}p(null)},v=C=>{const q=o.current;if(!q||!f)return;const P=window.getSelection();if(!P||P.rangeCount===0)return;const V=P.getRangeAt(0),F=V.startContainer;if(F.nodeType===Node.TEXT_NODE){const K=F.textContent||"",L=V.startOffset,D=K.slice(0,L).lastIndexOf("@");if(D!==-1){V.setStart(F,D),V.setEnd(F,L);const M=document.createElement("span");M.className="mention",M.setAttribute("data-mention","true"),M.setAttribute("data-user-id",C.id),M.setAttribute("contenteditable","false"),M.textContent=`@${C.name}`,V.deleteContents(),V.insertNode(M);const B=document.createTextNode("");V.setStartAfter(M),V.setEndAfter(M),V.insertNode(B),V.collapse(!1),P.removeAllRanges(),P.addRange(V),p(null),e(q.innerHTML),q.focus()}}},b=S.useMemo(()=>{if(!f)return[];const C=f.query.toLowerCase();return i.filter(q=>q.name.toLowerCase().includes(C))},[f,i]),I=(C,q)=>{C==="insertCheckbox"?document.execCommand("insertHTML",!1,`
                <div class="task-item">
                    <input type="checkbox" contenteditable="false" onclick="this.nextElementSibling.setAttribute('data-checked', this.checked.toString())" />
                    <span class="task-item-text" data-checked="false">&nbsp;</span>
                </div>
            `):document.execCommand(C,!1,q);const P=o.current;P&&(P.focus(),e(P.innerHTML))},N=(C,q)=>{C.preventDefault(),C.stopPropagation(),h(q)},E=C=>{if(N(C,!1),!!o.current){try{const P=C.dataTransfer.getData("text/uri-list")||C.dataTransfer.getData("text/plain");if(P&&(new URL(P).protocol==="http:"||new URL(P).protocol==="https:")){I("createLink",P);return}}catch{}if(C.dataTransfer.files&&C.dataTransfer.files.length>0){const P=Array.from(C.dataTransfer.files);s&&s(P)}}},A=({command:C,children:q})=>c.jsx("button",{type:"button",onMouseDown:P=>{P.preventDefault(),I(C)},className:"p-2 rounded-md hover:bg-slate-200 text-slate-600","aria-label":C,children:q});return c.jsxs("div",{className:"relative",children:[c.jsxs("div",{className:`bg-white border border-slate-300 rounded-md shadow-sm focus-within:ring-1 focus-within:ring-blue-500 focus-within:border-blue-500 transition-shadow ${u?"ring-2 ring-blue-500 shadow-lg":""}`,children:[c.jsxs("div",{className:"flex items-center gap-1 p-1 border-b border-slate-200",children:[c.jsx(A,{command:"bold",children:c.jsx(oB,{className:"w-5 h-5"})}),c.jsx(A,{command:"italic",children:c.jsx(lB,{className:"w-5 h-5"})}),c.jsx(A,{command:"insertUnorderedList",children:c.jsx(cB,{className:"w-5 h-5"})}),c.jsx(A,{command:"insertOrderedList",children:c.jsx(uB,{className:"w-5 h-5"})}),c.jsx(A,{command:"insertCheckbox",children:c.jsx(fB,{className:"w-5 h-5"})}),c.jsx("div",{className:"border-l h-5 mx-1 border-slate-200"}),c.jsx(A,{command:"removeFormat",children:c.jsx(dB,{className:"w-5 h-5"})})]}),c.jsx("div",{ref:o,onInput:x,onDragEnter:C=>N(C,!0),onDragLeave:C=>N(C,!1),onDragOver:C=>N(C,!0),onDrop:E,contentEditable:!0,"data-placeholder":t,className:"prose max-w-none prose-sm p-3 min-h-[80px] focus:outline-none"})]}),f&&b.length>0&&c.jsx("div",{style:{top:f.top,left:f.left},className:"absolute z-20 mt-1 bg-white shadow-lg rounded-md border w-48 max-h-40 overflow-y-auto",children:b.map(C=>c.jsx("button",{type:"button",onMouseDown:q=>q.preventDefault(),onClick:()=>v(C),className:"w-full text-left p-2 text-sm hover:bg-slate-100",children:C.name},C.id))})]})},BB=({note:n})=>{const{users:e,currentUser:t,updateNote:s,deleteNote:i,showConfirmation:o,toggleNoteLike:u,getUserById:h,showAlert:f}=Ue(),[p,x]=S.useState(!1),[v,b]=S.useState(""),[I,N]=S.useState([]),[E,A]=S.useState([]),[C,q]=S.useState([]);S.useEffect(()=>{p&&(b(n.content),N(n.attachments||[]),A([]),q([]))},[p,n.content,n.attachments]);const P=()=>{const{attachments:M,...B}=n;s({...B,content:v},E,C),x(!1)},V=()=>{o("Are you sure you want to permanently delete this note? This action cannot be undone.",()=>i(n.id))},F=S.useMemo(()=>t&&n.likes?.includes(t.id),[n.likes,t]),K=S.useMemo(()=>!n.likes||n.likes.length===0?"No one has liked this yet.":"Liked by: "+n.likes.map(M=>h(M)?.name||"a user").join(", "),[n.likes,h]),L=M=>{A(B=>[...B,...M])},k=M=>{N(B=>B.filter(G=>G.id!==M.id)),q(B=>[...B,M])},D=M=>{A(B=>B.filter(G=>G.name!==M))};return c.jsxs("div",{className:"relative pl-8 group",children:[c.jsx("div",{className:"absolute top-0 left-0 h-full border-l-2 border-slate-200",children:c.jsx("div",{className:"absolute -left-[1.05rem] top-1.5 p-1.5 bg-white rounded-full border-2 border-slate-200",children:c.jsx(uf,{className:"w-5 h-5 text-slate-500"})})}),c.jsx("div",{className:"ml-4 py-4",children:p?c.jsxs("div",{className:"space-y-2",children:[c.jsx(Sg,{value:v,onChange:b,placeholder:"Edit your note...",users:e,onFilesDrop:L}),(I.length>0||E.length>0)&&c.jsxs("div",{className:"space-y-2 p-2 border rounded-md bg-slate-50",children:[c.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase",children:"Attachments"}),I.map(M=>c.jsxs("div",{className:"flex items-center justify-between text-sm",children:[c.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[c.jsx(Nr,{className:"w-4 h-4 text-slate-400"}),c.jsx("span",{children:M.name}),c.jsxs("span",{className:"text-xs text-slate-500",children:["(",(M.size/1024).toFixed(1)," KB)"]})]}),c.jsx("button",{onClick:()=>k(M),className:"text-red-500 hover:text-red-700",children:c.jsx(fn,{className:"w-4 h-4"})})]},M.id)),E.map(M=>c.jsxs("div",{className:"flex items-center justify-between text-sm",children:[c.jsxs("div",{className:"flex items-center gap-2 text-blue-700",children:[c.jsx(Nr,{className:"w-4 h-4 text-blue-400"}),c.jsx("span",{children:M.name}),c.jsx("span",{className:"text-xs text-blue-500",children:"(new)"})]}),c.jsx("button",{onClick:()=>D(M.name),className:"text-red-500 hover:text-red-700",children:c.jsx(fn,{className:"w-4 h-4"})})]},M.name))]}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx("button",{onClick:()=>x(!1),className:"px-3 py-1 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsx("button",{onClick:P,className:"px-3 py-1 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700",children:"Save"})]})]}):c.jsxs("div",{className:"flex justify-between items-start gap-4",children:[c.jsxs("div",{className:"flex-grow",children:[c.jsx("p",{className:"text-xs text-slate-400 font-semibold",children:$n(n.createdAt)}),n.content&&c.jsx("div",{className:"prose max-w-none mt-1",dangerouslySetInnerHTML:{__html:n.content}}),n.attachments&&n.attachments.length>0&&c.jsx("div",{className:"mt-3 pt-3 border-t border-slate-100 space-y-2",children:n.attachments.map((M,B)=>c.jsxs("a",{href:M.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-slate-600 hover:text-blue-600 font-medium group",children:[c.jsx(Nr,{className:"w-4 h-4 text-slate-400 group-hover:text-blue-500"}),c.jsx("span",{children:M.name}),c.jsx(K_,{className:"w-4 h-4 text-slate-400 opacity-0 group-hover:opacity-100"})]},B))})]}),c.jsxs("div",{className:"flex-shrink-0 flex items-center gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2 text-slate-500",title:K,children:[c.jsx("button",{onClick:()=>u(n.id),className:`p-1 rounded-full transition-colors ${F?"text-blue-600 hover:text-blue-700":"text-slate-400 hover:text-blue-600"}`,children:c.jsx(Y_,{className:`w-5 h-5 ${F?"fill-current":"fill-none"}`})}),n.likes&&n.likes.length>0&&c.jsx("span",{className:"text-sm font-semibold",children:n.likes.length})]}),c.jsxs("div",{className:"flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[c.jsx("button",{onClick:()=>x(!0),className:"text-slate-500 hover:text-blue-600 p-1",children:c.jsx(ms,{className:"w-5 h-5"})}),c.jsx("button",{onClick:V,className:"text-slate-500 hover:text-red-600 p-1",children:c.jsx(In,{className:"w-5 h-5"})})]})]})]})})]})},zB=({quote:n})=>{const{deleteQuote:e,showConfirmation:t,updateQuote:s}=Ue(),i=f=>{t("Are you sure you want to delete this quote? This action cannot be undone.",()=>e(f))},o=f=>{const p=n.deliveryMethods||[],x=p.includes(f)?p.filter(v=>v!==f):[...p,f];s(n.id,{deliveryMethods:x})},u=["whatsapp","email"],h=f=>{const p=document.createElement("a");p.href=f.data,p.download=f.name,document.body.appendChild(p),p.click(),document.body.removeChild(p)};return c.jsxs("div",{className:"relative pl-8 group",children:[c.jsx("div",{className:"absolute top-0 left-0 h-full border-l-2 border-slate-200",children:c.jsx("div",{className:"absolute -left-[1.05rem] top-1.5 p-1.5 bg-white rounded-full border-2 border-slate-200",children:c.jsx(Nr,{className:"w-5 h-5 text-slate-500"})})}),c.jsxs("div",{className:"ml-4 py-4",children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{className:"flex-grow min-w-0",children:[n.title&&c.jsx("h4",{className:"font-bold text-slate-800 mb-2 truncate",children:n.title}),c.jsx("div",{className:"flex items-center gap-3",children:n.pdfName&&n.pdfData?c.jsxs("button",{onClick:()=>h({data:n.pdfData,name:n.pdfName}),className:"flex items-center gap-2 text-slate-700 hover:text-blue-600 font-medium text-left",children:[c.jsx(Nr,{className:"w-5 h-5 text-slate-500 flex-shrink-0"}),c.jsx("span",{className:"truncate",children:n.pdfName})]}):n.zohoUrl?c.jsxs("span",{className:"flex items-center gap-2 text-slate-700 font-medium",children:[c.jsx(oo,{className:"w-5 h-5 text-slate-500 flex-shrink-0"}),c.jsx("span",{className:"truncate",children:"Zoho Quote Link"})]}):null})]}),c.jsxs("div",{className:"flex items-center gap-4 flex-shrink-0 ml-4",children:[c.jsx("span",{className:"text-xs text-slate-400 font-semibold",children:$n(n.createdAt)}),n.zohoUrl&&c.jsx("a",{href:n.zohoUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700",title:"Open in Zoho",children:c.jsx(iB,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>i(n.id),className:"text-slate-400 hover:text-red-600 opacity-0 group-hover:opacity-100 transition-opacity",children:c.jsx(In,{className:"w-5 h-5"})})]})]}),c.jsx("div",{className:"mt-3 pt-3 border-t border-slate-100",children:c.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[c.jsx("span",{className:"text-sm font-semibold text-slate-500",children:"Delivered via:"}),c.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:u.map(f=>{const p=n.deliveryMethods?.includes(f),x="flex items-center gap-2 px-3 py-1.5 text-sm font-medium rounded-md border transition-colors",v=f==="whatsapp"?"bg-green-100 text-green-800 border-green-200":"bg-blue-100 text-blue-800 border-blue-200";return c.jsxs("button",{onClick:()=>o(f),className:`${x} ${p?v:"bg-white text-slate-700 border-slate-200 hover:bg-slate-50"}`,children:[f==="whatsapp"?c.jsx(cf,{className:"w-4 h-4"}):c.jsx(Vh,{className:"w-4 h-4"}),c.jsx("span",{children:f==="whatsapp"?"WhatsApp":"Email"}),p&&c.jsx(Ig,{className:"w-4 h-4"})]},f)})})]})})]})]})},qB=n=>new Promise((e,t)=>{const s=new FileReader;s.readAsDataURL(n),s.onload=()=>e(s.result),s.onerror=i=>t(i)}),HB=({dealId:n})=>{const{getNotesForDeal:e,addNote:t,getQuotesForDeal:s,addQuote:i,users:o}=Ue(),[u,h]=S.useState("note"),[f,p]=S.useState(""),[x,v]=S.useState([]),[b,I]=S.useState(""),[N,E]=S.useState(null),[A,C]=S.useState(""),q=S.useRef(null),[P,V]=S.useState(!1),[F,K]=S.useState(!1),L=e(n),k=s(n),D=S.useMemo(()=>[...L.map(Ie=>({...Ie,type:"note"})),...k.map(Ie=>({...Ie,type:"quote"}))].sort((Ie,O)=>new Date(O.createdAt).getTime()-new Date(Ie.createdAt).getTime()),[L,k]),M=le=>{v(Ie=>[...Ie,...le])},B=le=>{v(Ie=>Ie.filter(O=>O.name!==le))},G=async()=>{const le=f.replace(/<[^>]*>/g,"").trim().length>0,Ie=/data-mention="true"/.test(f);if(!(!le&&!Ie&&x.length===0)){K(!0);try{await t({dealId:n,content:f},x),p(""),v([])}catch(O){console.error("Error creating note:",O),alert("Could not save note. Please try again.")}finally{K(!1)}}},z=async le=>{le.preventDefault();const Ie=A.trim();if(!(!N&&!Ie)){K(!0);try{let O={title:b.trim()||void 0,zohoUrl:Ie||void 0};if(N){const oe=await qB(N);O.pdfName=N.name,O.pdfData=oe}await i({...O,dealId:n}),I(""),E(null),C(""),q.current&&(q.current.value="")}catch(O){console.error("Error uploading quote:",O),alert("Could not add quote. Please try again.")}finally{K(!1)}}},he=le=>{const Ie=le.target.files?le.target.files[0]:null;if(Ie&&Ie.type!=="application/pdf"){alert("Only PDF files are allowed."),E(null),q.current&&(q.current.value="");return}E(Ie)},Se=(le,Ie)=>{le.preventDefault(),le.stopPropagation(),V(Ie)},J=le=>{le.preventDefault(),le.stopPropagation(),V(!1);const Ie=le.dataTransfer.files;if(Ie&&Ie.length>0){const O=Ie[0];O.type!=="application/pdf"?alert("Only PDF files are allowed."):E(O)}},ge=({tab:le,children:Ie})=>c.jsx("button",{onClick:()=>h(le),className:`px-4 py-2 text-sm font-semibold rounded-t-lg border-b-2 transition-colors ${u===le?"text-blue-600 border-blue-600":"text-slate-500 border-transparent hover:text-slate-700 hover:border-slate-300"}`,children:Ie});return c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-800 flex items-center",children:[c.jsx(uf,{className:"w-5 h-5 mr-2 text-slate-500"})," Activity"]}),c.jsx("div",{className:"mt-4 border-b border-slate-200",children:c.jsxs("div",{className:"flex -mb-px",children:[c.jsx(ge,{tab:"note",children:"Add Note"}),c.jsx(ge,{tab:"quote",children:"Add Quote"})]})}),c.jsxs("div",{className:"py-4",children:[u==="note"&&c.jsxs("div",{className:"space-y-3",children:[c.jsx(Sg,{value:f,onChange:p,placeholder:"Add a new note, mention with @, or drag & drop files...",onFilesDrop:M,users:o}),x.length>0&&c.jsxs("div",{className:"space-y-2 p-2 border rounded-md bg-slate-50",children:[c.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase",children:"Attachments"}),x.map((le,Ie)=>c.jsxs("div",{className:"flex items-center justify-between text-sm",children:[c.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[c.jsx(Nr,{className:"w-4 h-4 text-slate-400"}),c.jsx("span",{children:le.name}),c.jsxs("span",{className:"text-xs text-slate-500",children:["(",(le.size/1024).toFixed(1)," KB)"]})]}),c.jsx("button",{onClick:()=>B(le.name),className:"text-red-500 hover:text-red-700",children:c.jsx(fn,{className:"w-4 h-4"})})]},Ie))]}),c.jsx("div",{className:"flex justify-end",children:c.jsxs("button",{onClick:G,disabled:F,className:"flex items-center bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors text-sm font-semibold disabled:bg-blue-300",children:[c.jsx(fs,{className:"w-4 h-4 mr-2"})," ",F?"Saving...":"Add Note"]})})]}),u==="quote"&&c.jsxs("form",{onSubmit:z,onDragEnter:le=>Se(le,!0),onDragLeave:le=>Se(le,!1),onDragOver:le=>Se(le,!0),onDrop:J,className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[c.jsx("button",{type:"button",onClick:()=>I("Anticipo"),className:`px-3 py-2 text-sm font-semibold rounded-md border transition-colors ${b==="Anticipo"?"bg-blue-600 text-white border-blue-600":"bg-white text-slate-600 border-slate-300 hover:bg-slate-50"}`,children:"Anticipo"}),c.jsx("button",{type:"button",onClick:()=>I("Liquidacin"),className:`px-3 py-2 text-sm font-semibold rounded-md border transition-colors ${b==="Liquidacin"?"bg-blue-600 text-white border-blue-600":"bg-white text-slate-600 border-slate-300 hover:bg-slate-50"}`,children:"Liquidacin"})]}),c.jsx("input",{type:"text",value:b,onChange:le=>I(le.target.value),placeholder:"Or type a custom title...",className:"w-full flex-grow px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),c.jsxs("label",{htmlFor:"quote-file-upload",className:`relative block border-2 border-dashed rounded-lg p-6 text-center transition-colors duration-200 cursor-pointer ${P?"border-blue-500 bg-blue-50":"border-slate-300 bg-slate-50 hover:border-slate-400"}`,children:[c.jsx("input",{type:"file",id:"quote-file-upload",accept:"application/pdf",onChange:he,ref:q,className:"sr-only"}),N?c.jsxs("div",{className:"flex flex-col items-center justify-center",children:[c.jsx(Nr,{className:"w-8 h-8 text-green-500"}),c.jsx("p",{className:"mt-2 font-semibold text-slate-700",children:N.name}),c.jsxs("p",{className:"text-xs text-slate-500",children:[(N.size/1024).toFixed(2)," KB"]}),c.jsxs("button",{type:"button",onClick:le=>{le.preventDefault(),E(null),q.current&&(q.current.value="")},className:"mt-3 flex items-center text-sm font-semibold text-red-600 hover:text-red-800",children:[c.jsx(fn,{className:"w-4 h-4 mr-1"})," Remove File"]})]}):c.jsxs("div",{className:"flex flex-col items-center justify-center pointer-events-none",children:[c.jsx(KR,{className:"w-8 h-8 text-slate-400"}),c.jsxs("p",{className:"mt-2 font-semibold text-slate-700",children:[c.jsx("span",{className:"text-blue-600",children:"Click to upload"})," or drag and drop"]}),c.jsx("p",{className:"text-xs text-slate-500",children:"PDF only"})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"flex-grow relative",children:[c.jsx(oo,{className:"w-4 h-4 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none"}),c.jsx("input",{type:"url",value:A,onChange:le=>C(le.target.value),placeholder:"or add Zoho URL",className:"w-full pl-9 pr-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),c.jsxs("button",{type:"submit",disabled:F||!N&&!A.trim(),className:"flex-shrink-0 flex items-center bg-blue-600 text-white px-3 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors text-sm font-semibold disabled:bg-blue-300 disabled:cursor-not-allowed",children:[c.jsx(fs,{className:"w-4 h-4 mr-1.5"}),F?"Adding...":"Add Quote"]})]})]})]}),c.jsx("div",{className:"mt-4 border-t border-slate-200 -mx-6 px-2",children:D.length>0?D.map(le=>c.jsx("div",{className:"border-b border-slate-200 last:border-b-0",children:le.type==="note"?c.jsx(BB,{note:le}):c.jsx(zB,{quote:le})},`${le.type}-${le.id}`)):c.jsx("p",{className:"text-sm text-slate-500 text-center py-8",children:"No activity for this deal yet."})})]})},GB=({isOpen:n,onClose:e,contact:t})=>{const{messageTemplates:s}=Ue(),[i,o]=S.useState(""),u=S.useMemo(()=>s.find(p=>p.id===i),[i,s]),h=S.useMemo(()=>u?u.body.replace(/{nombre del cliente}/g,t.firstName):"Select a template to see a preview.",[u,t.firstName]),f=()=>{if(!u)return;const p=t.phone.replace(/\D/g,""),x=encodeURIComponent(h),v=`https://web.whatsapp.com/send?phone=${p}&text=${x}`;window.open(v,"_blank"),e()};return Wi.useEffect(()=>{n&&s.length>0?o(s[0].id):n||o("")},[n,s]),c.jsx(sn,{isOpen:n,onClose:e,title:"Send WhatsApp Message",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"template-select",className:"block text-sm font-medium text-slate-700",children:"Select a message template"}),c.jsx("select",{id:"template-select",value:i,onChange:p=>o(p.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:s.length===0?c.jsx("option",{children:"No templates available"}):s.map(p=>c.jsx("option",{value:p.id,children:p.title},p.id))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Message Preview"}),c.jsx("div",{className:"mt-1 p-3 min-h-[100px] bg-slate-50 border rounded-md text-sm text-slate-600 whitespace-pre-wrap",children:h})]}),c.jsxs("div",{className:"flex justify-end pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"mr-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsxs("button",{type:"button",onClick:f,disabled:!u,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md shadow-sm hover:bg-green-700 disabled:bg-green-300",children:[c.jsx(cf,{className:"w-5 h-5 mr-2"})," Send on WhatsApp"]})]})]})})},$B=({isOpen:n,onClose:e,deal:t})=>{const{updateDeal:s,deleteDeal:i,showConfirmation:o,users:u}=Ue(),[h,f]=S.useState(t.title),[p,x]=S.useState(t.deliveryDate||""),[v,b]=S.useState(t.assignedUserId||""),I=S.useMemo(()=>Qi(new Date,5).toISOString().split("T")[0],[]),N=S.useMemo(()=>Qi(new Date,10).toISOString().split("T")[0],[]);S.useEffect(()=>{if(t&&n){f(t.title);const F=t.deliveryDate?t.deliveryDate.split("T")[0]:I;x(F),b(t.assignedUserId||"")}},[t,n,I]);const E=F=>{F.preventDefault(),!(!h||!v)&&(s(t.id,K=>({...K,title:h,deliveryDate:p||void 0,assignedUserId:v})),e())},A=()=>{o("Are you sure you want to delete this deal? It will be moved to the archive.",()=>{i(t.id),e()})},C=F=>`px-3 py-2 rounded-md text-sm font-semibold transition-colors border ${F?"bg-blue-600 text-white border-blue-700":"bg-white text-slate-700 border-slate-300 hover:bg-slate-100"}`,q=p===I,P=p===N,V=!!p&&!q&&!P;return c.jsx(sn,{isOpen:n,onClose:e,title:"Edit Deal",children:c.jsxs("form",{onSubmit:E,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-slate-700",children:"Deal Title"}),c.jsx("input",{type:"text",id:"title",value:h,onChange:F=>f(F.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Delivery Date"}),c.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[c.jsx("button",{type:"button",onClick:()=>x(I),className:C(q),children:"1 Semana"}),c.jsx("button",{type:"button",onClick:()=>x(N),className:C(P),children:"10 das"}),c.jsx(Nu,{value:p,onChange:x,children:c.jsx("div",{className:C(V),children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Dr,{className:`w-4 h-4 ${V?"":"text-slate-500"}`}),c.jsx("span",{children:"Elegir fecha"})]})})}),p&&c.jsxs("p",{className:"text-sm text-slate-500 ml-2",children:["Seleccionada: ",$n(p)]})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"assignedUser",className:"block text-sm font-medium text-slate-700",children:"Assigned To"}),c.jsx("select",{id:"assignedUser",value:v,onChange:F=>b(F.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,children:u.map(F=>c.jsx("option",{value:F.id,children:F.name},F.id))})]}),c.jsxs("div",{className:"flex justify-between items-center pt-4",children:[c.jsx("button",{type:"button",onClick:A,className:"text-red-600 hover:text-red-800 text-sm font-medium px-4 py-2 rounded-md hover:bg-red-50",children:"Delete Deal"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700",children:"Save Changes"})]})]})]})})},KB=({deal:n,onStageChange:e})=>{const{pipelineStages:t}=Ue();return c.jsx("div",{className:"flex flex-wrap items-center gap-2",children:t.map(s=>c.jsx("button",{onClick:()=>e(s.id),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${n.stageId===s.id?"bg-blue-600 text-white shadow":"bg-slate-200 text-slate-700 hover:bg-slate-300"}`,children:s.name},s.id))})},QB=({deal:n})=>{const{getContactById:e,showContactDetail:t}=Ue(),[s,i]=S.useState(!1),[o,u]=S.useState(!1),[h,f]=S.useState(null),p=S.useMemo(()=>n.contactIds.map(I=>e(I)).filter(I=>I!==void 0),[n.contactIds,e]),x=I=>{f(I),u(!0)},v=({textToCopy:I})=>{const[N,E]=S.useState(!1),A=()=>{I&&navigator.clipboard.writeText(I).then(()=>{E(!0),setTimeout(()=>E(!1),2e3)},C=>{console.error("Could not copy text: ",C)})};return c.jsx("button",{onClick:A,className:"text-slate-400 hover:text-blue-600 disabled:opacity-50",disabled:!I,title:`Copy ${I}`,children:N?c.jsx(Ig,{className:"w-4 h-4 text-green-500"}):c.jsx(gB,{className:"w-4 h-4"})})},b=I=>I.startsWith("+52")?I.substring(3).trim():I.startsWith("+1")?I.substring(2).trim():I;return c.jsxs(c.Fragment,{children:[c.jsx(MB,{isOpen:s,onClose:()=>i(!1),deal:n}),h&&c.jsx(GB,{isOpen:o,onClose:()=>u(!1),contact:h}),c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-800 flex items-center",children:[c.jsx(Rr,{className:"w-5 h-5 mr-2 text-slate-500"}),"Contacts"]}),c.jsx("button",{onClick:()=>i(!0),className:"text-blue-600 hover:text-blue-800 text-sm font-semibold",children:"Edit Contacts"})]}),c.jsx("div",{className:"space-y-4",children:p.length>0?p.map(I=>c.jsxs("div",{className:"flex gap-4 items-start",children:[c.jsxs("div",{className:"flex-grow p-4 bg-slate-50 rounded-lg space-y-2",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(v,{textToCopy:`${I.firstName} ${I.lastName}`}),c.jsxs("button",{onClick:()=>t(I.id),className:"font-bold text-slate-900 hover:text-blue-600 hover:underline text-left",children:[I.firstName," ",I.lastName]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(v,{textToCopy:I.company}),c.jsx("p",{className:"text-sm text-slate-600",children:I.company})]}),c.jsxs("div",{className:"flex items-center gap-3 border-t pt-2 mt-2",children:[c.jsx(v,{textToCopy:b(I.phone)}),c.jsx("p",{className:"text-sm text-slate-600",children:b(I.phone)})]}),I.email&&c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(v,{textToCopy:I.email}),c.jsx("p",{className:"text-sm text-slate-600 break-all",children:I.email})]})]}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("a",{href:`mailto:${I.email}`,className:"w-10 h-10 flex items-center justify-center bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition-colors",title:`Email ${I.email}`,children:c.jsx(Vh,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>x(I),className:"w-10 h-10 flex items-center justify-center bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors",title:`WhatsApp ${I.phone}`,children:c.jsx(cf,{className:"w-5 h-5"})})]})]},I.id)):c.jsx("p",{className:"text-sm text-slate-500 text-center py-4",children:"No contacts assigned to this deal."})})]})]})},WB=({isOpen:n,onClose:e,onAddTask:t,onUndo:s,defaultResponsibleUserId:i})=>{const{users:o}=Ue(),u=V=>V.toISOString().split("T")[0],h=u(new Date),f=new Date;f.setDate(f.getDate()+1);const p=u(f),x=u(Qi(new Date,2)),[v,b]=S.useState("Seguimiento"),[I,N]=S.useState(x),[E,A]=S.useState(i||"");S.useEffect(()=>{n&&(b("Seguimiento"),N(x),A(i||""))},[n,i,x]);const C=()=>{v.trim()&&(t(v,I,E),e())},q=()=>{s(),e()},P=V=>`px-3 py-1.5 rounded-md text-sm font-semibold transition-colors border ${V?"bg-blue-600 text-white border-blue-700":"bg-white text-slate-700 border-slate-300 hover:bg-slate-100"}`;return c.jsx(sn,{isOpen:n,onClose:e,title:"Create Follow-up Task",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("p",{className:"text-sm text-slate-600",children:"The previous task was marked as complete. Create a follow-up task?"}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"followup-title",className:"block text-sm font-medium text-slate-700",children:"Task Title"}),c.jsx("input",{type:"text",id:"followup-title",value:v,onChange:V=>b(V.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Due Date"}),c.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[c.jsx("button",{type:"button",onClick:()=>N(h),className:P(I===h),children:"Hoy"}),c.jsx("button",{type:"button",onClick:()=>N(p),className:P(I===p),children:"Maana"}),c.jsx("button",{type:"button",onClick:()=>N(x),className:P(I===x),children:"En 2 das"}),c.jsx(Nu,{value:I,onChange:N,children:c.jsx("div",{className:P(!!I&&I!==h&&I!==p&&I!==x),children:c.jsx(Dr,{className:"w-4 h-4"})})}),I&&c.jsxs("div",{className:"flex items-center gap-2 text-sm bg-blue-100 text-blue-800 font-medium px-3 py-1.5 rounded-md",children:[c.jsx("span",{children:$n(I)}),c.jsx("button",{type:"button",onClick:()=>N(""),className:"text-blue-600 hover:text-blue-800",children:c.jsx(fn,{className:"w-4 h-4"})})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"followup-user",className:"block text-sm font-medium text-slate-700",children:"Assign to"}),c.jsx("select",{id:"followup-user",value:E,onChange:V=>A(V.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:o.map(V=>c.jsx("option",{value:V.id,children:V.name},V.id))})]}),c.jsxs("div",{className:"flex justify-between items-center pt-4",children:[c.jsx("button",{onClick:q,className:"px-4 py-2 text-sm font-medium text-slate-700 rounded-md hover:bg-slate-100",children:"Undo"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Skip"}),c.jsx("button",{onClick:C,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700",children:"Create Task"})]})]})]})})},YB=({dealId:n})=>{const{getTasksForDeal:e,addTask:t,updateTask:s,deleteTask:i,getUserById:o,showConfirmation:u,getDealById:h}=Ue(),[f,p]=S.useState(!1),[x,v]=S.useState(null),[b,I]=S.useState(!1),[N,E]=S.useState(null),[A,C]=S.useState(!1),q=e(n),P=h(n),V=(D,M,B)=>{t({dealId:n,title:D,dueDate:M,responsibleUserId:B})},F=()=>{x&&s({...x,completed:!1})},K=D=>{E(D),I(!0)},L=D=>{u("Are you sure you want to delete this task? It will be moved to the archive.",()=>i(D))},k=D=>{const M=!D.completed;s({...D,completed:M}),M&&(v(D),p(!0))};return c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[c.jsx(WB,{isOpen:f,onClose:()=>p(!1),onAddTask:V,onUndo:F,defaultResponsibleUserId:x?.responsibleUserId}),c.jsx(eC,{isOpen:b,onClose:()=>I(!1),taskToEdit:N}),c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-800 flex items-center",children:[c.jsx($_,{className:"w-5 h-5 mr-2 text-slate-500"})," Tasks"]}),!A&&c.jsxs("button",{onClick:()=>C(!0),className:"flex items-center bg-blue-600 text-white px-3 py-1.5 rounded-lg text-sm font-semibold shadow hover:bg-blue-700 transition-colors",children:[c.jsx(fs,{className:"w-4 h-4 mr-1"})," Add Task"]})]}),A&&c.jsx(ZR,{dealId:n,showUserAssignment:!0,defaultAssignedUserId:P?.assignedUserId,onTaskAdded:()=>C(!1),onCancel:()=>C(!1)}),c.jsx("div",{className:"mt-6 space-y-2 border-t pt-3",children:q.length>0?q.map(D=>{const M=new Date;M.setHours(0,0,0,0);const B=D.dueDate?new Date(D.dueDate+"T00:00:00"):null,G=B&&B<M&&!D.completed,z=D.responsibleUserId?o(D.responsibleUserId):null;return c.jsxs("div",{className:"flex items-center justify-between text-sm group -m-2 p-2 rounded-md hover:bg-slate-50",children:[c.jsxs("div",{className:"flex items-start flex-grow pr-4 py-1",children:[c.jsx("button",{onClick:()=>k(D),"aria-label":D.completed?"Mark as incomplete":"Mark as complete",className:"pt-px",children:D.completed?c.jsx(El,{className:"w-6 h-6 text-green-500 mr-3 flex-shrink-0"}):c.jsx(HR,{className:"w-6 h-6 text-slate-400 group-hover:text-blue-500 mr-3 flex-shrink-0"})}),c.jsxs("div",{className:"flex-grow",children:[c.jsx("p",{className:`text-slate-800 break-words ${D.completed?"line-through text-slate-500":""}`,children:D.title}),c.jsxs("div",{className:"flex items-center text-xs mt-1 space-x-3",children:[D.dueDate&&c.jsxs("p",{className:`flex items-center ${D.completed?"text-slate-400":G?"text-red-600 font-semibold":"text-slate-500"}`,children:[c.jsx(Dr,{className:"w-3 h-3 mr-1.5"})," Due ",$n(D.dueDate)," ",G&&"(Overdue)"]}),z&&c.jsxs("p",{className:"flex items-center text-slate-500",children:[c.jsx(Rr,{className:"w-3 h-3 mr-1.5"}),z.name]})]})]})]}),c.jsxs("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0",children:[c.jsx("button",{onClick:()=>K(D),className:"text-slate-400 hover:text-blue-600",children:c.jsx(ms,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>L(D.id),className:"text-slate-400 hover:text-red-600",children:c.jsx(In,{className:"w-5 h-5"})})]})]},D.id)}):c.jsx("p",{className:"text-sm text-slate-500 pt-2",children:"No tasks for this deal yet."})})]})},XB=({deal:n})=>{const{tags:e,getTagById:t,updateDeal:s,addTag:i}=Ue(),[o,u]=S.useState(!1),[h,f]=S.useState(""),[p,x]=S.useState("bg-gray-500"),v=S.useMemo(()=>n.tagIds.map(C=>t(C)).filter(C=>C),[n.tagIds,t]),b=S.useMemo(()=>e.filter(C=>!n.tagIds.includes(C.id)),[e,n.tagIds]),I=C=>{s(n.id,q=>({tagIds:[...q.tagIds,C]}))},N=C=>{s(n.id,q=>({tagIds:q.tagIds.filter(P=>P!==C)}))},E=async()=>{if(!h)return;const C=await i({name:h,color:p});I(C.id),f(""),x("bg-gray-500")},A=["bg-red-500","bg-yellow-500","bg-green-500","bg-blue-500","bg-indigo-500","bg-purple-500","bg-pink-500","bg-gray-500"];return c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-800 flex items-center",children:[c.jsx($R,{className:"w-5 h-5 mr-2 text-slate-500"})," Tags"]}),c.jsx("button",{onClick:()=>u(!o),className:"text-blue-600 hover:text-blue-800 text-sm font-semibold",children:o?"Done":"Manage Tags"})]}),c.jsx("div",{className:"flex flex-wrap gap-2",children:v.map(C=>C&&c.jsxs("span",{className:`text-xs font-semibold text-white px-2 py-1 rounded-full flex items-center ${C.color}`,children:[C.name,o&&c.jsx("button",{onClick:()=>N(C.id),className:"ml-1.5 -mr-0.5 text-white/70 hover:text-white",children:c.jsx(fn,{className:"w-3 h-3"})})]},C.id))}),o&&c.jsxs("div",{className:"mt-4 pt-4 border-t",children:[c.jsxs("div",{className:"mb-2",children:[c.jsx("label",{className:"text-sm font-medium text-slate-600 block mb-1",children:"Add existing tag"}),c.jsxs("select",{onChange:C=>I(C.target.value),className:"block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-sm",children:[c.jsx("option",{children:"Select a tag..."}),b.map(C=>c.jsx("option",{value:C.id,children:C.name},C.id))]})]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"text-sm font-medium text-slate-600 block mb-1",children:"Or create a new one"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"text",placeholder:"New tag name",value:h,onChange:C=>f(C.target.value),className:"flex-grow px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm text-sm"}),c.jsx("button",{onClick:E,className:"bg-blue-600 text-white px-3 py-2 rounded-lg text-sm font-semibold",children:"+"})]}),c.jsx("div",{className:"flex gap-2 mt-2",children:A.map(C=>c.jsx("button",{onClick:()=>x(C),className:`w-6 h-6 rounded-full ${C} ${p===C?"ring-2 ring-offset-1 ring-blue-500":""}`},C))})]})]})]})},JB=()=>{const{dealId:n}=mk(),e=Xi(),{getDealById:t,updateDeal:s,restoreDeal:i,deals:o,getUserById:u,getStageById:h,pipelineStages:f}=Ue(),[p,x]=S.useState(!1),[v,b]=S.useState(null),[I,N]=S.useState(!1),E=S.useMemo(()=>t(n),[n,t,o]),A=S.useMemo(()=>E?!o.some(P=>P.id===E.id):!1,[E,o]),C=S.useMemo(()=>E?.assignedUserId?u(E.assignedUserId):null,[E,u]);if(S.useEffect(()=>{if(!E){const P=setTimeout(()=>e("/deals",{replace:!0}),1e3);return()=>clearTimeout(P)}},[E,e]),!E)return c.jsxs("div",{className:"text-center p-10",children:[c.jsx("h2",{className:"text-2xl font-bold text-slate-700",children:"Deal not found"}),c.jsx("p",{className:"text-slate-500 mt-2",children:"Redirecting to deals list..."})]});const q=P=>{if(A||E.stageId===P)return;const V=h(P);V&&(V.name==="Produccin"?b(E):s(E.id,F=>({...F,stageId:P})),V.name==="Compra de material"&&N(!0))};return c.jsxs("div",{className:"p-8 overflow-y-auto h-full",children:[p&&c.jsx($B,{isOpen:p,onClose:()=>x(!1),deal:E}),v&&c.jsx(XR,{isOpen:!!v,onClose:()=>b(null),onConfirm:P=>{const V=f.find(F=>F.name==="Produccin");V&&s(v.id,()=>({stageId:V.id,tagIds:P})),b(null)},deal:v}),c.jsx(JR,{isOpen:I,onClose:()=>N(!1),deal:E}),c.jsxs("div",{className:"mb-8",children:[c.jsxs("button",{onClick:()=>e("/deals"),className:"flex items-center text-sm font-semibold text-slate-600 hover:text-slate-900 mb-4",children:[c.jsx(Q_,{className:"w-5 h-5 mr-1"}),"Back to Deals"]}),c.jsxs("div",{className:"flex justify-between items-start gap-4",children:[c.jsxs("div",{className:"flex-grow",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("h2",{className:"text-3xl font-bold text-slate-800",children:E.title}),A?c.jsx("span",{className:"bg-red-100 text-red-800 text-sm font-semibold mr-2 px-3 py-1 rounded-full",children:"Eliminado"}):c.jsx("button",{onClick:()=>x(!0),className:"text-slate-500 hover:text-blue-600",children:c.jsx(ms,{className:"w-5 h-5"})})]}),c.jsxs("div",{className:"flex items-center gap-6 mt-2",children:[C&&c.jsxs("p",{className:"text-sm text-slate-600 flex items-center font-medium",children:[c.jsx(Rr,{className:"w-4 h-4 mr-2 text-slate-500"}),C.name]}),E.deliveryDate&&c.jsxs("p",{className:"text-sm text-slate-600 flex items-center font-medium",children:[c.jsx(Dr,{className:"w-4 h-4 mr-2 text-slate-500"}),$n(E.deliveryDate)]})]})]}),A&&c.jsxs("button",{onClick:()=>i(E.id),className:"flex items-center bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors",children:[c.jsx(Wa,{className:"w-5 h-5 mr-2"})," Restore Deal"]})]}),c.jsx("div",{className:"mt-6 border-t pt-6",children:A?c.jsx("p",{className:"text-slate-500 italic p-3 bg-slate-100 rounded-md",children:"This deal is archived. Restore it to make changes."}):c.jsx(KB,{deal:E,onStageChange:q})})]}),c.jsxs("fieldset",{disabled:A,className:"grid grid-cols-1 lg:grid-cols-3 lg:gap-8 lg:items-start disabled:opacity-75",children:[c.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[c.jsx(YB,{dealId:E.id}),c.jsx(HB,{dealId:E.id})]}),c.jsx("div",{className:"lg:col-span-1 mt-8 lg:mt-0 space-y-8",children:c.jsxs("div",{className:"space-y-8",children:[c.jsx(XB,{deal:E}),c.jsx(FB,{deal:E}),c.jsx(QB,{deal:E}),c.jsx(UB,{deal:E})]})})]})]})},ZB=({isOpen:n,onClose:e,onAddTask:t,onUndo:s,dealId:i,defaultResponsibleUserId:o})=>{const{users:u}=Ue(),h=F=>F.toISOString().split("T")[0],f=h(new Date),p=new Date;p.setDate(p.getDate()+1);const x=h(p),v=h(Qi(new Date,2)),[b,I]=S.useState("Seguimiento"),[N,E]=S.useState(v),[A,C]=S.useState(o||"");Wi.useEffect(()=>{n&&(I("Seguimiento"),E(v),C(o||""))},[n,v,o]);const q=()=>{b.trim()&&t(b,N,i,A)},P=()=>{s(),e()},V=F=>`px-3 py-1.5 rounded-md text-sm font-semibold transition-colors border ${F?"bg-blue-600 text-white border-blue-700":"bg-white text-slate-700 border-slate-300 hover:bg-slate-100"}`;return c.jsx(sn,{isOpen:n,onClose:e,title:"Create Follow-up Task",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("p",{className:"text-sm text-slate-600",children:"The previous task was marked as complete. Create a follow-up task?"}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"followup-title",className:"block text-sm font-medium text-slate-700",children:"Task Title"}),c.jsx("input",{type:"text",id:"followup-title",value:b,onChange:F=>I(F.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Due Date"}),c.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[c.jsx("button",{type:"button",onClick:()=>E(f),className:V(N===f),children:"Hoy"}),c.jsx("button",{type:"button",onClick:()=>E(x),className:V(N===x),children:"Maana"}),c.jsx("button",{type:"button",onClick:()=>E(v),className:V(N===v),children:"En 2 das"}),c.jsx(Nu,{value:N,onChange:E,children:c.jsx("div",{className:V(!!N&&N!==f&&N!==x&&N!==v),children:c.jsx(Dr,{className:"w-4 h-4"})})}),N&&c.jsxs("div",{className:"flex items-center gap-2 text-sm bg-blue-100 text-blue-800 font-medium px-3 py-1.5 rounded-md",children:[c.jsx("span",{children:$n(N)}),c.jsx("button",{type:"button",onClick:()=>E(""),className:"text-blue-600 hover:text-blue-800",children:c.jsx(fn,{className:"w-4 h-4"})})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"followup-user",className:"block text-sm font-medium text-slate-700",children:"Assign to"}),c.jsxs("select",{id:"followup-user",value:A,onChange:F=>C(F.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[c.jsx("option",{value:"",children:"Unassigned"}),u.map(F=>c.jsx("option",{value:F.id,children:F.name},F.id))]})]}),c.jsxs("div",{className:"flex justify-between items-center pt-4",children:[c.jsx("button",{onClick:P,className:"px-4 py-2 text-sm font-medium text-slate-700 rounded-md hover:bg-slate-100",children:"Undo"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Skip"}),c.jsx("button",{onClick:q,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700",children:"Create Task"})]})]})]})})},e9=()=>{const{currentUser:n,users:e,getAllPendingTasks:t,updateTask:s,deleteTask:i,getDealById:o,addTask:u,getUserById:h,deleteTasks:f,completeTasks:p,showConfirmation:x,showAlert:v}=Ue(),[b,I]=S.useState(!1),[N,E]=S.useState(null),[A,C]=S.useState(!1),[q,P]=S.useState(null),[V,F]=S.useState(new Set),[K,L]=S.useState(n?.id||"all"),[k,D]=S.useState(!0),M=t(),B=S.useMemo(()=>{if(!n)return e;const te=e.find(Ce=>Ce.id===n.id);if(!te)return e;const we=e.filter(Ce=>Ce.id!==n.id);return[te,...we]},[e,n]),G=S.useMemo(()=>K==="all"?M:K==="unassigned"?M.filter(te=>!te.responsibleUserId):M.filter(te=>te.responsibleUserId===K),[M,K]);S.useEffect(()=>{F(new Set)},[K]);const z=te=>{const we=!te.completed;s({...te,completed:we}).catch(()=>{}),we&&(E(te),I(!0))},he=()=>{N&&s({...N,completed:!1})},Se=async(te,we,Ce,Pe)=>{try{await u({dealId:Ce,title:te,dueDate:we,responsibleUserId:Pe}),I(!1)}catch(xt){console.error("Failed to add follow-up task:",xt)}},J=te=>{P(te),C(!0)},ge=te=>{F(we=>{const Ce=new Set(we);return Ce.has(te)?Ce.delete(te):Ce.add(te),Ce})},le=te=>{te.target.checked?F(new Set(G.map(we=>we.id))):F(new Set)},Ie=()=>{x(`Are you sure you want to delete ${V.size} tasks? They will be moved to the archive.`,()=>{f(Array.from(V)),F(new Set)})},O=()=>{if(Array.from(V).map(Ce=>M.find(Pe=>Pe.id===Ce)).filter(Boolean).filter(Ce=>!Ce.responsibleUserId).length>0){v("Action Required","Cannot complete tasks that are unassigned. Please assign them first.");return}p(Array.from(V)),F(new Set)},oe=te=>{x("Are you sure you want to delete this task? It will be moved to the archive.",()=>i(te))},me=({isActive:te,onClick:we,children:Ce})=>c.jsx("button",{onClick:we,className:`whitespace-nowrap px-4 py-3 text-sm font-semibold rounded-t-lg border-b-2 transition-colors ${te?"text-blue-600 border-blue-600":"text-slate-500 border-transparent hover:text-slate-700 hover:border-slate-300"}`,children:Ce});return c.jsxs("div",{className:"flex flex-col h-[calc(100vh)] p-8",children:[N&&c.jsx(ZB,{isOpen:b,onClose:()=>I(!1),onAddTask:Se,onUndo:he,dealId:N.dealId,defaultResponsibleUserId:N.responsibleUserId}),c.jsx(eC,{isOpen:A,onClose:()=>C(!1),taskToEdit:q}),c.jsxs("div",{className:"flex-shrink-0 pb-6 space-y-6",children:[c.jsx("div",{className:"flex justify-between items-center",children:c.jsx("h2",{className:"text-3xl font-bold text-slate-800",children:"Tareas"})}),c.jsx(hf,{}),c.jsxs("div",{className:"bg-white shadow rounded-lg",children:[c.jsxs("button",{onClick:()=>D(!k),className:"w-full flex justify-between items-center p-4 text-left text-lg font-semibold text-slate-700","aria-expanded":!k,children:[c.jsx("span",{children:"Aadir nueva tarea"}),c.jsx(GR,{className:`w-5 h-5 transition-transform duration-200 ${k?"rotate-180":""}`})]}),!k&&c.jsx("div",{className:"p-4 border-t border-slate-200",children:c.jsx(ZR,{showUserAssignment:!0,className:"bg-transparent border-none p-0 shadow-none"})})]})]}),c.jsx("div",{className:"border-b border-slate-200 mb-4",children:c.jsxs("nav",{className:"-mb-px flex space-x-4 overflow-x-auto","aria-label":"Tabs",children:[c.jsx(me,{isActive:K==="all",onClick:()=>L("all"),children:"Todos"}),B.map(te=>c.jsx(me,{isActive:K===te.id,onClick:()=>L(te.id),children:te.name},te.id))]})}),c.jsxs("div",{className:"flex-grow overflow-auto",children:[V.size>0&&c.jsxs("div",{className:"bg-blue-100 border border-blue-200 rounded-lg p-3 flex justify-between items-center mb-4",children:[c.jsxs("span",{className:"text-sm font-semibold text-blue-800",children:[V.size," task(s) selected"]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("button",{onClick:O,className:"flex items-center gap-2 text-sm font-semibold text-slate-700 hover:text-blue-600",children:[c.jsx(El,{className:"w-5 h-5"})," Mark as complete"]}),c.jsxs("button",{onClick:Ie,className:"flex items-center gap-2 text-sm font-semibold text-red-600 hover:text-red-800",children:[c.jsx(In,{className:"w-5 h-5"})," Delete"]}),c.jsx("button",{onClick:()=>F(new Set),className:"text-slate-500 hover:text-slate-700",children:c.jsx(fn,{className:"w-5 h-5"})})]})]}),c.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[c.jsxs("div",{className:"p-4 border-b border-slate-200 flex items-center",children:[c.jsx("input",{type:"checkbox",id:"select-all-tasks",className:"h-4 w-4 rounded border-slate-300 accent-blue-600 focus:ring-blue-500",onChange:le,checked:G.length>0&&V.size===G.length,disabled:G.length===0}),c.jsx("label",{htmlFor:"select-all-tasks",className:"ml-3 text-sm text-slate-600 font-medium",children:"Select All Pending Tasks"})]}),c.jsx("div",{className:"divide-y divide-slate-200",children:G.length>0?G.map(te=>{const we=te.dealId?o(te.dealId):null,Ce=te.responsibleUserId?h(te.responsibleUserId):null,Pe=new Date;Pe.setHours(0,0,0,0);const xt=te.dueDate?new Date(te.dueDate+"T00:00:00"):null,rt=xt&&xt<Pe&&!te.completed;return c.jsxs("div",{className:`flex items-center justify-between p-4 group ${V.has(te.id)?"bg-blue-50":"hover:bg-slate-50"}`,children:[c.jsxs("div",{className:"flex items-center flex-grow pr-4",children:[c.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 accent-blue-600 focus:ring-blue-500 mr-4 flex-shrink-0",checked:V.has(te.id),onChange:()=>ge(te.id),"aria-label":`Select task ${te.title}`}),c.jsx("button",{onClick:()=>z(te),"aria-label":te.completed?"Mark as incomplete":"Mark as complete",className:"pt-px",children:te.completed?c.jsx(El,{className:"w-6 h-6 text-green-500 mr-4 flex-shrink-0"}):c.jsx(HR,{className:"w-6 h-6 text-slate-400 group-hover:text-blue-500 mr-4 flex-shrink-0"})}),c.jsxs("div",{className:"flex-grow",children:[c.jsx("p",{className:"text-slate-800 font-medium",children:te.title}),c.jsxs("div",{className:"flex items-center gap-4 text-sm mt-1",children:[we&&c.jsxs(zc,{to:`/deals/${we.id}`,onClick:Ot=>Ot.stopPropagation(),className:"text-blue-600 hover:underline",children:["Deal: ",we.title]}),Ce?c.jsxs("span",{className:"text-slate-500 flex items-center",children:[c.jsx(Rr,{className:"w-4 h-4 mr-1.5"}),Ce.name]}):c.jsxs("span",{className:"text-slate-400 italic flex items-center",children:[c.jsx(Rr,{className:"w-4 h-4 mr-1.5"}),"Unassigned"]})]})]})]}),c.jsxs("div",{className:"flex items-center gap-4 flex-shrink-0",children:[te.dueDate&&c.jsxs("p",{className:`flex items-center text-sm ${rt?"text-red-600 font-semibold":"text-slate-500"}`,children:[c.jsx(Dr,{className:"w-4 h-4 mr-1.5"}),"Due ",$n(te.dueDate)]}),c.jsxs("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[c.jsx("button",{onClick:Ot=>{Ot.stopPropagation(),J(te)},className:"text-slate-400 hover:text-blue-600",children:c.jsx(ms,{className:"w-5 h-5"})}),c.jsx("button",{onClick:Ot=>{Ot.stopPropagation(),oe(te.id)},className:"text-slate-400 hover:text-red-600",children:c.jsx(In,{className:"w-5 h-5"})})]})]})]},te.id)}):c.jsxs("div",{className:"p-8 text-center",children:[c.jsx($_,{className:"w-16 h-16 mx-auto text-slate-400"}),c.jsx("h3",{className:"mt-4 text-xl font-semibold text-slate-800",children:"No Pending Tasks"}),c.jsx("p",{className:"mt-1 text-slate-500",children:"No tasks match the current filter."})]})})]})]})]})},t9=({isOpen:n,onClose:e,templateToEdit:t})=>{const{addMessageTemplate:s,updateMessageTemplate:i}=Ue(),[o,u]=S.useState(""),[h,f]=S.useState("");S.useEffect(()=>{t?(u(t.title),f(t.body)):(u(""),f(""))},[t,n]);const p=x=>{if(x.preventDefault(),!o||!h)return;const v={title:o,body:h};t?i({...v,id:t.id,sortIndex:t.sortIndex}):s(v),e()};return c.jsx(sn,{isOpen:n,onClose:e,title:t?"Edit Message Template":"Add New Message Template",children:c.jsxs("form",{onSubmit:p,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"template-title",className:"block text-sm font-medium text-slate-700",children:"Template Title"}),c.jsx("input",{type:"text",id:"template-title",value:o,onChange:x=>u(x.target.value),placeholder:"e.g., Seguimiento",className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"template-body",className:"block text-sm font-medium text-slate-700",children:"Message Body"}),c.jsx("textarea",{id:"template-body",value:h,onChange:x=>f(x.target.value),rows:4,className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0}),c.jsxs("div",{className:"mt-2 text-xs text-slate-500",children:["Available placeholders: ",c.jsx("code",{className:"bg-slate-200 px-1 rounded",children:"{nombre del cliente}"})]})]}),c.jsxs("div",{className:"flex justify-end pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"mr-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700",children:t?"Save Changes":"Add Template"})]})]})})},n9={"first name":"firstName",firstname:"firstName",nombre:"firstName",nombres:"firstName","last name":"lastName",lastname:"lastName",apellido:"lastName",apellidos:"lastName",email:"email","email address":"email",correo:"email","correo electrnico":"email","email 2":"email2","secondary email":"email2","email secundario":"email2",phone:"phone","phone number":"phone",telfono:"phone",telefono:"phone",mvil:"phone",movil:"phone",company:"company",empresa:"company",organizacin:"company","drive url":"googleDriveFolderUrl","google drive":"googleDriveFolderUrl","folder url":"googleDriveFolderUrl"},s9=n=>{const e=n.toLowerCase().trim().replace(/_/g," ");return n9[e]||"ignore"},qS=[{key:"firstName",label:"First Name"},{key:"lastName",label:"Last Name"},{key:"email",label:"Email"},{key:"email2",label:"Secondary Email"},{key:"phone",label:"Phone"},{key:"company",label:"Company"},{key:"googleDriveFolderUrl",label:"Google Drive URL"}],r9=n=>{const e=n.trim().split(/\r\n|\n/);if(e.length<1)return{headers:[],data:[]};const t=e[0].split(",").map(i=>i.trim()),s=e.slice(1).map(i=>{const o=i.split(","),u={};return t.forEach((h,f)=>{let p=(o[f]||"").trim();p.startsWith('"')&&p.endsWith('"')&&(p=p.substring(1,p.length-1)),u[h]=p}),u});return{headers:t,data:s}},i9=({isOpen:n,onClose:e})=>{const{bulkAddContacts:t}=Ue(),[s,i]=S.useState(1),[o,u]=S.useState(null),[h,f]=S.useState([]),[p,x]=S.useState([]),[v,b]=S.useState({}),[I,N]=S.useState(null),E=()=>{i(1),u(null),f([]),x([]),b({}),N(null)},A=()=>{E(),e()},C=he=>{if(N(null),he&&he.type==="text/csv"){const Se=new FileReader;Se.onload=J=>{try{const ge=J.target?.result,{headers:le,data:Ie}=r9(ge);if(le.length===0||Ie.length===0){N("File is empty or not formatted correctly.");return}u(he),f(le),x(Ie);const O=le.reduce((oe,me)=>(oe[me]=s9(me),oe),{});b(O),i(2)}catch{N("Failed to parse CSV file. Please check its format.")}},Se.readAsText(he)}else N("Please upload a valid CSV file.")},q=he=>{he.target.files&&he.target.files.length>0&&C(he.target.files[0])},P=S.useCallback(he=>{he.preventDefault(),he.stopPropagation(),he.dataTransfer.files&&he.dataTransfer.files.length>0&&(C(he.dataTransfer.files[0]),he.dataTransfer.clearData())},[]),V=he=>{he.preventDefault(),he.stopPropagation()},F=(he,Se)=>{b(J=>({...J,[he]:Se}))},K=async()=>{i(3);try{const he=p.map(Se=>{const J={};for(const ge in v){const le=v[ge];le!=="ignore"&&(J[le]=Se[ge])}return J});await t(he),i(4)}catch{N("An error occurred during import. Please try again."),i(2)}},L=S.useMemo(()=>{const he=Object.values(v),Se=["firstName","lastName","company","email","phone"];return!he.some(J=>Se.includes(J))},[v]),k=()=>c.jsxs("div",{className:"text-center",children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Upload CSV File"}),c.jsx("p",{className:"text-sm text-slate-500 mt-1 mb-4",children:"Select a CSV file containing the contacts you want to import."}),c.jsx("div",{onDrop:P,onDragOver:V,className:"border-2 border-dashed border-slate-300 rounded-lg p-10",children:c.jsxs("label",{htmlFor:"csv-upload",className:"cursor-pointer flex flex-col items-center",children:[c.jsx(KR,{className:"w-12 h-12 text-slate-400"}),c.jsxs("p",{className:"mt-2 font-semibold text-slate-700",children:[c.jsx("span",{className:"text-blue-600",children:"Click to upload"})," or drag and drop"]}),c.jsx("p",{className:"text-xs text-slate-500",children:"CSV file up to 5MB"}),c.jsx("input",{id:"csv-upload",type:"file",accept:".csv",onChange:q,className:"sr-only"})]})}),I&&c.jsx("p",{className:"mt-4 text-sm text-red-600",children:I})]}),D=()=>c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Map Fields"}),c.jsx("p",{className:"text-sm text-slate-500 mt-1 mb-4",children:"Match the columns from your CSV to the fields in the CRM. At least one of name, company, email or phone must be mapped."}),c.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto pr-2 border-b pb-4",children:h.map(he=>c.jsxs("div",{className:"grid grid-cols-2 gap-4 items-center",children:[c.jsx("span",{className:"font-medium text-slate-700 text-sm truncate",title:he,children:he}),c.jsxs("select",{value:v[he]||"ignore",onChange:Se=>F(he,Se.target.value),className:"block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm",children:[c.jsx("option",{value:"ignore",children:"Ignore this column"}),qS.map(Se=>c.jsx("option",{value:Se.key,children:Se.label},Se.key))]})]},he))}),c.jsxs("div",{className:"mt-4",children:[c.jsx("h4",{className:"font-semibold text-sm text-slate-600 mb-2",children:"Data Preview"}),c.jsx("div",{className:"overflow-x-auto border rounded-lg",children:c.jsxs("table",{className:"min-w-full text-xs",children:[c.jsx("thead",{className:"bg-slate-50",children:c.jsx("tr",{children:h.map(he=>{const Se=qS.find(J=>J.key===v[he]);return c.jsx("th",{className:"p-2 text-left font-medium text-slate-500",children:Se?Se.label:"(ignored)"},he)})})}),c.jsx("tbody",{className:"divide-y divide-slate-200",children:p.slice(0,3).map((he,Se)=>c.jsx("tr",{children:h.map(J=>c.jsx("td",{className:"p-2 text-slate-600 truncate max-w-[100px]",children:he[J]},J))},Se))})]})})]}),I&&c.jsx("p",{className:"mt-4 text-sm text-red-600",children:I})]}),M=()=>c.jsxs("div",{className:"text-center p-8 flex flex-col items-center",children:[c.jsx(Wa,{className:"w-12 h-12 text-blue-600 animate-spin"}),c.jsx("h3",{className:"text-lg font-semibold text-slate-800 mt-4",children:"Importing Contacts..."}),c.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Please wait while we process your file."})]}),B=()=>c.jsxs("div",{className:"text-center p-8 flex flex-col items-center",children:[c.jsx(El,{className:"w-12 h-12 text-green-500"}),c.jsx("h3",{className:"text-lg font-semibold text-slate-800 mt-4",children:"Import Successful"}),c.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:[p.length," contacts have been successfully imported."]})]}),G=()=>{switch(s){case 1:return c.jsx(k,{});case 2:return c.jsx(D,{});case 3:return c.jsx(M,{});case 4:return c.jsx(B,{});default:return null}},z=()=>{if(s===1||s===3)return c.jsx("div",{className:"flex justify-end",children:c.jsx("button",{type:"button",onClick:A,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"})});if(s===2)return c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("button",{type:"button",onClick:()=>{u(null),i(1)},className:"px-4 py-2 text-sm font-medium text-slate-700 rounded-md hover:bg-slate-100",children:"Back"}),c.jsx("button",{type:"button",onClick:K,disabled:L,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed",children:"Import"})]});if(s===4)return c.jsx("div",{className:"flex justify-end",children:c.jsx("button",{type:"button",onClick:A,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700",children:"Done"})})};return c.jsx(sn,{isOpen:n,onClose:A,title:"Import Contacts",children:c.jsxs("div",{className:"min-h-[400px] flex flex-col",children:[c.jsx("div",{className:"flex-grow",children:G()}),c.jsx("div",{className:"flex-shrink-0 pt-6 mt-6 border-t",children:z()})]})})},Z0=({status:n,message:e})=>{switch(n){case"pending":return c.jsx(Wa,{className:"w-5 h-5 text-slate-500 animate-spin"});case"success":return c.jsx(El,{className:"w-5 h-5 text-green-500"});case"failed":return c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(eB,{className:"w-5 h-5 text-red-500"}),e&&c.jsx("span",{className:"text-xs text-red-600",children:e})]});default:return c.jsx("div",{className:"w-5 h-5"})}},a9=()=>{const{currentUser:n}=Ue(),[e,t]=S.useState(!1),[s,i]=S.useState("idle"),[o,u]=S.useState("idle"),[h,f]=S.useState("idle"),[p,x]=S.useState(""),[v,b]=S.useState(""),[I,N]=S.useState(""),E=async()=>{if(!n){alert("Current user not found. Please log in again.");return}t(!0),i("pending"),x(""),u("idle"),b(""),f("idle"),N("");const A=`test_${n.id}_${Date.now()}`;let C=null;try{const q={userId:n.id,message:"Notification system test write.",link:"/settings",isRead:!0,createdAt:new Date().toISOString(),createdBy:{id:n.id,name:n.name},testId:A};C=(await Re.collection("notifications").add(q)).id,i("success")}catch(q){i("failed"),x(q.message||"An unknown error occurred."),t(!1);return}u("pending"),await new Promise(q=>setTimeout(q,500));try{const q=await Re.collection("notifications").where("testId","==",A).limit(1).get();if(q.empty)throw new Error("Test notification created but not found. This might indicate a permissions issue or an ID mismatch.");if(q.docs[0].id!==C)throw new Error("Found a test doc, but its ID does not match. This could indicate a query issue.");u("success")}catch(q){u("failed"),b(q.message||"An unknown error occurred.")}if(f("pending"),C)try{await Re.collection("notifications").doc(C).delete(),f("success")}catch(q){f("failed"),N(q.message||"Failed to clean up test notification.")}else f("failed"),N("Cannot run delete test because write test failed to return a document ID.");t(!1)};return c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-slate-800 mb-4",children:"Notification System Diagnostics"}),c.jsxs("div",{className:"bg-slate-50 p-6 rounded-lg border",children:[c.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"This tool tests the fundamental operations (Write, Read, Delete) for notifications for your user account. If any step fails, it likely indicates a problem with database permissions or configuration."}),c.jsxs("div",{className:"space-y-3 p-4 bg-white rounded-md border",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"font-medium text-slate-700",children:"1. Write Test Notification"}),c.jsx(Z0,{status:s,message:p})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"font-medium text-slate-700",children:"2. Read Test Notification"}),c.jsx(Z0,{status:o,message:v})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"font-medium text-slate-700",children:"3. Delete Test Notification (Cleanup)"}),c.jsx(Z0,{status:h,message:I})]})]}),c.jsx("div",{className:"mt-6 flex justify-end",children:c.jsxs("button",{onClick:E,disabled:e,className:"flex items-center bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors disabled:bg-blue-400 disabled:cursor-wait",children:[e?c.jsx(Wa,{className:"w-5 h-5 mr-2 animate-spin"}):c.jsx(YR,{className:"w-5 h-5 mr-2"}),e?"Running...":"Run Diagnostics"]})})]})]})},o9=({isOpen:n,onClose:e,userToEdit:t})=>{const{addUser:s,updateUser:i}=Ue(),[o,u]=S.useState(""),[h,f]=S.useState(""),[p,x]=S.useState("");S.useEffect(()=>{t?(u(t.name),f(t.email),x(t.role)):(u(""),f(""),x(""))},[t,n]);const v=b=>{if(b.preventDefault(),!o||!p)return;const I={name:o,email:h,role:p};t?i({...I,id:t.id,sortIndex:t.sortIndex}):s(I),e()};return c.jsx(sn,{isOpen:n,onClose:e,title:t?"Edit User":"Add New User",children:c.jsxs("form",{onSubmit:v,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-700",children:"Full Name"}),c.jsx("input",{type:"text",id:"name",value:o,onChange:b=>u(b.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700",children:"Email (Optional)"}),c.jsx("input",{type:"email",id:"email",value:h,onChange:b=>f(b.target.value),placeholder:"user@example.com (for login)",className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"}),c.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Required only for users who need to log in to the platform."})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-slate-700",children:"Role"}),c.jsx("input",{type:"text",id:"role",value:p,onChange:b=>x(b.target.value),placeholder:"e.g., Ventas, Diseo, Administrador",className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{className:"flex justify-end pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"mr-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700",children:t?"Save Changes":"Add User"})]})]})})},l9=()=>{const{users:n,deleteUser:e,showConfirmation:t,reorderUser:s}=Ue(),[i,o]=S.useState(!1),[u,h]=S.useState(null),f=Wi.useRef(null),p=()=>{h(null),o(!0)},x=E=>{h(E),o(!0)},v=E=>{t(`Are you sure you want to remove ${E.name}? They will no longer be able to access the CRM.`,()=>e(E.id))},b=(E,A)=>{f.current=A,E.dataTransfer.effectAllowed="move"},I=(E,A)=>{E.preventDefault(),f.current&&f.current!==A&&s(f.current,A),f.current=null},N=E=>{E.preventDefault(),E.dataTransfer.dropEffect="move"};return c.jsxs("div",{children:[c.jsx(o9,{isOpen:i,onClose:()=>o(!1),userToEdit:u}),c.jsx("div",{className:"flex justify-end mb-4",children:c.jsxs("button",{onClick:p,className:"flex items-center bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors",children:[c.jsx(fs,{className:"w-5 h-5 mr-2"}),"Add User"]})}),c.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[c.jsx("thead",{className:"bg-slate-50",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:"px-2 py-3 w-12"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Name"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Email"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Role"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:n.map(E=>c.jsxs("tr",{className:"hover:bg-slate-50",draggable:E.id!=="user_raul_colosio",onDragStart:A=>E.id!=="user_raul_colosio"&&b(A,E.id),onDrop:A=>E.id!=="user_raul_colosio"&&I(A,E.id),onDragOver:N,children:[c.jsx("td",{className:`px-4 py-4 whitespace-nowrap text-slate-400 ${E.id!=="user_raul_colosio"?"cursor-move hover:text-slate-600":""}`,children:E.id!=="user_raul_colosio"&&c.jsx(df,{className:"w-5 h-5"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-900",children:E.name}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:E.email||c.jsx("span",{className:"text-slate-400 italic",children:"No login"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:c.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${E.role==="Administrador"?"bg-indigo-100 text-indigo-800":E.role==="Director"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:E.role})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium flex items-center gap-4",children:E.id!=="user_raul_colosio"?c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>x(E),className:"text-blue-600 hover:text-blue-900","aria-label":`Edit ${E.name}`,children:c.jsx(ms,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>v(E),className:"text-red-600 hover:text-red-900","aria-label":`Delete ${E.name}`,children:c.jsx(In,{className:"w-5 h-5"})})]}):c.jsx("span",{className:"text-xs text-slate-400 font-medium",children:"Sistema"})})]},E.id))})]})})]})},Bc=["bg-red-500","bg-yellow-500","bg-green-500","bg-blue-500","bg-indigo-500","bg-purple-500","bg-pink-500","bg-gray-500"],c9=({isOpen:n,onClose:e,tagToEdit:t})=>{const{addTag:s,updateTag:i}=Ue(),[o,u]=S.useState(""),[h,f]=S.useState(Bc[0]);S.useEffect(()=>{t?(u(t.name),f(t.color)):(u(""),f(Bc[0]))},[t,n]);const p=x=>{x.preventDefault(),!(!o||!h)&&(e(),(async()=>{const v={name:o,color:h};try{t?await i({...v,id:t.id,sortIndex:t.sortIndex}):await s(v)}catch(b){console.error("Failed to save tag in background:",b)}})())};return c.jsx(sn,{isOpen:n,onClose:e,title:t?"Edit Tag":"Add New Tag",children:c.jsxs("form",{onSubmit:p,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"tag-name",className:"block text-sm font-medium text-slate-700",children:"Tag Name"}),c.jsx("input",{type:"text",id:"tag-name",value:o,onChange:x=>u(x.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Color"}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:Bc.map(x=>c.jsx("button",{type:"button",onClick:()=>f(x),className:`w-8 h-8 rounded-full ${x} ${h===x?"ring-2 ring-offset-2 ring-blue-500":""}`},x))})]}),c.jsxs("div",{className:"flex justify-end pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"mr-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700",children:t?"Save Changes":"Add Tag"})]})]})})},u9=()=>{const{tags:n,deleteTag:e,showConfirmation:t,reorderTag:s}=Ue(),[i,o]=S.useState(!1),[u,h]=S.useState(null),f=Wi.useRef(null),p=()=>{h(null),o(!0)},x=E=>{h(E),o(!0)},v=E=>{t("Are you sure you want to delete this tag? It will be removed from all deals.",()=>e(E))},b=(E,A)=>{f.current=A,E.dataTransfer.effectAllowed="move"},I=(E,A)=>{E.preventDefault(),f.current&&f.current!==A&&s(f.current,A),f.current=null},N=E=>{E.preventDefault(),E.dataTransfer.dropEffect="move"};return c.jsxs("div",{children:[c.jsx(c9,{isOpen:i,onClose:()=>o(!1),tagToEdit:u}),c.jsx("div",{className:"flex justify-end mb-4",children:c.jsxs("button",{onClick:p,className:"flex items-center bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors",children:[c.jsx(fs,{className:"w-5 h-5 mr-2"}),"Add Tag"]})}),c.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[c.jsx("thead",{className:"bg-slate-50",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:"px-2 py-3 w-12"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Preview"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Name"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:n.map(E=>c.jsxs("tr",{className:"hover:bg-slate-50",draggable:!0,onDragStart:A=>b(A,E.id),onDrop:A=>I(A,E.id),onDragOver:N,children:[c.jsx("td",{className:"px-4 py-4 whitespace-nowrap cursor-move text-slate-400 hover:text-slate-600",children:c.jsx(df,{className:"w-5 h-5"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`text-xs font-semibold text-white px-2 py-1 rounded-full ${E.color}`,children:E.name})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-900",children:E.name}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium flex items-center gap-4",children:[c.jsx("button",{onClick:()=>x(E),className:"text-blue-600 hover:text-blue-900",children:c.jsx(ms,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>v(E.id),className:"text-red-600 hover:text-red-900",children:c.jsx(In,{className:"w-5 h-5"})})]})]},E.id))})]})})]})},d9=({isOpen:n,onClose:e,tagToEdit:t})=>{const{addContactTag:s,updateContactTag:i}=Ue(),[o,u]=S.useState(""),[h,f]=S.useState(Bc[0]);S.useEffect(()=>{t?(u(t.name),f(t.color)):(u(""),f(Bc[0]))},[t,n]);const p=x=>{x.preventDefault(),!(!o||!h)&&(e(),(async()=>{const v={name:o,color:h};try{t?await i({...v,id:t.id,sortIndex:t.sortIndex}):await s(v)}catch(b){console.error("Failed to save contact tag in background:",b)}})())};return c.jsx(sn,{isOpen:n,onClose:e,title:t?"Edit Contact Tag":"Add New Contact Tag",children:c.jsxs("form",{onSubmit:p,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"contact-tag-name",className:"block text-sm font-medium text-slate-700",children:"Tag Name"}),c.jsx("input",{type:"text",id:"contact-tag-name",value:o,onChange:x=>u(x.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Color"}),c.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:Bc.map(x=>c.jsx("button",{type:"button",onClick:()=>f(x),className:`w-8 h-8 rounded-full ${x} ${h===x?"ring-2 ring-offset-2 ring-blue-500":""}`},x))})]}),c.jsxs("div",{className:"flex justify-end pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"mr-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700",children:t?"Save Changes":"Add Tag"})]})]})})},h9=()=>{const{contactTags:n,deleteContactTag:e,showConfirmation:t,reorderContactTag:s}=Ue(),[i,o]=S.useState(!1),[u,h]=S.useState(null),f=Wi.useRef(null),p=()=>{h(null),o(!0)},x=E=>{h(E),o(!0)},v=E=>{t("Are you sure you want to delete this contact tag? It will be removed from all associated contacts.",()=>e(E))},b=(E,A)=>{f.current=A,E.dataTransfer.effectAllowed="move"},I=(E,A)=>{E.preventDefault(),f.current&&f.current!==A&&s(f.current,A),f.current=null},N=E=>{E.preventDefault(),E.dataTransfer.dropEffect="move"};return c.jsxs("div",{children:[c.jsx(d9,{isOpen:i,onClose:()=>o(!1),tagToEdit:u}),c.jsx("div",{className:"flex justify-end mb-4",children:c.jsxs("button",{onClick:p,className:"flex items-center bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors",children:[c.jsx(fs,{className:"w-5 h-5 mr-2"}),"Add Contact Tag"]})}),c.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[c.jsx("thead",{className:"bg-slate-50",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:"px-2 py-3 w-12"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Preview"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Name"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:n.map(E=>c.jsxs("tr",{className:"hover:bg-slate-50",draggable:!0,onDragStart:A=>b(A,E.id),onDrop:A=>I(A,E.id),onDragOver:N,children:[c.jsx("td",{className:"px-4 py-4 whitespace-nowrap cursor-move text-slate-400 hover:text-slate-600",children:c.jsx(df,{className:"w-5 h-5"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`text-xs font-semibold text-white px-2 py-1 rounded-full ${E.color}`,children:E.name})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-900",children:E.name}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium flex items-center gap-4",children:[c.jsx("button",{onClick:()=>x(E),className:"text-blue-600 hover:text-blue-900",children:c.jsx(ms,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>v(E.id),className:"text-red-600 hover:text-red-900",children:c.jsx(In,{className:"w-5 h-5"})})]})]},E.id))})]})})]})},f9=()=>{const{messageTemplates:n,deleteMessageTemplate:e,showConfirmation:t,reorderMessageTemplate:s}=Ue(),[i,o]=S.useState(!1),[u,h]=S.useState(null),f=Wi.useRef(null),p=()=>{h(null),o(!0)},x=E=>{h(E),o(!0)},v=E=>{t("Are you sure you want to delete this message template?",()=>e(E))},b=(E,A)=>{f.current=A,E.dataTransfer.effectAllowed="move"},I=(E,A)=>{E.preventDefault(),f.current&&f.current!==A&&s(f.current,A),f.current=null},N=E=>{E.preventDefault(),E.dataTransfer.dropEffect="move"};return c.jsxs("div",{children:[c.jsx(t9,{isOpen:i,onClose:()=>o(!1),templateToEdit:u}),c.jsx("div",{className:"flex justify-end mb-4",children:c.jsxs("button",{onClick:p,className:"flex items-center bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors",children:[c.jsx(fs,{className:"w-5 h-5 mr-2"}),"Add Template"]})}),c.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[c.jsx("thead",{className:"bg-slate-50",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:"px-2 py-3 w-12"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Title"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Body"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:n.map(E=>c.jsxs("tr",{className:"hover:bg-slate-50",draggable:!0,onDragStart:A=>b(A,E.id),onDrop:A=>I(A,E.id),onDragOver:N,children:[c.jsx("td",{className:"px-4 py-4 whitespace-nowrap cursor-move text-slate-400 hover:text-slate-600",children:c.jsx(df,{className:"w-5 h-5"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-900",children:E.title}),c.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-slate-700 max-w-md",children:c.jsx("p",{className:"truncate",title:E.body,children:E.body})}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium flex items-center gap-4",children:[c.jsx("button",{onClick:()=>x(E),className:"text-blue-600 hover:text-blue-900",children:c.jsx(ms,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>v(E.id),className:"text-red-600 hover:text-red-900",children:c.jsx(In,{className:"w-5 h-5"})})]})]},E.id))})]})})]})},m9=()=>{const{pipelineStages:n,updatePipelineStage:e,reorderPipelineStage:t}=Ue(),[s,i]=S.useState(null),[o,u]=S.useState(""),h=Wi.useRef(null),f=I=>{i(I),u(I.name)},p=async I=>{o.trim()&&(await e({...I,name:o}),i(null))},x=(I,N)=>{h.current=N,I.dataTransfer.effectAllowed="move"},v=(I,N)=>{I.preventDefault(),h.current&&h.current!==N&&t(h.current,N),h.current=null},b=I=>{I.preventDefault(),I.dataTransfer.dropEffect="move"};return c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"Pipeline Stages"}),c.jsx("p",{className:"text-sm text-slate-600 my-4",children:"Customize your sales pipeline by renaming and reordering stages. Drag and drop to change the order."}),c.jsx("div",{className:"space-y-2 max-w-md",children:n.map(I=>c.jsxs("div",{className:"flex items-center gap-4 p-2 bg-slate-50 border rounded-lg hover:bg-slate-100",draggable:!0,onDragStart:N=>x(N,I.id),onDrop:N=>v(N,I.id),onDragOver:b,children:[c.jsx("div",{className:"cursor-move text-slate-400 hover:text-slate-600 p-2",children:c.jsx(df,{className:"w-5 h-5"})}),c.jsx("div",{className:"flex-grow",children:s?.id===I.id?c.jsx("input",{type:"text",value:o,onChange:N=>u(N.target.value),className:"block w-full px-2 py-1 bg-white border border-slate-300 rounded-md shadow-sm text-sm",autoFocus:!0}):c.jsx("span",{className:"text-sm font-medium text-slate-800",children:I.name})}),c.jsx("div",{className:"flex items-center gap-2",children:s?.id===I.id?c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>p(I),className:"text-green-600 hover:text-green-800",children:c.jsx(Ig,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>i(null),className:"text-red-600 hover:text-red-800",children:c.jsx(fn,{className:"w-5 h-5"})})]}):c.jsx("button",{onClick:()=>f(I),className:"text-blue-600 hover:text-blue-800",children:c.jsx(ms,{className:"w-5 h-5"})})})]},I.id))})]})},p9=()=>{const n=[{trigger:"Se crea un nuevo deal",action:"Crea tarea 'Enviar cotizacin' al usuario asignado (vence hoy).",status:"Activo"},{trigger:"Se crea un nuevo contacto",action:"Asigna automticamente la etiqueta 'Lead'.",status:"Activo"},{trigger:"Deal pasa a fase 'Ganado'",action:"Al contacto asociado: agrega etiqueta 'Cliente' y elimina 'Lead'.",status:"Activo"},{trigger:"Deal pasa a fase 'Ganado'",action:"Crea tarea 'Enviar el Google review' para Ral Colosio (vence en 2 das laborables).",status:"Activo"},{trigger:"Deal entra a fase 'Produccin'",action:"Agrega automticamente la etiqueta 'Recibido'.",status:"Activo"},{trigger:"Deal entra a fase 'Compra de material'",action:"Crea tarea 'Comprar material' al usuario asignado (vence hoy).",status:"Activo"},{trigger:"Etiqueta 'Serigrafa' es agregada",action:"Crea 2 tareas: 'Preparar positivo' (Ral Colosio) y 'Impresin de serigrafa' (impresion@promotienda.mx).",status:"Activo"},{trigger:"Etiqueta 'DTF textil' es agregada",action:"Crea 2 tareas: 'Enviar diseo' (Ral) y 'Estampado DTF' (Produccin).",status:"Activo"},{trigger:"Etiqueta 'UV' es agregada",action:"Crea 2 tareas: 'Enviar diseo' (Ral) y 'Estampado UV' (Produccin).",status:"Activo"}];return c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"Automatizaciones"}),c.jsxs("button",{className:"flex items-center bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors disabled:opacity-50",disabled:!0,children:[c.jsx(fs,{className:"w-5 h-5 mr-2"}),"Crear Automatizacin"]})]}),c.jsx("p",{className:"text-sm text-slate-600 mb-6",children:"Estas son las automatizaciones que se ejecutan actualmente en el sistema. Prximamente se podrn crear automatizaciones personalizadas."}),c.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:c.jsxs("table",{className:"min-w-full divide-y divide-slate-200",children:[c.jsx("thead",{className:"bg-slate-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Disparador (Trigger)"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Accin"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Estado"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-slate-200",children:n.map((e,t)=>c.jsxs("tr",{className:"hover:bg-slate-50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm font-medium text-slate-900",children:e.trigger}),c.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-slate-700",children:e.action}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:e.status})})]},t))})]})})]})},g9=()=>{const n=[{category:"Deals & Tasks",logic:"Un deal o tarea debe tener siempre un usuario asignado."},{category:"Contacts",logic:"Un contacto no puede tener las etiquetas 'Lead' y 'Cliente' al mismo tiempo. 'Cliente' tiene prioridad y 'Lead' se elimina si ambas estn presentes."},{category:"Production Stage",logic:"Un deal en 'Produccin' debe tener al menos una etiqueta de tipo de produccin para indicar el proceso."},{category:"Production Stage",logic:"Al agregar una etiqueta de produccin (ej. Serigrafa) a un deal que ya tiene 'Recibido', esta ltima se elimina automticamente."},{category:"Production Stage",logic:"Al salir de la fase de 'Produccin', se eliminan todas las etiquetas de produccin asignadas."},{category:"General",logic:"El clculo de fechas para tareas (ej. 'En 2 das') omite los domingos, considerndolos das no laborables."}];return c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"Lgicas del Sistema"}),c.jsx("p",{className:"text-sm text-slate-600 my-4",children:"Estas son las reglas de negocio fundamentales que garantizan la integridad y consistencia de los datos en toda la aplicacin. No son flujos de trabajo, sino restricciones y comportamientos base del sistema."}),c.jsx("div",{className:"space-y-4",children:n.map((e,t)=>c.jsxs("div",{className:"bg-slate-50 border border-slate-200 p-4 rounded-lg",children:[c.jsx("span",{className:"text-xs font-semibold uppercase text-slate-400",children:e.category}),c.jsx("p",{className:"text-slate-700 mt-1",children:e.logic})]},t))})]})},y9=()=>{const{contacts:n,deals:e,getDealById:t,getContactById:s,deletedContacts:i,restoreContact:o,deletedDeals:u,restoreDeal:h,deletedTasks:f,restoreTask:p}=Ue(),[x,v]=S.useState(!1),b=S.useMemo(()=>[...e,...u],[e,u]),I=()=>{const A=["firstName","lastName","email","email2","phone","company","zipCode","googleDriveFolderUrl"];let C="data:text/csv;charset=utf-8,"+A.join(",")+`
`;n.forEach(V=>{const F=A.map(K=>{let L=V[K]||"";return L=String(L).replace(/"/g,'""'),String(L).includes(",")&&(L=`"${L}"`),L}).join(",");C+=F+`
`});const q=encodeURI(C),P=document.createElement("a");P.setAttribute("href",q),P.setAttribute("download","contacts_export.csv"),document.body.appendChild(P),P.click(),document.body.removeChild(P)},N=A=>{if(!A)return 0;const C=new Date(A),q=new Date(C.getTime());q.setDate(q.getDate()+30);const P=new Date,V=q.getTime()-P.getTime();return V<0?0:Math.ceil(V/(1e3*60*60*24))},E=A=>c.jsxs("p",{className:"text-center text-sm text-slate-500 p-6",children:["No archived ",A,"."]});return c.jsxs(c.Fragment,{children:[c.jsx(i9,{isOpen:x,onClose:()=>v(!1)}),c.jsxs("div",{className:"space-y-8",children:[c.jsxs("section",{children:[c.jsx("h3",{className:"text-xl font-semibold text-slate-800 mb-4",children:"Import & Export"}),c.jsxs("div",{className:"bg-slate-50 p-6 rounded-lg border flex flex-col md:flex-row gap-4 justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-slate-700",children:"Export Contacts"}),c.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Download a CSV file of all your contacts."})]}),c.jsxs("button",{onClick:I,className:"flex items-center bg-white text-slate-700 border border-slate-300 px-4 py-2 rounded-lg shadow-sm hover:bg-slate-100 transition-colors",children:[c.jsx(K_,{className:"w-5 h-5 mr-2"}),"Export Contacts"]})]}),c.jsxs("div",{className:"bg-slate-50 p-6 rounded-lg border mt-4 flex flex-col md:flex-row gap-4 justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-slate-700",children:"Import Contacts"}),c.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Import new contacts from a CSV file."})]}),c.jsxs("button",{onClick:()=>v(!0),className:"flex items-center bg-white text-slate-700 border border-slate-300 px-4 py-2 rounded-lg shadow-sm hover:bg-slate-100 transition-colors",children:[c.jsx(sB,{className:"w-5 h-5 mr-2"}),"Import Contacts"]})]})]}),c.jsxs("section",{children:[c.jsx("h3",{className:"text-xl font-semibold text-slate-800 mb-4",children:"Archived Items"}),c.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Items are permanently deleted after 30 days in the archive."}),c.jsxs("div",{className:"mb-6",children:[c.jsxs("h4",{className:"font-semibold text-slate-700 mb-2",children:["Deals (",u.length,")"]}),c.jsx("div",{className:"border rounded-lg max-h-60 overflow-y-auto",children:u.length>0?c.jsx("ul",{className:"divide-y divide-slate-200",children:u.map(A=>{const C=N(A.deletedAt),q=A.contactIds.map(P=>s(P)).filter(Boolean);return c.jsxs("li",{className:"p-3 flex justify-between items-center group",children:[c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-slate-800",children:A.title}),q.length>0&&c.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Contacts: ",q.map(P=>`${P.firstName} ${P.lastName}`).join(", ")]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("span",{className:`text-xs font-semibold px-2 py-1 rounded-full ${C<=7?"bg-red-100 text-red-800":"bg-slate-100 text-slate-600"}`,children:[C," days left"]}),c.jsx("button",{onClick:()=>h(A.id),className:"text-slate-500 hover:text-blue-600 opacity-0 group-hover:opacity-100 transition-opacity",title:"Restore",children:c.jsx(Wa,{className:"w-4 h-4"})})]})]},A.id)})}):E("deals")})]}),c.jsxs("div",{className:"mb-6",children:[c.jsxs("h4",{className:"font-semibold text-slate-700 mb-2",children:["Contacts (",i.length,")"]}),c.jsx("div",{className:"border rounded-lg max-h-60 overflow-y-auto",children:i.length>0?c.jsx("ul",{className:"divide-y divide-slate-200",children:i.map(A=>{const C=N(A.deletedAt),q=b.filter(P=>P.contactIds.includes(A.id));return c.jsxs("li",{className:"p-3 flex justify-between items-center group",children:[c.jsxs("div",{children:[c.jsxs("p",{className:"font-medium text-slate-800",children:[A.firstName," ",A.lastName]}),q.length>0&&c.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Deals: ",q.map((P,V)=>c.jsxs(Wi.Fragment,{children:[c.jsx(zc,{to:`/deals/${P.id}`,className:"text-blue-600 hover:underline",children:P.title}),V<q.length-1&&", "]},P.id))]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("span",{className:`text-xs font-semibold px-2 py-1 rounded-full ${C<=7?"bg-red-100 text-red-800":"bg-slate-100 text-slate-600"}`,children:[C," days left"]}),c.jsx("button",{onClick:()=>o(A.id),className:"text-slate-500 hover:text-blue-600 opacity-0 group-hover:opacity-100 transition-opacity",title:"Restore",children:c.jsx(Wa,{className:"w-4 h-4"})})]})]},A.id)})}):E("contacts")})]}),c.jsxs("div",{children:[c.jsxs("h4",{className:"font-semibold text-slate-700 mb-2",children:["Tasks (",f.length,")"]}),c.jsx("div",{className:"border rounded-lg max-h-60 overflow-y-auto",children:f.length>0?c.jsx("ul",{className:"divide-y divide-slate-200",children:f.map(A=>{const C=N(A.deletedAt),q=A.dealId?t(A.dealId):null;return c.jsxs("li",{className:"p-3 flex justify-between items-center group",children:[c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-slate-800",children:A.title}),q&&c.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["From Deal: ",c.jsx(zc,{to:`/deals/${q.id}`,className:"text-blue-600 hover:underline",children:q.title})]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("span",{className:`text-xs font-semibold px-2 py-1 rounded-full ${C<=7?"bg-red-100 text-red-800":"bg-slate-100 text-slate-600"}`,children:[C," days left"]}),c.jsx("button",{onClick:()=>p(A.id),className:"text-slate-500 hover:text-blue-600 opacity-0 group-hover:opacity-100 transition-opacity",title:"Restore",children:c.jsx(Wa,{className:"w-4 h-4"})})]})]},A.id)})}):E("tasks")})]})]})]})]})},x9=()=>{const{isGoogleDriveConnected:n,connectToGoogleDrive:e,disconnectFromGoogleDrive:t,googleApiReady:s}=Ue(),[i,o]=S.useState(!1),u=async()=>{o(!0),await e(),o(!1)};return c.jsx("div",{children:c.jsxs("div",{className:"bg-slate-50 p-6 rounded-lg border",children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold text-slate-700 mb-2",children:"Google Drive"}),c.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Connect your Google account to select folders for your contacts and deals."})]}),c.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/d/da/Google_Drive_logo.png",alt:"Google Drive",className:"w-12 h-12"})]}),n?c.jsxs("div",{className:"flex items-center justify-between bg-green-50 border border-green-200 p-3 rounded-lg",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Ig,{className:"w-5 h-5 text-green-600"}),c.jsx("p",{className:"text-sm font-semibold text-green-800",children:"Connected to Google Drive"})]}),c.jsx("button",{onClick:t,className:"text-sm font-medium text-slate-600 hover:text-red-600",children:"Disconnect"})]}):c.jsxs("button",{onClick:u,disabled:i||!s,className:"flex items-center justify-center bg-white text-slate-700 border border-slate-300 px-4 py-2 rounded-lg shadow-sm hover:bg-slate-100 transition-colors disabled:bg-slate-100 disabled:cursor-wait",title:s?"Connect to Google Drive":"Google API is loading...",children:[i?c.jsx(Wa,{className:"w-5 h-5 mr-2 animate-spin"}):c.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/d/da/Google_Drive_logo.png",alt:"Google Drive",className:"w-5 h-5 mr-2"}),i?"Connecting...":"Connect to Google Drive"]})]})})},v9=()=>{const[n,e]=S.useState(Notification.permission),t=async()=>{const o=await Notification.requestPermission();e(o)},s=()=>{Notification.permission==="granted"&&new Notification("Test Notification",{body:"If you can see this, desktop notifications are working correctly!",icon:"/vite.svg"})},i=()=>{switch(n){case"granted":return c.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg text-center",children:[c.jsx("p",{className:"font-semibold text-green-800",children:"Desktop notifications are enabled."}),c.jsx("button",{onClick:s,className:"mt-2 text-sm font-semibold text-green-700 hover:underline",children:"Send Test Notification"})]});case"denied":return c.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-center",children:[c.jsx("p",{className:"font-semibold text-red-800",children:"Desktop notifications are disabled."}),c.jsx("p",{className:"text-sm text-red-700 mt-1",children:"You need to enable them in your browser settings for this site."})]});default:return c.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg text-center",children:[c.jsx("p",{className:"font-semibold text-yellow-800",children:"Notifications are not yet enabled."}),c.jsx("button",{onClick:t,className:"mt-2 text-sm font-semibold text-yellow-700 hover:underline",children:"Enable Desktop Notifications"})]})}};return c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-slate-800",children:"Notifications"}),c.jsx("p",{className:"text-sm text-slate-600 my-4",children:"Enable desktop notifications to receive alerts for new messages even when the application is in the background. This feature relies on your browser's capabilities and permissions."}),i()]})},HS={USERS:{id:"users",label:"Users",icon:Rr,content:l9},PIPELINE:{id:"pipeline",label:"Pipeline",icon:wB,content:m9},DEAL_TAGS:{id:"tags",label:"Deal Tags",icon:$R,content:u9},CONTACT_TAGS:{id:"contact_tags",label:"Contact Tags",icon:yB,content:h9},TEMPLATES:{id:"templates",label:"Message Templates",icon:uf,content:f9},NOTIFICATIONS:{id:"notifications",label:"Notifications",icon:mB,content:v9},AUTOMATIONS:{id:"automations",label:"Automatizaciones",icon:pB,content:p9},LOGICS:{id:"logics",label:"Lgicas del Sistema",icon:vB,content:g9},DATA:{id:"data",label:"Data & Archive",icon:nB,content:y9},INTEGRATIONS:{id:"integrations",label:"Integrations",icon:oo,content:x9},DIAGNOSTICS:{id:"diagnostics",label:"Diagnostics",icon:YR,content:a9}},_9=()=>{const[n,e]=S.useState("USERS"),t=HS[n].content;return c.jsxs("div",{className:"flex flex-col h-full p-8 bg-slate-100",children:[c.jsxs("header",{className:"flex-shrink-0 mb-8 space-y-6",children:[c.jsx("h2",{className:"text-3xl font-bold text-slate-800",children:"Settings"}),c.jsx(hf,{})]}),c.jsxs("div",{className:"flex flex-col md:flex-row flex-grow gap-8 overflow-hidden",children:[c.jsx("nav",{className:"flex-shrink-0 md:w-64",children:c.jsx("ul",{className:"space-y-2",children:Object.entries(HS).map(([s,i])=>{const o=i.icon,u=n===s;return c.jsx("li",{children:c.jsxs("button",{onClick:()=>e(s),className:`w-full flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors duration-200 text-left ${u?"bg-blue-600 text-white":"text-slate-600 hover:bg-slate-200"}`,children:[c.jsx(o,{className:"w-5 h-5 mr-3"}),i.label]})},i.id)})})}),c.jsx("main",{className:"flex-grow bg-white p-6 rounded-lg shadow-inner overflow-y-auto",children:c.jsx(t,{})})]})]})},b9=({deal:n,tagColorClass:e})=>{const{getUserById:t}=Ue(),s=Xi(),i=n.assignedUserId?t(n.assignedUserId):void 0,o=()=>{s(`/deals/${n.id}`)};return c.jsxs("div",{onClick:o,className:`bg-white p-4 rounded-lg shadow-sm mb-3 cursor-pointer border-t-4 ${e}`,children:[c.jsx("h4",{className:"font-bold text-slate-800",children:n.title}),c.jsxs("div",{className:"mt-2 space-y-2 text-sm",children:[i&&c.jsxs("div",{className:"flex items-center text-slate-600",children:[c.jsx("span",{className:"bg-slate-200 text-slate-600 rounded-full h-5 w-5 flex items-center justify-center text-xs font-bold mr-2",children:i.name.charAt(0)}),c.jsx("span",{children:i.name})]}),n.deliveryDate&&c.jsxs("div",{className:"flex items-center text-slate-500",children:[c.jsx(Dr,{className:"w-4 h-4 mr-2"}),c.jsx("span",{children:$n(n.deliveryDate)})]})]})]})},w9=({tag:n,deals:e})=>{const t=n.color.replace("bg-","border-t-");return c.jsx("div",{className:"w-80 flex-shrink-0",children:c.jsxs("div",{className:"rounded-lg p-2 h-full flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4 p-2",children:[c.jsx("h3",{className:"font-semibold text-slate-700",children:n.name}),c.jsx("span",{className:"text-sm bg-slate-200 text-slate-600 font-medium px-2 py-1 rounded-full",children:e.length})]}),c.jsx("div",{className:"overflow-y-auto h-full min-h-[50vh] px-1",children:e.map(s=>c.jsx(b9,{deal:s,tagColorClass:t},`${n.id}-${s.id}`))})]})})},T9=()=>{const{deals:n,tags:e}=Ue();return c.jsxs("div",{className:"flex flex-col h-full bg-slate-100",children:[c.jsxs("header",{className:"flex-shrink-0 p-8 pb-4 space-y-6",children:[c.jsx("div",{className:"flex justify-between items-center",children:c.jsx("h2",{className:"text-3xl font-bold text-slate-800",children:"Produccin"})}),c.jsx(hf,{})]}),c.jsx("div",{className:"flex-1 overflow-x-auto px-8 pb-4",children:c.jsx("div",{className:"inline-flex space-x-4 h-full",children:e.map(t=>{const s=n.filter(i=>i.tagIds.includes(t.id)).sort((i,o)=>{const u=i.deliveryDate?new Date(i.deliveryDate).getTime():1/0,h=o.deliveryDate?new Date(o.deliveryDate).getTime():1/0;return u-h});return c.jsx(w9,{tag:t,deals:s},t.id)})})})]})},E9=()=>{const[n,e]=S.useState(""),[t,s]=S.useState(""),[i,o]=S.useState(""),[u,h]=S.useState(!1),{login:f,currentUser:p}=Ue(),x=async v=>{v.preventDefault(),o(""),h(!0);try{await f(n,t)}catch(b){o(b.message||"Failed to log in. Please check your credentials.")}finally{h(!1)}};return p?c.jsx(ip,{to:"/deals",replace:!0}):c.jsx("div",{className:"flex items-center justify-center min-h-screen bg-slate-100",children:c.jsxs("div",{className:"w-full max-w-md p-8 space-y-8 bg-white rounded-lg shadow-md",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-center text-slate-800",children:"PROMOTIENDA"}),c.jsx("h2",{className:"mt-2 text-center text-xl font-semibold text-slate-600",children:"Sign in to your account"})]}),c.jsxs("form",{className:"mt-8 space-y-6",onSubmit:x,children:[c.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),c.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-slate-300 placeholder-slate-500 text-slate-900 rounded-t-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:n,onChange:v=>e(v.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),c.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-slate-300 placeholder-slate-500 text-slate-900 rounded-b-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Password",value:t,onChange:v=>s(v.target.value)})]})]}),i&&c.jsx("p",{className:"text-sm text-center text-red-600",children:i}),c.jsx("div",{children:c.jsx("button",{type:"submit",disabled:u,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-blue-400",children:u?"Signing in...":"Sign in"})})]})]})})},I9=()=>{const{notifications:n,sentNotifications:e,notes:t,contactNotes:s,users:i,markNotificationsAsRead:o,deleteNotifications:u,markNotificationsAsUnread:h,showConfirmation:f,getDealById:p,getContactById:x}=Ue(),[v,b]=S.useState(new Set),[I,N]=S.useState("received"),E=Xi(),A=S.useMemo(()=>[...n].sort((he,Se)=>new Date(Se.createdAt).getTime()-new Date(he.createdAt).getTime()),[n]),C=S.useMemo(()=>[...e].sort((he,Se)=>new Date(Se.createdAt).getTime()-new Date(he.createdAt).getTime()),[e]),q=I==="received"?A:C,P=he=>{b(Se=>{const J=new Set(Se);return J.has(he)?J.delete(he):J.add(he),J})},V=he=>{he.target.checked?b(new Set(q.map(Se=>Se.id))):b(new Set)},F=async he=>{I==="received"&&!he.isRead&&await o([he.id]),E(he.link)},K=()=>{f(`Are you sure you want to delete ${v.size} message(s)? This action cannot be undone.`,async()=>{await u(Array.from(v)),b(new Set)})},L=async()=>{await o(Array.from(v)),b(new Set)},k=async()=>{await h(Array.from(v)),b(new Set)},D=he=>o([he]),M=he=>h([he]),B=he=>{f("Delete this message permanently?",()=>u([he]))},G=({isActive:he,onClick:Se,children:J})=>c.jsx("button",{onClick:Se,className:`px-4 py-3 text-sm font-semibold border-b-2 transition-colors ${he?"text-blue-600 border-blue-600":"text-slate-500 border-transparent hover:text-slate-700 hover:border-slate-300"}`,children:J}),z=q.length>0&&v.size===q.length;return c.jsxs("div",{className:"flex flex-col h-full p-8 bg-slate-100",children:[c.jsx("header",{className:"flex-shrink-0 mb-8",children:c.jsx("h2",{className:"text-3xl font-bold text-slate-800",children:"Mensajes"})}),c.jsxs("main",{className:"flex-grow bg-white rounded-lg shadow-inner flex flex-col overflow-hidden",children:[c.jsx("div",{className:"border-b border-slate-200 sticky top-0 bg-white z-10",children:c.jsxs("div",{className:"px-4 flex",children:[c.jsxs(G,{isActive:I==="received",onClick:()=>{N("received"),b(new Set)},children:["Recibidos (",A.length,")"]}),c.jsxs(G,{isActive:I==="sent",onClick:()=>{N("sent"),b(new Set)},children:["Menciones realizadas (",C.length,")"]})]})}),v.size>0&&c.jsxs("div",{className:"bg-blue-100 border-b border-blue-200 p-3 flex justify-between items-center sticky top-[49px] z-10",children:[c.jsxs("span",{className:"text-sm font-semibold text-blue-800",children:[v.size," message(s) selected"]}),c.jsxs("div",{className:"flex items-center gap-4",children:[I==="received"&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:L,className:"flex items-center gap-2 text-sm font-semibold text-slate-700 hover:text-blue-600",children:[c.jsx(El,{className:"w-5 h-5"})," Mark as read"]}),c.jsxs("button",{onClick:k,className:"flex items-center gap-2 text-sm font-semibold text-slate-700 hover:text-blue-600",children:[c.jsx(Vh,{className:"w-5 h-5"})," Mark as unread"]})]}),c.jsxs("button",{onClick:K,className:"flex items-center gap-2 text-sm font-semibold text-red-600 hover:text-red-800",children:[c.jsx(In,{className:"w-5 h-5"})," Delete"]}),c.jsx("button",{onClick:()=>b(new Set),className:"text-slate-500 hover:text-slate-700",children:c.jsx(fn,{className:"w-5 h-5"})})]})]}),c.jsx("div",{className:"flex-grow overflow-y-auto",children:c.jsxs("div",{className:"divide-y divide-slate-100",children:[c.jsxs("div",{className:"p-4 flex items-center bg-slate-50 border-b border-slate-200 sticky top-0",children:[c.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-300 accent-blue-600 focus:ring-blue-500",onChange:V,checked:z,disabled:q.length===0,"aria-label":"Select all messages"}),c.jsx("span",{className:"ml-3 text-sm text-slate-600 font-medium",children:"Select All"})]}),q.length>0?q.map(he=>{if(I==="received"){const Se=he.link.match(/\/deals\/(\w+)/);let J=he.message;if(Se){const ge=Se[1],le=p(ge);le&&(J=`${he.createdBy.name} te mencion en una nota del deal '${le.title}'.`)}return c.jsxs("div",{className:`flex items-start p-4 group transition-colors ${v.has(he.id)?"bg-blue-50":""}`,children:[c.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 accent-blue-600 focus:ring-blue-500 mt-1 mr-4 flex-shrink-0",checked:v.has(he.id),onChange:()=>P(he.id),"aria-label":`Select message from ${he.createdBy.name}`}),c.jsxs("div",{className:"flex-grow cursor-pointer",onClick:()=>F(he),children:[c.jsxs("div",{className:"flex items-center",children:[!he.isRead&&c.jsx("span",{className:"h-2.5 w-2.5 bg-blue-500 rounded-full mr-3 flex-shrink-0","aria-label":"Unread"}),c.jsx("p",{className:`text-sm ${he.isRead?"text-slate-600":"font-bold text-slate-800"}`,children:J})]}),c.jsx("p",{className:"text-xs text-slate-400 mt-1",children:$n(he.createdAt)})]}),c.jsxs("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity ml-4",children:[he.isRead?c.jsxs("button",{onClick:ge=>{ge.stopPropagation(),M(he.id)},className:"text-slate-500 hover:text-blue-600 p-1",title:"Mark as unread",children:[" ",c.jsx(Vh,{className:"w-5 h-5"})," "]}):c.jsxs("button",{onClick:ge=>{ge.stopPropagation(),D(he.id)},className:"text-slate-500 hover:text-blue-600 p-1",title:"Mark as read",children:[" ",c.jsx(El,{className:"w-5 h-5"})," "]}),c.jsxs("button",{onClick:ge=>{ge.stopPropagation(),B(he.id)},className:"text-slate-500 hover:text-red-600 p-1",title:"Delete",children:[" ",c.jsx(In,{className:"w-5 h-5"})," "]})]})]},he.id)}else{const Se=t.find(me=>me.id===he.sourceNoteId)||s.find(me=>me.id===he.sourceNoteId),J=!!(Se?.likes&&Se.likes.length>0);let ge="Not yet acknowledged.";J&&Se?.likes&&(ge=`Acknowledged by: ${Se.likes.map(te=>i.find(we=>we.id===te)?.name||"a user").join(", ")}`);const le=i.find(me=>me.id===he.userId);let Ie="";const O=he.link.match(/\/deals\/(\w+)/),oe=he.link.match(/contactId=([^&]+)/);if(O){const me=p(O[1]);Ie=me?`en el deal '${me.title}'`:"en un deal eliminado"}else if(oe){const me=x(oe[1]);Ie=me?`para el contacto '${me.firstName||""} ${me.lastName||""}'`:"para un contacto eliminado"}return c.jsxs("div",{className:`flex items-start p-4 group transition-colors ${v.has(he.id)?"bg-blue-50":""}`,children:[c.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 accent-blue-600 focus:ring-blue-500 mt-1 mr-3 flex-shrink-0",checked:v.has(he.id),onChange:()=>P(he.id),"aria-label":`Select message to ${le?.name}`}),c.jsx("div",{className:"flex-shrink-0 mt-1 mr-3",title:ge,children:c.jsx(Y_,{className:`w-5 h-5 transition-colors ${J?"text-blue-600 fill-current":"text-slate-400"}`})}),c.jsxs("div",{className:"flex-grow cursor-pointer",onClick:()=>F(he),children:[c.jsxs("p",{className:"text-sm text-slate-600",children:["Mencionaste a ",c.jsx("span",{className:"font-bold",children:le?.name||"un usuario"})," en una nota ",Ie,"."]}),c.jsx("p",{className:"text-xs text-slate-400 mt-1",children:$n(he.createdAt)})]}),c.jsx("div",{className:"flex items-center gap-4 opacity-0 group-hover:opacity-100 transition-opacity ml-4",children:c.jsx("button",{onClick:me=>{me.stopPropagation(),B(he.id)},className:"text-slate-500 hover:text-red-600 p-1",title:"Delete",children:c.jsx(In,{className:"w-5 h-5"})})})]},he.id)}}):c.jsxs("div",{className:"text-center p-12",children:[c.jsx(WR,{className:"w-12 h-12 mx-auto text-slate-300"}),c.jsxs("h3",{className:"mt-4 text-lg font-semibold text-slate-700",children:["No ",I==="received"?"Received":"Sent"," Messages"]}),c.jsx("p",{className:"mt-1 text-sm text-slate-500",children:"This folder is empty."})]})]})})]})]})},S9=({isOpen:n,onClose:e,onConfirm:t,title:s,message:i})=>n?c.jsx(sn,{isOpen:n,onClose:e,title:s,children:c.jsxs("div",{className:"space-y-6",children:[c.jsx("p",{className:"text-slate-600 text-sm",children:i}),c.jsxs("div",{className:"flex justify-end pt-4 space-x-2",children:[c.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md shadow-sm hover:bg-red-700",children:"Confirm"})]})]})}):null,N9=({note:n})=>{const{users:e,currentUser:t,updateContactNote:s,deleteContactNote:i,showConfirmation:o,toggleContactNoteLike:u,getUserById:h}=Ue(),[f,p]=S.useState(!1),[x,v]=S.useState(""),[b,I]=S.useState([]),[N,E]=S.useState([]),[A,C]=S.useState([]);S.useEffect(()=>{f&&(v(n.content),I(n.attachments||[]),E([]),C([]))},[f,n.content,n.attachments]);const q=()=>{const{attachments:D,...M}=n;s({...M,content:x},N,A),p(!1)},P=()=>{o("Are you sure you want to permanently delete this note? This action cannot be undone.",()=>i(n.id))},V=S.useMemo(()=>t&&n.likes?.includes(t.id),[n.likes,t]),F=S.useMemo(()=>!n.likes||n.likes.length===0?"No one has liked this yet.":"Liked by: "+n.likes.map(D=>h(D)?.name||"a user").join(", "),[n.likes,h]),K=D=>{E(M=>[...M,...D])},L=D=>{I(M=>M.filter(B=>B.id!==D.id)),C(M=>[...M,D])},k=D=>{E(M=>M.filter(B=>B.name!==D))};return c.jsxs("div",{className:"relative pl-8 group",children:[c.jsx("div",{className:"absolute top-0 left-0 h-full border-l-2 border-slate-200",children:c.jsx("div",{className:"absolute -left-[1.05rem] top-1.5 p-1.5 bg-white rounded-full border-2 border-slate-200",children:c.jsx(uf,{className:"w-5 h-5 text-slate-500"})})}),c.jsx("div",{className:"ml-4 py-4",children:f?c.jsxs("div",{className:"space-y-2",children:[c.jsx(Sg,{value:x,onChange:v,placeholder:"Edit your note...",users:e,onFilesDrop:K}),(b.length>0||N.length>0)&&c.jsxs("div",{className:"space-y-2 p-2 border rounded-md bg-slate-50",children:[c.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase",children:"Attachments"}),b.map(D=>c.jsxs("div",{className:"flex items-center justify-between text-sm",children:[c.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[c.jsx(Nr,{className:"w-4 h-4 text-slate-400"}),c.jsx("span",{children:D.name}),c.jsxs("span",{className:"text-xs text-slate-500",children:["(",(D.size/1024).toFixed(1)," KB)"]})]}),c.jsx("button",{onClick:()=>L(D),className:"text-red-500 hover:text-red-700",children:c.jsx(fn,{className:"w-4 h-4"})})]},D.id)),N.map(D=>c.jsxs("div",{className:"flex items-center justify-between text-sm",children:[c.jsxs("div",{className:"flex items-center gap-2 text-blue-700",children:[c.jsx(Nr,{className:"w-4 h-4 text-blue-400"}),c.jsx("span",{children:D.name}),c.jsx("span",{className:"text-xs text-blue-500",children:"(new)"})]}),c.jsx("button",{onClick:()=>k(D.name),className:"text-red-500 hover:text-red-700",children:c.jsx(fn,{className:"w-4 h-4"})})]},D.name))]}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx("button",{onClick:()=>p(!1),className:"px-3 py-1 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsx("button",{onClick:q,className:"px-3 py-1 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700",children:"Save"})]})]}):c.jsxs("div",{className:"flex justify-between items-start gap-4",children:[c.jsxs("div",{className:"flex-grow",children:[c.jsx("p",{className:"text-xs text-slate-400 font-semibold",children:$n(n.createdAt)}),n.content&&c.jsx("div",{className:"prose max-w-none mt-1",dangerouslySetInnerHTML:{__html:n.content}}),n.attachments&&n.attachments.length>0&&c.jsx("div",{className:"mt-3 pt-3 border-t border-slate-100 space-y-2",children:n.attachments.map((D,M)=>c.jsxs("a",{href:D.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-slate-600 hover:text-blue-600 font-medium group",children:[c.jsx(Nr,{className:"w-4 h-4 text-slate-400 group-hover:text-blue-500"}),c.jsx("span",{children:D.name}),c.jsx(K_,{className:"w-4 h-4 text-slate-400 opacity-0 group-hover:opacity-100"})]},M))})]}),c.jsxs("div",{className:"flex-shrink-0 flex items-center gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2 text-slate-500",title:F,children:[c.jsx("button",{onClick:()=>u(n.id),className:`p-1 rounded-full transition-colors ${V?"text-blue-600 hover:text-blue-700":"text-slate-400 hover:text-blue-600"}`,children:c.jsx(Y_,{className:`w-5 h-5 ${V?"fill-current":"fill-none"}`})}),n.likes&&n.likes.length>0&&c.jsx("span",{className:"text-sm font-semibold",children:n.likes.length})]}),c.jsxs("div",{className:"flex space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[c.jsx("button",{onClick:()=>p(!0),className:"text-slate-500 hover:text-blue-600 p-1",children:c.jsx(ms,{className:"w-5 h-5"})}),c.jsx("button",{onClick:P,className:"text-slate-500 hover:text-red-600 p-1",children:c.jsx(In,{className:"w-5 h-5"})})]})]})]})})]})},A9=({contactId:n})=>{const{getNotesForContact:e,addContactNote:t,users:s}=Ue(),i=e(n),[o,u]=S.useState(""),[h,f]=S.useState([]),[p,x]=S.useState(!1),v=N=>{f(E=>[...E,...N])},b=N=>{f(E=>E.filter(A=>A.name!==N))},I=async()=>{const N=o.replace(/<[^>]*>/g,"").trim().length>0,E=/data-mention="true"/.test(o);if(!(!N&&!E&&h.length===0)){x(!0);try{await t({contactId:n,content:o},h),u(""),f([])}catch(A){console.error("Error creating note for contact:",A),alert("Could not save note. Please try again.")}finally{x(!1)}}};return c.jsxs("div",{children:[c.jsxs("h4",{className:"text-lg font-semibold text-slate-800 flex items-center mb-2",children:[c.jsx(uf,{className:"w-5 h-5 mr-2 text-slate-500"}),"Contact Notes"]}),c.jsxs("div",{className:"py-4 space-y-3",children:[c.jsx(Sg,{value:o,onChange:u,placeholder:"Add a note, mention with @, or drag & drop files...",onFilesDrop:v,users:s}),h.length>0&&c.jsxs("div",{className:"space-y-2 p-2 border rounded-md bg-slate-50",children:[c.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase",children:"Attachments"}),h.map((N,E)=>c.jsxs("div",{className:"flex items-center justify-between text-sm",children:[c.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[c.jsx(Nr,{className:"w-4 h-4 text-slate-400"}),c.jsx("span",{children:N.name}),c.jsxs("span",{className:"text-xs text-slate-500",children:["(",(N.size/1024).toFixed(1)," KB)"]})]}),c.jsx("button",{onClick:()=>b(N.name),className:"text-red-500 hover:text-red-700",children:c.jsx(fn,{className:"w-4 h-4"})})]},E))]}),c.jsx("div",{className:"flex justify-end",children:c.jsxs("button",{onClick:I,disabled:p,className:"flex items-center bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors text-sm font-semibold disabled:bg-blue-300",children:[c.jsx(fs,{className:"w-4 h-4 mr-2"})," ",p?"Saving...":"Add Note"]})})]}),c.jsx("div",{className:"mt-4 border-t border-slate-200",children:i.length>0?i.map(N=>c.jsx("div",{className:"border-b border-slate-200 last:border-b-0",children:c.jsx(N9,{note:N})},N.id)):c.jsx("p",{className:"text-sm text-slate-500 text-center py-8",children:"No notes for this contact yet."})})]})},R9=n=>`https://web.whatsapp.com/send?phone=${n.replace(/\D/g,"")}`,C9=n=>{try{const t=decodeURIComponent(n).split("/Mi unidad/");return t.length>1?t[1].replace(/\//g," / "):n}catch{return n}},D9=({isOpen:n,onClose:e,contactId:t})=>{const{getContactById:s,deals:i,showAddEditContact:o,showAddDeal:u,contactTags:h,getStageById:f}=Ue();if(!t)return null;const p=s(t),x=i.filter(N=>N.contactIds.includes(t));if(!p)return null;const v=p.contactTagIds?.map(N=>h.find(E=>E.id===N)).filter(Boolean),b=()=>{o(p),e()},I=()=>{e(),u(p.id)};return c.jsx(sn,{isOpen:n,onClose:e,title:"Contact Details",children:c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{children:c.jsxs("div",{className:"grid grid-cols-[1fr_auto] gap-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-2xl font-bold text-slate-800",children:[p.firstName," ",p.lastName]}),c.jsx("p",{className:"text-slate-600",children:p.company})]}),c.jsxs("button",{onClick:b,className:"flex items-center text-sm font-semibold text-blue-600 hover:text-blue-800 lg:hidden",children:[c.jsx(ms,{className:"w-4 h-4 mr-1"})," Edit"]})]}),v&&v.length>0&&c.jsx("div",{className:"flex flex-wrap gap-2",children:v.map(N=>c.jsx("span",{className:`text-xs font-semibold text-white px-2 py-1 rounded-full ${N.color}`,children:N.name},N.id))}),c.jsxs("div",{className:"border-t pt-4 space-y-3 text-sm",children:[p.email&&c.jsxs("p",{className:"text-slate-700",children:[c.jsx("strong",{children:"Email:"})," ",p.email]}),p.email2&&c.jsxs("p",{className:"text-slate-700",children:[c.jsx("strong",{children:"Secondary Email:"})," ",p.email2]}),c.jsxs("p",{className:"text-slate-700",children:[c.jsx("strong",{children:"Phone:"})," ",p.phone]}),p.googleDriveFolderUrl&&c.jsxs("div",{className:"flex items-start text-slate-700",children:[c.jsx("strong",{className:"w-20 flex-shrink-0",children:"Nube:"}),c.jsxs("a",{href:p.googleDriveFolderUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-600 hover:underline break-all",children:[c.jsx(QR,{className:"w-4 h-4 flex-shrink-0"}),c.jsx("span",{children:C9(p.googleDriveFolderUrl)})]})]})]})]}),c.jsxs("div",{className:"flex flex-col space-y-2 border-l pl-6",children:[c.jsxs("button",{onClick:b,className:"hidden lg:flex items-center text-sm font-semibold text-blue-600 hover:text-blue-800 justify-end mb-2",children:[c.jsx(ms,{className:"w-4 h-4 mr-1"})," Edit"]}),p.email&&c.jsx("a",{href:`mailto:${p.email}`,className:"p-2 rounded-md hover:bg-slate-100 text-slate-600 border",title:`Email ${p.email}`,children:c.jsx(Vh,{className:"w-5 h-5"})}),c.jsx("a",{href:R9(p.phone),target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-md hover:bg-slate-100 text-slate-600 border",title:`WhatsApp ${p.phone}`,children:c.jsx(cf,{className:"w-5 h-5"})})]})]})}),c.jsxs("div",{children:[c.jsxs("h4",{className:"text-lg font-semibold text-slate-800 flex items-center mb-2",children:[c.jsx(Eg,{className:"w-5 h-5 mr-2 text-slate-500"})," Associated Deals (",x.length,")"]}),c.jsx("div",{className:"border rounded-lg max-h-40 overflow-y-auto",children:x.length>0?c.jsx("ul",{className:"divide-y divide-slate-200",children:x.map(N=>{const E=f(N.stageId);return c.jsxs("li",{className:"p-3 hover:bg-slate-50",children:[c.jsx(zc,{to:`/deals/${N.id}`,onClick:e,className:"font-semibold text-blue-600 hover:underline",children:N.title}),c.jsxs("div",{className:"flex justify-between items-center mt-1",children:[c.jsx("p",{className:"text-sm text-slate-500",children:E?.name}),c.jsx("p",{className:"text-sm text-slate-400",children:$n(N.createdAt)})]})]},N.id)})}):c.jsxs("div",{className:"text-center p-4",children:[c.jsx("p",{className:"text-sm text-slate-500",children:"No deals associated with this contact."}),c.jsxs("button",{onClick:I,className:"mt-2 text-sm font-semibold text-blue-600 hover:underline flex items-center justify-center mx-auto",children:[c.jsx(fs,{className:"w-4 h-4 mr-1"}),"Create New Deal"]})]})})]}),c.jsx("div",{className:"border-t pt-4",children:c.jsx(A9,{contactId:p.id})})]})})},GS=[{name:"Mexico",code:"+52"},{name:"USA",code:"+1"}],k9=({isOpen:n,onClose:e,contactToEdit:t})=>{const{addContact:s,updateContact:i,deleteContact:o,showConfirmation:u,pickGoogleDriveFolder:h,isGoogleDriveConnected:f,googleApiReady:p,contactTags:x}=Ue(),[v,b]=S.useState(""),[I,N]=S.useState(""),[E,A]=S.useState(""),[C,q]=S.useState(""),[P,V]=S.useState("+52"),[F,K]=S.useState(""),[L,k]=S.useState(""),[D,M]=S.useState(""),[B,G]=S.useState([]);S.useEffect(()=>{if(t){b(t.firstName),N(t.lastName),A(t.email),q(t.email2||""),k(t.company),M(t.googleDriveFolderUrl||""),G(t.contactTagIds||[]);const O=t.phone||"";let oe=!1;const me=[...GS].sort((te,we)=>we.code.length-te.code.length);for(const te of me)if(O.startsWith(te.code)){V(te.code),K(O.substring(te.code.length)),oe=!0;break}oe||(V("+52"),K(O.replace(/\D/g,"")))}else b(""),N(""),A(""),q(""),V("+52"),K(""),k(""),M(""),G([])},[t,n]);const z=O=>{O.preventDefault();const oe=v.trim(),me=I.trim(),te=E.replace(/\s/g,""),we=C.replace(/\s/g,""),Ce=F.replace(/\s/g,""),Pe=L.trim(),xt=D.trim();if(!oe&&!me&&!te&&!Ce&&!Pe){alert("Please fill out at least one field (First Name, Last Name, Email, Phone, or Company) to create a contact.");return}const rt={firstName:oe,lastName:me,email:te,email2:we,phone:`${P}${Ce}`,company:Pe,googleDriveFolderUrl:xt,contactTagIds:B};e(),(async()=>{try{t?await i({...rt,id:t.id,createdAt:t.createdAt}):await s(rt)}catch(Ot){console.error("Failed to save contact in background:",Ot)}})()},he=()=>{t&&u("Are you sure you want to delete this contact? It will be moved to the archive.",()=>{o(t.id),e()})},Se=async()=>{try{const O=await h();O&&M(O.url)}catch(O){console.error(O),alert("Could not open Google Drive picker. Please ensure you are connected in Settings.")}},J=S.useMemo(()=>B.map(O=>x.find(oe=>oe.id===O)).filter(Boolean),[B,x]),ge=S.useMemo(()=>x.filter(O=>!B.includes(O.id)),[B,x]),le=O=>{O&&!B.includes(O)&&G(oe=>[...oe,O])},Ie=O=>{G(oe=>oe.filter(me=>me!==O))};return c.jsx(sn,{isOpen:n,onClose:e,title:t?"Edit Contact":"Add New Contact",children:c.jsxs("form",{onSubmit:z,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-slate-700",children:"First Name"}),c.jsx("input",{type:"text",id:"firstName",value:v,onChange:O=>b(O.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-slate-700",children:"Last Name"}),c.jsx("input",{type:"text",id:"lastName",value:I,onChange:O=>N(O.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700",children:"Email"}),c.jsx("input",{type:"email",id:"email",value:E,onChange:O=>A(O.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email2",className:"block text-sm font-medium text-slate-700",children:"Secondary Email (Optional)"}),c.jsx("input",{type:"email",id:"email2",value:C,onChange:O=>q(O.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-slate-700",children:"Phone"}),c.jsxs("div",{className:"mt-1 flex rounded-md shadow-sm",children:[c.jsx("select",{value:P,onChange:O=>V(O.target.value),className:"inline-flex items-center px-3 rounded-l-md border border-r-0 border-slate-300 bg-slate-50 text-slate-500 text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500","aria-label":"Country code",children:GS.map(O=>c.jsxs("option",{value:O.code,children:[O.name," (",O.code,")"]},O.code))}),c.jsx("input",{type:"tel",id:"phone",placeholder:"Phone number",value:F,onChange:O=>K(O.target.value),className:"flex-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-r-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"company",className:"block text-sm font-medium text-slate-700",children:"Company"}),c.jsx("input",{type:"text",id:"company",value:L,onChange:O=>k(O.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"googleDriveUrl",className:"block text-sm font-medium text-slate-700",children:"Google Drive Folder URL"}),c.jsxs("div",{className:"mt-1 flex gap-2",children:[c.jsx("input",{type:"url",id:"googleDriveUrl",value:D,onChange:O=>M(O.target.value),placeholder:"https://drive.google.com/...",className:"flex-grow block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"}),c.jsx("button",{type:"button",onClick:Se,disabled:!f||!p,title:f?"Select Folder from Google Drive":"Connect to Google Drive in Settings first",className:"flex-shrink-0 px-3 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200 disabled:bg-slate-50 disabled:cursor-not-allowed disabled:text-slate-400",children:c.jsx(oo,{className:"w-5 h-5"})})]}),!f&&c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Connect to Google Drive in Settings to enable folder selection."})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Contact Tags"}),c.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2 p-2 border border-slate-300 rounded-md bg-white",children:[J.map(O=>c.jsxs("span",{className:`text-xs font-semibold text-white px-2 py-1 rounded-full flex items-center ${O.color}`,children:[O.name,c.jsx("button",{type:"button",onClick:()=>Ie(O.id),className:"ml-1.5 -mr-0.5 text-white/70 hover:text-white",children:c.jsx(fn,{className:"w-3 h-3"})})]},O.id)),c.jsxs("select",{onChange:O=>{le(O.target.value),O.target.value=""},value:"",className:"flex-grow bg-transparent border-none focus:ring-0 text-sm p-0 min-w-[120px]",children:[c.jsx("option",{value:"",children:"Add a tag..."}),ge.map(O=>c.jsx("option",{value:O.id,children:O.name},O.id))]})]})]}),c.jsxs("div",{className:"flex justify-between items-center pt-4",children:[c.jsx("div",{children:t&&c.jsxs("button",{type:"button",onClick:he,className:"flex items-center text-sm font-medium text-red-600 hover:text-red-800 hover:bg-red-50 px-3 py-2 rounded-md",children:[c.jsx(In,{className:"w-4 h-4 mr-2"}),"Delete Contact"]})}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{type:"button",onClick:e,className:"mr-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed",children:t?"Save Changes":"Add Contact"})]})]})]})})},j9=({isOpen:n,onClose:e,defaultContactId:t})=>{const{addDeal:s,contacts:i,users:o,pipelineStages:u,showAlert:h}=Ue(),f=Xi(),[p,x]=S.useState(""),[v,b]=S.useState(""),[I,N]=S.useState(""),[E,A]=S.useState("user_raul_colosio"),[C,q]=S.useState(!1);S.useEffect(()=>{n&&(x(""),b(t||""),N(u.length>0?u[0].id:""),A("user_raul_colosio"),q(!1))},[n,t,u]);const P=async V=>{if(V.preventDefault(),!(!p||!I||C)){q(!0);try{const F=await s({title:p,contactIds:v?[v]:[],assignedUserId:E,stageId:I,tagIds:[]});f(`/deals/${F.id}`),e()}catch(F){console.error("Failed to create deal:",F)}finally{q(!1)}}};return c.jsx(sn,{isOpen:n,onClose:e,title:"Add New Deal",children:c.jsxs("form",{onSubmit:P,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-slate-700",children:"Deal Title"}),c.jsx("input",{type:"text",id:"title",value:p,onChange:V=>x(V.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"contact",className:"block text-sm font-medium text-slate-700",children:"Contact"}),c.jsxs("select",{id:"contact",value:v,onChange:V=>b(V.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:!!t,children:[c.jsx("option",{value:"",children:"Select a contact (optional)"}),i.map(V=>c.jsxs("option",{value:V.id,children:[V.firstName," ",V.lastName," - ",V.company]},V.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"assignedUser",className:"block text-sm font-medium text-slate-700",children:"Assigned To"}),c.jsx("select",{id:"assignedUser",value:E,onChange:V=>A(V.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:o.map(V=>c.jsx("option",{value:V.id,children:V.name},V.id))})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"stage",className:"block text-sm font-medium text-slate-700",children:"Stage"}),c.jsx("select",{id:"stage",value:I,onChange:V=>N(V.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:u.map(V=>c.jsx("option",{value:V.id,children:V.name},V.id))})]}),c.jsxs("div",{className:"flex justify-end pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"mr-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md hover:bg-slate-200",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:C,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed",children:C?"Saving...":"Add Deal"})]})]})})},P9=({isOpen:n,onClose:e,title:t,message:s})=>n?c.jsx(sn,{isOpen:n,onClose:e,title:t,children:c.jsxs("div",{className:"space-y-6",children:[c.jsx("p",{className:"text-slate-600 text-sm",children:s}),c.jsx("div",{className:"flex justify-end pt-4",children:c.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Aceptar"})})]})}):null,O9=({isCollapsed:n})=>{const{notifications:e}=Ue(),t=e.filter(i=>!i.isRead).length,s=({isActive:i})=>`flex items-center py-3 text-sm font-medium rounded-lg transition-colors duration-200 relative ${n?"px-3 justify-center":"px-4"} ${i?"bg-blue-600 text-white":"text-slate-200 hover:bg-slate-700 hover:text-white"}`;return c.jsxs(Xo,{to:"/messages",className:s,title:"Mensajes",children:[c.jsx(WR,{className:`w-5 h-5 shrink-0 ${!n&&"mr-3"}`}),!n&&c.jsx("span",{className:"truncate",children:"Mensajes"}),t>0&&c.jsxs("span",{className:`absolute top-2 flex ${n?"right-2":"right-4"}`,children:[c.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),c.jsx("span",{className:"relative flex items-center justify-center h-5 min-w-[20px] px-1 text-xs font-bold text-white bg-red-500 rounded-full",children:t})]})]})},M9=({isCollapsed:n,onToggle:e})=>{const{currentUser:t,logout:s,tasks:i}=Ue(),o=t?.role==="Administrador",u=S.useMemo(()=>t?i.filter(f=>!f.completed&&f.responsibleUserId===t.id).length:0,[i,t]),h=({isActive:f})=>`flex items-center py-3 text-sm font-medium rounded-lg transition-colors duration-200 relative ${n?"px-3 justify-center":"px-4"} ${f?"bg-blue-600 text-white":"text-slate-200 hover:bg-slate-700 hover:text-white"}`;return c.jsxs("div",{className:`bg-slate-800 text-white flex flex-col h-screen relative z-20 transition-all duration-300 ${n?"w-20":"w-64"}`,children:[c.jsx("div",{className:"flex items-center justify-center h-20 border-b border-slate-700 shrink-0 px-4",children:n?c.jsx(Eg,{className:"w-8 h-8 text-white mx-auto"}):c.jsx("h1",{className:"text-2xl font-bold text-white",children:"PROMOTIENDA"})}),c.jsxs("nav",{className:`p-4 space-y-2 overflow-y-auto flex-grow ${n?"px-2":"px-4"}`,children:[c.jsxs(Xo,{to:"/deals",className:h,title:"Ventas",children:[c.jsx(_B,{className:`w-5 h-5 shrink-0 ${!n&&"mr-3"}`}),!n&&c.jsx("span",{className:"truncate",children:"Ventas"})]}),c.jsxs(Xo,{to:"/production",className:h,title:"Produccin",children:[c.jsx(bB,{className:`w-5 h-5 shrink-0 ${!n&&"mr-3"}`}),!n&&c.jsx("span",{className:"truncate",children:"Produccin"})]}),c.jsxs(Xo,{to:"/activities",className:h,title:"Tareas",children:[c.jsx($_,{className:`w-5 h-5 shrink-0 ${!n&&"mr-3"}`}),!n&&c.jsx("span",{className:"truncate",children:"Tareas"}),u>0&&c.jsxs("span",{className:`absolute top-2 flex ${n?"right-2":"right-4"}`,children:[c.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),c.jsx("span",{className:"relative flex items-center justify-center h-5 min-w-[20px] px-1 text-xs font-bold text-white bg-red-500 rounded-full",children:u})]})]}),c.jsx(O9,{isCollapsed:n}),c.jsxs(Xo,{to:"/contacts",className:h,title:"Contacts",children:[c.jsx(Rr,{className:`w-5 h-5 shrink-0 ${!n&&"mr-3"}`}),!n&&c.jsx("span",{className:"truncate",children:"Contacts"})]}),o&&c.jsxs(Xo,{to:"/settings",className:h,title:"Settings",children:[c.jsx(ZF,{className:`w-5 h-5 shrink-0 ${!n&&"mr-3"}`}),!n&&c.jsx("span",{className:"truncate",children:"Settings"})]})]}),c.jsxs("div",{className:"shrink-0",children:[c.jsx("div",{className:"p-4 border-t border-slate-700",children:c.jsx("button",{onClick:e,className:`${h({isActive:!1})} w-full`,"aria-label":n?"Expand sidebar":"Collapse sidebar",children:n?c.jsx(tB,{className:"w-5 h-5"}):c.jsx(Q_,{className:"w-5 h-5"})})}),t&&c.jsx("div",{className:"p-4 border-t border-slate-700",children:n?c.jsx("div",{className:"bg-slate-700 text-white rounded-full h-10 w-10 flex items-center justify-center text-lg font-bold mx-auto",title:`${t.name}
${t.email}`,children:t.name.charAt(0).toUpperCase()}):c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-semibold text-white truncate",title:t.name,children:t.name}),c.jsx("p",{className:"text-xs text-slate-400 truncate",title:t.email,children:t.email})]})}),c.jsx("div",{className:"p-4 border-t border-slate-700",children:c.jsxs("button",{onClick:s,className:`${h({isActive:!1})} w-full`,title:"Logout",children:[c.jsx(aB,{className:`w-5 h-5 shrink-0 ${!n&&"mr-3"}`}),!n&&c.jsx("span",{className:"truncate",children:"Logout"})]})})]})]})},V9=()=>{const[n,e]=S.useState(!1);return c.jsxs("div",{className:"flex bg-slate-100 h-screen",children:[c.jsx(M9,{isCollapsed:n,onToggle:()=>e(t=>!t)}),c.jsx("main",{className:"flex-1 flex flex-col overflow-hidden",children:c.jsx(nN,{})})]})},L9=()=>{const{loading:n,currentUser:e}=Ue();return n?c.jsx("div",{className:"flex items-center justify-center h-screen bg-slate-100",children:c.jsx("p",{className:"text-slate-500",children:"Loading Application..."})}):e?c.jsx(nN,{}):c.jsx(ip,{to:"/login",replace:!0})},U9=()=>c.jsxs(Rk,{children:[c.jsx(Os,{path:"/login",element:c.jsx(E9,{})}),c.jsx(Os,{element:c.jsx(L9,{}),children:c.jsxs(Os,{element:c.jsx(V9,{}),children:[c.jsx(Os,{path:"/",element:c.jsx(ip,{to:"/deals",replace:!0})}),c.jsx(Os,{path:"/deals",element:c.jsx(SB,{})}),c.jsx(Os,{path:"/deals/:dealId",element:c.jsx(JB,{})}),c.jsx(Os,{path:"/contacts",element:c.jsx(jB,{})}),c.jsx(Os,{path:"/activities",element:c.jsx(e9,{})}),c.jsx(Os,{path:"/production",element:c.jsx(T9,{})}),c.jsx(Os,{path:"/messages",element:c.jsx(I9,{})}),c.jsx(Os,{path:"/settings",element:c.jsx(_9,{})})]})}),c.jsx(Os,{path:"*",element:c.jsx(ip,{to:"/",replace:!0})})]}),F9=()=>{const{showContactDetail:n}=Ue(),e=Yi(),t=Xi();return S.useEffect(()=>{const i=new URLSearchParams(e.search).get("contactId");i&&(n(i),t(e.pathname,{replace:!0}))},[e.search,n,t]),null},B9=()=>{const{notifications:n,loading:e}=Ue(),t=S.useRef(null),s=S.useRef(!1),i=S.useRef(new Set),o=S.useRef(!0);return S.useEffect(()=>{const u=()=>{o.current=!document.hidden};return document.addEventListener("visibilitychange",u),()=>document.removeEventListener("visibilitychange",u)},[]),S.useEffect(()=>{if(e)return;const u=new Set(n.map(f=>f.id));if(!s.current){s.current=!0,i.current=u;return}const h=n.filter(f=>!i.current.has(f.id));if(h.length>0){const f=h[0];if(o.current)t.current?.play().catch(p=>console.warn("Audio play failed:",p));else if("Notification"in window&&Notification.permission==="granted"){const p=new Notification("New Message",{body:f.message,icon:"/vite.svg",silent:!1});p.onclick=()=>{window.focus()}}}i.current=u},[n,e]),c.jsx("audio",{ref:t,id:"notification-sound",src:"https://cdn.pixabay.com/download/audio/2023/09/24/audio_3108132791.mp3",preload:"auto"})},z9=()=>{const[n,e]=S.useState(null),[t,s]=S.useState({isOpen:!1,contactId:null}),[i,o]=S.useState({isOpen:!1,contactToEdit:null}),[u,h]=S.useState({isOpen:!1}),[f,p]=S.useState(null),x=(F,K)=>e({isOpen:!0,message:F,onConfirm:K}),v=F=>s({isOpen:!0,contactId:F}),b=F=>o({isOpen:!0,contactToEdit:F}),I=F=>h({isOpen:!0,contactId:F}),N=(F,K)=>p({isOpen:!0,title:F,message:K}),E=()=>e(null),A=async()=>{n&&(await n.onConfirm(),E())},C=()=>s({isOpen:!1,contactId:null}),q=()=>o({isOpen:!1,contactToEdit:null}),P=()=>h({isOpen:!1}),V=()=>p(null);return c.jsx(Jk,{children:c.jsxs(JF,{showConfirmation:x,showContactDetail:v,showAddEditContact:b,showAddDeal:I,showAlert:N,children:[c.jsx(F9,{}),c.jsx(B9,{}),c.jsx(U9,{}),c.jsx(S9,{isOpen:n?.isOpen||!1,onClose:E,onConfirm:A,title:"Confirm Action",message:n?.message||""}),c.jsx(D9,{isOpen:t.isOpen,onClose:C,contactId:t.contactId}),c.jsx(k9,{isOpen:i.isOpen,onClose:q,contactToEdit:i.contactToEdit}),c.jsx(j9,{isOpen:u.isOpen,onClose:P,defaultContactId:u.contactId}),c.jsx(P9,{isOpen:f?.isOpen||!1,onClose:V,title:f?.title||"Alert",message:f?.message||""})]})})},tC=document.getElementById("root");if(!tC)throw new Error("Could not find root element to mount to");const q9=MD.createRoot(tC);q9.render(c.jsx(Wi.StrictMode,{children:c.jsx(z9,{})}));
